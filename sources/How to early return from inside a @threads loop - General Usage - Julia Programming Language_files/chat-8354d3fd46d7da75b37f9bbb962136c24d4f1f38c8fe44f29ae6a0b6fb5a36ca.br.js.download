define("discourse/plugins/chat/discourse/adapters/chat-message",["exports","discourse/adapters/rest"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{pathFor(e,t,i){if(i.targetMessageId)return`/chat/lookup/${i.targetMessageId}.json?chat_channel_id=${i.channelId}`
let n=`/chat/${i.channelId}/messages.json?page_size=${i.pageSize}`
return i.messageId&&(n+=`&message_id=${i.messageId}`),i.direction&&(n+=`&direction=${i.direction}`),n}apiNameFor(){return"chat-message"}}e.default=i})),define("discourse/plugins/chat/discourse/admin-chat-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"admin.adminPlugins",path:"/plugins",map(){this.route("chat")}}})),define("discourse/plugins/chat/discourse/chat-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){this.route("chat",{path:"/chat"},(function(){this.route("channel",{path:"/c/:channelTitle/:channelId"},(function(){this.route("near-message",{path:"/:messageId"}),this.route("threads",{path:"/t"}),this.route("thread",{path:"/t/:threadId"},(function(){this.route("near-message",{path:"/:messageId"})}))})),this.route("channel.info",{path:"/c/:channelTitle/:channelId/info"},(function(){this.route("members",{path:"/members"}),this.route("settings",{path:"/settings"})})),this.route("browse",{path:"/browse"},(function(){this.route("all",{path:"/all"}),this.route("closed",{path:"/closed"}),this.route("open",{path:"/open"}),this.route("archived",{path:"/archived"})})),this.route("message",{path:"/message/:messageId"})}))}})),define("discourse/plugins/chat/discourse/components/channels-list",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","discourse-common/utils/decorators","discourse/plugins/chat/discourse/components/chat/modal/new-message","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p,m,b,g,f,v,y,w
function _(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const M=(0,c.createTemplateFactory)({id:"SZZdf8nK",block:'[[[41,[30,0,["showMobileDirectMessageButton"]],[[[1,"  "],[8,[39,1],[[24,0,"no-text btn-flat open-new-message-btn keep-mobile-sidebar-open btn-floating"],[16,"title",[28,[37,2],[[30,0,["createDirectMessageChannelLabel"]]],null]]],[["@icon","@action"],["plus",[30,0,["openNewMessageModal"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[11,0],[24,"role","region"],[16,"aria-label",[28,[37,2],["chat.aria_roles.channels_list"],null]],[16,0,[28,[37,3],["channels-list",[52,[30,0,["hasScrollbar"]],"has-scrollbar"]],null]],[4,[38,4],["scroll",[52,[30,0,["chatStateManager","isFullPageActive"]],[30,0,["storeScrollPosition"]],[28,[37,5],null,null]]],null],[4,[38,6],[[30,0,["computeHasScrollbar"]]],null],[4,[38,7],[[30,0,["computeResizedEntries"]]],null],[12],[1,"\\n"],[41,[30,0,["displayPublicChannels"]],[[[1,"    "],[10,0],[14,0,"chat-channel-divider public-channels-section"],[12],[1,"\\n"],[41,[30,0,["inSidebar"]],[[[1,"        "],[11,1],[24,0,"title-caret"],[24,1,"public-channels-caret"],[24,"role","button"],[24,"title","toggle nav list"],[24,"data-toggleable","public-channels"],[4,[38,4],["click",[28,[37,8],[[30,0],"toggleChannelSection","public-channels"],null]],null],[12],[1,"\\n          "],[1,[28,[35,9],["angle-up"],null]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"      "],[10,1],[14,0,"channel-title"],[12],[1,[28,[35,2],["chat.chat_channels"],null]],[13],[1,"\\n\\n      "],[8,[39,10],[[24,0,"btn no-text btn-flat open-browse-page-btn title-action"],[16,"title",[28,[37,2],["chat.channels_list_popup.browse"],null]]],[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n        "],[1,[28,[35,9],["pencil-alt"],null]],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,1,"public-channels"],[15,0,[28,[37,3],["channels-list-container","public-channels",[52,[30,0,["inSidebar"]],"collapsible-sidebar-section"]],null]],[12],[1,"\\n"],[41,[30,0,["publicChannelsEmpty"]],[[[1,"        "],[10,0],[14,0,"public-channel-empty-message"],[12],[1,"\\n          "],[10,1],[14,0,"channel-title"],[12],[1,[28,[35,2],["chat.no_public_channels"],null]],[13],[1,"\\n          "],[8,[39,10],null,[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n            "],[1,[28,[35,2],["chat.click_to_join"],null]],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[42,[28,[37,12],[[28,[37,12],[[30,0,["chatChannelsManager","publicMessageChannels"]]],null]],null],null,[[[1,"          "],[8,[39,13],null,[["@channel","@options"],[[30,1],[28,[37,14],null,[["settingsButton"],[true]]]]],null],[1,"\\n"]],[1]],null]],[]]],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[8,[39,15],null,[["@name","@tagName","@outletArgs"],["below-public-chat-channels","",[28,[37,14],null,[["inSidebar"],[[30,0,["inSidebar"]]]]]]],null],[1,"\\n\\n"],[41,[30,0,["showDirectMessageChannels"]],[[[1,"    "],[10,0],[14,0,"chat-channel-divider direct-message-channels-section"],[12],[1,"\\n"],[41,[30,0,["inSidebar"]],[[[1,"        "],[11,1],[24,0,"title-caret"],[24,1,"direct-message-channels-caret"],[24,"role","button"],[24,"title","toggle nav list"],[24,"data-toggleable","direct-message-channels"],[4,[38,4],["click",[28,[37,8],[[30,0],"toggleChannelSection","direct-message-channels"],null]],null],[12],[1,"\\n          "],[1,[28,[35,9],["angle-up"],null]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"      "],[10,1],[14,0,"channel-title"],[12],[1,[28,[35,2],["chat.direct_messages.title"],null]],[13],[1,"\\n\\n"],[41,[28,[37,16],[[30,0,["canCreateDirectMessageChannel"]],[28,[37,17],[[30,0,["showMobileDirectMessageButton"]]],null]],null],[[[1,"        "],[8,[39,1],[[24,0,"no-text btn-flat open-new-message-btn"],[16,"title",[28,[37,2],[[30,0,["createDirectMessageChannelLabel"]]],null]]],[["@icon","@action"],["plus",[30,0,["openNewMessageModal"]]]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[10,0],[14,1,"direct-message-channels"],[15,0,[30,0,["directMessageChannelClasses"]]],[12],[1,"\\n"],[42,[28,[37,12],[[28,[37,12],[[30,0,["chatChannelsManager","truncatedDirectMessageChannels"]]],null]],null],null,[[[1,"      "],[8,[39,13],null,[["@channel","@options"],[[30,2],[28,[37,14],null,[["leaveButton"],[true]]]]],null],[1,"\\n"]],[2]],null],[1,"  "],[13],[1,"\\n"],[13]],["channel","channel"],false,["if","d-button","i18n","concat-class","on","noop","did-insert","chat/on-resize","action","d-icon","link-to","each","-track-array","chat-channel-row","hash","plugin-outlet","and","not"]]',moduleName:"discourse/plugins/chat/discourse/components/channels-list.hbs",isStrictMode:!1})
let z=e.default=(u=class extends i.default{constructor(){super(...arguments),_(this,"chat",d,this),_(this,"router",h,this),_(this,"chatStateManager",p,this),_(this,"chatChannelsManager",m,this),_(this,"site",b,this),_(this,"siteSettings",g,this),_(this,"session",f,this),_(this,"currentUser",v,this),_(this,"modal",y,this),_(this,"hasScrollbar",w,this)}computeHasScrollbar(e){this.hasScrollbar=e.scrollHeight>e.clientHeight}computeResizedEntries(e){this.computeHasScrollbar(e[0].target)}openNewMessageModal(){this.modal.show(l.default)}get showMobileDirectMessageButton(){return this.site.mobileView&&this.canCreateDirectMessageChannel}get inSidebar(){return this.args.inSidebar??!1}get publicMessageChannelsEmpty(){return 0===this.chatChannelsManager.publicMessageChannels?.length}get createDirectMessageChannelLabel(){return this.canCreateDirectMessageChannel?"chat.direct_messages.new":"chat.direct_messages.cannot_create"}get showDirectMessageChannels(){return this.canCreateDirectMessageChannel||this.chatChannelsManager.directMessageChannels?.length>0}get canCreateDirectMessageChannel(){return this.chat.userCanDirectMessage}get displayPublicChannels(){return!!this.siteSettings.enable_public_channels&&(!this.publicMessageChannelsEmpty||(this.currentUser?.staff||this.currentUser?.has_joinable_public_channels))}get directMessageChannelClasses(){return"channels-list-container direct-message-channels "+(this.inSidebar?"collapsible-sidebar-section":"")}toggleChannelSection(e){this.args.toggleSection(e)}didRender(){this._super(...arguments),(0,a.schedule)("afterRender",this._applyScrollPosition)}storeScrollPosition(){if(this.chatStateManager.isDrawerActive)return
const e=document.querySelector(".channels-list")?.scrollTop||0
this.session.channelsListPosition=e}_applyScrollPosition(){if(this.chatStateManager.isDrawerActive)return
const e=this.chatStateManager.isFullPageActive&&this.session.channelsListPosition||0
document.querySelector(".channels-list").scrollTo(0,e)}},d=j(u.prototype,"chat",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=j(u.prototype,"router",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=j(u.prototype,"chatStateManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=j(u.prototype,"chatChannelsManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=j(u.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=j(u.prototype,"siteSettings",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=j(u.prototype,"session",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=j(u.prototype,"currentUser",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=j(u.prototype,"modal",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=j(u.prototype,"hasScrollbar",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j(u.prototype,"computeHasScrollbar",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"computeHasScrollbar"),u.prototype),j(u.prototype,"computeResizedEntries",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"computeResizedEntries"),u.prototype),j(u.prototype,"openNewMessageModal",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"openNewMessageModal"),u.prototype),j(u.prototype,"toggleChannelSection",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"toggleChannelSection"),u.prototype),j(u.prototype,"storeScrollPosition",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"storeScrollPosition"),u.prototype),j(u.prototype,"_applyScrollPosition",[o.bind],Object.getOwnPropertyDescriptor(u.prototype,"_applyScrollPosition"),u.prototype),u);(0,t.setComponentTemplate)(M,z)})),define("discourse/plugins/chat/discourse/components/chat-browse-view",["exports","@ember/component","@ember/object","@ember/runloop","@ember/service","discourse-common/config/environment","discourse-common/lib/debounce","discourse/plugins/chat/discourse/components/chat/modal/create-channel","discourse/plugins/chat/discourse/components/chat/modal/new-message","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const f=(0,c.createTemplateFactory)({id:"zgnKR+Z1",block:'[[[10,0],[14,0,"chat-browse-view__header chat-full-page-header"],[12],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"    "],[8,[39,1],[[24,0,"chat-full-page-header__back-btn no-text btn-flat btn"],[16,"title",[28,[37,2],["chat.browse.back"],null]]],[["@route"],["chat.index"]],[["default"],[[[[1,"\\n      "],[1,[28,[35,3],["chevron-left"],null]],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n  "],[10,1],[14,0,"chat-browse-view__title"],[12],[1,[28,[35,2],["chat.browse.title"],null]],[13],[1,"\\n\\n"],[41,[30,0,["currentUser","staff"]],[[[1,"    "],[8,[39,4],[[16,0,[28,[37,5],["new-channel-btn",[52,[30,0,["site","mobileView"]],"btn-flat"]],null]]],[["@action","@icon","@label"],[[30,0,["createChannel"]],"plus",[52,[30,0,["site","desktopView"]],"chat.create_channel.title"]]],null],[1,"\\n"]],[]],null],[13],[1,"\\n\\n"],[10,0],[14,0,"chat-browse-view"],[12],[1,"\\n  "],[10,0],[14,0,"chat-browse-view__actions"],[12],[1,"\\n    "],[10,"nav"],[12],[1,"\\n      "],[10,"ul"],[14,0,"nav-pills chat-browse-view__filters"],[12],[1,"\\n"],[42,[28,[37,7],[[28,[37,7],[[30,0,["tabs"]]],null]],null],null,[[[1,"          "],[10,"li"],[15,0,[28,[37,8],["chat-browse-view__filter -",[30,1]],null]],[12],[1,"\\n            "],[8,[39,1],[[16,0,[28,[37,8],["chat-browse-view__filter-link -",[30,1]],null]]],[["@route"],[[28,[37,8],["chat.browse.",[30,1]],null]]],[["default"],[[[[1,"\\n              "],[1,[28,[35,2],[[28,[37,8],["chat.browse.filter_",[30,1]],null]],null]],[1,"\\n            "]],[]]]]],[1,"\\n          "],[13],[1,"\\n"]],[1]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[39,9],[[16,"placeholder",[28,[37,2],["chat.browse.filter_input_placeholder"],null]],[4,[38,12],[[28,[37,10],[[30,0],[30,0,["focusFilterInput"]]],null]],null]],[["@class","@filterAction","@icons"],["filter-input",[28,[37,10],[[30,0],"debouncedFiltering"],null],[28,[37,11],null,[["right"],["search"]]]]],null],[1,"\\n  "],[13],[1,"\\n\\n"],[41,[28,[37,13],[[30,0,["channelsCollection","fetchedOnce"]],[28,[37,14],[[30,0,["channelsCollection","length"]]],null]],null],[[[1,"    "],[10,0],[14,0,"empty-state"],[12],[1,"\\n      "],[10,1],[14,0,"empty-state-title"],[12],[1,[28,[35,2],["chat.empty_state.title"],null]],[13],[1,"\\n      "],[10,0],[14,0,"empty-state-body"],[12],[1,"\\n        "],[10,2],[12],[1,[28,[35,2],["chat.empty_state.direct_message"],null]],[13],[1,"\\n        "],[8,[39,4],null,[["@action","@label"],[[30,0,["showChatNewMessageModal"]],"chat.empty_state.direct_message_cta"]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[41,[30,0,["channelsCollection","length"]],[[[1,"    "],[8,[39,15],null,[["@selector","@action"],[".chat-channel-card",[30,0,["channelsCollection","load"]]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-browse-view__content_wrapper"],[12],[1,"\\n        "],[10,0],[14,0,"chat-browse-view__content"],[12],[1,"\\n          "],[10,0],[14,0,"chat-browse-view__cards"],[12],[1,"\\n"],[42,[28,[37,7],[[28,[37,7],[[30,0,["channelsCollection"]]],null]],null],null,[[[1,"              "],[8,[39,16],null,[["@channel"],[[30,2]]],null],[1,"\\n"]],[2]],null],[1,"          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,17],null,[["@condition"],[[30,0,["channelsCollection","loading"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]],null]],[]]],[13]],["tab","channel"],false,["if","link-to","i18n","d-icon","d-button","concat-class","each","-track-array","concat","dc-filter-input","action","hash","did-insert","and","not","load-more","chat-channel-card","conditional-loading-spinner"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-browse-view.hbs",isStrictMode:!1}),v=["all","open","closed","archived"]
let y=e.default=(u=(0,i.computed)("siteSettings.chat_allow_archiving_channels"),d=class extends t.default{constructor(){super(...arguments),m(this,"chatApi",h,this),m(this,"modal",p,this),b(this,"tagName","")}didReceiveAttrs(){this._super(...arguments),this.channelsCollection||this.set("channelsCollection",this.chatApi.channels()),this.channelsCollection.load({filter:this.filter,status:this.status})}get tabs(){return this.siteSettings.chat_allow_archiving_channels?v:[...v].removeObject("archived")}showChatNewMessageModal(){this.modal.show(l.default)}onScroll(){(0,s.default)(this,this.channelsCollection.load,{filter:this.filter,status:this.status},a.INPUT_DELAY)}debouncedFiltering(e){this.set("channelsCollection",this.chatApi.channels()),(0,s.default)(this,this.channelsCollection.load,{filter:e.target.value,status:this.status},a.INPUT_DELAY)}createChannel(){this.modal.show(o.default)}focusFilterInput(e){(0,n.schedule)("afterRender",(()=>e?.focus()))}},h=g(d.prototype,"chatApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=g(d.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g(d.prototype,"tabs",[u],Object.getOwnPropertyDescriptor(d.prototype,"tabs"),d.prototype),g(d.prototype,"showChatNewMessageModal",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"showChatNewMessageModal"),d.prototype),g(d.prototype,"onScroll",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"onScroll"),d.prototype),g(d.prototype,"debouncedFiltering",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"debouncedFiltering"),d.prototype),g(d.prototype,"createChannel",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"createChannel"),d.prototype),g(d.prototype,"focusFilterInput",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"focusFilterInput"),d.prototype),d);(0,t.setComponentTemplate)(f,y)})),define("discourse/plugins/chat/discourse/components/chat-channel-archive-status",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","@ember/template","@ember/utils","discourse/lib/ajax-error","discourse-common/lib/get-url","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const g=(0,u.createTemplateFactory)({id:"OSF9OQ/P",block:'[[[41,[30,0,["shouldRender"]],[[[41,[30,1,["archive","failed"]],[[[1,"    "],[10,0],[15,0,[28,[37,1],["alert alert-warn chat-channel-retry-archive",[30,1,["status"]]],null]],[12],[1,"\\n      "],[10,0],[14,0,"chat-channel-archive-failed-message"],[12],[1,"\\n        "],[1,[30,0,["channelArchiveFailedMessage"]]],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"chat-channel-archive-failed-retry"],[12],[1,"\\n        "],[8,[39,2],null,[["@action","@label"],[[30,0,["retryArchive"]],"chat.channel_archive.retry"]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[41,[30,1,["archive","completed"]],[[[1,"    "],[10,0],[15,0,[28,[37,1],["chat-channel-archive-status",[30,1,["status"]]],null]],[12],[1,"\\n      "],[1,[30,0,["channelArchiveCompletedMessage"]]],[1,"\\n    "],[13],[1,"\\n  "]],[]],null]],[]]]],[]],null]],["@channel"],false,["if","concat-class","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-archive-status.hbs",isStrictMode:!1})
let f=e.default=(d=class extends i.default{constructor(){super(...arguments),m(this,"chatApi",h,this),m(this,"currentUser",p,this)}get shouldRender(){return this.currentUser.admin&&(0,s.isPresent)(this.args.channel.archive)}get channelArchiveFailedMessage(){const e=this.args.channel.archive,t=e.topicId?"chat.channel_status.archive_failed":"chat.channel_status.archive_failed_no_topic"
return(0,a.htmlSafe)(c.default.t(t,{completed:e.messages,total:e.totalMessages,topic_url:this.topicUrl}))}get channelArchiveCompletedMessage(){return(0,a.htmlSafe)(c.default.t("chat.channel_status.archive_completed",{topic_url:this.topicUrl}))}retryArchive(){return this.chatApi.createChannelArchive(this.args.channel.id).catch(o.popupAjaxError)}get topicUrl(){return this.args.channel.archive.topicId?(0,l.default)(`/t/-/${this.args.channel.archive.topicId}`):""}},h=b(d.prototype,"chatApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=b(d.prototype,"currentUser",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b(d.prototype,"retryArchive",[n.action],Object.getOwnPropertyDescriptor(d.prototype,"retryArchive"),d.prototype),d);(0,t.setComponentTemplate)(g,f)})),define("discourse/plugins/chat/discourse/components/chat-channel-card",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"iGJxwFqF",block:'[[[41,[30,1],[[[1,"  "],[10,0],[15,0,[28,[37,1],["chat-channel-card",[52,[30,1,["isClosed"]],"-closed"],[52,[30,1,["isArchived"]],"-archived"]],null]],[15,5,[28,[37,2],[[30,1,["chatable","color"]]],null]],[15,"data-channel-id",[30,1,["id"]]],[12],[1,"\\n    "],[10,0],[14,0,"chat-channel-card__header"],[12],[1,"\\n      "],[8,[39,3],[[24,0,"chat-channel-card__name-container"]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n        "],[10,1],[14,0,"chat-channel-card__name"],[12],[1,"\\n          "],[1,[28,[35,4],[[30,1,["title"]]],null]],[1,"\\n        "],[13],[1,"\\n"],[41,[30,1,["chatable","read_restricted"]],[[[1,"          "],[1,[28,[35,5],["lock"],[["class"],["chat-channel-card__read-restricted"]]]],[1,"\\n"]],[]],null],[1,"      "]],[]]]]],[1,"\\n\\n      "],[10,0],[14,0,"chat-channel-card__header-actions"],[12],[1,"\\n"],[41,[30,1,["currentUserMembership","muted"]],[[[1,"          "],[8,[39,3],[[24,0,"chat-channel-card__tag -muted"],[24,"tabindex","-1"]],[["@route","@models"],["chat.channel.info.settings",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n            "],[1,[28,[35,6],["chat.muted"],null]],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[39,3],[[24,0,"chat-channel-card__setting"],[24,"tabindex","-1"]],[["@route","@models"],["chat.channel.info.settings",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n          "],[1,[28,[35,5],["cog"],null]],[1,"\\n        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,1,["description"]],[[[1,"      "],[10,0],[14,0,"chat-channel-card__description"],[12],[1,"\\n        "],[1,[28,[35,4],[[30,1,["description"]]],null]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,0,"chat-channel-card__cta"],[12],[1,"\\n"],[41,[30,1,["isFollowing"]],[[[1,"        "],[10,0],[14,0,"chat-channel-card__tags"],[12],[1,"\\n          "],[10,1],[14,0,"chat-channel-card__tag -joined"],[12],[1,"\\n            "],[1,[28,[35,6],["chat.joined"],null]],[1,"\\n          "],[13],[1,"\\n\\n          "],[8,[39,7],null,[["@channel","@options"],[[30,1],[28,[37,8],null,[["leaveClass","labelType"],["btn-link btn-small chat-channel-card__leave-btn","short"]]]]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[41,[30,1,["isJoinable"]],[[[1,"        "],[8,[39,7],null,[["@channel","@options"],[[30,1],[28,[37,8],null,[["joinClass","labelType"],["btn-primary btn-small chat-channel-card__join-btn","short"]]]]],null],[1,"\\n      "]],[]],null]],[]]],[1,"\\n"],[41,[28,[37,9],[[30,1,["membershipsCount"]],0],null],[[[1,"        "],[8,[39,3],[[24,0,"chat-channel-card__members"],[24,"tabindex","-1"]],[["@route","@models"],["chat.channel.info.members",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n          "],[1,[28,[35,6],["chat.channel.memberships_count"],[["count"],[[30,1,["membershipsCount"]]]]]],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@channel"],false,["if","concat-class","border-color","link-to","replace-emoji","d-icon","i18n","toggle-channel-membership-button","hash","gt"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-card.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chat",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-channel-chooser-header",["exports","@ember/component","select-kit/components/combo-box/combo-box-header","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"27aMe1xD",block:'[[[10,0],[14,0,"select-kit-header-wrapper"],[12],[1,"\\n"],[41,[30,0,["selectedContent"]],[[[1,"    "],[8,[39,1],null,[["@channel"],[[30,0,["selectedContent"]]]],null],[1,"\\n"]],[]],[[[1,"    "],[1,[28,[35,2],["chat.incoming_webhooks.channel_placeholder"],null]],[1,"\\n"]],[]]],[1,"\\n  "],[1,[28,[35,3],[[30,0,["caretIcon"]]],[["class"],["caret-icon"]]]],[1,"\\n"],[13]],[],false,["if","chat-channel-title","i18n","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-chooser-header.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,i.default.extend({}))})),define("discourse/plugins/chat/discourse/components/chat-channel-chooser-row",["exports","@ember/component","select-kit/components/select-kit/select-kit-row","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"ZkPkPrfc",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["item"]]]],null]],[],false,["chat-channel-title"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-chooser-row.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,i.default.extend({classNames:["chat-channel-chooser-row"]}))})),define("discourse/plugins/chat/discourse/components/chat-channel-chooser",["exports","select-kit/components/combo-box"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=t.default.extend({pluginApiIdentifiers:["chat-channel-chooser"],classNames:["chat-channel-chooser"],selectKitOptions:{headerComponent:"chat-channel-chooser-header"},modifyComponentForRow:()=>"chat-channel-chooser-row"})})),define("discourse/plugins/chat/discourse/components/chat-channel-info",["exports","@glimmer/component","@ember/routing","@ember/service","discourse-common/helpers/d-icon","discourse-i18n","discourse/plugins/chat/discourse/components/chat-channel-status","discourse/plugins/chat/discourse/components/chat-channel-title","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=class extends t.default{constructor(){super(...arguments),m(this,"chatChannelInfoRouteOriginManager",d,this),m(this,"site",h,this),b(this,"membersLabel",a.default.t("chat.channel_info.tabs.members")),b(this,"settingsLabel",a.default.t("chat.channel_info.tabs.settings")),b(this,"backToChannelLabel",a.default.t("chat.channel_info.back_to_all_channel")),b(this,"backToAllChannelsLabel",a.default.t("chat.channel_info.back_to_channel"))}get showTabs(){return this.site.desktopView&&this.args.channel.membershipsCount>1&&this.args.channel.isOpen}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"mqkcHmJ9",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-full-page-header"],[12],[1,"\\n      "],[10,0],[14,0,"chat-channel-header-details"],[12],[1,"\\n        "],[10,0],[14,0,"chat-full-page-header__left-actions"],[12],[1,"\\n"],[41,[30,0,["chatChannelInfoRouteOriginManager","isBrowse"]],[[[1,"            "],[8,[32,0],[[24,0,"chat-full-page-header__back-btn no-text btn-flat btn"],[16,"title",[30,0,["backToAllChannelsLabel"]]]],[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n              "],[1,[28,[32,1],["chevron-left"],null]],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],[[[1,"            "],[8,[32,0],[[24,0,"chat-full-page-header__back-btn no-text btn-flat btn"],[16,"title",[30,0,["backToChannelLabel"]]]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n              "],[1,[28,[32,1],["chevron-left"],null]],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]]],[1,"        "],[13],[1,"\\n\\n        "],[8,[32,2],null,[["@channel"],[[30,1]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[32,3],null,[["@channel"],[[30,1]]],null],[1,"\\n\\n    "],[10,0],[14,0,"chat-channel-info"],[12],[1,"\\n"],[41,[30,0,["showTabs"]],[[[1,"        "],[10,"nav"],[14,0,"chat-channel-info__nav"],[12],[1,"\\n          "],[10,"ul"],[14,0,"nav nav-pills"],[12],[1,"\\n            "],[10,"li"],[12],[1,"\\n              "],[8,[32,0],null,[["@route","@model","@replace"],["chat.channel.info.settings",[30,1],true]],[["default"],[[[[1,"\\n                "],[1,[30,0,["settingsLabel"]]],[1,"\\n              "]],[]]]]],[1,"\\n            "],[13],[1,"\\n            "],[10,"li"],[12],[1,"\\n              "],[8,[32,0],null,[["@route","@model","@replace"],["chat.channel.info.members",[30,1],true]],[["default"],[[[[1,"\\n                "],[1,[30,0,["membersLabel"]]],[1,"\\n              "]],[]]]]],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[46,[28,[31,2],null,null],null,null,null],[1,"\\n    "],[13],[1,"\\n  "]],["@channel"],false,["if","component","-outlet"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-info.js",scope:()=>[i.LinkTo,r.default,o.default,s.default],isStrictMode:!0}),p),d=g((u=p).prototype,"chatChannelInfoRouteOriginManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(u.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u)})),define("discourse/plugins/chat/discourse/components/chat-channel-leave-btn",["exports","@ember/component","@glimmer/component","@ember/service","@ember/utils","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o,l
function c(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,a.createTemplateFactory)({id:"LdJqLI+5",block:'[[[41,[30,0,["shouldRender"]],[[[1,"  "],[8,[39,1],[[24,0,"btn-flat chat-channel-leave-btn"]],[["@icon","@action","@title"],["times",[30,1],[30,0,["leaveChatTitleKey"]]]],null],[1,"\\n"]],[]],null]],["@onLeaveChannel"],false,["if","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-leave-btn.hbs",isStrictMode:!1})
let h=e.default=(s=class extends i.default{constructor(){super(...arguments),c(this,"chat",o,this),c(this,"site",l,this)}get shouldRender(){return!this.site.mobileView&&(0,r.isPresent)(this.args.channel)}get leaveChatTitleKey(){return this.args.channel.isDirectMessageChannel?"chat.direct_messages.leave":"chat.leave"}},o=u(s.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=u(s.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s);(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/chat-channel-members",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/runloop","@ember/service","ember-modifier","discourse/lib/is-element-in-viewport","discourse-common/config/environment","discourse-common/lib/debounce","discourse-i18n","truth-helpers/helpers/gt","discourse/plugins/chat/discourse/components/chat-user-info","discourse/plugins/chat/discourse/components/dc-filter-input","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g){"use strict"
var f,v,y,w,_,j
function M(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function z(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function k(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(j=class extends t.default{constructor(){super(...arguments),M(this,"chatApi",v,this),M(this,"modal",y,this),M(this,"loadingSlider",w,this),M(this,"filter",_,this),z(this,"filterPlaceholder",d.default.t("chat.members_view.filter_placeholder")),z(this,"noMembershipsFoundLabel",d.default.t("chat.channel.no_memberships_found")),z(this,"noMembershipsLabel",d.default.t("chat.channel.no_memberships")),z(this,"focusInput",(0,o.modifier)((e=>{(0,a.schedule)("afterRender",(()=>{e.focus()}))}))),z(this,"fill",(0,o.modifier)((e=>(this.resizeObserver=new ResizeObserver((()=>{(0,l.default)(e)&&this.load()})),this.resizeObserver.observe(e),()=>{this.resizeObserver.disconnect()})))),z(this,"loadMore",(0,o.modifier)((e=>(this.intersectionObserver=new IntersectionObserver(this.load),this.intersectionObserver.observe(e),()=>{this.intersectionObserver.disconnect()}))))}get noResults(){return this.members.fetchedOnce&&!this.members.loading}get members(){const e={}
return this.filter?.length&&(e.username=this.filter),this.chatApi.listChannelMemberships(this.args.channel.id,e)}load(){(0,u.default)(this,this.debouncedLoad,c.INPUT_DELAY)}mutFilter(e){this.filter=e.target.value,this.load()}async debouncedLoad(){this.loadingSlider.transitionStarted(),await this.members.load({limit:20}),this.loadingSlider.transitionEnded()}},(0,g.setComponentTemplate)((0,b.createTemplateFactory)({id:"nVVbbQcR",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-channel-members"],[12],[1,"\\n      "],[8,[32,0],[[16,"placeholder",[30,0,["filterPlaceholder"]]],[4,[30,0,["focusInput"]],null,null]],[["@class","@filterAction","@icons"],["chat-channel-members__filter",[30,0,["mutFilter"]],[28,[32,1],null,[["right"],["search"]]]]],null],[1,"\\n\\n"],[41,[28,[32,2],[[30,1,["membershipsCount"]],0],null],[[[1,"        "],[11,"ul"],[24,0,"chat-channel-members__list"],[4,[30,0,["fill"]],null,null],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["members"]]],null]],null],null,[[[1,"            "],[10,"li"],[14,0,"chat-channel-members__list-item"],[12],[1,"\\n              "],[8,[32,3],null,[["@user","@avatarSize"],[[30,2,["user"]],"tiny"]],null],[1,"\\n            "],[13],[1,"\\n"]],[2]],[[[41,[30,0,["noResults"]],[[[1,"              "],[10,"li"],[14,0,"chat-channel-members__list-item -no-results alert alert-info"],[12],[1,"\\n                "],[1,[30,0,["noMembershipsFoundLabel"]]],[1,"\\n              "],[13],[1,"\\n"]],[]],null]],[]]],[1,"        "],[13],[1,"\\n\\n        "],[11,0],[4,[30,0,["loadMore"]],null,null],[12],[1,"\\n          "],[10,"br"],[12],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[10,2],[14,0,"alert alert-info"],[12],[1,"\\n          "],[1,[30,0,["noMembershipsLabel"]]],[1,"\\n        "],[13],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n  "]],["@channel","membership"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-members.js",scope:()=>[m.default,n.hash,h.default,p.default],isStrictMode:!0}),j),v=k((f=j).prototype,"chatApi",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=k(f.prototype,"modal",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=k(f.prototype,"loadingSlider",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=k(f.prototype,"filter",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),k(f.prototype,"members",[i.cached],Object.getOwnPropertyDescriptor(f.prototype,"members"),f.prototype),k(f.prototype,"load",[r.action],Object.getOwnPropertyDescriptor(f.prototype,"load"),f.prototype),k(f.prototype,"mutFilter",[r.action],Object.getOwnPropertyDescriptor(f.prototype,"mutFilter"),f.prototype),f)})),define("discourse/plugins/chat/discourse/components/chat-channel-message-emoji-picker",["exports","@glimmer/component","@ember/object","@ember/service","@popperjs/core","ember-modifier","discourse/lib/offset-calculator","discourse/plugins/chat/discourse/components/chat-emoji-picker","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=class extends t.default{constructor(){super(...arguments),m(this,"site",d,this),m(this,"chatEmojiPickerManager",h,this),b(this,"context","chat-channel-message"),b(this,"listenToBodyScroll",(0,a.modifier)((()=>{const e=()=>{this.chatEmojiPickerManager.close()}
return document.addEventListener("scroll",e),()=>{document.removeEventListener("scroll",e)}})))}didSelectEmoji(e){this.chatEmojiPickerManager.picker?.didSelectEmoji(e),this.chatEmojiPickerManager.close()}didInsert(e){this.site.mobileView||(this._popper=(0,r.createPopper)(this.chatEmojiPickerManager.picker?.trigger,e,{placement:"top",modifiers:[{name:"eventListeners",options:{scroll:!1,resize:!1}},{name:"flip",options:{padding:{top:(0,s.headerOffset)()}}}]})),e.classList.remove("hidden")}willDestroy(){this._popper?.destroy()}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"aPYRVr1X",block:'[[[1,"\\n    "],[8,[32,0],[[4,[30,0,["listenToBodyScroll"]],null,null]],[["@context","@didInsert","@willDestroy","@didSelectEmoji","@class"],["chat-channel-message",[30,0,["didInsert"]],[30,0,["willDestroy"]],[30,0,["didSelectEmoji"]],"hidden"]],null],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-message-emoji-picker.js",scope:()=>[o.default],isStrictMode:!0}),p),d=g((u=p).prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(u.prototype,"chatEmojiPickerManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g(u.prototype,"didSelectEmoji",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"didSelectEmoji"),u.prototype),g(u.prototype,"didInsert",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"didInsert"),u.prototype),g(u.prototype,"willDestroy",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"willDestroy"),u.prototype),u)})),define("discourse/plugins/chat/discourse/components/chat-channel-metadata",["exports","@ember/component","@glimmer/component","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"dcIpnToE",block:'[[[10,0],[14,0,"chat-channel-metadata"],[12],[1,"\\n"],[41,[30,1,["lastMessage"]],[[[1,"    "],[10,0],[14,0,"chat-channel-metadata__date"],[12],[1,"\\n      "],[1,[30,0,["lastMessageFormattedDate"]]],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["unreadIndicator"]],[[[1,"    "],[8,[39,1],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],null],[13]],["@channel"],false,["if","chat-channel-unread-indicator"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-metadata.hbs",isStrictMode:!1})
class a extends i.default{get unreadIndicator(){return this.args.unreadIndicator??!1}get lastMessageFormattedDate(){return moment(this.args.channel.lastMessage.createdAt).calendar(null,{sameDay:"LT",nextDay:"[Tomorrow]",nextWeek:"dddd",lastDay:"[Yesterday]",lastWeek:"dddd",sameElse:"l"})}}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/chat-channel-preview-card",["exports","@ember/component","@glimmer/component","@ember/service","@ember/utils","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,a.createTemplateFactory)({id:"BCZbso3D",block:'[[[10,0],[15,0,[28,[37,0],["chat-channel-preview-card",[52,[51,[30,0,["hasDescription"]]],"-no-description"],[52,[51,[30,0,["showJoinButton"]]],"-no-button"]],null]],[12],[1,"\\n  "],[8,[39,2],null,[["@channel"],[[30,1]]],null],[1,"\\n"],[41,[30,0,["hasDescription"]],[[[1,"    "],[10,2],[14,0,"chat-channel-preview-card__description"],[12],[1,"\\n      "],[1,[30,1,["description"]]],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[41,[30,0,["showJoinButton"]],[[[1,"    "],[8,[39,4],null,[["@channel","@options"],[[30,1],[28,[37,5],null,[["joinClass"],["btn-primary"]]]]],null],[1,"\\n"]],[]],null],[1,"  "],[8,[39,6],[[24,0,"chat-channel-preview-card__browse-all"]],[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n    "],[1,[28,[35,7],["chat.browse_all_channels"],null]],[1,"\\n  "]],[]]]]],[1,"\\n"],[13]],["@channel"],false,["concat-class","unless","chat-channel-title","if","toggle-channel-membership-button","hash","link-to","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-preview-card.hbs",isStrictMode:!1})
let c=e.default=(s=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get showJoinButton(){return this.args.channel?.isOpen&&this.args.channel?.canJoin}get hasDescription(){return!(0,r.isEmpty)(this.args.channel?.description)}},u=s.prototype,d="chat",h=[n.inject],p={configurable:!0,enumerable:!0,writable:!0,initializer:null},b={},Object.keys(p).forEach((function(e){b[e]=p[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=h.slice().reverse().reduce((function(e,t){return t(u,d,e)||e}),b),m&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(m):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(u,d,b),b=null),o=b,s)
var u,d,h,p,m,b;(0,t.setComponentTemplate)(l,c)})),define("discourse/plugins/chat/discourse/components/chat-channel-row",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/will-destroy","@ember/routing","@ember/service","@ember/template","ember-modifier","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse-common/helpers/d-icon","discourse-common/utils/decorators","discourse-i18n","truth-helpers/helpers/and","truth-helpers/helpers/eq","discourse/plugins/chat/discourse/components/chat-channel-metadata","discourse/plugins/chat/discourse/components/chat-channel-title","discourse/plugins/chat/discourse/components/toggle-channel-membership-button","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j){"use strict"
var M,z,k,C,O,S,P,T,E,x,D,A,I,U,L,N,R
function F(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function W(e,t,i){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function B(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function H(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function $(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(R=new WeakMap,N=class extends t.default{constructor(){super(...arguments),W(this,R,{get:V,set:void 0}),F(this,"api",z,this),F(this,"capabilities",k,this),F(this,"chat",C,this),F(this,"currentUser",O,this),F(this,"router",S,this),F(this,"site",P,this),F(this,"isAtThreshold",T,this),F(this,"shouldRemoveChannel",E,this),F(this,"showRemoveButton",x,this),F(this,"swipableRow",D,this),F(this,"shouldReset",A,this),F(this,"diff",I,this),F(this,"rowStyle",U,this),F(this,"canSwipe",L,this),B(this,"registerSwipableRow",(0,u.modifier)((e=>{this.swipableRow=e}))),B(this,"onReset",(0,u.modifier)((e=>{const t=()=>{this.rowStyle=(0,c.htmlSafe)("margin-right: 0px;"),this.showRemoveButton=!1,this.shouldReset=!1}
return e.addEventListener("transitionend",t,{once:!0}),()=>{e.removeEventListener("transitionend",t),this.rowStyle=(0,c.htmlSafe)("margin-right: 0px;"),this.showRemoveButton=!1,this.shouldReset=!1}}))),B(this,"onRemoveChannel",(0,u.modifier)((e=>{e.addEventListener("transitionend",(()=>{this.chat.unfollowChannel(this.args.channel).catch(h.popupAjaxError)}),{once:!0}),e.classList.add("-fade-out")}))),B(this,"handleSwipe",(0,u.modifier)((e=>(e.addEventListener("touchstart",this.onSwipeStart,{passive:!0}),e.addEventListener("touchmove",this.onSwipe,{passive:!0}),e.addEventListener("touchend",this.onSwipeEnd),()=>{e.removeEventListener("touchstart",this.onSwipeStart),e.removeEventListener("touchmove",this.onSwipe),e.removeEventListener("touchend",this.onSwipeEnd)}))))}onSwipeStart(e){this._initialX=e.changedTouches[0].screenX}onSwipe(e){this.showRemoveButton=!0,this.shouldReset=!1,this.isAtThreshold=!1
const t=window.innerWidth/3,i=e.changedTouches[0].screenX
this.diff=this._initialX-i,this.isAtThreshold=this.diff>=t,this.diff>25?(this.isAtThreshold&&(this.diff=t+.1*(this.diff-t)),this.rowStyle=(0,c.htmlSafe)(`margin-right: ${this.diff}px;`)):this.rowStyle=(0,c.htmlSafe)("margin-right: 0px;")}onSwipeEnd(){this.isAtThreshold?(this.rowStyle=(0,c.htmlSafe)("margin-right: 0px;"),this.shouldRemoveChannel=!0):this.shouldReset=!0}get shouldHandleSwipe(){return this.capabilities.touch&&this.args.channel.isDirectMessageChannel}get leaveDirectMessageLabel(){return b.default.t("chat.direct_messages.leave")}get leaveChannelLabel(){return b.default.t("chat.channel_settings.leave_channel")}get channelHasUnread(){return this.args.channel.tracking.unreadCount>0}startTrackingStatus(){H(this,R)?.trackStatus()}stopTrackingStatus(){H(this,R)?.stopTrackingStatus()}},(0,j.setComponentTemplate)((0,_.createTemplateFactory)({id:"BPSb+2l5",block:'[[[1,"\\n    "],[8,[32,0],[[16,0,[28,[32,1],["chat-channel-row",[52,[30,1,["focused"]],"focused"],[52,[30,1,["currentUserMembership","muted"]],"muted"],[52,[30,2,["leaveButton"]],"can-leave"],[52,[28,[32,2],[[30,0,["chat","activeChannel","id"]],[30,1,["id"]]],null],"active"],[52,[30,0,["channelHasUnread"]],"has-unread"]],null]],[24,"tabindex","0"],[16,"data-chat-channel-id",[30,1,["id"]]],[4,[32,3],[[30,0,["startTrackingStatus"]]],null],[4,[32,4],[[30,0,["stopTrackingStatus"]]],null],[4,[52,[30,0,["shouldRemoveChannel"]],[50,[30,0,["onRemoveChannel"]],2,null,null]],null,null]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n      "],[11,0],[16,0,[28,[32,1],["chat-channel-row__content",[52,[30,0,["shouldReset"]],"-animate-reset"]],null]],[16,5,[30,0,["rowStyle"]]],[4,[52,[30,0,["shouldHandleSwipe"]],[50,[30,0,["registerSwipableRow"]],2,null,null]],null,null],[4,[52,[30,0,["shouldHandleSwipe"]],[50,[30,0,["handleSwipe"]],2,null,null]],null,null],[4,[52,[30,0,["shouldReset"]],[50,[30,0,["onReset"]],2,null,null]],null,null],[12],[1,"\\n        "],[8,[32,5],null,[["@channel"],[[30,1]]],null],[1,"\\n        "],[8,[32,6],null,[["@channel","@unreadIndicator"],[[30,1],true]],null],[1,"\\n\\n"],[41,[28,[32,7],[[30,2,["leaveButton"]],[30,1,["isFollowing"]],[30,0,["site","desktopView"]]],null],[[[1,"          "],[8,[32,8],null,[["@channel","@options"],[[30,1],[28,[32,9],null,[["leaveClass","labelType","leaveIcon","leaveTitle"],["btn-flat chat-channel-leave-btn","none","times",[52,[30,1,["isDirectMessageChannel"]],[30,0,["leaveDirectMessageLabel"]],[30,0,["leaveChannelLabel"]]]]]]]],null],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n\\n"],[41,[30,0,["showRemoveButton"]],[[[1,"        "],[10,0],[15,0,[28,[32,1],["chat-channel-row__action-btn",[52,[30,0,["isAtThreshold"]],"-at-threshold","-not-at-threshold"]],null]],[12],[1,"\\n          "],[1,[28,[32,10],["times-circle"],null]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "]],[]]]]],[1,"\\n  "]],["@channel","@options"],false,["if","modifier"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-row.js",scope:()=>[o.LinkTo,d.default,f.default,a.default,s.default,y.default,v.default,g.default,w.default,n.hash,p.default],isStrictMode:!0}),N),z=$((M=N).prototype,"api",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=$(M.prototype,"capabilities",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=$(M.prototype,"chat",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=$(M.prototype,"currentUser",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=$(M.prototype,"router",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=$(M.prototype,"site",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=$(M.prototype,"isAtThreshold",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E=$(M.prototype,"shouldRemoveChannel",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),x=$(M.prototype,"showRemoveButton",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),D=$(M.prototype,"swipableRow",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=$(M.prototype,"shouldReset",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),I=$(M.prototype,"diff",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),U=$(M.prototype,"rowStyle",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=$(M.prototype,"canSwipe",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),$(M.prototype,"onSwipeStart",[m.bind],Object.getOwnPropertyDescriptor(M.prototype,"onSwipeStart"),M.prototype),$(M.prototype,"onSwipe",[m.bind],Object.getOwnPropertyDescriptor(M.prototype,"onSwipe"),M.prototype),$(M.prototype,"onSwipeEnd",[m.bind],Object.getOwnPropertyDescriptor(M.prototype,"onSwipeEnd"),M.prototype),$(M.prototype,"startTrackingStatus",[r.action],Object.getOwnPropertyDescriptor(M.prototype,"startTrackingStatus"),M.prototype),$(M.prototype,"stopTrackingStatus",[r.action],Object.getOwnPropertyDescriptor(M.prototype,"stopTrackingStatus"),M.prototype),M)
function V(){return this.args.channel?.chatable?.users?.firstObject}})),define("discourse/plugins/chat/discourse/components/chat-channel-settings",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/routing","@ember/service","discourse/components/d-button","discourse/components/d-toggle-switch","discourse/helpers/category-badge","discourse/helpers/replace-emoji","discourse/lib/ajax-error","discourse-i18n","select-kit/components/combo-box","discourse/plugins/chat/discourse/components/chat/form","discourse/plugins/chat/discourse/components/chat/modal/archive-channel","discourse/plugins/chat/discourse/components/chat/modal/delete-channel","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name","discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status","discourse/plugins/chat/discourse/components/chat-retention-reminder-text","discourse/plugins/chat/discourse/components/toggle-channel-membership-button","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j,M){"use strict"
var z,k,C,O,S,P,T,E,x,D
function A(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function I(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function U(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const L=[{name:h.default.t("chat.notification_levels.never"),value:"never"},{name:h.default.t("chat.notification_levels.mention"),value:"mention"},{name:h.default.t("chat.notification_levels.always"),value:"always"}]
e.default=(D=class extends t.default{constructor(){super(...arguments),A(this,"chatApi",k,this),A(this,"chatGuardian",C,this),A(this,"currentUser",O,this),A(this,"siteSettings",S,this),A(this,"dialog",P,this),A(this,"modal",T,this),A(this,"site",E,this),A(this,"toasts",x,this),I(this,"notificationLevels",L),I(this,"settingsSectionTitle",h.default.t("chat.settings.settings_title")),I(this,"channelInfoSectionTitle",h.default.t("chat.settings.info_title")),I(this,"categoryLabel",h.default.t("chat.settings.category_label")),I(this,"historyLabel",h.default.t("chat.settings.history_label")),I(this,"adminSectionTitle",h.default.t("chat.settings.admin_title")),I(this,"membersLabel",h.default.t("chat.channel_info.tabs.members")),I(this,"descriptionSectionTitle",h.default.t("chat.about_view.description")),I(this,"titleSectionTitle",h.default.t("chat.about_view.title")),I(this,"descriptionPlaceholder",h.default.t("chat.channel_edit_description_modal.description")),I(this,"toggleThreadingLabel",h.default.t("chat.settings.channel_threading_label")),I(this,"toggleThreadingDescription",h.default.t("chat.settings.channel_threading_description")),I(this,"muteSectionLabel",h.default.t("chat.settings.mute")),I(this,"channelWideMentionsLabel",h.default.t("chat.settings.channel_wide_mentions_label")),I(this,"autoJoinLabel",h.default.t("chat.settings.auto_join_users_label")),I(this,"desktopNotificationsLevelLabel",h.default.t("chat.settings.desktop_notification_level")),I(this,"mobileNotificationsLevelLabel",h.default.t("chat.settings.mobile_notification_level"))}get canEditChannel(){return this.chatGuardian.canEditChatChannel()}get shouldRenderTitleSection(){return this.args.channel.isCategoryChannel}get shouldRenderDescriptionSection(){return this.args.channel.isCategoryChannel}get shouldRenderStatusSection(){return this.args.channel.isCategoryChannel}get shouldRenderArchiveRow(){return this.chatGuardian.canArchiveChannel(this.args.channel)}get toggleChannelWideMentionsAvailable(){return this.args.channel.isCategoryChannel&&this.args.channel.isOpen}get toggleThreadingAvailable(){return this.args.channel.isCategoryChannel&&this.args.channel.isOpen}get channelWideMentionsDescription(){return h.default.t("chat.settings.channel_wide_mentions_description",{channel:this.args.channel.title})}get isChannelMuted(){return this.args.channel.currentUserMembership.muted}get shouldRenderChannelWideMentionsAvailable(){return this.args.channel.isCategoryChannel}get shouldRenderDesktopNotificationsLevelSection(){return!this.isChannelMuted}get shouldRenderMobileNotificationsLevelSection(){return!this.isChannelMuted}get autoJoinAvailable(){return this.siteSettings.max_chat_auto_joined_users>0&&this.args.channel.isCategoryChannel&&this.args.channel.isOpen}get shouldRenderAdminSection(){return this.canEditChannel&&(this.toggleChannelWideMentionsAvailable||this.args.channel.isCategoryChannel)}async onToggleChannelWideMentions(){const e=!this.args.channel.allowChannelWideMentions
if(this.args.channel.allowChannelWideMentions!==e)try{this.args.channel.allowChannelWideMentions=e
const t=await this._updateChannelProperty(this.args.channel,"allow_channel_wide_mentions",e)
this.args.channel.allowChannelWideMentions=t.channel.allow_channel_wide_mentions}catch(t){(0,d.popupAjaxError)(t)}}async onToggleAutoJoinUsers(){return this.args.channel.autoJoinUsers?await this.onDisableAutoJoinUsers():await this.onEnableAutoJoinUsers()}async onDisableAutoJoinUsers(){if(!1!==this.args.channel.autoJoinUsers)try{this.args.channel.autoJoinUsers=!1
const e=await this._updateChannelProperty(this.args.channel,"auto_join_users",!1)
this.args.channel.autoJoinUsers=e.channel.auto_join_users}catch(e){(0,d.popupAjaxError)(e)}}onEnableAutoJoinUsers(){if(!0!==this.args.channel.autoJoinUsers)return this.dialog.confirm({message:h.default.t("chat.settings.auto_join_users_warning",{category:this.args.channel.chatable.name}),didConfirm:async()=>{try{const e=await this._updateChannelProperty(this.args.channel,"auto_join_users",!0)
this.args.channel.autoJoinUsers=e.channel.auto_join_users}catch(e){(0,d.popupAjaxError)(e)}}})}onToggleMuted(){const e=!this.args.channel.currentUserMembership.muted
this.saveNotificationSettings("muted","muted",e)}async saveNotificationSettings(e,t,i){if(this.args.channel.currentUserMembership[e]===i)return
this.args.channel.currentUserMembership[e]=i
const n={}
n[t]=i
try{const i=await this.chatApi.updateCurrentUserChannelNotificationsSettings(this.args.channel.id,n)
this.args.channel.currentUserMembership[e]=i.membership[t],this.toasts.success({data:{message:h.default.t("saved")}})}catch(r){(0,d.popupAjaxError)(r)}}async _updateChannelProperty(e,t,i){try{const n=await this.chatApi.updateChannel(e.id,{[t]:i})
return this.toasts.success({data:{message:h.default.t("saved")}}),n}catch(n){(0,d.popupAjaxError)(n)}}async onToggleThreadingEnabled(e){try{this.args.channel.threadingEnabled=!e
const t=await this._updateChannelProperty(this.args.channel,"threading_enabled",!e)
this.args.channel.threadingEnabled=t.channel.threading_enabled}catch(t){(0,d.popupAjaxError)(t)}}onToggleChannelState(){return this.modal.show(y.default,{model:this.args.channel})}onArchiveChannel(){return this.modal.show(b.default,{model:{channel:this.args.channel}})}onDeleteChannel(){return this.modal.show(g.default,{model:{channel:this.args.channel}})}onEditChannelName(){return this.modal.show(v.default,{model:this.args.channel})}onEditChannelDescription(){return this.modal.show(f.default,{model:this.args.channel})}},(0,M.setComponentTemplate)((0,j.createTemplateFactory)({id:"07j4TRNU",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-channel-settings"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n"],[41,[30,0,["shouldRenderTitleSection"]],[[[1,"          "],[8,[30,1,["section"]],null,[["@title"],[[30,0,["titleSectionTitle"]]]],[["default"],[[[[1,"\\n            "],[8,[30,2,["row"]],null,null,[["default","action"],[[[[1,"\\n                "],[10,0],[14,0,"chat-channel-settings__name"],[12],[1,"\\n                  "],[1,[28,[32,1],[[30,3,["title"]]],null]],[1,"\\n                "],[13],[1,"\\n\\n"],[41,[30,3,["isCategoryChannel"]],[[[1,"                  "],[10,0],[14,0,"chat-channel-settings__slug"],[12],[1,"\\n                    "],[8,[32,2],null,[["@route","@models"],["chat.channel",[30,3,["routeModels"]]]],[["default"],[[[[1,"\\n                      /chat/c/"],[1,[30,3,["slug"]]],[1,"/"],[1,[30,3,["id"]]],[1,"\\n                    "]],[]]]]],[1,"\\n                  "],[13],[1,"\\n"]],[]],null],[1,"              "]],[]],[[[1,"\\n"],[41,[30,0,["canEditChannel"]],[[[1,"                  "],[8,[32,3],[[24,0,"edit-name-slug-btn btn-flat"]],[["@label","@action"],["chat.channel_settings.edit",[30,0,["onEditChannelName"]]]],null],[1,"\\n"]],[]],null],[1,"              "]],[]]]]],[1,"\\n          "]],[2]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["shouldRenderDescriptionSection"]],[[[1,"          "],[8,[30,1,["section"]],null,[["@title"],[[30,0,["descriptionSectionTitle"]]]],[["default"],[[[[1,"\\n            "],[8,[30,4,["row"]],null,null,[["default","action"],[[[[1,"\\n"],[41,[30,3,["description","length"]],[[[1,"                  "],[1,[30,3,["description"]]],[1,"\\n"]],[]],[[[1,"                  "],[1,[30,0,["descriptionPlaceholder"]]],[1,"\\n"]],[]]],[1,"              "]],[]],[[[1,"\\n"],[41,[30,0,["canEditChannel"]],[[[1,"                  "],[8,[32,3],[[24,0,"edit-description-btn btn-flat"]],[["@label","@action"],[[52,[30,3,["description","length"]],"chat.channel_settings.edit","chat.channel_settings.add"],[30,0,["onEditChannelDescription"]]]],null],[1,"\\n"]],[]],null],[1,"              "]],[]]]]],[1,"\\n          "]],[4]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"          "],[8,[30,1,["section"]],null,null,[["default"],[[[[1,"\\n            "],[8,[30,5,["row"]],null,[["@label","@route","@routeModels"],[[30,0,["membersLabel"]],"chat.channel.info.members",[30,3,["routeModels"]]]],null],[1,"\\n          "]],[5]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,3,["isOpen"]],[[[1,"          "],[8,[30,1,["section"]],null,[["@title"],[[30,0,["settingsSectionTitle"]]]],[["default"],[[[[1,"\\n            "],[8,[30,6,["row"]],null,[["@label"],[[30,0,["muteSectionLabel"]]]],[["action"],[[[[1,"\\n                "],[8,[32,4],[[24,0,"chat-channel-settings__mute-switch"],[4,[32,5],["click",[30,0,["onToggleMuted"]]],null]],[["@state"],[[30,3,["currentUserMembership","muted"]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["shouldRenderDesktopNotificationsLevelSection"]],[[[1,"              "],[8,[30,6,["row"]],null,[["@label"],[[30,0,["desktopNotificationsLevelLabel"]]]],[["action"],[[[[1,"\\n                  "],[8,[32,6],null,[["@content","@value","@valueProperty","@class","@onChange"],[[30,0,["notificationLevels"]],[30,3,["currentUserMembership","desktopNotificationLevel"]],"value","chat-channel-settings__selector chat-channel-settings__desktop-notifications-selector",[28,[32,7],[[30,0,["saveNotificationSettings"]],"desktopNotificationLevel","desktop_notification_level"],null]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["shouldRenderMobileNotificationsLevelSection"]],[[[1,"              "],[8,[30,6,["row"]],null,[["@label"],[[30,0,["mobileNotificationsLevelLabel"]]]],[["action"],[[[[1,"\\n                  "],[8,[32,6],null,[["@content","@value","@valueProperty","@class","@onChange"],[[30,0,["notificationLevels"]],[30,3,["currentUserMembership","mobileNotificationLevel"]],"value","chat-channel-settings__selector chat-channel-settings__mobile-notifications-selector",[28,[32,7],[[30,0,["saveNotificationSettings"]],"mobileNotificationLevel","mobile_notification_level"],null]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"          "]],[6]]]]],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[30,1,["section"]],null,[["@title"],[[30,0,["channelInfoSectionTitle"]]]],[["default"],[[[[1,"\\n"],[41,[30,3,["isCategoryChannel"]],[[[1,"            "],[8,[30,7,["row"]],null,[["@label"],[[30,0,["categoryLabel"]]]],[["default"],[[[[1,"\\n              "],[1,[28,[32,8],[[30,3,["chatable"]]],[["link","allowUncategorized"],[true,true]]]],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n          "],[8,[30,7,["row"]],null,[["@label"],[[30,0,["historyLabel"]]]],[["default"],[[[[1,"\\n            "],[8,[32,9],null,[["@channel","@type"],[[30,3],"short"]],null],[1,"\\n          "]],[]]]]],[1,"\\n        "]],[7]]]]],[1,"\\n\\n"],[41,[30,0,["shouldRenderAdminSection"]],[[[1,"          "],[8,[30,1,["section"]],[[24,"data-section","admin"]],[["@title"],[[30,0,["adminSectionTitle"]]]],[["default"],[[[[1,"\\n"],[41,[30,0,["autoJoinAvailable"]],[[[1,"              "],[8,[30,8,["row"]],null,[["@label"],[[30,0,["autoJoinLabel"]]]],[["action"],[[[[1,"\\n                  "],[8,[32,4],[[24,0,"chat-channel-settings__auto-join-switch"],[4,[32,5],["click",[28,[32,7],[[30,0,["onToggleAutoJoinUsers"]],[30,3,["autoJoinUsers"]]],null]],null]],[["@state"],[[30,3,["autoJoinUsers"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["toggleChannelWideMentionsAvailable"]],[[[1,"              "],[8,[30,8,["row"]],null,[["@label"],[[30,0,["channelWideMentionsLabel"]]]],[["action","description"],[[[[1,"\\n                  "],[8,[32,4],[[24,0,"chat-channel-settings__channel-wide-mentions"],[4,[32,5],["click",[28,[32,7],[[30,0,["onToggleChannelWideMentions"]],[30,3,["allowChannelWideMentions"]]],null]],null]],[["@state"],[[30,3,["allowChannelWideMentions"]]]],null],[1,"\\n                "]],[]],[[[1,"\\n                  "],[1,[30,0,["channelWideMentionsDescription"]]],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["toggleThreadingAvailable"]],[[[1,"              "],[8,[30,8,["row"]],null,[["@label"],[[30,0,["toggleThreadingLabel"]]]],[["action","description"],[[[[1,"\\n                  "],[8,[32,4],[[24,0,"chat-channel-settings__threading-switch"],[4,[32,5],["click",[28,[32,7],[[30,0,["onToggleThreadingEnabled"]],[30,3,["threadingEnabled"]]],null]],null]],[["@state"],[[30,3,["threadingEnabled"]]]],null],[1,"\\n                "]],[]],[[[1,"\\n                  "],[1,[30,0,["toggleThreadingDescription"]]],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["shouldRenderStatusSection"]],[[[41,[30,0,["shouldRenderArchiveRow"]],[[[1,"                "],[8,[30,8,["row"]],null,null,[["action"],[[[[1,"\\n                    "],[8,[32,3],[[24,0,"archive-btn chat-form__btn btn-flat"]],[["@action","@label","@icon"],[[30,0,["onArchiveChannel"]],"chat.channel_settings.archive_channel","archive"]],null],[1,"\\n                  "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n              "],[8,[30,8,["row"]],null,null,[["action"],[[[[1,"\\n"],[41,[30,3,["isOpen"]],[[[1,"                    "],[8,[32,3],[[24,0,"close-btn chat-form__btn btn-flat"]],[["@action","@label","@icon"],[[30,0,["onToggleChannelState"]],"chat.channel_settings.close_channel","lock"]],null],[1,"\\n"]],[]],[[[1,"                    "],[8,[32,3],[[24,0,"open-btn chat-form__btn btn-flat"]],[["@action","@label","@icon"],[[30,0,["onToggleChannelState"]],"chat.channel_settings.open_channel","unlock"]],null],[1,"\\n"]],[]]],[1,"                "]],[]]]]],[1,"\\n\\n              "],[8,[30,8,["row"]],null,null,[["action"],[[[[1,"\\n                  "],[8,[32,3],[[24,0,"delete-btn chat-form__btn btn-flat"]],[["@action","@label","@icon"],[[30,0,["onDeleteChannel"]],"chat.channel_settings.delete_channel","trash-alt"]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n          "]],[8]]]]],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[30,1,["section"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,9,["row"]],null,null,[["action"],[[[[1,"\\n              "],[8,[32,10],null,[["@channel","@options"],[[30,3],[28,[32,11],null,[["joinClass","leaveClass","joinIcon","leaveIcon"],["btn-primary","btn-flat","sign-in-alt","sign-out-alt"]]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n        "]],[9]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n    "],[13],[1,"\\n  "]],["form","section","@channel","section","section","section","section","section","section"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-settings.js",scope:()=>[m.default,u.default,a.LinkTo,o.default,l.default,n.on,p.default,i.fn,c.default,w.default,_.default,i.hash],isStrictMode:!0}),D),k=U((z=D).prototype,"chatApi",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=U(z.prototype,"chatGuardian",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=U(z.prototype,"currentUser",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=U(z.prototype,"siteSettings",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=U(z.prototype,"dialog",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=U(z.prototype,"modal",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=U(z.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=U(z.prototype,"toasts",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U(z.prototype,"onToggleChannelWideMentions",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"onToggleChannelWideMentions"),z.prototype),U(z.prototype,"onToggleAutoJoinUsers",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"onToggleAutoJoinUsers"),z.prototype),U(z.prototype,"onDisableAutoJoinUsers",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"onDisableAutoJoinUsers"),z.prototype),U(z.prototype,"onEnableAutoJoinUsers",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"onEnableAutoJoinUsers"),z.prototype),U(z.prototype,"onToggleMuted",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"onToggleMuted"),z.prototype),U(z.prototype,"saveNotificationSettings",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"saveNotificationSettings"),z.prototype),U(z.prototype,"_updateChannelProperty",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"_updateChannelProperty"),z.prototype),U(z.prototype,"onToggleThreadingEnabled",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"onToggleThreadingEnabled"),z.prototype),U(z.prototype,"onToggleChannelState",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"onToggleChannelState"),z.prototype),U(z.prototype,"onArchiveChannel",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"onArchiveChannel"),z.prototype),U(z.prototype,"onDeleteChannel",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"onDeleteChannel"),z.prototype),U(z.prototype,"onEditChannelName",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"onEditChannelName"),z.prototype),U(z.prototype,"onEditChannelDescription",[r.action],Object.getOwnPropertyDescriptor(z.prototype,"onEditChannelDescription"),z.prototype),z)})),define("discourse/plugins/chat/discourse/components/chat-channel-status",["exports","@ember/component","@glimmer/component","discourse-i18n","discourse/plugins/chat/discourse/models/chat-channel","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
function s(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,a.createTemplateFactory)({id:"i9qs4lOv",block:'[[[41,[30,0,["shouldRender"]],[[[1,"  "],[10,0],[14,0,"chat-channel-status"],[12],[1,"\\n    "],[1,[28,[35,1],[[30,0,["channelStatusIcon"]]],null]],[1,"\\n    "],[10,1],[12],[1,[30,0,["channelStatusMessage"]]],[13],[1,"\\n    "],[8,[39,2],null,[["@channel"],[[30,1]]],null],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@channel"],false,["if","d-icon","chat-channel-archive-status"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-status.hbs",isStrictMode:!1})
var u=new WeakSet,d=new WeakSet
class h extends i.default{constructor(){super(...arguments),s(this,d),s(this,u),o(this,"LONG_FORMAT","long"),o(this,"SHORT_FORMAT","short"),o(this,"VALID_FORMATS",[this.SHORT_FORMAT,this.LONG_FORMAT])}get format(){return this.VALID_FORMATS.includes(this.args.format)?this.args.format:this.LONG_FORMAT}get shouldRender(){return this.channelStatusIcon&&this.args.channel.status!==r.CHANNEL_STATUSES.open}get channelStatusMessage(){return this.format===this.LONG_FORMAT?l(this,d,m).call(this,this.args.channel.status):l(this,u,p).call(this,this.args.channel.status)}get channelStatusIcon(){return(0,r.channelStatusIcon)(this.args.channel.status)}}function p(e){switch(e){case r.CHANNEL_STATUSES.archived:return n.default.t("chat.channel_status.archived")
case r.CHANNEL_STATUSES.closed:return n.default.t("chat.channel_status.closed")
case r.CHANNEL_STATUSES.open:return n.default.t("chat.channel_status.open")
case r.CHANNEL_STATUSES.readOnly:return n.default.t("chat.channel_status.read_only")}}function m(e){switch(e){case r.CHANNEL_STATUSES.archived:return n.default.t("chat.channel_status.archived_header")
case r.CHANNEL_STATUSES.closed:return n.default.t("chat.channel_status.closed_header")
case r.CHANNEL_STATUSES.open:return n.default.t("chat.channel_status.open_header")
case r.CHANNEL_STATUSES.readOnly:return n.default.t("chat.channel_status.read_only_header")}}e.default=h,(0,t.setComponentTemplate)(c,h)})),define("discourse/plugins/chat/discourse/components/chat-channel-title",["exports","@ember/component","@glimmer/component","@ember/template","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,r.createTemplateFactory)({id:"kV5Mo0ml",block:'[[[41,[30,1,["isDirectMessageChannel"]],[[[1,"  "],[10,0],[14,0,"chat-channel-title is-dm"],[12],[1,"\\n"],[41,[30,1,["chatable","users","length"]],[[[1,"      "],[10,0],[14,0,"chat-channel-title__avatar"],[12],[1,"\\n"],[41,[30,0,["multiDm"]],[[[1,"          "],[10,1],[14,0,"chat-channel-title__users-count"],[12],[1,"\\n            "],[1,[30,1,["chatable","users","length"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[8,[39,1],null,[["@user"],[[28,[37,2],[[30,1,["chatable","users"]],"0"],null]]],null],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,0,"chat-channel-title__user-info"],[12],[1,"\\n      "],[10,0],[14,0,"chat-channel-title__usernames"],[12],[1,"\\n"],[41,[30,1,["chatable","users","length"]],[[[41,[30,0,["multiDm"]],[[[1,"            "],[10,1],[14,0,"chat-channel-title__name"],[12],[1,[30,0,["usernames"]]],[13],[1,"\\n"]],[]],[[[44,[[28,[37,2],[[30,1,["chatable","users"]],"0"],null]],[[[1,"              "],[10,1],[14,0,"chat-channel-title__name"],[12],[1,[30,2,["username"]]],[13],[1,"\\n"],[41,[30,0,["showUserStatus"]],[[[1,"                "],[8,[39,4],null,[["@class","@status","@showDescription"],["chat-channel-title__user-status-message",[28,[37,2],[[30,1,["chatable","users"]],"0.status"],null],[52,[30,0,["site","mobileView"]],"true"]]],null],[1,"\\n"]],[]],null],[1,"              "],[8,[39,5],null,[["@name","@outletArgs","@tagName","@connectorTagName"],["after-chat-channel-username",[28,[37,6],null,[["user"],[[30,2]]]],"",""]],null],[1,"\\n"]],[2]]]],[]]]],[]],[[[1,"          "],[10,1],[14,0,"chat-channel-title__name"],[12],[1,"Add users"],[13],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[48,[30,3]],[[[1,"      "],[18,3,null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],[[[41,[30,1,["isCategoryChannel"]],[[[1,"  "],[10,0],[14,0,"chat-channel-title is-category"],[12],[1,"\\n    "],[10,1],[14,0,"chat-channel-title__category-badge"],[15,5,[30,0,["channelColorStyle"]]],[12],[1,"\\n      "],[1,[28,[35,9],["d-chat"],null]],[1,"\\n"],[41,[30,1,["chatable","read_restricted"]],[[[1,"        "],[1,[28,[35,9],["lock"],[["class"],["chat-channel-title__restricted-category-icon"]]]],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n    "],[10,1],[14,0,"chat-channel-title__name"],[12],[1,"\\n      "],[1,[28,[35,10],[[30,1,["title"]]],null]],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[48,[30,3]],[[[1,"      "],[18,3,null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],[]]]],["@channel","user","&default"],false,["if","chat-user-avatar","get","let","user-status-message","plugin-outlet","hash","has-block","yield","d-icon","replace-emoji"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-title.hbs",isStrictMode:!1})
class s extends i.default{get users(){return this.args.channel.chatable.users}get multiDm(){return this.users.length>1}get usernames(){return this.users.mapBy("username").join(", ")}get channelColorStyle(){return(0,n.htmlSafe)(`color: #${this.args.channel.chatable.color}`)}get showUserStatus(){return!(1!==this.users.length||!this.users[0].status)}}e.default=s,(0,t.setComponentTemplate)(a,s)})),define("discourse/plugins/chat/discourse/components/chat-channel-unread-indicator",["exports","@ember/component","@glimmer/component","@ember/service","discourse/plugins/chat/discourse/lib/chat-user-preferences","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function m(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const g=(0,a.createTemplateFactory)({id:"YuxjflSR",block:'[[[41,[30,0,["showUnreadIndicator"]],[[[1,"  "],[10,0],[15,0,[28,[37,1],["chat-channel-unread-indicator",[52,[30,0,["isUrgent"]],"-urgent"]],null]],[12],[1,"\\n    "],[10,0],[14,0,"chat-channel-unread-indicator__number"],[12],[41,[30,0,["showUnreadCount"]],[[[1,[30,0,["unreadCount"]]]],[]],[[[1,""]],[]]],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","concat-class"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-unread-indicator.hbs",isStrictMode:!1})
let f=e.default=(u=new WeakSet,d=new WeakSet,s=class extends i.default{constructor(){super(...arguments),p(this,d),p(this,u),h(this,"chat",o,this),h(this,"site",l,this),h(this,"currentUser",c,this)}get showUnreadIndicator(){return this.args.channel.tracking.unreadCount>0||this.chat.activeChannel?.id!==this.args.channel.id&&this.args.channel.unreadThreadsCountSinceLastViewed>0}get unreadCount(){return m(this,d,y).call(this)&&m(this,u,v).call(this)?this.args.channel.tracking.mentionCount:this.args.channel.tracking.unreadCount}get isUrgent(){return m(this,d,y).call(this)?m(this,u,v).call(this):this.args.channel.isDirectMessageChannel||m(this,u,v).call(this)}get showUnreadCount(){return m(this,d,y).call(this)?m(this,u,v).call(this):this.args.channel.isDirectMessageChannel||this.isUrgent}},o=b(s.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=b(s.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=b(s.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s)
function v(){return this.args.channel.tracking.mentionCount>0}function y(){return(0,r.hasChatIndicator)(this.currentUser).ONLY_MENTIONS}(0,t.setComponentTemplate)(g,f)})),define("discourse/plugins/chat/discourse/components/chat-channel",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/application","@ember/object","@ember/runloop","@ember/service","discourse/lib/ajax-error","discourse/lib/desktop-notifications","discourse/lib/url","discourse/lib/user-presence","discourse-common/lib/debounce","discourse-common/utils/decorators","discourse/plugins/chat/discourse/lib/chat-constants","discourse/plugins/chat/discourse/lib/chat-ios-hacks","discourse/plugins/chat/discourse/lib/chat-messages-loader","discourse/plugins/chat/discourse/lib/check-message-visibility","discourse/plugins/chat/discourse/lib/scroll-helpers","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/services/chat-pane-base-subscriptions-manager","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_){"use strict"
var j,M,z,k,C,O,S,P,T,E,x,D,A,I,U,L,N,R,F,W,B,H,$,V,q,K,G,J,Y,Z,X
function Q(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ee(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function te(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ie(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function ne(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const re=(0,_.createTemplateFactory)({id:"83GBvqqH",block:'[[[11,0],[16,0,[28,[37,0],["chat-channel",[52,[30,0,["messagesLoader","loading"]],"loading"],[52,[30,0,["pane","sending"]],"chat-channel--sending"],[52,[51,[30,0,["messagesLoader","fetchedOnce"]]],"chat-channel--not-loaded-once"]],null]],[16,"data-id",[30,1,["id"]]],[4,[38,3],[[30,0,["setUploadDropZone"]]],null],[4,[38,3],[[30,0,["setupListeners"]]],null],[4,[38,4],[[30,0,["teardownListeners"]]],null],[4,[38,3],[[30,0,["didUpdateChannel"]]],null],[4,[38,3],[[30,0,["addAutoFocusEventListener"]]],null],[4,[38,4],[[30,0,["removeAutoFocusEventListener"]]],null],[12],[1,"\\n  "],[8,[39,5],null,[["@channel","@onCloseFullScreen","@displayed"],[[30,1],[30,0,["onCloseFullScreen"]],[30,0,["includeHeader"]]]],null],[1,"\\n\\n  "],[8,[39,6],null,[["@channel"],[[30,1]]],null],[1,"\\n\\n  "],[8,[39,7],null,null,null],[1,"\\n\\n  "],[11,0],[24,0,"chat-messages-scroll chat-messages-container popper-viewport"],[4,[38,3],[[30,0,["setScrollable"]]],null],[4,[38,8],[[28,[37,9],null,[["onScroll","onScrollEnd","reverse"],[[30,0,["onScroll"]],[30,0,["onScrollEnd"]],true]]]],null],[12],[1,"\\n    "],[11,0],[24,0,"chat-messages-container"],[4,[38,10],[[30,0,["didResizePane"]],[28,[37,9],null,[["delay","immediate"],[100,true]]]],null],[12],[1,"\\n"],[42,[28,[37,12],[[28,[37,12],[[30,0,["messagesManager","messages"]]],null]],null],"id",[[[1,"        "],[8,[39,13],null,[["@message","@disableMouseEvents","@resendStagedMessage","@fetchMessagesByDate","@context"],[[30,2],[30,0,["isScrolling"]],[30,0,["resendStagedMessage"]],[30,0,["fetchMessagesByDate"]],"channel"]],null],[1,"\\n"]],[2]],[[[41,[51,[30,0,["messagesLoader","fetchedOnce"]]],[[[1,"          "],[8,[39,14],null,null,null],[1,"\\n"]],[]],null]],[]]],[1,"    "],[13],[1,"\\n\\n"],[41,[30,0,["messagesLoader","loadedPast"]],[[[1,"      "],[10,0],[14,0,"all-loaded-message"],[12],[1,"\\n        "],[1,[28,[35,15],["chat.all_loaded"],null]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n\\n  "],[8,[39,16],null,[["@onScrollToBottom","@isVisible"],[[30,0,["scrollToLatestMessage"]],[30,0,["needsArrow"]]]],null],[1,"\\n\\n"],[41,[30,0,["pane","selectingMessages"]],[[[1,"    "],[8,[39,17],null,[["@enableMove","@pane"],[[28,[37,18],[[28,[37,19],[[30,1,["isDirectMessageChannel"]]],null],[30,1,["canModerate"]]],null],[30,0,["pane"]]]],null],[1,"\\n"]],[]],[[[41,[28,[37,18],[[28,[37,19],[[30,1,["isFollowing"]]],null],[30,1,["isCategoryChannel"]]],null],[[[1,"      "],[8,[39,20],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],[[[1,"      "],[8,[39,21],null,[["@channel","@uploadDropZone","@onSendMessage"],[[30,1],[30,0,["uploadDropZone"]],[30,0,["onSendMessage"]]]],null],[1,"\\n"]],[]]]],[]]],[1,"\\n  "],[8,[39,22],null,[["@model"],[[30,1]]],null],[1,"\\n"],[13]],["@channel","message"],false,["concat-class","if","unless","did-insert","will-destroy","chat-full-page-header","chat/notices","chat-mention-warnings","chat/scrollable-list","hash","chat/on-resize","each","-track-array","chat-message","chat-skeleton","i18n","chat/scroll-to-bottom-arrow","chat/selection-manager","and","not","chat-channel-preview-card","chat/composer/channel","chat-upload-drop-zone"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel.hbs",isStrictMode:!1})
let ae=e.default=(j=(0,o.inject)("chat-channel-composer"),M=(0,o.inject)("chat-channel-pane"),G=new WeakSet,J=new WeakSet,Y=new WeakSet,Z=new WeakSet,X=new WeakSet,z=class extends i.default{constructor(){super(...arguments),ee(this,X),ee(this,Z),ee(this,Y),ee(this,J),ee(this,G),Q(this,"appEvents",k,this),Q(this,"capabilities",C,this),Q(this,"chat",O,this),Q(this,"chatApi",S,this),Q(this,"chatChannelsManager",P,this),Q(this,"chatChannelPaneSubscriptionsManager",T,this),Q(this,"chatComposerPresenceManager",E,this),Q(this,"chatDraftsManager",x,this),Q(this,"chatEmojiPickerManager",D,this),Q(this,"chatStateManager",A,this),Q(this,"composer",I,this),Q(this,"pane",U,this),Q(this,"currentUser",L,this),Q(this,"messageBus",N,this),Q(this,"router",R,this),Q(this,"site",F,this),Q(this,"sending",W,this),Q(this,"showChatQuoteSuccess",B,this),Q(this,"includeHeader",H,this),Q(this,"needsArrow",$,this),Q(this,"atBottom",V,this),Q(this,"uploadDropZone",q,this),Q(this,"isScrolling",K,this),te(this,"scrollable",null)
te(this,"_mentionWarningsSeen",{}),te(this,"_unreachableGroupMentions",[]),te(this,"_overMembersLimitGroupMentions",[])}get messagesLoader(){return new g.default((0,r.getOwner)(this),this.args.channel)}get messagesManager(){return this.args.channel.messagesManager}get currentUserMembership(){return this.args.channel.currentUserMembership}setUploadDropZone(e){this.uploadDropZone=e}setScrollable(e){this.scrollable=e}setupListeners(){(0,d.onPresenceChange)({callback:this.onPresenceChangeCallback})}teardownListeners(){ie(this,Y,le).call(this),(0,d.removeOnPresenceChange)(this.onPresenceChangeCallback),this.unsubscribeToUpdates(this.args.channel.id)}didResizePane(){this.debounceFillPaneAttempt(),this.computeDatesSeparators()}didUpdateChannel(){this.messagesManager.clear(),this.args.channel.isDirectMessageChannel&&!this.args.channel.isFollowing&&this.chatChannelsManager.follow(this.args.channel)
const e=this.chatDraftsManager.get({channelId:this.args.channel.id})
e?this.composer.message=e:this.resetComposerMessage(),this.composer.focus(),this.loadMessages(),this.args.channel.updateLastViewedAt()}loadMessages(){this.args.channel?.id&&(this.subscribeToUpdates(this.args.channel),this.args.targetMessageId?this.debounceHighlightOrFetchMessage(this.args.targetMessageId):this.fetchMessages({fetch_from_last_read:!0}))}onPresenceChangeCallback(e){e&&this.debouncedUpdateLastReadMessage()}async fetchMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(this.messagesLoader.loading)return
this.messagesManager.clear()
const t=await this.messagesLoader.load(e)
if(this.messagesManager.messages=this.processMessages(this.args.channel,t),e.target_message_id)this.scrollToMessageId(e.target_message_id,{highlight:!0})
else if(e.fetch_from_last_read){const e=this.currentUserMembership?.lastReadMessageId
this.scrollToMessageId(e)}else e.target_date?this.scrollToMessageId(t.meta.target_message_id,{highlight:!0,position:"center"}):(this._ignoreNextScroll=!0,this.scrollToBottom())
this.debounceFillPaneAttempt(),this.debouncedUpdateLastReadMessage()}async fetchMoreMessages(e){let{direction:t}=e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
if(this.messagesLoader.loading)return
const n=await this.messagesLoader.loadMore({direction:t})
if(!n)return
const r=this.processMessages(this.args.channel,n)
if(!r.length)return
const a=this.messagesManager.messages.lastObject.id;(0,b.stackingContextFix)(this.scrollable,(()=>{this.messagesManager.addMessages(r)})),t!==m.FUTURE||i.noScroll||this.scrollToMessageId(a,{position:"end",forceAuto:!0}),this.debounceFillPaneAttempt()}scrollToBottom(){this._ignoreNextScroll=!0,(0,v.scrollListToBottom)(this.scrollable)}scrollToMessageId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
this._ignoreNextScroll=!0
const i=this.messagesManager.findMessage(e);(0,v.scrollListToMessage)(this.scrollable,i,t)}debounceFillPaneAttempt(){this._debouncedFillPaneAttemptHandler=(0,h.default)(this,this.fillPaneAttempt,500)}fetchMessagesByDate(e){if(this.messagesLoader.loading)return
const t=this.messagesManager.findFirstMessageOfDay(new Date(e))
t.firstOfResults&&this.messagesLoader.canLoadMorePast?this.fetchMessages({target_date:e,direction:m.FUTURE}):this.highlightOrFetchMessage(t.id,{position:"center"})}async fillPaneAttempt(){this.messagesLoader.fetchedOnce&&(this.messagesManager.messages.length>200||this.messagesLoader.canLoadMorePast&&(0,s.schedule)("afterRender",(()=>{const e=this.messagesManager.messages.firstObject?.id,t=this.scrollable.querySelector(`.chat-message-container[data-id="${e}"]`)
t&&(0,f.checkMessageTopVisibility)(this.scrollable,t)&&this.fetchMoreMessages({direction:m.PAST})})))}processMessages(e,t){const i=[]
let n=!1
const r=this.messagesManager.messages.some((e=>e.newest))
return t?.messages?.forEach(((a,s)=>{a.firstOfResults=0===s,this.currentUser.ignored_users&&(a.hidden=this.currentUser.ignored_users.includes(a.user.username)),this.requestedTargetMessageId===a.id?a.expanded=!a.hidden:a.expanded=!(a.hidden||a.deleted_at),!r&&!n&&a.id>this.currentUserMembership?.lastReadMessageId&&(n=!0,a.newest=!0)
const o=y.default.create(e,a)
o.manager=e.messagesManager,o.thread&&ie(this,Z,ce).call(this,o.thread,t.tracking.thread_tracking),i.push(o)})),i}debounceHighlightOrFetchMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
this._debouncedHighlightOrFetchMessageHandler=(0,h.default)(this,this.highlightOrFetchMessage,e,t,100)}highlightOrFetchMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
const i=this.messagesManager.findMessage(e)
i?this.scrollToMessageId(i.id,Object.assign({highlight:!0,position:"start",autoExpand:!0,behavior:this.capabilities.isIOS?"smooth":null},t)):this.fetchMessages({target_message_id:e})}debouncedUpdateLastReadMessage(){this._debouncedUpdateLastReadMessageHandler=(0,h.default)(this,this.updateLastReadMessage,m.READ_INTERVAL_MS)}updateLastReadMessage(){this.args.channel.isFollowing&&(0,s.schedule)("afterRender",(()=>{let e=null
if(this.scrollable.querySelectorAll(".chat-message-container").forEach((t=>{(0,f.checkMessageBottomVisibility)(this.scrollable,t)&&(e=t)})),!e)return
let t=this.messagesManager.findMessage(e.dataset.id)
if(!t)return
const i=this.args.channel.currentUserMembership?.lastReadMessageId
return i>t.id?void 0:this.chatApi.markChannelAsRead(this.args.channel.id,t.id)}))}scrollToLatestMessage(){this.messagesLoader.canLoadMoreFuture?this.fetchMessages():this.messagesManager.messages.length>0&&this.scrollToBottom(this.scrollable)}onScroll(e){(0,b.bodyScrollFix)(),(0,s.next)((()=>{ie(this,X,ue).call(this)||(this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!0,this.debouncedUpdateLastReadMessage(),e.atTop||!this.capabilities.isIOS&&e.up&&e.distanceToTop.percentage<40?this.fetchMoreMessages({direction:m.PAST}):e.atBottom&&this.fetchMoreMessages({direction:m.FUTURE}))}))}onScrollEnd(e){(0,c.resetIdle)(),this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!1,this.atBottom=e.atBottom,e.atBottom&&this.fetchMoreMessages({direction:m.FUTURE})}onMessage(e){if("sent"===e.type)this.handleSentMessage(e)}handleSentMessage(e){if(e.chat_message.user.id===this.currentUser.id&&e.staged_id){if((0,w.handleStagedMessage)(this.args.channel,this.messagesManager,e))return}const t=y.default.create(this.args.channel,e.chat_message)
t.manager=this.args.channel.messagesManager,(0,b.stackingContextFix)(this.scrollable,(()=>{this.messagesManager.addMessages([t])})),this.debouncedUpdateLastReadMessage(),this.args.channel.lastMessage=t}async onSendMessage(e){await e.cook(),e.editing?await ie(this,G,se).call(this,e):await ie(this,J,oe).call(this,e)}resetComposerMessage(){this.composer.reset(this.args.channel)}_onSendError(e,t){const i=this.args.channel.messagesManager.findStagedMessage(e)
i&&(t.jqXHR?.responseJSON?.errors?.length?(i.message="",i.cooked="",i.error=t.jqXHR.responseJSON.errors[0]):(this.chat.markNetworkAsUnreliable(),i.error="network_error")),this.resetComposerMessage()}resendStagedMessage(e){this.pane.sending=!0,e.error=null
const t={cooked:e.cooked,message:e.message,upload_ids:e.uploads.map((e=>e.id)),staged_id:e.id}
this.chatApi.sendMessage(this.args.channel.id,t).catch((e=>{this._onSendError(t.staged_id,e)})).then((()=>{this.chat.markNetworkAsReliable()})).finally((()=>{this.pane.sending=!1}))}onCloseFullScreen(){this.chatStateManager.prefersDrawer(),u.default.routeTo(this.chatStateManager.lastKnownAppURL).then((()=>{u.default.routeTo(this.chatStateManager.lastKnownChatURL)}))}unsubscribeToUpdates(e){e&&(this.chatChannelPaneSubscriptionsManager.unsubscribe(),this.messageBus.unsubscribe(`/chat/${e}`,this.onMessage))}subscribeToUpdates(e){e&&(this.messageBus.subscribe(`/chat/${e.id}`,this.onMessage,e.channelMessageBusLastId),this.chatChannelPaneSubscriptionsManager.subscribe(e))}addAutoFocusEventListener(){document.addEventListener("keydown",this._autoFocus)}removeAutoFocusEventListener(){document.removeEventListener("keydown",this._autoFocus)}_autoFocus(e){if(this.chatStateManager.isDrawerActive)return
const{key:t,metaKey:i,ctrlKey:n,code:r,target:a}=e
!t||t.length>1||i||n||"Space"===r||"?"===t||a&&!/^(INPUT|TEXTAREA|SELECT)$/.test(a.tagName)&&(e.preventDefault(),this.composer.focus({addText:e.key}))}computeDatesSeparators(){(0,s.schedule)("afterRender",(()=>{const e=[...this.scrollable.querySelectorAll(".chat-message-separator-date")].reverse(),t=this.scrollable.querySelector(".chat-messages-container").clientHeight
e.map(((i,n)=>{const r={bottom:0,date:i},a=i.nextElementSibling
if(n>0){const i=e[n-1].nextElementSibling
r.bottom=t-i.offsetTop}if(1===e.length)r.height=t
else if(0===n)r.height=t-a.offsetTop
else{const i=e[n-1].nextElementSibling
r.height=t-a.offsetTop-(t-i.offsetTop)}return r})).forEach((e=>{e.date.style.bottom=e.bottom+"px",e.date.style.height=e.height+"px"}))}))}},k=ne(z.prototype,"appEvents",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=ne(z.prototype,"capabilities",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=ne(z.prototype,"chat",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=ne(z.prototype,"chatApi",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=ne(z.prototype,"chatChannelsManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=ne(z.prototype,"chatChannelPaneSubscriptionsManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=ne(z.prototype,"chatComposerPresenceManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=ne(z.prototype,"chatDraftsManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=ne(z.prototype,"chatEmojiPickerManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=ne(z.prototype,"chatStateManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=ne(z.prototype,"composer",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=ne(z.prototype,"pane",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=ne(z.prototype,"currentUser",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=ne(z.prototype,"messageBus",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=ne(z.prototype,"router",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=ne(z.prototype,"site",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=ne(z.prototype,"sending",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),B=ne(z.prototype,"showChatQuoteSuccess",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),H=ne(z.prototype,"includeHeader",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),$=ne(z.prototype,"needsArrow",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),V=ne(z.prototype,"atBottom",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),q=ne(z.prototype,"uploadDropZone",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=ne(z.prototype,"isScrolling",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ne(z.prototype,"messagesLoader",[n.cached],Object.getOwnPropertyDescriptor(z.prototype,"messagesLoader"),z.prototype),ne(z.prototype,"setUploadDropZone",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"setUploadDropZone"),z.prototype),ne(z.prototype,"setScrollable",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"setScrollable"),z.prototype),ne(z.prototype,"setupListeners",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"setupListeners"),z.prototype),ne(z.prototype,"teardownListeners",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"teardownListeners"),z.prototype),ne(z.prototype,"didResizePane",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"didResizePane"),z.prototype),ne(z.prototype,"didUpdateChannel",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"didUpdateChannel"),z.prototype),ne(z.prototype,"loadMessages",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"loadMessages"),z.prototype),ne(z.prototype,"onPresenceChangeCallback",[p.bind],Object.getOwnPropertyDescriptor(z.prototype,"onPresenceChangeCallback"),z.prototype),ne(z.prototype,"scrollToBottom",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"scrollToBottom"),z.prototype),ne(z.prototype,"fetchMessagesByDate",[p.bind],Object.getOwnPropertyDescriptor(z.prototype,"fetchMessagesByDate"),z.prototype),ne(z.prototype,"processMessages",[p.bind],Object.getOwnPropertyDescriptor(z.prototype,"processMessages"),z.prototype),ne(z.prototype,"scrollToLatestMessage",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"scrollToLatestMessage"),z.prototype),ne(z.prototype,"onScroll",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"onScroll"),z.prototype),ne(z.prototype,"onScrollEnd",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"onScrollEnd"),z.prototype),ne(z.prototype,"onMessage",[p.bind],Object.getOwnPropertyDescriptor(z.prototype,"onMessage"),z.prototype),ne(z.prototype,"onSendMessage",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"onSendMessage"),z.prototype),ne(z.prototype,"resetComposerMessage",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"resetComposerMessage"),z.prototype),ne(z.prototype,"resendStagedMessage",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"resendStagedMessage"),z.prototype),ne(z.prototype,"onCloseFullScreen",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"onCloseFullScreen"),z.prototype),ne(z.prototype,"addAutoFocusEventListener",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"addAutoFocusEventListener"),z.prototype),ne(z.prototype,"removeAutoFocusEventListener",[a.action],Object.getOwnPropertyDescriptor(z.prototype,"removeAutoFocusEventListener"),z.prototype),ne(z.prototype,"_autoFocus",[p.bind],Object.getOwnPropertyDescriptor(z.prototype,"_autoFocus"),z.prototype),ne(z.prototype,"computeDatesSeparators",[p.bind],Object.getOwnPropertyDescriptor(z.prototype,"computeDatesSeparators"),z.prototype),z)
async function se(e){this.pane.sending=!0
const t={message:e.message,upload_ids:e.uploads.map((e=>e.id))}
this.resetComposerMessage()
try{(0,b.stackingContextFix)(this.scrollable,(async()=>{await this.chatApi.editMessage(this.args.channel.id,e.id,t)}))}catch(i){(0,l.popupAjaxError)(i)}finally{e.editing=!1,this.chatDraftsManager.remove({channelId:this.args.channel.id}),this.pane.sending=!1}}async function oe(e){this.pane.sending=!0,(0,c.resetIdle)(),(0,b.stackingContextFix)(this.scrollable,(async()=>{await this.args.channel.stageMessage(e)})),e.manager=this.args.channel.messagesManager,this.resetComposerMessage(),this.capabilities.isIOS||this.messagesLoader.canLoadMoreFuture||this.scrollToLatestMessage()
try{await this.chatApi.sendMessage(this.args.channel.id,{message:e.message,in_reply_to_id:e.inReplyTo?.id,staged_id:e.id,upload_ids:e.uploads.map((e=>e.id))}),this.capabilities.isIOS||this.scrollToLatestMessage()}catch(t){this._onSendError(e.id,t)}finally{this.chatDraftsManager.remove({channelId:this.args.channel.id}),this.pane.sending=!1}}function le(){(0,s.cancel)(this._debouncedHighlightOrFetchMessageHandler),(0,s.cancel)(this._debouncedUpdateLastReadMessageHandler),(0,s.cancel)(this._debouncedFillPaneAttemptHandler)}function ce(e,t){t[e.id]&&(e.tracking.unreadCount=t[e.id].unread_count,e.tracking.mentionCount=t[e.id].mention_count)}function ue(){const e=this._ignoreNextScroll
return this._ignoreNextScroll=!1,e}(0,t.setComponentTemplate)(re,ae)})),define("discourse/plugins/chat/discourse/components/chat-composer-dropdown",["exports","@ember/component","@glimmer/component","@ember/object","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const s=(0,r.createTemplateFactory)({id:"kgRiw3WL",block:'[[[41,[30,1,["length"]],[[[1,"  "],[8,[39,1],[[16,0,[28,[37,2],["chat-composer-dropdown__trigger-btn","btn-flat",[52,[30,2],"has-active-panel"]],null]],[17,3]],[["@title","@icon","@disabled","@arrow","@placements"],[[28,[37,3],["chat.composer.toggle_toolbar"],null],"plus",[30,4],true,[28,[37,4],["top","bottom"],null]]],[["default"],[[[[1,"\\n    "],[10,"ul"],[14,0,"chat-composer-dropdown__list"],[12],[1,"\\n"],[42,[28,[37,6],[[28,[37,6],[[30,1]],null]],null],null,[[[1,"        "],[10,"li"],[15,0,[28,[37,2],["chat-composer-dropdown__item",[30,6,["id"]]],null]],[12],[1,"\\n          "],[8,[39,7],[[16,0,[28,[37,2],["chat-composer-dropdown__action-btn",[30,6,["id"]]],null]]],[["@icon","@action","@label"],[[30,6,["icon"]],[28,[37,8],[[30,0,["onButtonClick"]],[30,6],[30,5,["close"]]],null],[30,6,["label"]]]],null],[1,"\\n        "],[13],[1,"\\n"]],[6]],null],[1,"    "],[13],[1,"\\n  "]],[5]]]]],[1,"\\n"]],[]],null]],["@buttons","@hasActivePanel","&attrs","@isDisabled","menu","button"],false,["if","d-menu","concat-class","i18n","array","each","-track-array","d-button","fn"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer-dropdown.hbs",isStrictMode:!1})
let o=e.default=(a=class extends i.default{onButtonClick(e,t){t(),e.action()}},l=a.prototype,c="onButtonClick",u=[n.action],d=Object.getOwnPropertyDescriptor(a.prototype,"onButtonClick"),h=a.prototype,p={},Object.keys(d).forEach((function(e){p[e]=d[e]})),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=u.slice().reverse().reduce((function(e,t){return t(l,c,e)||e}),p),h&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(h):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(l,c,p),p=null),a)
var l,c,u,d,h,p;(0,t.setComponentTemplate)(s,o)})),define("discourse/plugins/chat/discourse/components/chat-composer-message-details",["exports","@ember/component","@glimmer/component","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"IEh9HUqD",block:'[[[10,0],[14,0,"chat-composer-message-details"],[15,"data-id",[30,1,["id"]]],[15,"data-action",[52,[30,1,["editing"]],"edit","reply"]],[12],[1,"\\n  "],[10,0],[14,0,"chat-reply"],[12],[1,"\\n    "],[1,[28,[35,1],[[52,[30,1,["editing"]],"pencil-alt","reply"]],null]],[1,"\\n    "],[8,[39,2],null,[["@user"],[[30,1,["user"]]]],null],[1,"\\n    "],[10,1],[14,0,"chat-reply__username"],[12],[1,[30,1,["user","username"]]],[13],[1,"\\n    "],[10,1],[14,0,"chat-reply__excerpt"],[12],[1,"\\n      "],[1,[28,[35,3],[[28,[37,4],[[30,1,["excerpt"]]],null]],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,5],[[24,0,"btn-flat cancel-message-action"]],[["@action","@icon","@title"],[[30,2],"times-circle","cancel"]],null],[1,"\\n"],[13]],["@message","@cancelAction"],false,["if","d-icon","chat-user-avatar","replace-emoji","html-safe","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer-message-details.hbs",isStrictMode:!1})
class a extends i.default{}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/chat-composer-upload",["exports","@ember/component","@glimmer/component","discourse/lib/uploads","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,r.createTemplateFactory)({id:"Ecj7n+7W",block:'[[[41,[30,1],[[[1,"  "],[10,0],[15,0,[28,[37,1],["chat-composer-upload",[52,[30,0,["isImage"]],"chat-composer-upload--image"],[52,[51,[30,2]],"chat-composer-upload--in-progress"]],null]],[12],[1,"\\n    "],[10,0],[14,0,"preview"],[12],[1,"\\n"],[41,[30,0,["isImage"]],[[[41,[30,2],[[[1,"          "],[10,"img"],[14,0,"preview-img"],[15,"src",[30,1,["short_path"]]],[12],[13],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[35,3],["far-image"],null]],[1,"\\n"]],[]]]],[]],[[[1,"        "],[1,[28,[35,3],["file-alt"],null]],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n\\n    "],[10,1],[14,0,"data"],[12],[1,"\\n"],[41,[51,[30,0,["isImage"]]],[[[1,"        "],[10,0],[14,0,"top-data"],[12],[1,"\\n          "],[10,1],[14,0,"file-name"],[12],[1,[30,0,["fileName"]]],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[10,0],[14,0,"bottom-data"],[12],[1,"\\n"],[41,[30,2],[[[41,[51,[30,0,["isImage"]]],[[[1,"            "],[10,1],[14,0,"extension-pill"],[12],[1,[30,1,["extension"]]],[13],[1,"\\n"]],[]],null]],[]],[[[41,[30,1,["processing"]],[[[1,"            "],[10,1],[14,0,"processing"],[12],[1,[28,[35,4],["processing"],null]],[13],[1,"\\n"]],[]],[[[1,"            "],[10,1],[14,0,"uploading"],[12],[1,[28,[35,4],["uploading"],null]],[13],[1,"\\n"]],[]]],[1,"\\n          "],[10,"progress"],[14,0,"upload-progress"],[14,1,"file"],[14,"max","100"],[15,2,[30,1,["progress"]]],[12],[13],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[39,5],[[24,0,"btn-flat chat-composer-upload__remove-btn"]],[["@action","@icon","@title"],[[30,3],"times","chat.remove_upload"]],null],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@upload","@isDone","@onCancel"],false,["if","concat-class","unless","d-icon","i18n","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer-upload.hbs",isStrictMode:!1})
class s extends i.default{get isImage(){return(0,n.isImage)(this.args.upload.original_filename||this.args.upload.fileName)}get fileName(){return this.args.isDone?this.args.upload.original_filename:this.args.upload.fileName}}e.default=s,(0,t.setComponentTemplate)(a,s)})),define("discourse/plugins/chat/discourse/components/chat-composer-uploads",["exports","@ember/component","@ember/object","@ember/service","discourse/lib/uppy-media-optimization-plugin","discourse/lib/utilities","discourse/mixins/uppy-upload","discourse-common/lib/object","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d
function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,c.createTemplateFactory)({id:"FoGAB5VV",block:'[[[41,[30,0,["showUploadsContainer"]],[[[1,"  "],[10,0],[14,0,"chat-composer-uploads-container"],[12],[1,"\\n"],[42,[28,[37,2],[[28,[37,2],[[30,0,["uploads"]]],null]],null],null,[[[1,"      "],[8,[39,3],null,[["@upload","@isDone","@onCancel"],[[30,1],true,[28,[37,4],[[30,0],"removeUpload",[30,1]],null]]],null],[1,"\\n"]],[1]],null],[1,"\\n"],[42,[28,[37,2],[[28,[37,2],[[30,0,["inProgressUploads"]]],null]],null],null,[[[1,"      "],[8,[39,3],null,[["@upload","@onCancel"],[[30,2],[28,[37,4],[[30,0],"cancelUploading",[30,2]],null]]],null],[1,"\\n"]],[2]],null],[1,"  "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[8,[39,5],null,[["@allowMultiple","@fileInputId","@fileInputClass"],[true,[30,0,["fileUploadElementId"]],"hidden-upload-field"]],null]],["upload","upload"],false,["if","each","-track-array","chat-composer-upload","action","pick-files-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer-uploads.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(p,t.default.extend(s.default,(u=(0,l.default)("uploads.length","inProgressUploads.length"),d={classNames:["chat-composer-uploads"],mediaOptimizationWorker:(0,n.inject)(),chatStateManager:(0,n.inject)(),id:"chat-composer-uploader",type:"chat-composer",existingUploads:null,uploads:null,useMultipartUploadsIfAvailable:!0,uploadDropZone:null,init(){this._super(...arguments),this.setProperties({fileInputSelector:`#${this.fileUploadElementId}`})},didReceiveAttrs(){this._super(...arguments),this.inProgressUploads?.length>0&&this._uppyInstance?.cancelAll(),this.set("uploads",this.existingUploads?(0,o.cloneJSON)(this.existingUploads):[])},didInsertElement(){this._super(...arguments),this.composerInputEl?.addEventListener("paste",this._pasteEventListener)},willDestroyElement(){this._super(...arguments),this.composerInputEl?.removeEventListener("paste",this._pasteEventListener)},uploadDone(e){this.uploads.pushObject(e),this._triggerUploadsChanged()},showUploadsContainer:(e,t)=>e>0||t>0,cancelUploading(e){this.appEvents.trigger(`upload-mixin:${this.id}:cancel-upload`,{fileId:e.id}),this.removeUpload(e)},removeUpload(e){this.uploads.removeObject(e),this._triggerUploadsChanged()},_uploadDropTargetOptions(){return{target:this.uploadDropZone||document.body}},_uppyReady(){this.siteSettings.composer_media_optimization_image_enabled&&this._useUploadPlugin(r.default,{optimizeFn:(e,t)=>this.mediaOptimizationWorker.optimizeImage(e,t),runParallel:!this.site.isMobileDevice}),this._onPreProcessProgress((e=>{const t=this.inProgressUploads.findBy("id",e.id)
t?.processing||t?.set("processing",!0)})),this._onPreProcessComplete((e=>{const t=this.inProgressUploads.findBy("id",e.id)
t?.set("processing",!1)}))},_pasteEventListener(e){if(document.activeElement!==this.composerInputEl)return
const{canUpload:t,canPasteHtml:i,types:n}=(0,a.clipboardHelpers)(e,{siteSettings:this.siteSettings,canUpload:!0})
!t||i||n.includes("text/plain")||e&&e.clipboardData&&e.clipboardData.files&&this._addFiles([...e.clipboardData.files],{pasted:!0})},onProgressUploadsChanged(){this._triggerUploadsChanged(this.uploads,{inProgressUploadsCount:this.inProgressUploads?.length})},_triggerUploadsChanged(){this.onUploadChanged?.(this.uploads,{inProgressUploadsCount:this.inProgressUploads?.length})}},h(d,"showUploadsContainer",[u],Object.getOwnPropertyDescriptor(d,"showUploadsContainer"),d),h(d,"cancelUploading",[i.action],Object.getOwnPropertyDescriptor(d,"cancelUploading"),d),h(d,"removeUpload",[i.action],Object.getOwnPropertyDescriptor(d,"removeUpload"),d),h(d,"_pasteEventListener",[l.bind],Object.getOwnPropertyDescriptor(d,"_pasteEventListener"),d),d)))})),define("discourse/plugins/chat/discourse/components/chat-composer",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/application","@ember/object","@ember/runloop","@ember/service","@ember/utils","pretty-text/emoji","pretty-text/emoji/data","rsvp","discourse/components/modal/insert-hyperlink","discourse/lib/autocomplete","discourse/lib/hashtag-autocomplete","discourse/lib/text","discourse/lib/user-search","discourse/lib/user-status-on-autocomplete","discourse-common/lib/object","discourse-common/lib/raw-templates","discourse-i18n","discourse/plugins/chat/discourse/components/chat/modal/channel-summary","discourse/plugins/chat/discourse/lib/chat-composer-buttons","discourse/plugins/chat/discourse/lib/chat-message-interactor","discourse/plugins/chat/discourse/lib/textarea-interactor","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j,M,z,k){"use strict"
var C,O,S,P,T,E,x,D,A,I,U,L,N,R,F,W,B,H,V,q,K,G,J,Y
function Z(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function X(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Q(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function ee(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const te=(0,k.createTemplateFactory)({id:"7dJhz7X+",block:'[[[1,"\\n"],[10,0],[14,0,"chat-composer__wrapper"],[12],[1,"\\n"],[41,[30,0,["shouldRenderMessageDetails"]],[[[1,"    "],[8,[39,1],null,[["@message","@cancelAction"],[[52,[30,0,["currentMessage","editing"]],[30,0,["currentMessage"]],[30,0,["currentMessage","inReplyTo"]]],[30,0,["composer","cancel"]]]],null],[1,"\\n"]],[]],null],[1,"\\n  "],[11,0],[24,"role","region"],[16,"aria-label",[28,[37,2],["chat.aria_roles.composer"],null]],[16,0,[28,[37,3],["chat-composer",[52,[30,0,["isFocused"]],"is-focused"],[52,[30,0,["pane","sending"]],"is-sending"],[52,[30,0,["sendEnabled"]],"is-send-enabled","is-send-disabled"],[52,[30,0,["disabled"]],"is-disabled","is-enabled"],[52,[30,0,["currentMessage","draftSaved"]],"is-draft-saved","is-draft-unsaved"]],null]],[4,[38,4],[[30,0,["didUpdateMessage"]],[30,0,["currentMessage"]]],null],[4,[38,4],[[30,0,["didUpdateInReplyTo"]],[30,0,["currentMessage","inReplyTo"]]],null],[4,[38,5],[[30,0,["setup"]]],null],[4,[38,6],[[30,0,["teardown"]]],null],[4,[38,6],[[30,0,["cancelPersistDraft"]]],null],[12],[1,"\\n    "],[10,0],[14,0,"chat-composer__outer-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-composer__inner-container"],[12],[1,"\\n        "],[8,[39,7],null,[["@buttons","@isDisabled"],[[30,0,["dropdownButtons"]],[30,0,["disabled"]]]],null],[1,"\\n\\n        "],[11,0],[24,0,"chat-composer__input-container"],[4,[38,8],["click",[30,0,["composer","focus"]]],null],[12],[1,"\\n          "],[8,[39,9],[[16,1,[30,0,["composerId"]]],[16,2,[28,[37,10],[[30,0,["currentMessage","message"]]],null]],[24,0,"chat-composer__input"],[16,"disabled",[30,0,["disabled"]]],[24,"autocorrect","on"],[24,"autocapitalize","sentences"],[16,"placeholder",[30,0,["placeholder"]]],[16,"rows",1],[16,"data-chat-composer-context",[30,0,["context"]]],[24,4,"text"],[4,[38,5],[[30,0,["setupTextareaInteractor"]]],null],[4,[38,8],["input",[30,0,["onInput"]]],null],[4,[38,8],["keydown",[30,0,["onKeyDown"]]],null],[4,[38,8],["focusin",[30,0,["onTextareaFocusIn"]]],null],[4,[38,8],["focusin",[28,[37,11],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,8],["focusout",[28,[37,11],[[30,0,["computeIsFocused"]],false],null]],null],[4,[38,5],[[30,0,["setupAutocomplete"]]],null]],null,null],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[30,0,["inlineButtons","length"]],[[[42,[28,[37,13],[[28,[37,13],[[30,0,["inlineButtons"]]],null]],null],null,[[[1,"            "],[8,[39,14],[[16,0,[29,["-",[30,1,["id"]]]]],[16,"disabled",[28,[37,15],[[30,0,["disabled"]],[30,1,["disabled"]]],null]],[16,"tabindex",[52,[30,1,["disabled"]],-1,0]],[4,[38,8],["click",[28,[37,11],[[30,0,["handleInlineButonAction"]],[30,1,["action"]]],null]],[["bubbles"],[false]]],[4,[38,8],["focus",[28,[37,11],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,8],["blur",[28,[37,11],[[30,0,["computeIsFocused"]],false],null]],null]],[["@icon"],[[30,1,["icon"]]]],null],[1,"\\n"]],[1]],null],[1,"\\n          "],[8,[39,16],null,null,null],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[39,14],[[24,0,"-send"],[16,"title",[28,[37,2],["chat.composer.send"],null]],[16,"disabled",[28,[37,15],[[30,0,["disabled"]],[28,[37,17],[[30,0,["sendEnabled"]]],null]],null]],[16,"tabindex",[52,[30,0,["sendEnabled"]],0,-1]],[4,[38,8],["click",[30,0,["onSend"]]],null],[4,[38,8],["mousedown",[30,0,["trapMouseDown"]]],null],[4,[38,8],["focus",[28,[37,11],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,8],["blur",[28,[37,11],[[30,0,["computeIsFocused"]],false],null]],null]],[["@icon"],["paper-plane"]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n"],[41,[30,0,["canAttachUploads"]],[[[1,"    "],[8,[39,18],null,[["@fileUploadElementId","@onUploadChanged","@existingUploads","@uploadDropZone","@composerInputEl"],[[30,0,["fileUploadElementId"]],[30,0,["onUploadChanged"]],[30,0,["currentMessage","uploads"]],[30,2],[30,0,["composer","textarea","element"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["shouldRenderReplyingIndicator"]],[[[1,"    "],[10,0],[14,0,"chat-replying-indicator-container"],[12],[1,"\\n      "],[8,[39,19],null,[["@presenceChannelName"],[[30,0,["presenceChannelName"]]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[8,[39,20],null,[["@context","@didSelectEmoji"],[[30,0,["context"]],[30,0,["onSelectEmoji"]]]],null],[1,"\\n"],[13]],["button","@uploadDropZone"],false,["if","chat-composer-message-details","i18n","concat-class","did-update","did-insert","will-destroy","chat-composer-dropdown","on","d-textarea","readonly","fn","each","-track-array","chat/composer/button","or","chat/composer/separator","not","chat-composer-uploads","chat-replying-indicator","chat-emoji-picker"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer.hbs",isStrictMode:!1})
let ie=e.default=(V=new WeakSet,q=new WeakSet,K=new WeakSet,G=new WeakSet,J=new WeakSet,Y=new WeakSet,C=class extends i.default{constructor(){super(...arguments),X(this,Y),X(this,J),X(this,G),X(this,K),X(this,q),X(this,V),Z(this,"capabilities",O,this),Z(this,"site",S,this),Z(this,"siteSettings",P,this),Z(this,"store",T,this),Z(this,"chat",E,this),Z(this,"chatComposerPresenceManager",x,this),Z(this,"chatComposerWarningsTracker",D,this),Z(this,"appEvents",A,this),Z(this,"chatEmojiReactionStore",I,this),Z(this,"chatEmojiPickerManager",U,this),Z(this,"currentUser",L,this),Z(this,"chatApi",N,this),Z(this,"chatDraftsManager",R,this),Z(this,"modal",F,this),Z(this,"isFocused",W,this),Z(this,"inProgressUploadsCount",B,this),Z(this,"presenceChannelName",H,this)}get shouldRenderMessageDetails(){return this.currentMessage?.editing||"channel"===this.context&&this.currentMessage?.inReplyTo}get inlineButtons(){return(0,j.chatComposerButtons)(this,"inline",this.context)}get dropdownButtons(){return(0,j.chatComposerButtons)(this,"dropdown",this.context)}get fileUploadElementId(){return this.context+"-file-uploader"}get canAttachUploads(){return this.siteSettings.chat_allow_uploads&&(0,l.isPresent)(this.args.uploadDropZone)}persistDraft(){}setupAutocomplete(e){const t=$(e)
Q(this,q,re).call(this,t),Q(this,G,se).call(this,t),Q(this,K,ae).call(this,t)}setupTextareaInteractor(e){this.composer.textarea=new z.default((0,r.getOwner)(this),e),this.site.desktopView&&this.args.autofocus&&this.composer.focus({ensureAtEnd:!0,refreshHeight:!0})}didUpdateMessage(){this.cancelPersistDraft(),this.composer.textarea.value=this.currentMessage.message,this.persistDraft(),this.captureMentions({skipDebounce:!0})}didUpdateInReplyTo(){this.cancelPersistDraft(),this.persistDraft()}cancelPersistDraft(){(0,s.cancel)(this._persistHandler)}handleInlineButonAction(e,t){t.stopPropagation(),e()}get currentMessage(){return this.composer.message}get hasContent(){const e=this.siteSettings.chat_minimum_message_length||1
return this.currentMessage?.message?.length>=e||this.canAttachUploads&&this.hasUploads}get hasUploads(){return this.currentMessage?.uploads?.length>0}get sendEnabled(){return(this.hasContent||this.currentMessage?.editing)&&!this.pane.sending&&!this.inProgressUploadsCount>0}setup(){this.appEvents.on("chat:modify-selection",this,"modifySelection"),this.appEvents.on("chat:open-insert-link-modal",this,"openInsertLinkModal")}teardown(){this.appEvents.off("chat:modify-selection",this,"modifySelection"),this.appEvents.off("chat:open-insert-link-modal",this,"openInsertLinkModal"),this.pane.sending=!1}insertDiscourseLocalDate(){const e=require("discourse/plugins/discourse-local-dates/discourse/components/modal/local-dates-create").default
this.modal.show(e,{model:{insertDate:e=>{this.composer.textarea.addText(this.composer.textarea.getSelected(),e),this.composer.focus()}}})}uploadClicked(){document.querySelector(`#${this.fileUploadElementId}`).click()}computeIsFocused(e){(0,s.next)((()=>{this.isFocused=e}))}onInput(e){this.currentMessage.draftSaved=!1,this.currentMessage.message=e.target.value,this.composer.textarea.refreshHeight(),this.reportReplyingPresence(),this.persistDraft(),this.captureMentions()}onUploadChanged(e,t){let{inProgressUploadsCount:i}=t
this.currentMessage.draftSaved=!1,this.inProgressUploadsCount=i||0,void 0!==e&&"undefined"!==i&&0===i&&this.currentMessage&&(this.currentMessage.uploads=(0,v.cloneJSON)(e)),this.composer.textarea?.focus(),this.reportReplyingPresence(),this.persistDraft()}trapMouseDown(e){e?.preventDefault()}async onSend(e){this.sendEnabled&&(e?.preventDefault(),!this.currentMessage.editing||this.hasUploads||0!==this.currentMessage.message.length?(await this.args.onSendMessage(this.currentMessage),this.composer.textarea.refreshHeight()):Q(this,Y,le).call(this))}reportReplyingPresence(){this.args.channel&&this.currentMessage&&this.chatComposerPresenceManager.notifyState(this.presenceChannelName,!this.currentMessage.editing&&this.hasContent)}modifySelection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{type:null,context:null}
if(t.context!==this.context)return
const i=this.composer.textarea.getSelected("",{lineVal:!0})
"bold"===t.type?this.composer.textarea.applySurround(i,"**","**","bold_text"):"italic"===t.type?this.composer.textarea.applySurround(i,"_","_","italic_text"):"code"===t.type&&this.composer.textarea.applySurround(i,"`","`","code_text")}onTextareaFocusIn(e){this.capabilities.isIOS&&((e=this.composer.textarea.textarea).style.transform="translateY(-99999px)",e.focus(),window.requestAnimationFrame((()=>{window.requestAnimationFrame((()=>{e.style.transform=""}))})))}onKeyDown(e){if(!(this.site.mobileView||e.altKey||e.metaKey||Q(this,J,oe).call(this))){if("Escape"===e.key&&!e.shiftKey)return this.handleEscape(e)
if("Enter"===e.key){if(e.shiftKey)return
if(!e.ctrlKey){const{pre:e}=this.composer.textarea.getSelected({lineVal:!0})
if(this.composer.textarea.isInside(e,/(^|\n)```/g))return}return this.onSend(),e.preventDefault(),!1}if("ArrowUp"===e.key&&!this.hasContent&&!this.currentMessage.editing)if(e.shiftKey&&this.lastMessage?.replyable)this.composer.replyTo(this.lastMessage)
else{const e=this.lastUserMessage(this.currentUser)
e?.editable&&this.composer.edit(e)}}}openInsertLinkModal(e){if((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{context:null}).context!==this.context)return
const t=this.composer.textarea.getSelected("",{lineVal:!0}),i=t?.value
this.modal.show(h.default,{model:{linkText:i,toolbarEvent:{addText:e=>this.composer.textarea.addText(t,e)}}})}onSelectEmoji(e){const t=`:${e}:`
this.chatEmojiReactionStore.track(t),this.composer.textarea.addText(this.composer.textarea.getSelected(),t),this.site.desktopView?this.composer.focus():this.chatEmojiPickerManager.close()}captureMentions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{skipDebounce:!1}
this.hasContent?this.chatComposerWarningsTracker.trackMentions(this.currentMessage,e.skipDebounce):this.chatComposerWarningsTracker.reset()}showChannelSummaryModal(){this.modal.show(_.default,{model:{channelId:this.args.channel.id}})}},O=ee(C.prototype,"capabilities",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=ee(C.prototype,"site",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=ee(C.prototype,"siteSettings",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=ee(C.prototype,"store",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=ee(C.prototype,"chat",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=ee(C.prototype,"chatComposerPresenceManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=ee(C.prototype,"chatComposerWarningsTracker",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=ee(C.prototype,"appEvents",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=ee(C.prototype,"chatEmojiReactionStore",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=ee(C.prototype,"chatEmojiPickerManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=ee(C.prototype,"currentUser",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=ee(C.prototype,"chatApi",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=ee(C.prototype,"chatDraftsManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=ee(C.prototype,"modal",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=ee(C.prototype,"isFocused",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),B=ee(C.prototype,"inProgressUploadsCount",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),H=ee(C.prototype,"presenceChannelName",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee(C.prototype,"persistDraft",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"persistDraft"),C.prototype),ee(C.prototype,"setupAutocomplete",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"setupAutocomplete"),C.prototype),ee(C.prototype,"setupTextareaInteractor",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"setupTextareaInteractor"),C.prototype),ee(C.prototype,"didUpdateMessage",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"didUpdateMessage"),C.prototype),ee(C.prototype,"didUpdateInReplyTo",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"didUpdateInReplyTo"),C.prototype),ee(C.prototype,"cancelPersistDraft",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"cancelPersistDraft"),C.prototype),ee(C.prototype,"handleInlineButonAction",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"handleInlineButonAction"),C.prototype),ee(C.prototype,"setup",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"setup"),C.prototype),ee(C.prototype,"teardown",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"teardown"),C.prototype),ee(C.prototype,"insertDiscourseLocalDate",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"insertDiscourseLocalDate"),C.prototype),ee(C.prototype,"uploadClicked",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"uploadClicked"),C.prototype),ee(C.prototype,"computeIsFocused",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"computeIsFocused"),C.prototype),ee(C.prototype,"onInput",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"onInput"),C.prototype),ee(C.prototype,"onUploadChanged",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"onUploadChanged"),C.prototype),ee(C.prototype,"trapMouseDown",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"trapMouseDown"),C.prototype),ee(C.prototype,"onSend",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"onSend"),C.prototype),ee(C.prototype,"modifySelection",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"modifySelection"),C.prototype),ee(C.prototype,"onTextareaFocusIn",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"onTextareaFocusIn"),C.prototype),ee(C.prototype,"onKeyDown",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"onKeyDown"),C.prototype),ee(C.prototype,"openInsertLinkModal",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"openInsertLinkModal"),C.prototype),ee(C.prototype,"onSelectEmoji",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"onSelectEmoji"),C.prototype),ee(C.prototype,"captureMentions",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"captureMentions"),C.prototype),ee(C.prototype,"showChannelSummaryModal",[a.action],Object.getOwnPropertyDescriptor(C.prototype,"showChannelSummaryModal"),C.prototype),C)
function ne(e){const t=this.store.createRecord("user",e)
this.currentMessage.mentionedUsers.set(t.id,t)}function re(e){this.siteSettings.enable_mentions&&e.autocomplete({template:(0,y.findRawTemplate)("user-selector-autocomplete"),key:"@",width:"100%",treatAsTextarea:!0,autoSelectFirstSuggestion:!0,transformComplete:e=>(e.isUser&&Q(this,V,ne).call(this,e),e.username||e.name),dataSource:e=>((0,f.destroyUserStatuses)(),(0,g.default)({term:e,includeGroups:!0}).then((e=>{if(e?.users?.length>0){const t=this.chat.presenceChannel.users?.mapBy("username")
e.users.forEach((e=>{t.includes(e.username)&&(e.cssClasses="is-online")})),(0,f.initUserStatusHtml)((0,r.getOwner)(this),e.users)}return e}))),onRender:e=>{(0,f.renderUserStatusHtml)(e)},afterComplete:(e,t)=>{t.preventDefault(),this.composer.textarea.value=e,this.composer.focus(),this.captureMentions()},onClose:f.destroyUserStatuses})}function ae(e){(0,m.setupHashtagAutocomplete)(this.site.hashtag_configurations["chat-composer"],e,this.siteSettings,{treatAsTextarea:!0,afterComplete:(e,t)=>{t.preventDefault(),this.composer.textarea.value=e,this.composer.focus()}})}function se(e){this.siteSettings.enable_emoji&&e.autocomplete({template:(0,y.findRawTemplate)("emoji-selector-autocomplete"),key:":",afterComplete:(e,t)=>{t.preventDefault(),this.composer.textarea.value=e,this.composer.focus()},treatAsTextarea:!0,onKeyUp:(e,t)=>{const i=/(?:^|[\s.\?,@\/#!%&*;:\[\]{}=\-_()])(:(?!:).?[\w-]*:?(?!:)(?:t\d?)?:?) ?$/gi.exec(e.substring(0,t))
if(i&&i[1])return[i[1]]},transformComplete:t=>t.code?(this.chatEmojiReactionStore.track(t.code),`${t.code}:`):(e.autocomplete({cancel:!0}),this.chatEmojiPickerManager.open({context:this.context,initialFilter:t.term}),""),dataSource:e=>new d.Promise((t=>{const i=`:${e}`
e=e.toLowerCase()
let n=Math.max(this.siteSettings.emoji_autocomplete_min_chars,2)
if(e.length<n)return t(p.SKIP)
if(!e.match(/[^-\{\}\[\]\(\)\*_\<\>\\\/].*[^-\{\}\[\]\(\)\*_\<\>\\\/]/))return t(p.SKIP)
if(""===e)return this.chatEmojiReactionStore.favorites.length?t(this.chatEmojiReactionStore.favorites.slice(0,5)):t(["slight_smile","smile","wink","sunny","blush"])
const r=this.site.custom_emoji_translation||{},a=Object.assign({},u.translations,r)
if(a[i])return t([a[i]])
const s=this.site.denied_emojis||[],o=e.match(/^:?(.*?):t([2-6])?$/)
if(o){const e=o[1],i=o[2]
if((0,c.isSkinTonableEmoji)(e)&&!s.includes(e))return t(i?[`${e}:t${i}`]:[2,3,4,5,6].map((t=>`${e}:t${t}`)))}return t((0,c.emojiSearch)(e,{maxResults:5,diversity:this.chatEmojiReactionStore.diversity,exclude:s}))})).then((e=>{if(e!==p.SKIP)return e.map((e=>({code:e,src:(0,b.emojiUrlFor)(e)})))})).then((t=>(t?.length&&t.push({label:w.default.t("composer.more_emoji"),term:e}),t)))})}function oe(){return document.querySelector(".autocomplete")}function le(){new M.default((0,r.getOwner)(this),this.currentMessage,this.context).delete(),this.reset(this.args.channel,this.args.thread)}(0,t.setComponentTemplate)(te,ie)})),define("discourse/plugins/chat/discourse/components/chat-drawer",["exports","@ember/component","@ember/object","@ember/runloop","@ember/service","@ember/template","discourse/lib/url","discourse/lib/utilities","discourse-common/lib/get-url","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h
function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,u.createTemplateFactory)({id:"Km2Q7jFJ",block:'[[[41,[30,0,["chatStateManager","isDrawerActive"]],[[[1,"  "],[11,0],[16,"data-chat-channel-id",[30,0,["chat","activeChannel","id"]]],[16,"data-chat-thread-id",[30,0,["chat","activeChannel","activeThread","id"]]],[16,0,[28,[37,1],["chat-drawer",[52,[30,0,["chatStateManager","isDrawerExpanded"]],"is-expanded"]],null]],[16,5,[30,0,["drawerStyle"]]],[4,[38,2],[".chat-drawer-resizer",[30,0,["didResize"]]],null],[12],[1,"\\n    "],[10,0],[14,0,"chat-drawer-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-drawer-resizer"],[12],[13],[1,"\\n      "],[8,[30,0,["chatDrawerRouter","component"]],null,[["@params","@openURL","@openInFullPage","@toggleExpand","@close","@drawerActions"],[[30,0,["chatDrawerRouter","params"]],[30,0,["openURL"]],[30,0,["openInFullPage"]],[30,0,["toggleExpand"]],[30,0,["close"]],[30,0,["drawerActions"]]]],null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","concat-class","chat/resizable-node"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(m,t.default.extend((d=(0,c.observes)("chatStateManager.isDrawerActive"),h={tagName:"",chat:(0,r.inject)(),router:(0,r.inject)(),chatDrawerSize:(0,r.inject)(),chatChannelsManager:(0,r.inject)(),chatStateManager:(0,r.inject)(),chatDrawerRouter:(0,r.inject)(),loading:!1,sizeTimer:null,rafTimer:null,hasUnreadMessages:!1,drawerStyle:null,didInsertElement(){this._super(...arguments),this.chat.userCanChat&&(this._checkSize(),this.appEvents.on("chat:open-url",this,"openURL"),this.appEvents.on("chat:toggle-close",this,"close"),this.appEvents.on("composer:closed",this,"_checkSize"),this.appEvents.on("composer:opened",this,"_checkSize"),this.appEvents.on("composer:resized",this,"_checkSize"),this.appEvents.on("composer:div-resizing",this,"_dynamicCheckSize"),window.addEventListener("resize",this._checkSize),this.appEvents.on("composer:resize-started",this,"_startDynamicCheckSize"),this.appEvents.on("composer:resize-ended",this,"_clearDynamicCheckSize"),this.computeDrawerStyle())},willDestroyElement(){this._super(...arguments),this.chat.userCanChat&&(window.removeEventListener("resize",this._checkSize),this.appEvents&&(this.appEvents.off("chat:open-url",this,"openURL"),this.appEvents.off("chat:toggle-close",this,"close"),this.appEvents.off("composer:closed",this,"_checkSize"),this.appEvents.off("composer:opened",this,"_checkSize"),this.appEvents.off("composer:resized",this,"_checkSize"),this.appEvents.off("composer:div-resizing",this,"_dynamicCheckSize"),this.appEvents.off("composer:resize-started",this,"_startDynamicCheckSize"),this.appEvents.off("composer:resize-ended",this,"_clearDynamicCheckSize")),this.sizeTimer&&((0,n.cancel)(this.sizeTimer),this.sizeTimer=null),this.rafTimer&&window.cancelAnimationFrame(this.rafTimer))},_fireHiddenAppEvents(){this.appEvents.trigger("chat:rerender-header")},computeDrawerStyle(){const{width:e,height:t}=this.chatDrawerSize.size
let i=`width: ${(0,o.escapeExpression)((e||"0").toString())}px;`
i+=`height: ${(0,o.escapeExpression)((t||"0").toString())}px;`,this.set("drawerStyle",(0,a.htmlSafe)(i))},get drawerActions(){return{openInFullPage:this.openInFullPage,close:this.close,toggleExpand:this.toggleExpand}},_dynamicCheckSize(){this.chatStateManager.isDrawerActive&&(this.rafTimer||(this.rafTimer=window.requestAnimationFrame((()=>{this.rafTimer=null,this._performCheckSize()}))))},_startDynamicCheckSize(){this.chatStateManager.isDrawerActive&&document.querySelector(".chat-drawer-outlet-container").classList.add("clear-transitions")},_clearDynamicCheckSize(){this.chatStateManager.isDrawerActive&&(document.querySelector(".chat-drawer-outlet-container").classList.remove("clear-transitions"),this._checkSize())},_checkSize(){this.sizeTimer=(0,n.throttle)(this,this._performCheckSize,150)},_performCheckSize(){if(this.isDestroying||this.isDestroyed)return
const e=document.querySelector(".chat-drawer-outlet-container")
if(!e)return
const t=document.getElementById("reply-control"),i=t.classList.contains("closed")
e.style.setProperty("--composer-right",(i?15:Math.max(15,t.offsetLeft))+"px")},openURL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null
this.chat.activeChannel=null,this.chatDrawerRouter.stateFor(this._routeFromURL(e)),this.chatStateManager.didOpenDrawer(e)},_routeFromURL(e){let t=this.router.recognize((0,l.default)(e||"/"))
return"index"===t.localName&&(t=t.parent),t},async openInFullPage(){return this.chatStateManager.storeAppURL(),this.chatStateManager.prefersFullPage(),this.chat.activeChannel=null,await new Promise((e=>(0,n.next)(e))),s.default.routeTo(this.chatStateManager.lastKnownChatURL)},toggleExpand(){this.computeDrawerStyle(),this.chatStateManager.didToggleDrawer(),this.appEvents.trigger("chat:toggle-expand",this.chatStateManager.isDrawerExpanded)},close(){this.computeDrawerStyle(),this.chatStateManager.didCloseDrawer(),this.chat.activeChannel=null},didResize(e,t){let{width:i,height:n}=t
this.chatDrawerSize.size={width:i,height:n}}},p(h,"_fireHiddenAppEvents",[d],Object.getOwnPropertyDescriptor(h,"_fireHiddenAppEvents"),h),p(h,"_dynamicCheckSize",[c.bind],Object.getOwnPropertyDescriptor(h,"_dynamicCheckSize"),h),p(h,"_checkSize",[c.bind],Object.getOwnPropertyDescriptor(h,"_checkSize"),h),p(h,"openURL",[i.action],Object.getOwnPropertyDescriptor(h,"openURL"),h),p(h,"openInFullPage",[i.action],Object.getOwnPropertyDescriptor(h,"openInFullPage"),h),p(h,"toggleExpand",[i.action],Object.getOwnPropertyDescriptor(h,"toggleExpand"),h),p(h,"close",[i.action],Object.getOwnPropertyDescriptor(h,"close"),h),p(h,"didResize",[i.action],Object.getOwnPropertyDescriptor(h,"didResize"),h),h)))})),define("discourse/plugins/chat/discourse/components/chat-drawer/channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,a.createTemplateFactory)({id:"l2AmQk6g",block:'[[[8,[39,0],null,[["@toggleExpand"],[[30,1,["toggleExpand"]]]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,null],[1,"\\n\\n  "],[8,[39,2],null,[["@channel","@drawerActions"],[[30,0,["chat","activeChannel"]],[30,1]]],null],[1,"\\n\\n  "],[8,[39,3],null,[["@drawerActions"],[[30,1]]],null],[1,"\\n"]],[]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[11,0],[24,0,"chat-drawer-content"],[4,[38,5],[[30,0,["fetchChannel"]]],null],[4,[38,6],[[30,0,["fetchChannel"]],[30,2,["channelId"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[42,[28,[37,8],[[28,[37,8],[[28,[37,9],[[30,0,["chat","activeChannel"]]],null]],null]],null],null,[[[1,"        "],[8,[39,10],null,[["@targetMessageId","@channel"],[[28,[37,11],[[30,2,["messageId"]]],null],[30,3]]],null],[1,"\\n"]],[3]],null]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@drawerActions","@params","channel"],false,["chat-drawer/header","chat-drawer/header/left-actions","chat-drawer/header/channel-title","chat-drawer/header/right-actions","if","did-insert","did-update","each","-track-array","array","chat-channel","readonly"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/channel.hbs",isStrictMode:!1})
let m=e.default=(s=class extends i.default{constructor(){super(...arguments),d(this,"appEvents",o,this),d(this,"chat",l,this),d(this,"chatStateManager",c,this),d(this,"chatChannelsManager",u,this)}fetchChannel(){if(this.args.params?.channelId)return this.chatChannelsManager.find(this.args.params.channelId).then((e=>{this.chat.activeChannel=e}))}},o=h(s.prototype,"appEvents",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=h(s.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(s.prototype,"chatStateManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(s.prototype,"chatChannelsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(s.prototype,"fetchChannel",[n.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchChannel"),s.prototype),s);(0,t.setComponentTemplate)(p,m)})),define("discourse/plugins/chat/discourse/components/chat-drawer/header",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"YEFR7d/9",block:'[[[11,0],[24,"role","region"],[16,"aria-label",[28,[37,0],["chat.aria_roles.header"],null]],[24,0,"chat-drawer-header"],[16,"title",[52,[30,0,["chatStateManager","isDrawerExpanded"]],[28,[37,0],["chat.collapse"],null],[28,[37,0],["chat.expand"],null]]],[4,[38,2],["click",[30,1]],null],[12],[1,"\\n  "],[18,2,null],[1,"\\n"],[13]],["@toggleExpand","&default"],false,["i18n","if","on","yield"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)}))
define("discourse/plugins/chat/discourse/components/chat-drawer/header/back-link",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"kj3DzeN+",block:'[[[8,[39,0],[[16,"title",[30,1]],[24,0,"chat-drawer-header__back-btn"]],[["@route","@models"],[[30,2],[28,[37,1],[[30,3],[28,[37,2],null,null]],null]]],[["default"],[[[[1,"\\n  "],[1,[28,[35,3],["chevron-left"],null]],[1,"\\n"]],[]]]]]],["@title","@route","@routeModels"],false,["link-to","or","array","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/back-link.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/channel-title",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"Kaybpdy4",block:'[[[41,[30,1],[[[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"    "],[8,[39,1],[[24,0,"chat-drawer-header__title"]],[["@route","@models"],[[52,[30,1,["isDirectMessageChannel"]],"chat.channel.info.settings","chat.channel.info.members"],[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n        "],[8,[39,2],null,[["@channel"],[[30,1]]],null],[1,"\\n      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],[[[1,"    "],[11,0],[24,"role","button"],[24,0,"chat-drawer-header__title"],[4,[38,3],["click",[30,2,["toggleExpand"]]],null],[12],[1,"\\n      "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n        "],[8,[39,2],null,[["@channel"],[[30,1]]],[["default"],[[[[1,"\\n"],[41,[30,1,["tracking","unreadCount"]],[[[1,"            "],[10,1],[14,0,"chat-unread-count"],[12],[1,"\\n              "],[1,[30,1,["tracking","unreadCount"]]],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]]]],[]],null]],["@channel","@drawerActions"],false,["if","link-to","chat-channel-title","on"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/channel-title.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/close-button",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"GvR89FJy",block:'[[[8,[39,0],[[24,0,"btn-flat btn-link chat-drawer-header__close-btn"]],[["@icon","@action","@title"],["times",[30,1],"chat.close"]],null]],["@close"],false,["d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/close-button.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/full-page-button",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"Q3UEeeW9",block:'[[[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[8,[39,1],[[24,0,"btn-flat btn-link chat-drawer-header__full-screen-btn"]],[["@icon","@title","@action"],["discourse-expand","chat.open_full_page",[30,1]]],null],[1,"\\n"]],[]],null]],["@openInFullPage"],false,["if","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/full-page-button.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/left-actions",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"y0iVBJEN",block:'[[[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[10,0],[14,0,"chat-drawer-header__left-actions"],[12],[1,"\\n    "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n      "],[8,[39,1],null,[["@route","@title"],["chat",[28,[37,2],["chat.return_to_list"],null]]],null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","chat-drawer/header/back-link","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/left-actions.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/right-actions",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"n0mIgt/b",block:'[[[10,0],[14,0,"chat-drawer-header__right-actions"],[12],[1,"\\n  "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n"],[41,[30,0,["showThreadsListButton"]],[[[1,"      "],[8,[39,1],null,[["@channel"],[[30,0,["chat","activeChannel"]]]],null],[1,"\\n"]],[]],null],[1,"\\n    "],[8,[39,2],null,[["@toggleExpand"],[[30,1,["toggleExpand"]]]],null],[1,"\\n\\n    "],[8,[39,3],null,[["@openInFullPage"],[[30,1,["openInFullPage"]]]],null],[1,"\\n\\n    "],[8,[39,4],null,[["@close"],[[30,1,["close"]]]],null],[1,"\\n  "],[13],[1,"\\n"],[13]],["@drawerActions"],false,["if","chat/thread/threads-list-button","chat-drawer/header/toggle-expand-button","chat-drawer/header/full-page-button","chat-drawer/header/close-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/right-actions.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get showThreadsListButton(){return this.chat.activeChannel?.threadingEnabled}},c=a.prototype,u="chat",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/title",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"h7tnAKNT",block:'[[[10,1],[14,0,"chat-drawer-header__title"],[12],[1,"\\n  "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n    "],[1,[28,[35,0],[[30,1]],null]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@title"],false,["i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/title.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/toggle-expand-button",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"g4xvMUNB",block:'[[[8,[39,0],[[24,0,"btn-flat btn-link chat-drawer-header__expand-btn"]],[["@icon","@action","@title"],[[52,[30,0,["chatStateManager","isDrawerExpanded"]],"angle-double-down","angle-double-up"],[30,1],[52,[30,0,["chatStateManager","isDrawerExpanded"]],"chat.collapse","chat.expand"]]],null]],["@toggleExpand"],false,["d-button","if"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/toggle-expand-button.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/index",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"EGaKY0Ld",block:'[[[8,[39,0],null,[["@toggleExpand"],[[30,1,["toggleExpand"]]]],[["default"],[[[[1,"\\n  "],[10,0],[14,0,"chat-drawer-header__title"],[12],[1,"\\n    "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n      "],[1,[28,[35,1],["chat.heading"],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,2],null,[["@drawerActions"],[[30,1]]],null],[1,"\\n"]],[]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[10,0],[14,0,"chat-drawer-content"],[12],[1,"\\n    "],[8,[39,4],null,null,null],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@drawerActions"],false,["chat-drawer/header","i18n","chat-drawer/header/right-actions","if","channels-list"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/index.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/thread",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,a.createTemplateFactory)({id:"qengP9cp",block:'[[[8,[39,0],null,[["@toggleExpand"],[[30,1,["toggleExpand"]]]],[["default"],[[[[1,"\\n"],[41,[28,[37,2],[[30,0,["chatStateManager","isDrawerExpanded"]],[30,0,["chat","activeChannel"]]],null],[[[1,"    "],[10,0],[14,0,"chat-drawer-header__left-actions"],[12],[1,"\\n      "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n        "],[8,[39,3],null,[["@route","@title","@routeModels"],[[30,0,["backLink","route"]],[28,[37,4],[[30,0,["backLink","title"]]],null],[30,0,["backLink","models"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[8,[39,5],null,[["@title"],["chat.thread.label"]],null],[1,"\\n\\n  "],[8,[39,6],null,[["@drawerActions"],[[30,1]]],null],[1,"\\n"]],[]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[11,0],[24,0,"chat-drawer-content"],[4,[38,7],[[30,0,["fetchChannelAndThread"]]],null],[4,[38,8],[[30,0,["fetchChannelAndThread"]],[30,2,["channelId"]]],null],[4,[38,8],[[30,0,["fetchChannelAndThread"]],[30,2,["threadId"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel","activeThread"]],[[[1,"      "],[8,[39,9],null,[["@thread","@targetMessageId"],[[30,0,["chat","activeChannel","activeThread"]],[30,2,["messageId"]]]],null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@drawerActions","@params"],false,["chat-drawer/header","if","and","chat-drawer/header/back-link","i18n","chat-drawer/header/title","chat-drawer/header/right-actions","did-insert","did-update","chat-thread"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/thread.hbs",isStrictMode:!1})
let b=e.default=(s=class extends i.default{constructor(){super(...arguments),h(this,"appEvents",o,this),h(this,"chat",l,this),h(this,"chatStateManager",c,this),h(this,"chatChannelsManager",u,this),h(this,"chatHistory",d,this)}get backLink(){const e={models:this.chat.activeChannel.routeModels}
return"chat.channel.threads"===this.chatHistory.previousRoute?.name?(e.title="chat.return_to_threads_list",e.route="chat.channel.threads"):(e.title="chat.return_to_list",e.route="chat.channel"),e}fetchChannelAndThread(){if(this.args.params?.channelId&&this.args.params?.threadId)return this.chatChannelsManager.find(this.args.params.channelId).then((e=>{this.chat.activeChannel=e,e.threadsManager.find(e.id,this.args.params.threadId).then((e=>{this.chat.activeChannel.activeThread=e}))}))}},o=p(s.prototype,"appEvents",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=p(s.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=p(s.prototype,"chatStateManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(s.prototype,"chatChannelsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=p(s.prototype,"chatHistory",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(s.prototype,"fetchChannelAndThread",[n.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchChannelAndThread"),s.prototype),s);(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/chat-drawer/threads",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,a.createTemplateFactory)({id:"hyK1qjXq",block:'[[[8,[39,0],null,[["@toggleExpand"],[[30,1,["toggleExpand"]]]],[["default"],[[[[1,"\\n"],[41,[28,[37,2],[[30,0,["chatStateManager","isDrawerExpanded"]],[30,0,["chat","activeChannel"]]],null],[[[1,"    "],[10,0],[14,0,"chat-drawer-header__left-actions"],[12],[1,"\\n      "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n        "],[8,[39,3],null,[["@route","@title","@routeModels"],["chat.channel",[28,[37,4],["chat.return_to_list"],null],[30,0,["chat","activeChannel","routeModels"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[8,[39,5],null,[["@title"],["chat.threads.list"]],null],[1,"\\n\\n  "],[8,[39,6],null,[["@drawerActions"],[[30,1]]],null],[1,"\\n"]],[]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[11,0],[24,0,"chat-drawer-content"],[4,[38,7],[[30,0,["fetchChannel"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[1,"      "],[8,[39,8],null,[["@channel","@includeHeader"],[[30,0,["chat","activeChannel"]],false]],null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@drawerActions"],false,["chat-drawer/header","if","and","chat-drawer/header/back-link","i18n","chat-drawer/header/title","chat-drawer/header/right-actions","did-insert","chat-thread-list"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/threads.hbs",isStrictMode:!1})
let m=e.default=(s=class extends i.default{constructor(){super(...arguments),d(this,"appEvents",o,this),d(this,"chat",l,this),d(this,"chatStateManager",c,this),d(this,"chatChannelsManager",u,this)}fetchChannel(){if(this.args.params?.channelId)return this.chatChannelsManager.find(this.args.params.channelId).then((e=>{this.chat.activeChannel=e}))}},o=h(s.prototype,"appEvents",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=h(s.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(s.prototype,"chatStateManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(s.prototype,"chatChannelsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(s.prototype,"fetchChannel",[n.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchChannel"),s.prototype),s);(0,t.setComponentTemplate)(p,m)})),define("discourse/plugins/chat/discourse/components/chat-emoji-avatar",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"dtSGV+5d",block:'[[[10,0],[14,0,"chat-emoji-avatar"],[12],[1,"\\n  "],[10,0],[14,0,"chat-emoji-avatar-container"],[12],[1,"\\n    "],[1,[28,[35,0],[[30,1]],null]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@emoji"],false,["replace-emoji"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-emoji-avatar.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/chat-emoji-picker",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","@ember/template","discourse/lib/text","discourse-common/config/environment","discourse-common/lib/debounce","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g,f,v,y,w
function _(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function M(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.FITZPATRICK_MODIFIERS=void 0
const z=(0,h.createTemplateFactory)({id:"l3mpMFCA",block:'[[[1,"\\n"],[41,[28,[37,1],[[30,0,["chatEmojiPickerManager","picker","context"]],[30,1]],null],[[[1,"  "],[11,0],[16,0,[28,[37,2],["chat-emoji-picker",[30,2],[52,[30,0,["chatEmojiPickerManager","closing"]],"closing"]],null]],[17,3],[4,[38,3],[[30,0,["addClickOutsideEventListener"]]],null],[4,[38,3],[[30,0,["chatEmojiPickerManager","loadEmojis"]]],null],[4,[38,3],[[52,[30,4],[30,4],[28,[37,4],null,null]]],null],[4,[38,5],[[52,[30,5],[30,5],[28,[37,4],null,null]]],null],[4,[38,5],[[30,0,["removeClickOutsideEventListener"]]],null],[4,[38,6],["keydown",[30,0,["trapKeyDownEvents"]]],null],[12],[1,"\\n    "],[10,0],[14,0,"chat-emoji-picker__filter-container"],[12],[1,"\\n      "],[8,[39,7],[[16,"placeholder",[28,[37,8],["chat.emoji_picker.search_placeholder"],null]],[16,"autofocus",true],[4,[38,3],[[52,[30,0,["site","desktopView"]],[30,0,["focusFilter"]],[28,[37,4],null,null]]],null],[4,[38,3],[[28,[37,11],[[30,0,["didInputFilter"]],[30,0,["chatEmojiPickerManager","picker","initialFilter"]]],null]],null]],[["@class","@value","@filterAction","@icons"],["chat-emoji-picker__filter",[30,0,["chatEmojiPickerManager","picker","initialFilter"]],[28,[37,9],[[30,0],[30,0,["didInputFilter"]]],[["value"],["target.value"]]],[28,[37,10],null,[["left"],["search"]]]]],[["default"],[[[[1,"\\n        "],[11,0],[24,0,"chat-emoji-picker__fitzpatrick-scale"],[24,"role","toolbar"],[4,[38,6],["keyup",[30,0,["didNavigateFitzpatrickScale"]]],null],[12],[1,"\\n"],[41,[30,0,["isExpandedFitzpatrickScale"]],[[[42,[28,[37,13],[[28,[37,13],[[30,0,["fitzpatrickModifiers"]]],null]],null],null,[[[1,"\\n"],[41,[28,[37,14],[[30,6,["scale"]],[30,0,["chatEmojiReactionStore","diversity"]]],null],[[[1,"                "],[11,"button"],[16,"title",[28,[37,15],["t",[30,6,["scale"]]],null]],[24,"tabindex","-1"],[16,0,[28,[37,2],["chat-emoji-picker__fitzpatrick-modifier-btn",[28,[37,15],["t",[30,6,["scale"]]],null]],null]],[24,4,"button"],[4,[38,6],["keyup",[28,[37,11],[[30,0,["didRequestFitzpatrickScale"]],[30,6,["scale"]]],null]],null],[4,[38,6],["click",[28,[37,11],[[30,0,["didRequestFitzpatrickScale"]],[30,6,["scale"]]],null]],null],[12],[1,"\\n                  "],[1,[28,[35,16],["check"],null]],[1,"\\n                "],[13],[1,"\\n"]],[]],null]],[6]],null]],[]],null],[1,"\\n          "],[11,"button"],[16,"title",[28,[37,15],["t",[30,0,["fitzpatrick","scale"]]],null]],[16,0,[28,[37,2],["chat-emoji-picker__fitzpatrick-modifier-btn current",[28,[37,15],["t",[30,0,["chatEmojiReactionStore","diversity"]]],null]],null]],[24,4,"button"],[4,[38,6],["keyup",[30,0,["didToggleFitzpatrickScale"]]],null],[4,[38,6],["click",[30,0,["didToggleFitzpatrickScale"]]],null],[12],[13],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,0,["chatEmojiPickerManager","sections","length"]],[[[41,[28,[37,1],[[30,0,["filteredEmojis"]],null],null],[[[1,"        "],[10,0],[14,0,"chat-emoji-picker__sections-nav"],[12],[1,"\\n          "],[10,0],[14,0,"chat-emoji-picker__sections-nav__indicator"],[15,5,[30,0,["navIndicatorStyle"]]],[12],[13],[1,"\\n\\n"],[42,[28,[37,17],[[30,0,["groups"]]],null],null,[[[1,"            "],[8,[39,18],[[16,0,[28,[37,2],["btn-flat","chat-emoji-picker__section-btn",[52,[28,[37,1],[[30,0,["chatEmojiPickerManager","lastVisibleSection"]],[30,8]],null],"active"]],null]],[24,"tabindex","-1"],[16,5,[30,0,["navBtnStyle"]]],[16,"data-section",[30,8]]],[["@action"],[[28,[37,11],[[30,0,["didRequestSection"]],[30,8]],null]]],[["default"],[[[[1,"\\n"],[41,[28,[37,1],[[30,8],"favorites"],null],[[[1,"                "],[1,[28,[35,19],[":star:"],null]],[1,"\\n"]],[]],[[[1,"                "],[10,"img"],[14,"width","18"],[14,"height","18"],[14,0,"emoji"],[15,"src",[28,[37,20],[[30,7],"0.url"],null]],[12],[13],[1,"\\n"]],[]]],[1,"            "]],[]]]]],[1,"\\n"]],[7,8]],null],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[11,0],[24,0,"chat-emoji-picker__scrollable-content"],[4,[38,21],null,null],[12],[1,"\\n        "],[11,0],[24,0,"chat-emoji-picker__sections"],[24,"role","button"],[4,[38,6],["click",[30,0,["didSelectEmoji"]]],null],[4,[38,6],["keydown",[30,0,["onSectionsKeyDown"]]],null],[12],[1,"\\n"],[41,[28,[37,14],[[30,0,["filteredEmojis"]],null],null],[[[1,"            "],[10,0],[14,0,"chat-emoji-picker__section filtered"],[12],[1,"\\n"],[42,[28,[37,13],[[28,[37,13],[[30,0,["filteredEmojis"]]],null]],null],null,[[[1,"                "],[10,"img"],[14,"width","32"],[14,"height","32"],[14,0,"emoji"],[15,"src",[28,[37,22],[[30,9],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"tabindex","0"],[15,"data-emoji",[30,9,["name"]]],[15,"data-tonable",[52,[30,9,["tonable"]],"true"]],[15,"alt",[30,9,["name"]]],[15,"title",[28,[37,23],[[30,9],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"loading","lazy"],[12],[13],[1,"\\n"]],[9]],[[[1,"                "],[10,2],[14,0,"chat-emoji-picker__no-results"],[12],[1,"\\n                  "],[1,[28,[35,8],["chat.emoji_picker.no_results"],null]],[1,"\\n                "],[13],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[42,[28,[37,17],[[30,0,["groups"]]],null],null,[[[1,"            "],[10,0],[15,0,[28,[37,2],["chat-emoji-picker__section",[52,[28,[37,14],[[30,0,["filteredEmojis"]],null],null],"hidden"]],null]],[15,"data-section",[30,11]],[14,"role","region"],[15,"aria-label",[28,[37,8],[[28,[37,15],["chat.emoji_picker.",[30,11]],null]],[["translatedFallback"],[[30,11]]]]],[12],[1,"\\n              "],[10,"h2"],[14,0,"chat-emoji-picker__section-title"],[12],[1,"\\n                "],[1,[28,[35,8],[[28,[37,15],["chat.emoji_picker.",[30,11]],null]],[["translatedFallback"],[[30,11]]]]],[1,"\\n              "],[13],[1,"\\n              "],[10,0],[14,0,"chat-emoji-picker__section-emojis"],[12],[1,"\\n"],[44,[[28,[37,20],[[30,10],"0"],null]],[[[1,"                  "],[10,"img"],[14,"width","32"],[14,"height","32"],[14,0,"emoji"],[15,"src",[28,[37,22],[[30,12],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"tabindex","0"],[15,"data-emoji",[30,12,["name"]]],[15,"data-tonable",[52,[30,12,["tonable"]],"true"]],[15,"alt",[30,12,["name"]]],[15,"title",[28,[37,23],[[30,12],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"loading","lazy"],[12],[13],[1,"\\n"]],[12]]],[1,"\\n"],[41,[28,[37,25],[[30,0,["chatEmojiPickerManager","visibleSections"]],[30,11]],null],[[[42,[28,[37,13],[[28,[37,13],[[30,10]],null]],null],null,[[[41,[28,[37,26],[[30,14],0],null],[[[1,"                      "],[10,"img"],[14,"width","32"],[14,"height","32"],[14,0,"emoji"],[15,"src",[28,[37,22],[[30,13],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"tabindex","-1"],[15,"data-emoji",[30,13,["name"]]],[15,"data-tonable",[52,[30,13,["tonable"]],"true"]],[15,"alt",[30,13,["name"]]],[15,"title",[28,[37,23],[[30,13],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"loading","lazy"],[12],[13],[1,"\\n"]],[]],null]],[13,14]],null]],[]],null],[1,"              "],[13],[1,"\\n            "],[13],[1,"\\n"]],[10,11]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,0],[14,0,"spinner medium"],[12],[13],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n\\n"],[41,[28,[37,27],[[30,0,["site","mobileView"]],[28,[37,1],[[30,0,["chatEmojiPickerManager","picker","context"]],"chat-channel-message"],null]],null],[[[1,"    "],[10,0],[14,0,"chat-emoji-picker__backdrop"],[12],[13],[1,"\\n"]],[]],null]],[]],null]],["@context","@class","&attrs","@didInsert","@willDestroy","fitzpatrick","emojis","section","emoji","emojis","section","emoji","emoji","index"],false,["if","eq","concat-class","did-insert","noop","will-destroy","on","dc-filter-input","i18n","action","hash","fn","each","-track-array","not-eq","concat","d-icon","-each-in","d-button","replace-emoji","get","chat/emoji-picker-scroll-listener","tonable-emoji-url","tonable-emoji-title","let","includes","gt","and"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-emoji-picker.hbs",isStrictMode:!1}),k=e.FITZPATRICK_MODIFIERS=[{scale:1,modifier:null},{scale:2,modifier:":t2"},{scale:3,modifier:":t3"},{scale:4,modifier:":t4"},{scale:5,modifier:":t5"},{scale:6,modifier:":t6"}]
let C=e.default=(p=class extends i.default{constructor(){super(...arguments),_(this,"chatEmojiPickerManager",m,this),_(this,"emojiPickerScrollObserver",b,this),_(this,"chatEmojiReactionStore",g,this),_(this,"capabilities",f,this),_(this,"site",v,this),_(this,"filteredEmojis",y,this),_(this,"isExpandedFitzpatrickScale",w,this),j(this,"fitzpatrickModifiers",k)}get groups(){const e=this.chatEmojiPickerManager.emojis
return{...{favorites:this.chatEmojiReactionStore.favorites.filter((e=>!this.site.denied_emojis?.includes(e))).map((e=>({name:e,group:"favorites",url:(0,l.emojiUrlFor)(e)})))},...e}}get flatEmojis(){if(!this.chatEmojiPickerManager.emojis)return[]
let{favorites:e,...t}=this.chatEmojiPickerManager.emojis
return Object.values(t).flat()}get navIndicatorStyle(){const e=this.chatEmojiPickerManager.lastVisibleSection,t=Object.keys(this.groups).indexOf(e)
return(0,o.htmlSafe)(`width: ${100/Object.keys(this.groups).length}%; transform: translateX(${100*t}%);`)}get navBtnStyle(){return(0,o.htmlSafe)(`width: ${100/Object.keys(this.groups).length}%;`)}trapKeyDownEvents(e){"Escape"===e.key&&this.chatEmojiPickerManager.close(),"ArrowUp"===e.key&&e.stopPropagation(),"ArrowDown"===e.key&&e.target.classList.contains("dc-filter-input")&&(e.stopPropagation(),e.preventDefault(),document.querySelector('.chat-emoji-picker__scrollable-content .emoji[tabindex="0"]')?.focus())}didNavigateFitzpatrickScale(e){if("keyup"!==e.type)return
const t=[...e.target.closest(".chat-emoji-picker__fitzpatrick-scale")?.querySelectorAll(".chat-emoji-picker__fitzpatrick-modifier-btn")||[]]
"ArrowRight"===e.key&&(e.preventDefault(),e.target===t[t.length-1]?t[0].focus():e.target.nextElementSibling?.focus()),"ArrowLeft"===e.key&&(e.preventDefault(),e.target===t[0]?t[t.length-1].focus():e.target.previousElementSibling?.focus())}didToggleFitzpatrickScale(e){if("keyup"===e.type){if("Escape"===e.key)return e.preventDefault(),void(this.isExpandedFitzpatrickScale=!1)
if("Enter"!==e.key)return}this.isExpandedFitzpatrickScale=!this.isExpandedFitzpatrickScale}didRequestFitzpatrickScale(e,t){if("keyup"===t.type){if("Escape"===t.key)return t.preventDefault(),t.stopPropagation(),this.isExpandedFitzpatrickScale=!1,void this._focusCurrentFitzpatrickScale()
if("Enter"!==t.key)return}t.preventDefault(),t.stopPropagation(),this.isExpandedFitzpatrickScale=!1,this.chatEmojiReactionStore.diversity=e,this._focusCurrentFitzpatrickScale()}_focusCurrentFitzpatrickScale(){(0,a.schedule)("afterRender",(()=>{document.querySelector(".chat-emoji-picker__fitzpatrick-modifier-btn.current")?.focus()}))}didInputFilter(e){e?.length?(0,u.default)(this,this.debouncedDidInputFilter,e,c.INPUT_DELAY):this.filteredEmojis=null}focusFilter(e){(0,a.schedule)("afterRender",(()=>{e?.focus()}))}debouncedDidInputFilter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:""
e=e.toLowerCase(),this.filteredEmojis=this.flatEmojis.filter((t=>t.name.toLowerCase().includes(e)||t.search_aliases?.any((t=>t.toLowerCase().includes(e))))),(0,a.schedule)("afterRender",(()=>{const e=document.querySelector(".chat-emoji-picker__scrollable-content")
e&&(e.scrollTop=0)}))}onSectionsKeyDown(e){"Enter"===e.key?this.didSelectEmoji(e):this.didNavigateSection(e)}didNavigateSection(e){const t=e=>[...e.querySelectorAll(".emoji")],i=e=>{t(e)[0].focus()},n=e.target.closest(".chat-emoji-picker__section"),r=()=>{document.querySelector(".dc-filter-input")?.focus()},a=()=>[...document.querySelectorAll(".chat-emoji-picker__section:not(.hidden) .emoji")]
if("ArrowRight"===e.key){e.preventDefault()
const t=e.target.nextElementSibling
if(t)t.focus()
else{const e=n.nextElementSibling
e&&i(e)}}if("ArrowLeft"===e.key){e.preventDefault()
const i=e.target.previousElementSibling
if(i)i.focus()
else{const e=n.previousElementSibling
e?(e=>{const i=t(e)
i[i.length-1].focus()})(e):r()}}if("ArrowDown"===e.key){e.preventDefault(),e.stopPropagation()
const t=a().filter((t=>t.offsetTop>e.target.offsetTop)).findBy("offsetLeft",e.target.offsetLeft)
if(t)t.focus()
else{const e=n.nextElementSibling
e&&i(e)}}if("ArrowUp"===e.key){e.preventDefault(),e.stopPropagation()
const t=a().reverse().filter((t=>t.offsetTop<e.target.offsetTop)).findBy("offsetLeft",e.target.offsetLeft)
t?t.focus():r()}}didSelectEmoji(e){if(e.target.classList.contains("emoji")&&("click"===e.type||"Enter"===e.key)){e.preventDefault(),e.stopPropagation()
let t=e.target.dataset.emoji
const i=e.target.dataset.tonable,n=this.chatEmojiReactionStore.diversity
i&&n>1&&(t=`${t}:t${n}`),this.args.didSelectEmoji?.(t)}}didRequestSection(e){const t=document.querySelector(".chat-emoji-picker__scrollable-content")
this.filteredEmojis=null,this.emojiPickerScrollObserver.enabled=!1,this.chatEmojiPickerManager.addVisibleSections([e]),this.chatEmojiPickerManager.lastVisibleSection=e,t&&this.capabilities.isIOS&&(document.querySelector(".chat-emoji-picker__scrollable-content").style.overflow="hidden"),(0,a.schedule)("afterRender",(()=>{const i=document.querySelector(`.chat-emoji-picker__section[data-section="${e}"] .emoji:nth-child(1)`);([...document.querySelectorAll(`.chat-emoji-picker__section[data-section="${e}"] .emoji`)].find((e=>e.offsetTop>i.offsetTop))||i).focus(),(0,a.later)((()=>{t&&this.capabilities.isIOS&&(document.querySelector(".chat-emoji-picker__scrollable-content").style.overflow="scroll"),this.emojiPickerScrollObserver.enabled=!0}),200)}))}addClickOutsideEventListener(){document.addEventListener("click",this.didClickOutside)}removeClickOutsideEventListener(){document.removeEventListener("click",this.didClickOutside)}didClickOutside(e){e.target.closest(".chat-emoji-picker")||this.chatEmojiPickerManager.close()}},m=M(p.prototype,"chatEmojiPickerManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=M(p.prototype,"emojiPickerScrollObserver",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=M(p.prototype,"chatEmojiReactionStore",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=M(p.prototype,"capabilities",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=M(p.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=M(p.prototype,"filteredEmojis",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=M(p.prototype,"isExpandedFitzpatrickScale",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M(p.prototype,"trapKeyDownEvents",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"trapKeyDownEvents"),p.prototype),M(p.prototype,"didNavigateFitzpatrickScale",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didNavigateFitzpatrickScale"),p.prototype),M(p.prototype,"didToggleFitzpatrickScale",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didToggleFitzpatrickScale"),p.prototype),M(p.prototype,"didRequestFitzpatrickScale",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didRequestFitzpatrickScale"),p.prototype),M(p.prototype,"didInputFilter",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didInputFilter"),p.prototype),M(p.prototype,"focusFilter",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"focusFilter"),p.prototype),M(p.prototype,"onSectionsKeyDown",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"onSectionsKeyDown"),p.prototype),M(p.prototype,"didNavigateSection",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didNavigateSection"),p.prototype),M(p.prototype,"didSelectEmoji",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didSelectEmoji"),p.prototype),M(p.prototype,"didRequestSection",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didRequestSection"),p.prototype),M(p.prototype,"addClickOutsideEventListener",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"addClickOutsideEventListener"),p.prototype),M(p.prototype,"removeClickOutsideEventListener",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"removeClickOutsideEventListener"),p.prototype),M(p.prototype,"didClickOutside",[d.bind],Object.getOwnPropertyDescriptor(p.prototype,"didClickOutside"),p.prototype),p);(0,t.setComponentTemplate)(z,C)})),define("discourse/plugins/chat/discourse/components/chat-full-page-header",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s,o,l
function c(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,r.createTemplateFactory)({id:"yVLEOr2Q",block:'[[[41,[28,[37,1],[[30,0,["chatStateManager","isFullPageActive"]],[30,0,["displayed"]]],null],[[[1,"  "],[10,0],[15,0,[28,[37,2],["chat-full-page-header",[52,[51,[30,1,["isFollowing"]]],"-not-following"]],null]],[12],[1,"\\n    "],[10,0],[14,0,"chat-channel-header-details"],[12],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"        "],[10,0],[14,0,"chat-full-page-header__left-actions"],[12],[1,"\\n          "],[8,[39,4],[[24,0,"chat-full-page-header__back-btn no-text btn-flat"]],[["@route"],["chat"]],[["default"],[[[[1,"\\n            "],[1,[28,[35,5],["chevron-left"],null]],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[8,[39,4],[[24,0,"chat-channel-title-wrapper"]],[["@route","@models"],["chat.channel.info",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n        "],[8,[39,6],null,[["@channel"],[[30,1]]],null],[1,"\\n      "]],[]]]]],[1,"\\n\\n"],[41,[28,[37,7],[[30,1,["threadingEnabled"]],[30,0,["site","desktopView"]]],null],[[[1,"        "],[10,0],[14,0,"chat-full-page-header__right-actions"],[12],[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"            "],[8,[39,8],[[24,0,"open-drawer-btn btn-flat"]],[["@icon","@title","@action"],["discourse-compress","chat.close_full_page",[30,2]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["showThreadsListButton"]],[[[1,"            "],[8,[39,9],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,10],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],null]],["@channel","@onCloseFullScreen"],false,["if","and","concat-class","unless","link-to","d-icon","chat-channel-title","or","d-button","chat/thread/threads-list-button","chat-channel-status"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-full-page-header.hbs",isStrictMode:!1})
let h=e.default=(a=class extends i.default{constructor(){super(...arguments),c(this,"site",s,this),c(this,"chatStateManager",o,this),c(this,"router",l,this)}get displayed(){return this.args.displayed??!0}get showThreadsListButton(){return this.args.channel.threadingEnabled&&"chat.channel.threads"!==this.router.currentRoute.name&&"chat.channel.thread.index"!==this.router.currentRoute.name&&"chat.channel.thread"!==this.router.currentRoute.name}},s=u(a.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=u(a.prototype,"chatStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=u(a.prototype,"router",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a);(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/chat-mention-warnings",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template","discourse-common/lib/get-url","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,o.createTemplateFactory)({id:"OyAiEEsN",block:'[[[41,[30,0,["show"]],[[[1,"  "],[10,0],[14,0,"chat-mention-warnings"],[12],[1,"\\n    "],[10,0],[14,0,"chat-mention-warning__icon"],[12],[1,"\\n      "],[1,[28,[35,1],["exclamation-triangle"],null]],[1,"\\n    "],[13],[1,"\\n    "],[10,0],[14,0,"chat-mention-warning__text"],[12],[1,"\\n      "],[10,0],[14,0,"chat-mention-warning__header"],[12],[1,"\\n        "],[1,[30,0,["warningHeaderText"]]],[1,"\\n      "],[13],[1,"\\n      "],[10,"ul"],[15,0,[30,0,["listStyleClass"]]],[12],[1,"\\n"],[41,[30,0,["hasTooManyMentions"]],[[[1,"          "],[10,"li"],[12],[1,[30,0,["tooManyMentionsBody"]]],[13],[1,"\\n"]],[]],[[[41,[30,0,["channelWideMentionDisallowed"]],[[[1,"            "],[10,"li"],[12],[1,[28,[35,2],["chat.mention_warning.channel_wide_mentions_disallowed"],null]],[13],[1,"\\n"]],[]],null],[41,[30,0,["hasUnreachableGroupMentions"]],[[[1,"            "],[10,"li"],[12],[1,[30,0,["unreachableBody"]]],[13],[1,"\\n"]],[]],null],[41,[30,0,["hasOverMembersLimitGroupMentions"]],[[[1,"            "],[10,"li"],[12],[1,[30,0,["overMembersLimitBody"]]],[13],[1,"\\n"]],[]],null]],[]]],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","d-icon","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-mention-warnings.hbs",isStrictMode:!1})
let b=e.default=(l=class extends i.default{constructor(){super(...arguments),h(this,"siteSettings",c,this),h(this,"currentUser",u,this),h(this,"chatComposerWarningsTracker",d,this)}get unreachableGroupMentions(){return this.chatComposerWarningsTracker.unreachableGroupMentions}get overMembersLimitGroupMentions(){return this.chatComposerWarningsTracker.overMembersLimitGroupMentions}get hasTooManyMentions(){return this.chatComposerWarningsTracker.tooManyMentions}get channelWideMentionDisallowed(){return this.chatComposerWarningsTracker.channelWideMentionDisallowed}get mentionsCount(){return this.chatComposerWarningsTracker.mentionsCount}get unreachableGroupMentionsCount(){return this.unreachableGroupMentions.length}get overMembersLimitMentionsCount(){return this.overMembersLimitGroupMentions.length}get hasUnreachableGroupMentions(){return this.unreachableGroupMentionsCount>0}get hasOverMembersLimitGroupMentions(){return this.overMembersLimitMentionsCount>0}get warningsCount(){return this.unreachableGroupMentionsCount+this.overMembersLimitMentionsCount}get show(){return this.hasTooManyMentions||this.channelWideMentionDisallowed||this.hasUnreachableGroupMentions||this.hasOverMembersLimitGroupMentions}get listStyleClass(){return this.hasTooManyMentions?"chat-mention-warnings-list__simple":this.warningsCount>1?"chat-mention-warnings-list__multiple":"chat-mention-warnings-list__simple"}get warningHeaderText(){return this.mentionsCount<=this.warningsCount||this.hasTooManyMentions?s.default.t("chat.mention_warning.groups.header.all"):s.default.t("chat.mention_warning.groups.header.some")}get tooManyMentionsBody(){if(this.hasTooManyMentions)return this.currentUser.admin?(0,r.htmlSafe)(s.default.t("chat.mention_warning.too_many_mentions_admin",{count:this.siteSettings.max_mentions_per_chat_message,siteSettingUrl:(0,a.default)("/admin/site_settings/category/plugins?filter=max_mentions_per_chat_message")})):(0,r.htmlSafe)(s.default.t("chat.mention_warning.too_many_mentions",{count:this.siteSettings.max_mentions_per_chat_message}))}get unreachableBody(){if(this.hasUnreachableGroupMentions)switch(this.unreachableGroupMentionsCount){case 1:return s.default.t("chat.mention_warning.groups.unreachable_1",{group:this.unreachableGroupMentions[0]})
case 2:return s.default.t("chat.mention_warning.groups.unreachable_2",{group1:this.unreachableGroupMentions[0],group2:this.unreachableGroupMentions[1]})
default:return s.default.t("chat.mention_warning.groups.unreachable_multiple",{group:this.unreachableGroupMentions[0],count:this.unreachableGroupMentionsCount-1})}}get overMembersLimitBody(){if(this.hasOverMembersLimitGroupMentions)return(0,r.htmlSafe)(s.default.messageFormat("chat.mention_warning.groups.too_many_members_MF",{groupCount:this.overMembersLimitMentionsCount,isAdmin:this.currentUser.admin,siteSettingUrl:(0,a.default)("/admin/site_settings/category/plugins?filter=max_users_notified_per_group_mention"),notificationLimit:this.siteSettings.max_users_notified_per_group_mention,group1:this.overMembersLimitGroupMentions[0],group2:this.overMembersLimitGroupMentions[1]}))}},c=p(l.prototype,"siteSettings",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=p(l.prototype,"chatComposerWarningsTracker",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l);(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/chat-message-actions-desktop",["exports","@glimmer/component","@glimmer/tracking","@ember/application","@ember/helper","@ember/modifier","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/render-modifiers/modifiers/will-destroy","@ember/runloop","@ember/service","@popperjs/core","discourse/components/bookmark-icon","discourse/components/d-button","discourse/helpers/concat-class","select-kit/components/dropdown-select-box","truth-helpers/helpers/and","discourse/plugins/chat/discourse/components/chat-message-reaction","discourse/plugins/chat/discourse/lib/chat-message-container","discourse/plugins/chat/discourse/lib/chat-message-interactor","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j){"use strict"
var M,z,k,C,O,S
function P(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function T(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function E(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const x="full"
e.default=(S=class extends t.default{constructor(){super(...arguments),P(this,"chat",z,this),P(this,"chatEmojiPickerManager",k,this),P(this,"site",C,this),P(this,"size",O,this),T(this,"popper",null)}get message(){return this.chat.activeMessage.model}get context(){return this.chat.activeMessage.context}get messageInteractor(){return new w.default((0,n.getOwner)(this),this.message,this.context)}get shouldRenderFavoriteReactions(){return this.size===x}onWheel(){this.chat.activeMessage=null}setup(e){this.popper?.destroy(),(0,u.schedule)("afterRender",(()=>{const t=(0,y.default)(this.message.id,this.context)
if(!t)return
const i=t.closest(".popper-viewport")
this.size=i.clientWidth<500?"reduced":x,t&&(this.popper=(0,h.createPopper)(t,e,{placement:"top-end",strategy:"fixed",modifiers:[{name:"flip",enabled:!0,options:{boundary:i,fallbackPlacements:["bottom-end"]}},{name:"hide",enabled:!0},{name:"eventListeners",options:{scroll:!1}},{name:"offset",options:{offset:[-2,-10]}}]}))}))}teardown(){this.popper?.destroy(),this.popper=null}},(0,j.setComponentTemplate)((0,_.createTemplateFactory)({id:"VNxuLXrF",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,0,["site","desktopView"]],[30,0,["chat","activeMessage","model","persisted"]]],null],[[[1,"      "],[11,0],[16,0,[28,[32,1],["chat-message-actions-container",[28,[32,2],["is-size-",[30,0,["size"]]],null]],null]],[16,"data-id",[30,0,["message","id"]]],[4,[32,3],[[30,0,["setup"]]],null],[4,[32,4],[[30,0,["setup"]],[30,0,["chat","activeMessage","model","id"]]],null],[4,[32,5],["wheel",[30,0,["onWheel"]]],[["passive"],[true]]],[4,[32,6],[[30,0,["teardown"]]],null],[12],[1,"\\n        "],[10,0],[15,0,[28,[32,1],["chat-message-actions",[52,[51,[30,0,["messageInteractor","secondaryActions","length"]]],"has-no-secondary-actions"]],null]],[12],[1,"\\n"],[41,[30,0,["shouldRenderFavoriteReactions"]],[[[42,[28,[31,3],[[28,[31,3],[[30,0,["messageInteractor","emojiReactions"]]],null]],null],"emoji",[[[1,"              "],[8,[32,7],null,[["@reaction","@onReaction","@message","@showCount"],[[30,1],[30,0,["messageInteractor","react"]],[30,0,["message"]],false]],null],[1,"\\n"]],[1]],null]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canInteractWithMessage"]],[[[1,"            "],[8,[32,8],[[24,0,"btn-flat react-btn"]],[["@action","@icon","@title","@forwardEvent"],[[30,0,["messageInteractor","openEmojiPicker"]],"discourse-emojis","chat.react",true]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canBookmark"]],[[[1,"            "],[8,[32,8],[[24,0,"btn-flat bookmark-btn"]],[["@action"],[[30,0,["messageInteractor","toggleBookmark"]]]],[["default"],[[[[1,"\\n              "],[8,[32,9],null,[["@bookmark"],[[30,0,["message","bookmark"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canReply"]],[[[1,"            "],[8,[32,8],[[24,0,"btn-flat reply-btn"]],[["@action","@icon","@title"],[[30,0,["messageInteractor","reply"]],"reply","chat.reply"]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[28,[32,0],[[30,0,["messageInteractor","message"]],[30,0,["messageInteractor","secondaryActions","length"]]],null],[[[1,"            "],[8,[32,10],null,[["@class","@options","@content","@onChange"],["more-buttons secondary-actions",[28,[32,11],null,[["icon","placement","customStyle","btnCustomClasses"],["ellipsis-v","left","true","btn-flat"]]],[30,0,["messageInteractor","secondaryActions"]],[30,0,["messageInteractor","handleSecondaryActions"]]]],null],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["reaction"],false,["if","unless","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-actions-desktop.js",scope:()=>[f.default,b.default,r.concat,o.default,l.default,a.on,c.default,v.default,m.default,p.default,g.default,r.hash],isStrictMode:!0}),S),z=E((M=S).prototype,"chat",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=E(M.prototype,"chatEmojiPickerManager",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=E(M.prototype,"site",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=E(M.prototype,"size",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return x}}),E(M.prototype,"onWheel",[s.action],Object.getOwnPropertyDescriptor(M.prototype,"onWheel"),M.prototype),E(M.prototype,"setup",[s.action],Object.getOwnPropertyDescriptor(M.prototype,"setup"),M.prototype),E(M.prototype,"teardown",[s.action],Object.getOwnPropertyDescriptor(M.prototype,"teardown"),M.prototype),M)})),define("discourse/plugins/chat/discourse/components/chat-message-actions-mobile",["exports","@glimmer/component","@glimmer/tracking","@ember/application","@ember/helper","@ember/modifier","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/service","discourse/components/bookmark-icon","discourse/components/d-button","discourse/helpers/concat-class","discourse-common/lib/later","truth-helpers/helpers/and","truth-helpers/helpers/or","discourse/plugins/chat/discourse/components/chat-message-reaction","discourse/plugins/chat/discourse/components/chat-user-avatar","discourse/plugins/chat/discourse/lib/chat-message-interactor","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y){"use strict"
var w,_,j,M,z,k,C,O,S,P
function T(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function E(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function x(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function D(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(O=new WeakSet,S=new WeakSet,P=new WeakSet,C=class extends t.default{constructor(){super(...arguments),E(this,P),E(this,S),E(this,O),T(this,"chat",_,this),T(this,"site",j,this),T(this,"capabilities",M,this),T(this,"hasExpandedReply",z,this),T(this,"showFadeIn",k,this)}get message(){return this.chat.activeMessage.model}get context(){return this.chat.activeMessage.context}get messageInteractor(){return new f.default((0,n.getOwner)(this),this.message,this.context)}fadeAndVibrate(){(0,h.default)(x(this,S,I).bind(this)),this.capabilities.userHasBeenActive&&this.capabilities.canVibrate&&navigator.vibrate(5)}expandReply(e){e.stopPropagation(),this.hasExpandedReply=!0}collapseMenu(e){e.preventDefault(),x(this,O,A).call(this)}actAndCloseMenu(e){this.messageInteractor[e](),x(this,O,A).call(this)}openEmojiPicker(e,t){this.messageInteractor.openEmojiPicker(e,t),x(this,O,A).call(this)}},(0,y.setComponentTemplate)((0,v.createTemplateFactory)({id:"nW31Z6tX",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,0,["site","mobileView"]],[30,0,["chat","activeMessage","model","persisted"]]],null],[[[1,"      "],[11,0],[16,0,[28,[32,1],["chat-message-actions-backdrop",[52,[30,0,["showFadeIn"]],"fade-in"]],null]],[4,[32,2],[[30,0,["fadeAndVibrate"]]],null],[12],[1,"\\n        "],[11,0],[24,"role","button"],[24,0,"collapse-area"],[4,[32,3],["touchstart",[30,0,["collapseMenu"]]],[["passive","bubbles"],[false,false]]],[12],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"chat-message-actions"],[12],[1,"\\n          "],[10,0],[14,0,"selected-message-container"],[12],[1,"\\n            "],[10,0],[14,0,"selected-message"],[12],[1,"\\n              "],[8,[32,4],null,[["@user"],[[30,0,["message","user"]]]],null],[1,"\\n              "],[11,1],[24,"role","button"],[16,0,[28,[32,1],["selected-message-reply",[52,[30,0,["hasExpandedReply"]],"is-expanded"]],null]],[4,[32,3],["touchstart",[30,0,["expandReply"]]],[["passive"],[true]]],[12],[1,"\\n                "],[1,[30,0,["message","message"]]],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,"ul"],[14,0,"secondary-actions"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["messageInteractor","secondaryActions"]]],null]],null],null,[[[1,"              "],[10,"li"],[14,0,"chat-message-action-item"],[15,"data-id",[30,1,["id"]]],[12],[1,"\\n                "],[8,[32,5],[[24,0,"chat-message-action"]],[["@translatedLabel","@icon","@action"],[[30,1,["name"]],[30,1,["icon"]],[28,[32,6],[[30,0,["actAndCloseMenu"]],[30,1,["id"]]],null]]],null],[1,"\\n              "],[13],[1,"\\n"]],[1]],null],[1,"          "],[13],[1,"\\n\\n"],[41,[28,[32,7],[[30,0,["messageInteractor","canReact"]],[30,0,["messageInteractor","canReply"]]],null],[[[1,"            "],[10,0],[14,0,"main-actions"],[12],[1,"\\n"],[41,[30,0,["messageInteractor","canReact"]],[[[42,[28,[31,2],[[28,[31,2],[[30,0,["messageInteractor","emojiReactions"]]],null]],null],null,[[[1,"                  "],[8,[32,8],null,[["@reaction","@onReaction","@message","@showCount"],[[30,2],[30,0,["messageInteractor","react"]],[30,0,["message"]],false]],null],[1,"\\n"]],[2]],null],[1,"\\n                "],[8,[32,5],[[24,"data-id","react"],[24,0,"btn-flat react-btn"]],[["@action","@icon","@title","@forwardEvent"],[[30,0,["openEmojiPicker"]],"discourse-emojis","chat.react",true]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canBookmark"]],[[[1,"                "],[8,[32,5],[[24,"data-id","bookmark"],[24,0,"btn-flat bookmark-btn"]],[["@action"],[[28,[32,6],[[30,0,["actAndCloseMenu"]],"toggleBookmark"],null]]],[["default"],[[[[1,"\\n                  "],[8,[32,9],null,[["@bookmark"],[[30,0,["message","bookmark"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canReply"]],[[[1,"                "],[8,[32,5],[[24,"data-id","reply"],[24,0,"chat-message-action reply-btn btn-flat"]],[["@action","@icon","@title"],[[28,[32,6],[[30,0,["actAndCloseMenu"]],"reply"],null],"reply","chat.reply"]],null],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["button","reaction"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-actions-mobile.js",scope:()=>[p.default,d.default,o.default,a.on,g.default,u.default,r.fn,m.default,b.default,c.default],isStrictMode:!0}),C),_=D((w=C).prototype,"chat",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=D(w.prototype,"site",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=D(w.prototype,"capabilities",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=D(w.prototype,"hasExpandedReply",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),k=D(w.prototype,"showFadeIn",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),D(w.prototype,"fadeAndVibrate",[s.action],Object.getOwnPropertyDescriptor(w.prototype,"fadeAndVibrate"),w.prototype),D(w.prototype,"expandReply",[s.action],Object.getOwnPropertyDescriptor(w.prototype,"expandReply"),w.prototype),D(w.prototype,"collapseMenu",[s.action],Object.getOwnPropertyDescriptor(w.prototype,"collapseMenu"),w.prototype),D(w.prototype,"actAndCloseMenu",[s.action],Object.getOwnPropertyDescriptor(w.prototype,"actAndCloseMenu"),w.prototype),D(w.prototype,"openEmojiPicker",[s.action],Object.getOwnPropertyDescriptor(w.prototype,"openEmojiPicker"),w.prototype),w)
function A(){x(this,P,U).call(this),(0,h.default)((()=>{this.isDestroying||this.isDestroyed||(this.chat.activeMessage=null)}),200)}function I(){this.showFadeIn=!0}function U(){this.showFadeIn=!1}})),define("discourse/plugins/chat/discourse/components/chat-message-collapser",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template","discourse/lib/utilities","discourse-common/lib/dom-from-string","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.isCollapsible=function(e,t){const i=Array.prototype.slice.call((0,s.default)(e))
return w(i)||M(i)||z(t)||C(i)||S(i)}
const d=(0,l.createTemplateFactory)({id:"0kb4UYGW",block:'[[[10,0],[14,0,"chat-message-collapser"],[12],[1,"\\n"],[41,[30,0,["hasUploads"]],[[[1,"    "],[1,[28,[35,1],[[30,1]],null]],[1,"\\n\\n    "],[8,[39,2],null,[["@header","@onToggle"],[[30,0,["uploadsHeader"]],[30,2]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-uploads"],[12],[1,"\\n"],[42,[28,[37,4],[[28,[37,4],[[30,3]],null]],null],null,[[[1,"          "],[8,[39,5],null,[["@upload"],[[30,4]]],null],[1,"\\n"]],[4]],null],[1,"      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],[[[42,[28,[37,4],[[28,[37,4],[[30,0,["cookedBodies"]]],null]],null],null,[[[41,[30,5,["needsCollapser"]],[[[1,"        "],[8,[39,2],null,[["@header","@onToggle"],[[30,5,["header"]],[30,2]]],[["default"],[[[[1,"\\n"],[41,[30,5,["videoAttributes"]],[[[1,"            "],[10,0],[14,0,"chat-message-collapser-lazy-video"],[12],[1,"\\n              "],[8,[39,6],null,[["@videoAttributes"],[[30,5,["videoAttributes"]]]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[1,"            "],[1,[30,5,["body"]]],[1,"\\n"]],[]]],[1,"        "]],[]]]]],[1,"\\n"]],[]],[[[1,"        "],[1,[30,5,["body"]]],[1,"\\n"]],[]]]],[5]],null]],[]]],[13]],["@cooked","@onToggleCollapse","@uploads","upload","cooked"],false,["if","html-safe","collapser","each","-track-array","chat-upload","lazy-video"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-collapser.hbs",isStrictMode:!1})
let h=e.default=(c=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="siteSettings",n=this,(i=u)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get hasUploads(){return z(this.args.uploads)}get uploadsHeader(){let e=""
return e=1===this.args.uploads.length?this.args.uploads[0].original_filename:o.default.t("chat.uploaded_files",{count:this.args.uploads.length}),(0,r.htmlSafe)(`<span class="chat-message-collapser-link-small">${(0,a.escapeExpression)(e)}</span>`)}get cookedBodies(){const e=Array.prototype.slice.call((0,s.default)(this.args.cooked))
return w(e)?this.lazyVideoCooked(e):M(e)?this.imageOneboxCooked(e):C(e)?this.imageCooked(e):S(e)?this.galleryCooked(e):[]}lazyVideoCooked(e){return e.reduce(((e,t)=>{if(this.siteSettings.lazy_videos_enabled&&y(t)){const i=(0,requirejs("discourse/plugins/discourse-lazy-videos/lib/lazy-video-attributes").default)(t)
if(this.siteSettings[`lazy_${i.providerName}_enabled`]){const n=(0,a.escapeExpression)(i.url),s=i.title,o=(0,r.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link" rel="noopener noreferrer" href="${n}">${s}</a>`)
e.push({header:o,body:t,videoAttributes:i,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})}else e.push({body:t,needsCollapser:!1})
return e}),[])}imageOneboxCooked(e){return e.reduce(((e,t)=>{if(j(t)){let i=_(t)?t.firstChild.src:t.firstElementChild.href
i=(0,a.escapeExpression)(i)
const n=(0,r.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link-small" rel="noopener noreferrer" href="${i}">${i}</a>`)
e.push({header:n,body:t,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})
return e}),[])}imageCooked(e){return e.reduce(((e,t)=>{if(k(t)){const i=(0,a.escapeExpression)(t.firstElementChild.src),n=(0,a.escapeExpression)(t.firstElementChild.alt),s=(0,r.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link-small" rel="noopener noreferrer" href="${i}">${n||i}</a>`)
e.push({header:s,body:t,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})
return e}),[])}galleryCooked(e){return e.reduce(((e,t)=>{if(O(t)){const i=(0,a.escapeExpression)(t.firstElementChild.href),n=(0,a.escapeExpression)(t.firstElementChild.firstElementChild.textContent)
t.firstElementChild.removeChild(t.firstElementChild.firstElementChild)
const s=(0,r.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link-small" rel="noopener noreferrer" href="${i}">${n}</a>`)
e.push({header:s,body:t,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})
return e}),[])}},p=c.prototype,m="siteSettings",b=[n.inject],g={configurable:!0,enumerable:!0,writable:!0,initializer:null},v={},Object.keys(g).forEach((function(e){v[e]=g[e]})),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=b.slice().reverse().reduce((function(e,t){return t(p,m,e)||e}),v),f&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(f):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(p,m,v),v=null),u=v,c)
var p,m,b,g,f,v
function y(e){return e.classList.contains("lazy-video-container")}function w(e){return e.some((e=>y(e)))}function _(e){return e.firstChild&&"IMG"===e.firstChild.nodeName&&e.firstChild.classList.contains("animated")&&e.firstChild.classList.contains("onebox")}function j(e){return _(e)||function(e){return e.firstElementChild&&"A"===e.firstElementChild.nodeName&&e.firstElementChild.classList.contains("onebox")&&e.firstElementChild.firstElementChild&&"IMG"===e.firstElementChild.firstElementChild.nodeName}(e)}function M(e){return e.some((e=>j(e)))}function z(e){return e?.length>0}function k(e){return"P"===e.nodeName&&e.firstElementChild&&"IMG"===e.firstElementChild.nodeName&&!e.firstElementChild.classList.contains("emoji")}function C(e){return e.some((e=>k(e)))}function O(e){return e.firstElementChild&&"A"===e.firstElementChild.nodeName&&e.firstElementChild.firstElementChild&&e.firstElementChild.firstElementChild.classList.contains("outer-box")}function S(e){return e.some((e=>O(e)))}(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/chat-message-in-reply-to-indicator",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"VnKb8LJy",block:'[[[41,[30,1,["inReplyTo"]],[[[1,"  "],[8,[39,1],[[24,0,"chat-reply is-direct-reply"]],[["@route","@models"],[[30,0,["route"]],[30,0,["model"]]]],[["default"],[[[[1,"\\n    "],[1,[28,[35,2],["share"],[["title"],["chat.in_reply_to"]]]],[1,"\\n\\n"],[41,[30,1,["inReplyTo","chatWebhookEvent","emoji"]],[[[1,"      "],[8,[39,3],null,[["@emoji"],[[30,1,["inReplyTo","chatWebhookEvent","emoji"]]]],null],[1,"\\n"]],[]],[[[1,"      "],[8,[39,4],null,[["@user"],[[30,1,["inReplyTo","user"]]]],null],[1,"\\n"]],[]]],[1,"\\n    "],[10,1],[14,0,"chat-reply__excerpt"],[12],[1,"\\n      "],[1,[28,[35,5],[[28,[37,6],[[30,1,["inReplyTo","excerpt"]]],null]],null]],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]],null]],["@message"],false,["if","link-to","d-icon","chat-emoji-avatar","chat-user-avatar","replace-emoji","html-safe"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-in-reply-to-indicator.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get route(){return this.hasThread?"chat.channel.thread":"chat.channel.near-message"}get model(){return this.hasThread?[...this.args.message.channel.routeModels,this.args.message.thread.id]:[...this.args.message.channel.routeModels,this.args.message.inReplyTo.id]}get hasThread(){return this.args.message?.channel?.threadingEnabled&&this.args.message?.thread?.id}},c=a.prototype,u="router",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-message-reaction",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","@ember/service","@ember/template","ember-modifier","discourse/helpers/concat-class","discourse/lib/text","truth-helpers/helpers/and","discourse/plugins/chat/discourse/lib/get-reaction-text","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g,f,v,y,w
function _(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function M(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(w=class extends t.default{constructor(){super(...arguments),_(this,"capabilities",b,this),_(this,"currentUser",g,this),_(this,"tooltip",f,this),_(this,"site",v,this),_(this,"isActive",y,this),j(this,"registerTooltip",(0,o.modifier)((e=>{if(!this.popoverContent?.length)return
const t=this.tooltip.register(e,{content:(0,s.htmlSafe)(this.popoverContent),identifier:"chat-message-reaction-tooltip",animated:!1,placement:"top",fallbackPlacements:["bottom"],triggers:this.site.mobileView?["hold"]:["hover"]})
return()=>{t?.destroy()}})))}get showCount(){return this.args.showCount??!0}get emojiString(){return`:${this.args.reaction.emoji}:`}get emojiUrl(){return(0,c.emojiUrlFor)(this.args.reaction.emoji)}handleClick(e){e.stopPropagation(),this.args.onReaction?.(this.args.reaction.emoji,this.args.reaction.reacted?"remove":"add"),this.tooltip.close()}get popoverContent(){if(this.args.reaction.count&&this.args.reaction.users?.length)return(0,c.emojiUnescape)((0,d.getReactionText)(this.args.reaction,this.currentUser))}},(0,p.setComponentTemplate)((0,h.createTemplateFactory)({id:"wzg8WR/+",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,1],[30,0,["emojiUrl"]]],null],[[[1,"      "],[11,"button"],[24,"tabindex","0"],[16,0,[28,[32,1],["chat-message-reaction",[52,[30,1,["reacted"]],"reacted"],[52,[30,0,["isActive"]],"-active"]],null]],[16,"data-emoji-name",[30,1,["emoji"]]],[16,"title",[30,0,["emojiString"]]],[24,4,"button"],[4,[32,2],["click",[30,0,["handleClick"]]],[["passive"],[true]]],[4,[30,0,["registerTooltip"]],null,null],[12],[1,"\\n        "],[10,"img"],[14,"loading","lazy"],[14,0,"emoji"],[14,"width","20"],[14,"height","20"],[15,"alt",[30,0,["emojiString"]]],[15,"src",[30,0,["emojiUrl"]]],[12],[13],[1,"\\n\\n"],[41,[28,[32,0],[[30,0,["showCount"]],[30,1,["count"]]],null],[[[1,"          "],[10,1],[14,0,"count"],[12],[1,[30,1,["count"]]],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@reaction"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-reaction.js",scope:()=>[u.default,l.default,n.on],isStrictMode:!0}),w),b=M((m=w).prototype,"capabilities",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=M(m.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=M(m.prototype,"tooltip",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=M(m.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=M(m.prototype,"isActive",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M(m.prototype,"handleClick",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"handleClick"),m.prototype),M(m.prototype,"popoverContent",[i.cached],Object.getOwnPropertyDescriptor(m.prototype,"popoverContent"),m.prototype),m)})),define("discourse/plugins/chat/discourse/components/chat-message-separator-date",["exports","@ember/component","@glimmer/component","@ember/object","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const s=(0,r.createTemplateFactory)({id:"9p1ZIO+U",block:'[[[41,[30,1,["formattedFirstMessageDate"]],[[[1,"  "],[11,0],[16,0,[28,[37,1],["chat-message-separator-date",[52,[30,1,["newest"]],"with-last-visit"]],null]],[24,"role","button"],[4,[38,2],["click",[30,0,["onDateClick"]]],[["passive"],[true]]],[12],[1,"\\n    "],[11,0],[24,0,"chat-message-separator__text-container"],[4,[38,3],null,null],[12],[1,"\\n      "],[10,1],[14,0,"chat-message-separator__text"],[12],[1,"\\n        "],[1,[30,1,["formattedFirstMessageDate"]]],[1,"\\n\\n"],[41,[30,1,["newest"]],[[[1,"          "],[10,1],[14,0,"chat-message-separator__last-visit"],[12],[1,"\\n            "],[10,1],[14,0,"chat-message-separator__last-visit-separator"],[12],[1,"-"],[13],[1,"\\n            "],[1,[28,[35,4],["chat.last_visit"],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"chat-message-separator__line-container"],[12],[1,"\\n    "],[10,0],[14,0,"chat-message-separator__line"],[12],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@message"],false,["if","concat-class","on","chat/track-message-separator-date","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-separator-date.hbs",isStrictMode:!1})
let o=e.default=(a=class extends i.default{onDateClick(){return this.args.fetchMessagesByDate?.(this.args.message.firstMessageOfTheDayAt)}},l=a.prototype,c="onDateClick",u=[n.action],d=Object.getOwnPropertyDescriptor(a.prototype,"onDateClick"),h=a.prototype,p={},Object.keys(d).forEach((function(e){p[e]=d[e]})),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=u.slice().reverse().reduce((function(e,t){return t(l,c,e)||e}),p),h&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(h):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(l,c,p),p=null),a)
var l,c,u,d,h,p;(0,t.setComponentTemplate)(s,o)})),define("discourse/plugins/chat/discourse/components/chat-message-separator-new",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"0fHoqVRL",block:'[[[41,[28,[37,1],[[30,1,["newest"]],[28,[37,2],[[30,1,["formattedFirstMessageDate"]]],null]],null],[[[1,"  "],[10,0],[14,0,"chat-message-separator-new"],[12],[1,"\\n    "],[10,0],[14,0,"chat-message-separator__text-container"],[12],[1,"\\n      "],[10,1],[14,0,"chat-message-separator__text"],[12],[1,"\\n        "],[1,[28,[35,3],["chat.last_visit"],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-message-separator__line-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-separator__line"],[12],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@message"],false,["if","and","not","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-separator-new.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/chat-message-text",["exports","@ember/component","@glimmer/component","discourse/plugins/chat/discourse/components/chat-message-collapser","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,r.createTemplateFactory)({id:"CosMY0zi",block:'[[[10,0],[14,0,"chat-message-text"],[12],[1,"\\n"],[41,[30,0,["isCollapsible"]],[[[1,"    "],[8,[39,1],null,[["@cooked","@uploads","@onToggleCollapse"],[[30,1],[30,2],[30,3]]],null],[1,"\\n"]],[]],[[[1,"    "],[1,[28,[35,2],[[30,1]],null]],[1,"\\n"]],[]]],[1,"\\n"],[41,[30,0,["isEdited"]],[[[1,"    "],[10,1],[14,0,"chat-message-edited"],[12],[1,"("],[1,[28,[35,3],["chat.edited"],null]],[1,")"],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[18,4,null],[1,"\\n"],[13]],["@cooked","@uploads","@onToggleCollapse","&default"],false,["if","chat-message-collapser","html-safe","i18n","yield"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-text.hbs",isStrictMode:!1})
class s extends i.default{get isEdited(){return this.args.edited??!1}get isCollapsible(){return(0,n.isCollapsible)(this.args.cooked,this.args.uploads)}}e.default=s,(0,t.setComponentTemplate)(a,s)})),define("discourse/plugins/chat/discourse/components/chat-message-thread-indicator",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const f=(0,o.createTemplateFactory)({id:"UrMTjVxW",block:'[[[11,0],[16,0,[28,[37,0],["chat-message-thread-indicator",[52,[30,0,["isActive"]],"-active"]],null]],[24,"role","button"],[16,"title",[28,[37,2],["chat.threads.open"],null]],[4,[38,3],[[30,0,["setup"]]],null],[4,[38,4],[[30,0,["teardown"]]],null],[12],[1,"\\n\\n  "],[10,0],[14,0,"chat-message-thread-indicator__last-reply-avatar"],[12],[1,"\\n    "],[8,[39,5],null,[["@user","@avatarSize"],[[30,1,["thread","preview","lastReplyUser"]],"small"]],null],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"chat-message-thread-indicator__last-reply-info"],[12],[1,"\\n    "],[10,1],[14,0,"chat-message-thread-indicator__last-reply-username"],[12],[1,"\\n      "],[1,[30,1,["thread","preview","lastReplyUser","username"]]],[1,"\\n    "],[13],[1,"\\n    "],[10,1],[14,0,"chat-message-thread-indicator__last-reply-timestamp"],[12],[1,"\\n      "],[1,[28,[35,6],[[30,1,["thread","preview","lastReplyCreatedAt"]]],[["leaveAgo"],["true"]]]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"chat-message-thread-indicator__replies-count"],[12],[1,"\\n    "],[1,[28,[35,2],["chat.thread.replies"],[["count"],[[30,1,["thread","preview","replyCount"]]]]]],[1,"\\n  "],[13],[1,"\\n  "],[8,[39,7],null,[["@thread"],[[30,1,["thread"]]]],null],[1,"\\n  "],[10,0],[14,0,"chat-message-thread-indicator__last-reply-excerpt"],[12],[1,"\\n    "],[1,[28,[35,8],[[28,[37,9],[[30,1,["thread","preview","lastReplyExcerpt"]]],null]],null]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@message"],false,["concat-class","if","i18n","did-insert","will-destroy","chat-user-avatar","format-date","chat-thread-participants","replace-emoji","html-safe"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-thread-indicator.hbs",isStrictMode:!1})
let v=e.default=(l=class extends i.default{constructor(){super(...arguments),b(this,"capabilities",c,this),b(this,"chat",u,this),b(this,"chatStateManager",d,this),b(this,"router",h,this),b(this,"site",p,this),b(this,"isActive",m,this)}setup(e){this.element=e,this.capabilities.touch&&(this.element.addEventListener("touchstart",this.onTouchStart,{passive:!0}),this.element.addEventListener("touchmove",this.cancelTouch,{passive:!0}),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchCancel",this.cancelTouch)),this.element.addEventListener("click",this.openThread,{passive:!0})}teardown(){this.capabilities.touch&&(this.element.removeEventListener("touchstart",this.onTouchStart,{passive:!0}),this.element.removeEventListener("touchmove",this.cancelTouch,{passive:!0}),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchCancel",this.cancelTouch)),this.element.removeEventListener("click",this.openThread,{passive:!0})}onTouchStart(e){this.isActive=!0,e.stopPropagation(),this.touching=!0}onTouchEnd(){this.isActive=!1,this.touching&&this.openThread()}cancelTouch(){this.isActive=!1,this.touching=!1}openThread(){this.chat.activeMessage=null,this.router.transitionTo("chat.channel.thread",...this.args.message.thread.routeModels)}},c=g(l.prototype,"capabilities",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=g(l.prototype,"chat",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=g(l.prototype,"chatStateManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(l.prototype,"router",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=g(l.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=g(l.prototype,"isActive",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g(l.prototype,"setup",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"setup"),l.prototype),g(l.prototype,"teardown",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"teardown"),l.prototype),g(l.prototype,"onTouchStart",[s.bind],Object.getOwnPropertyDescriptor(l.prototype,"onTouchStart"),l.prototype),g(l.prototype,"onTouchEnd",[s.bind],Object.getOwnPropertyDescriptor(l.prototype,"onTouchEnd"),l.prototype),g(l.prototype,"cancelTouch",[s.bind],Object.getOwnPropertyDescriptor(l.prototype,"cancelTouch"),l.prototype),g(l.prototype,"openThread",[s.bind],Object.getOwnPropertyDescriptor(l.prototype,"openThread"),l.prototype),l);(0,t.setComponentTemplate)(f,v)})),define("discourse/plugins/chat/discourse/components/chat-message",["exports","@glimmer/component","@glimmer/tracking","@ember/application","@ember/component","@ember/modifier","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/render-modifiers/modifiers/will-destroy","@ember/runloop","@ember/service","ember-modifier","discourse/components/d-button","discourse/helpers/concat-class","discourse/lib/optional-service","discourse/lib/update-user-status-on-mention","discourse-common/lib/debounce","discourse-common/lib/later","discourse-common/utils/decorators","discourse-i18n","truth-helpers/helpers/eq","truth-helpers/helpers/not","discourse/plugins/chat/discourse/components/chat/message/avatar","discourse/plugins/chat/discourse/components/chat/message/error","discourse/plugins/chat/discourse/components/chat/message/info","discourse/plugins/chat/discourse/components/chat/message/left-gutter","discourse/plugins/chat/discourse/components/chat-message-in-reply-to-indicator","discourse/plugins/chat/discourse/components/chat-message-reaction","discourse/plugins/chat/discourse/components/chat-message-separator-date","discourse/plugins/chat/discourse/components/chat-message-separator-new","discourse/plugins/chat/discourse/components/chat-message-text","discourse/plugins/chat/discourse/components/chat-message-thread-indicator","discourse/plugins/chat/discourse/lib/chat-message-interactor","discourse/plugins/chat/discourse/lib/zoom-check","discourse/plugins/chat/discourse/modifiers/chat/on-long-press","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j,M,z,k,C,O,S,P,T,E,x,D,A,I,U){"use strict"
var L,N,R,F,W,B,H,$,V,q,K,G,J,Y,Z,X,Q,ee,te
function ie(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ne(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function re(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ae(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.MESSAGE_CONTEXT_THREAD=e.MENTION_KEYWORDS=void 0,e.addChatMessageDecorator=function(e){se.push(e)},e.default=void 0,e.resetChatMessageDecorators=function(){se=[]}
let se=[]
e.MENTION_KEYWORDS=["here","all"]
const oe=e.MESSAGE_CONTEXT_THREAD="thread"
e.default=(te=new WeakSet,ee=class extends t.default{constructor(){super(...arguments),ne(this,te),ie(this,"site",N,this),ie(this,"dialog",R,this),ie(this,"currentUser",F,this),ie(this,"appEvents",W,this),ie(this,"capabilities",B,this),ie(this,"chat",H,this),ie(this,"chatApi",$,this),ie(this,"chatEmojiReactionStore",V,this),ie(this,"chatEmojiPickerManager",q,this),ie(this,"chatChannelPane",K,this),ie(this,"chatThreadPane",G,this),ie(this,"chatChannelsManager",J,this),ie(this,"router",Y,this),ie(this,"toasts",Z,this),ie(this,"isActive",X,this),ie(this,"adminTools",Q,this),re(this,"toggleCheckIfPossible",(0,h.modifier)((e=>{let t=!1
const i=()=>{this.pane.selectingMessages&&(event.shiftKey?this.messageInteractor.bulkSelect(!this.args.message.selected):this.messageInteractor.select(!this.args.message.selected))}
return this.pane.selectingMessages&&(e.addEventListener("click",i,{passive:!0}),t=!0),()=>{t&&e.removeEventListener("click",i)}}))),this.initMentionedUsers()}get pane(){return this.args.context===oe?this.chatThreadPane:this.chatChannelPane}get messageInteractor(){return new D.default((0,n.getOwner)(this),this.args.message,this.args.context)}get deletedAndCollapsed(){return this.args.message?.deletedAt&&this.collapsed}get hiddenAndCollapsed(){return this.args.message?.hidden&&this.collapsed}get collapsed(){return!this.args.message?.expanded}get deletedMessageLabel(){let e=1
const t=i=>{const n=i.previousMessage
n?.deletedAt&&(e++,t(n))}
return t(this.args.message),w.default.t("chat.deleted",{count:e})}get shouldRender(){return this.args.message.expanded||!this.args.message.deletedAt||this.args.message.deletedAt&&!this.args.message.nextMessage?.deletedAt}get shouldRenderOpenEmojiPickerButton(){return this.chat.userCanInteractWithChat&&this.site.desktopView}get secondaryActionsIsExpanded(){return document.querySelector(".more-buttons.secondary-actions.is-expanded")}expand(){const e=t=>{const i=t.previousMessage
i?.deletedAt&&(i.expanded=!0,e(i))}
this.args.message.expanded=!0,this.refreshStatusOnMentions(),e(this.args.message)}toggleChecked(e){e.stopPropagation(),e.shiftKey?this.messageInteractor.bulkSelect(e.target.checked):this.messageInteractor.select(e.target.checked)}willDestroyMessage(){(0,u.cancel)(this._invitationSentTimer),(0,u.cancel)(this._disableMessageActionsHandler),(0,u.cancel)(this._makeMessageActiveHandler),(0,u.cancel)(this._debounceDecorateCookedMessageHandler),function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,te,le).call(this),this.chat.activeMessage=null}refreshStatusOnMentions(){(0,u.schedule)("afterRender",(()=>{this.args.message.mentionedUsers.forEach((e=>{const t=`/u/${e.username.toLowerCase()}`
this.messageContainer.querySelectorAll(`a.mention[href="${t}"]`).forEach((t=>{(0,g.updateUserStatusOnMention)((0,n.getOwner)(this),t,e.status)}))}))}))}didInsertMessage(e){this.messageContainer=e,this.debounceDecorateCookedMessage(),this.refreshStatusOnMentions()}didUpdateMessageId(){this.debounceDecorateCookedMessage()}didUpdateMessageVersion(){this.debounceDecorateCookedMessage(),this.refreshStatusOnMentions(),this.initMentionedUsers()}debounceDecorateCookedMessage(){this._debounceDecorateCookedMessageHandler=(0,f.default)(this,this.decorateCookedMessage,this.args.message,100)}decorateCookedMessage(e){(0,u.schedule)("afterRender",(()=>{se.forEach((t=>{t.call(this,this.messageContainer,e.channel)}))}))}initMentionedUsers(){this.args.message.mentionedUsers.forEach((e=>{e.isTrackingStatus()||(e.trackStatus(),e.on("status-changed",this,"refreshStatusOnMentions"))}))}get show(){return!this.args.message?.deletedAt||this.currentUser.id===this.args.message?.user?.id||this.currentUser.staff||this.args.message?.channel?.canModerate}onMouseEnter(){this.site.mobileView||this.chat.activeMessage?.model?.id!==this.args.message.id&&(this.secondaryActionsIsExpanded||(this._onMouseEnterMessageDebouncedHandler=(0,f.default)(this,this._debouncedOnHoverMessage,250)))}onMouseMove(){this.site.mobileView||this.chat.activeMessage?.model?.id!==this.args.message.id&&(this.secondaryActionsIsExpanded||this._setActiveMessage())}onMouseLeave(e){(0,u.cancel)(this._onMouseEnterMessageDebouncedHandler),this.site.mobileView||(e.toElement||e.relatedTarget)?.closest(".chat-message-actions-container")||this.secondaryActionsIsExpanded||(this.chat.activeMessage=null)}_debouncedOnHoverMessage(){this._setActiveMessage()}_setActiveMessage(){this.args.disableMouseEvents||((0,u.cancel)(this._onMouseEnterMessageDebouncedHandler),this.chat.userCanInteractWithChat&&this.args.message.expanded&&(this.chat.activeMessage={model:this.args.message,context:this.args.context}))}onLongPressStart(e,t){this.args.message.expanded&&this.args.message.persisted&&"IMG"!==t.target.tagName&&(this._makeMessageActiveHandler=(0,v.default)((()=>{this.isActive=!0}),125))}onLongPressCancel(){(0,u.cancel)(this._makeMessageActiveHandler),this.isActive=!1,this._disableMessageActionsHandler=(0,v.default)((()=>{document.documentElement.classList.remove("disable-message-actions-touch")}),200)}onLongPressEnd(e,t){"IMG"!==t.target.tagName&&((0,u.cancel)(this._makeMessageActiveHandler),this.isActive=!1,(0,A.default)()||(document.documentElement.classList.add("disable-message-actions-touch"),document.activeElement.blur(),document.querySelector(".chat-composer__input")?.blur(),this._setActiveMessage()))}get hasActiveState(){return this.isActive||this.chat.activeMessage?.model?.id===this.args.message.id}get hasReply(){return this.args.message.inReplyTo&&!this.hideReplyToInfo}get hideUserInfo(){const e=this.args.message,t=e.previousMessage
return!!t&&(!e.firstOfResults&&(!e.chatWebhookEvent&&(!t.deletedAt&&(!(Math.abs(new Date(e.createdAt)-new Date(t.createdAt))>3e5)&&(e.inReplyTo?e.inReplyTo?.id===t.id&&e.user?.id===t.user?.id:e.user?.id===t.user?.id)))))}get hideReplyToInfo(){return this.args.context===oe||this.args.message?.inReplyTo?.id===this.args.message?.previousMessage?.id||this.threadingEnabled}get threadingEnabled(){return this.args.message?.channel?.threadingEnabled&&!!this.args.message?.thread}get showThreadIndicator(){return this.args.context!==oe&&this.threadingEnabled&&this.args.message?.thread&&this.args.message?.thread.preview.replyCount>0}},(0,r.setComponentTemplate)((0,U.createTemplateFactory)({id:"P4lHG05h",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[41,[28,[32,0],[[30,1],"channel"],null],[[[1,"        "],[8,[32,1],null,[["@fetchMessagesByDate","@message"],[[30,2],[30,3]]],null],[1,"\\n        "],[8,[32,2],null,[["@message"],[[30,3]]],null],[1,"\\n"]],[]],null],[1,"\\n      "],[11,0],[16,0,[28,[32,3],["chat-message-container",[52,[30,0,["pane","selectingMessages"]],"-selectable"],[52,[30,3,["highlighted"]],"-highlighted"],[52,[28,[32,0],[[30,3,["user","id"]],[30,0,["currentUser","id"]]],null],"is-by-current-user"],[52,[30,3,["staged"]],"-staged","-persisted"],[52,[30,3,["processed"]],"-processed","-not-processed"],[52,[30,0,["hasActiveState"]],"-active"],[52,[30,3,["bookmark"]],"-bookmarked"],[52,[30,3,["deletedAt"]],"-deleted"],[52,[30,3,["selected"]],"-selected"],[52,[30,3,["error"]],"-errored"],[52,[30,0,["showThreadIndicator"]],"has-thread-indicator"],[52,[30,0,["hideUserInfo"]],"-user-info-hidden"],[52,[30,0,["hasReply"]],"has-reply"]],null]],[16,"data-id",[30,3,["id"]]],[16,"data-thread-id",[30,3,["thread","id"]]],[17,4],[4,[32,4],[[30,0,["didInsertMessage"]]],null],[4,[32,5],[[30,0,["didUpdateMessageId"]],[30,3,["id"]]],null],[4,[32,5],[[30,0,["didUpdateMessageVersion"]],[30,3,["version"]]],null],[4,[32,6],[[30,0,["willDestroyMessage"]]],null],[4,[32,7],["mouseenter",[30,0,["onMouseEnter"]]],[["passive"],[true]]],[4,[32,7],["mouseleave",[30,0,["onMouseLeave"]]],[["passive"],[true]]],[4,[32,7],["mousemove",[30,0,["onMouseMove"]]],[["passive"],[true]]],[4,[30,0,["toggleCheckIfPossible"]],null,null],[4,[32,8],[[30,0,["onLongPressStart"]],[30,0,["onLongPressEnd"]],[30,0,["onLongPressCancel"]]],null],[12],[1,"\\n"],[41,[30,0,["show"]],[[[41,[30,0,["pane","selectingMessages"]],[[[1,"            "],[8,[32,9],[[24,0,"chat-message-selector"],[4,[32,7],["click",[30,0,["toggleChecked"]]],null]],[["@type","@checked"],["checkbox",[30,3,["selected"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["deletedAndCollapsed"]],[[[1,"            "],[10,0],[14,0,"chat-message-text -deleted"],[12],[1,"\\n              "],[8,[32,10],[[24,0,"btn-flat chat-message-expand"]],[["@action","@translatedLabel"],[[30,0,["expand"]],[30,0,["deletedMessageLabel"]]]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[41,[30,0,["hiddenAndCollapsed"]],[[[1,"            "],[10,0],[14,0,"chat-message-text -hidden"],[12],[1,"\\n              "],[8,[32,10],[[24,0,"btn-flat chat-message-expand"]],[["@action","@label"],[[30,0,["expand"]],"chat.hidden"]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[1,"            "],[10,0],[14,0,"chat-message"],[12],[1,"\\n"],[41,[51,[30,0,["hideReplyToInfo"]]],[[[1,"                "],[8,[32,11],null,[["@message"],[[30,3]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["hideUserInfo"]],[[[1,"                "],[8,[32,12],null,[["@message"],[[30,3]]],null],[1,"\\n"]],[]],[[[1,"                "],[8,[32,13],null,[["@message"],[[30,3]]],null],[1,"\\n"]],[]]],[1,"\\n              "],[10,0],[14,0,"chat-message-content"],[12],[1,"\\n                "],[8,[32,14],null,[["@message","@show"],[[30,3],[28,[32,15],[[30,0,["hideUserInfo"]]],null]]],null],[1,"\\n\\n                "],[8,[32,16],null,[["@cooked","@uploads","@edited"],[[30,3,["cooked"]],[30,3,["uploads"]],[30,3,["edited"]]]],[["default"],[[[[1,"\\n"],[41,[30,3,["reactions","length"]],[[[1,"                    "],[10,0],[14,0,"chat-message-reaction-list"],[12],[1,"\\n"],[42,[28,[31,3],[[28,[31,3],[[30,3,["reactions"]]],null]],null],null,[[[1,"                        "],[8,[32,17],null,[["@reaction","@onReaction","@message","@showTooltip"],[[30,5],[30,0,["messageInteractor","react"]],[30,3],true]],null],[1,"\\n"]],[5]],null],[1,"\\n"],[41,[30,0,["shouldRenderOpenEmojiPickerButton"]],[[[1,"                        "],[8,[32,10],[[24,0,"chat-message-react-btn"]],[["@action","@icon","@title","@forwardEvent"],[[30,0,["messageInteractor","openEmojiPicker"]],"discourse-emojis","chat.react",true]],null],[1,"\\n"]],[]],null],[1,"                    "],[13],[1,"\\n"]],[]],null],[1,"                "]],[]]]]],[1,"\\n\\n                "],[8,[32,18],null,[["@message","@onRetry"],[[30,3],[30,6]]],null],[1,"\\n              "],[13],[1,"\\n\\n"],[41,[30,0,["showThreadIndicator"]],[[[1,"                "],[8,[32,19],null,[["@message"],[[30,3]]],null],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n          "]],[]]]],[]]]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@context","@fetchMessagesByDate","@message","&attrs","reaction","@resendStagedMessage"],false,["if","unless","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message.js",scope:()=>[_.default,P.default,T.default,m.default,o.default,l.default,c.default,a.on,I.default,r.Input,p.default,O.default,C.default,M.default,k.default,j.default,E.default,S.default,z.default,x.default],isStrictMode:!0}),ee),N=ae((L=ee).prototype,"site",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=ae(L.prototype,"dialog",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=ae(L.prototype,"currentUser",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=ae(L.prototype,"appEvents",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=ae(L.prototype,"capabilities",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=ae(L.prototype,"chat",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=ae(L.prototype,"chatApi",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=ae(L.prototype,"chatEmojiReactionStore",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=ae(L.prototype,"chatEmojiPickerManager",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=ae(L.prototype,"chatChannelPane",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=ae(L.prototype,"chatThreadPane",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=ae(L.prototype,"chatChannelsManager",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=ae(L.prototype,"router",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=ae(L.prototype,"toasts",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=ae(L.prototype,"isActive",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Q=ae(L.prototype,"adminTools",[b.default],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae(L.prototype,"expand",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"expand"),L.prototype),ae(L.prototype,"toggleChecked",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"toggleChecked"),L.prototype),ae(L.prototype,"willDestroyMessage",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"willDestroyMessage"),L.prototype),ae(L.prototype,"refreshStatusOnMentions",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"refreshStatusOnMentions"),L.prototype),ae(L.prototype,"didInsertMessage",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"didInsertMessage"),L.prototype),ae(L.prototype,"didUpdateMessageId",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"didUpdateMessageId"),L.prototype),ae(L.prototype,"didUpdateMessageVersion",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"didUpdateMessageVersion"),L.prototype),ae(L.prototype,"decorateCookedMessage",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"decorateCookedMessage"),L.prototype),ae(L.prototype,"initMentionedUsers",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"initMentionedUsers"),L.prototype),ae(L.prototype,"onMouseEnter",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"onMouseEnter"),L.prototype),ae(L.prototype,"onMouseMove",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"onMouseMove"),L.prototype),ae(L.prototype,"onMouseLeave",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"onMouseLeave"),L.prototype),ae(L.prototype,"_debouncedOnHoverMessage",[y.bind],Object.getOwnPropertyDescriptor(L.prototype,"_debouncedOnHoverMessage"),L.prototype),ae(L.prototype,"onLongPressStart",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"onLongPressStart"),L.prototype),ae(L.prototype,"onLongPressCancel",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"onLongPressCancel"),L.prototype),ae(L.prototype,"onLongPressEnd",[s.action],Object.getOwnPropertyDescriptor(L.prototype,"onLongPressEnd"),L.prototype),L)
function le(){this.args.message.mentionedUsers.forEach((e=>{e.stopTrackingStatus(),e.off("status-changed",this,"refreshStatusOnMentions")}))}})),define("discourse/plugins/chat/discourse/components/chat-notice",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/notices/mention_without_membership","@ember/template-factory"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,s.createTemplateFactory)({id:"b08rTxsM",block:'[[[10,0],[14,0,"chat-notices__notice"],[12],[1,"\\n\\n"],[41,[30,1,["textContent"]],[[[1,"    "],[10,2],[14,0,"chat-notices__notice__content"],[12],[1,"\\n      "],[1,[30,1,["textContent"]]],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[1,"    "],[8,[30,0,["component"]],null,[["@channel","@notice","@clearNotice"],[[30,2],[30,1],[30,0,["clearNotice"]]]],null],[1,"\\n"]],[]]],[1,"\\n  "],[8,[39,1],[[24,0,"btn-flat chat-notices__notice__clear"]],[["@icon","@action"],["times",[30,0,["clearNotice"]]]],null],[1,"\\n"],[13]],["@notice","@channel"],false,["if","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-notice.hbs",isStrictMode:!1}),h={mention_without_membership:a.default}
let p=e.default=(o=(0,r.inject)("chat-channel-pane-subscriptions-manager"),l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="subscriptionsManager",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}clearNotice(){this.subscriptionsManager.clearNotice(this.args.notice)}get component(){return h[this.args.notice.type]}},c=u(l.prototype,"subscriptionsManager",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(l.prototype,"clearNotice",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"clearNotice"),l.prototype),l);(0,t.setComponentTemplate)(d,p)})),define("discourse/plugins/chat/discourse/components/chat-notices",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s,o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,r.createTemplateFactory)({id:"UNJhKnD9",block:'[[[10,0],[14,0,"chat-notices"],[12],[1,"\\n  "],[8,[39,0],null,[["@channel"],[[30,1]]],null],[1,"\\n\\n"],[42,[28,[37,2],[[28,[37,2],[[30,0,["noticesForChannel"]]],null]],null],null,[[[1,"    "],[8,[39,3],null,[["@notice","@channel"],[[30,2],[30,1]]],null],[1,"\\n"]],[2]],null],[13]],["@channel","notice"],false,["chat-retention-reminder","each","-track-array","chat-notice"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-notices.hbs",isStrictMode:!1})
let c=e.default=(a=(0,n.inject)("chat-channel-pane-subscriptions-manager"),s=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="subscriptionsManager",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get noticesForChannel(){return this.subscriptionsManager.notices.filter((e=>e.channelId===this.args.channel.id))}},u=s.prototype,d="subscriptionsManager",h=[a],p={configurable:!0,enumerable:!0,writable:!0,initializer:null},b={},Object.keys(p).forEach((function(e){b[e]=p[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=h.slice().reverse().reduce((function(e,t){return t(u,d,e)||e}),b),m&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(m):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(u,d,b),b=null),o=b,s)
var u,d,h,p,m,b;(0,t.setComponentTemplate)(l,c)})),define("discourse/plugins/chat/discourse/components/chat-replying-indicator",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember/utils","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,l.createTemplateFactory)({id:"7VNw+o1q",block:'[[[41,[30,1],[[[1,"  "],[11,0],[16,0,[28,[37,1],["chat-replying-indicator",[52,[30,0,["presenceChannel","subscribed"]],"is-subscribed"]],null]],[4,[38,2],[[30,0,["subscribe"]]],null],[4,[38,3],[[30,0,["updateSubscription"]],[30,1]],null],[4,[38,4],[[30,0,["unsubscribe"]]],null],[12],[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[10,1],[14,0,"chat-replying-indicator__text"],[12],[1,[30,0,["text"]]],[13],[1,"\\n      "],[10,1],[14,0,"chat-replying-indicator__wave"],[12],[1,"\\n        "],[10,1],[14,0,"chat-replying-indicator__dot"],[12],[1,"."],[13],[1,"\\n        "],[10,1],[14,0,"chat-replying-indicator__dot"],[12],[1,"."],[13],[1,"\\n        "],[10,1],[14,0,"chat-replying-indicator__dot"],[12],[1,"."],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@presenceChannelName"],false,["if","concat-class","did-insert","did-update","will-destroy"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-replying-indicator.hbs",isStrictMode:!1})
let g=e.default=(c=class extends i.default{constructor(){super(...arguments),p(this,"currentUser",u,this),p(this,"presence",d,this),p(this,"presenceChannel",h,this)}async updateSubscription(){await this.unsubscribe(),await this.subscribe()}async subscribe(){this.presenceChannel=this.presence.getChannel(this.args.presenceChannelName),await this.presenceChannel.subscribe()}async unsubscribe(){this.presenceChannel?.subscribed&&await this.presenceChannel.unsubscribe()}get users(){return this.presenceChannel?.get("users")?.filter((e=>e.id!==this.currentUser.id))||[]}get usernames(){return this.users.mapBy("username")}get text(){if(1===this.usernames.length)return o.default.t("chat.replying_indicator.single_user",{username:this.usernames[0]})
if(this.usernames.length<4){const e=this.usernames[this.usernames.length-1],t=this.usernames.slice(0,this.usernames.length-1).join(o.default.t("word_connector.comma"))
return o.default.t("chat.replying_indicator.multiple_users",{commaSeparatedUsernames:t,lastUsername:e})}const e=this.usernames.slice(0,2).join(o.default.t("word_connector.comma"))
return o.default.t("chat.replying_indicator.many_users",{commaSeparatedUsernames:e,count:this.usernames.length-2})}get shouldRender(){return(0,s.isPresent)(this.usernames)}},u=m(c.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(c.prototype,"presence",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(c.prototype,"presenceChannel",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m(c.prototype,"updateSubscription",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"updateSubscription"),c.prototype),m(c.prototype,"subscribe",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"subscribe"),c.prototype),m(c.prototype,"unsubscribe",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"unsubscribe"),c.prototype),c);(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/chat-retention-reminder-text",["exports","@glimmer/component","@ember/service","discourse-i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function d(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(c=new WeakMap,l=class extends t.default{constructor(){var e,t,i,n
super(...arguments),u(this,c,{get:v,set:void 0}),e=this,t="siteSettings",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get type(){return this.args.type??"long"}get text(){return this.args.channel.isDirectMessageChannel?d(this,c)>0?n.default.t(`chat.retention_reminders.${this.type}`,{count:this.siteSettings.chat_dm_retention_days}):n.default.t(`chat.retention_reminders.indefinitely_${this.type}`):d(this,c)>0?n.default.t(`chat.retention_reminders.${this.type}`,{count:this.siteSettings.chat_channel_retention_days}):n.default.t(`chat.retention_reminders.indefinitely_${this.type}`)}},(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"jf5EPrBy",block:'[[[1,"\\n    "],[10,1],[14,0,"chat-retention-reminder-text"],[12],[1,"\\n      "],[1,[30,0,["text"]]],[1,"\\n    "],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-retention-reminder-text.js",isStrictMode:!0}),l),h=(s=l).prototype,p="siteSettings",m=[i.inject],b={configurable:!0,enumerable:!0,writable:!0,initializer:null},f={},Object.keys(b).forEach((function(e){f[e]=b[e]})),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=m.slice().reverse().reduce((function(e,t){return t(h,p,e)||e}),f),g&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(g):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(h,p,f),f=null),o=f,s)
var h,p,m,b,g,f
function v(){return this.args.channel.isDirectMessageChannel?this.siteSettings.chat_dm_retention_days:this.siteSettings.chat_channel_retention_days}})),define("discourse/plugins/chat/discourse/components/chat-retention-reminder",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/lib/ajax","discourse/lib/ajax-error","discourse/plugins/chat/discourse/components/chat-retention-reminder-text","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h
function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(h=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=d)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get show(){return this.args.channel?.isDirectMessageChannel&&this.currentUser?.get("needs_dm_retention_reminder")||this.args.channel?.isCategoryChannel&&this.currentUser?.get("needs_channel_retention_reminder")}async dismiss(){try{await(0,a.ajax)("/chat/dismiss-retention-reminder",{method:"POST",data:{chatable_type:this.args.channel.chatableType}})
const e=this.args.channel.isDirectMessageChannel?"needs_dm_retention_reminder":"needs_channel_retention_reminder"
this.currentUser.set(e,!1)}catch(e){(0,s.popupAjaxError)(e)}}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"HqR3OXWH",block:'[[[1,"\\n"],[41,[30,0,["show"]],[[[1,"      "],[10,0],[14,0,"chat-retention-reminder"],[12],[1,"\\n        "],[8,[32,0],null,[["@channel"],[[30,1]]],null],[1,"\\n        "],[8,[32,1],[[24,0,"btn-flat dismiss-btn"]],[["@action","@icon"],[[30,0,["dismiss"]],"times"]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-retention-reminder.js",scope:()=>[o.default,r.default],isStrictMode:!0}),h),d=p((u=h).prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(u.prototype,"dismiss",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"dismiss"),u.prototype),u)}))
define("discourse/plugins/chat/discourse/components/chat-side-panel-resizer",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"9PfqvIVl",block:'[[[10,0],[14,0,"chat-side-panel-resizer"],[12],[13]],[],false,[]]',moduleName:"discourse/plugins/chat/discourse/components/chat-side-panel-resizer.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/chat-side-panel",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember/template","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const f=(0,o.createTemplateFactory)({id:"r+jKfyi4",block:'[[[41,[30,0,["chatStateManager","isSidePanelExpanded"]],[[[1,"  "],[11,0],[24,0,"chat-side-panel"],[16,5,[52,[28,[37,1],[[30,0,["site","desktopView"]],[30,0,["chatStateManager","isFullPageActive"]]],null],[30,0,["widthStyle"]]]],[4,[38,2],[[30,0,["setupSize"]]],null],[4,[38,3],[".chat-side-panel-resizer",[30,0,["didResize"]],[28,[37,4],null,[["position","vertical","mutate","resetOnWindowResize"],[false,false,false,true]]]],null],[12],[1,"\\n    "],[18,1,null],[1,"\\n\\n"],[41,[30,0,["site","desktopView"]],[[[1,"      "],[8,[39,6],null,null,null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["&default"],false,["if","and","did-insert","chat/resizable-node","hash","yield","chat-side-panel-resizer"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-side-panel.hbs",isStrictMode:!1})
let v=e.default=(p=new WeakSet,l=class extends i.default{constructor(){super(...arguments),b(this,p),m(this,"chatStateManager",c,this),m(this,"chatSidePanelSize",u,this),m(this,"site",d,this),m(this,"widthStyle",h,this)}setupSize(){this.widthStyle=(0,s.htmlSafe)(`width:${this.chatSidePanelSize.width}px`)}didResize(e,t){if(this.isDestroying||this.isDestroyed)return
e.parentElement.getBoundingClientRect().width-t.width>=250&&(this.chatSidePanelSize.width=t.width,e.style.width=t.width+"px",this.widthStyle=(0,s.htmlSafe)(`width:${t.width}px`))}},c=g(l.prototype,"chatStateManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=g(l.prototype,"chatSidePanelSize",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=g(l.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(l.prototype,"widthStyle",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g(l.prototype,"setupSize",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"setupSize"),l.prototype),g(l.prototype,"didResize",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"didResize"),l.prototype),l);(0,t.setComponentTemplate)(f,v)})),define("discourse/plugins/chat/discourse/components/chat-skeleton",["exports","@ember/component","@glimmer/component","@ember/template","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
function a(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function s(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"2YNyZ6h6",block:'[[[10,0],[14,0,"chat-skeleton -animation"],[12],[1,"\\n"],[42,[28,[37,1],[[28,[37,1],[[30,0,["placeholders"]]],null]],null],null,[[[1,"    "],[10,0],[14,0,"chat-skeleton__body"],[12],[1,"\\n      "],[10,0],[14,0,"chat-skeleton__message"],[12],[1,"\\n        "],[10,0],[14,0,"chat-skeleton__message-avatar"],[12],[13],[1,"\\n        "],[10,0],[14,0,"chat-skeleton__message-poster"],[12],[13],[1,"\\n        "],[10,0],[14,0,"chat-skeleton__message-content"],[12],[1,"\\n"],[41,[30,1,["image"]],[[[1,"            "],[10,0],[14,0,"chat-skeleton__message-img"],[12],[13],[1,"\\n"]],[]],null],[1,"\\n          "],[10,0],[14,0,"chat-skeleton__message-text"],[12],[1,"\\n"],[42,[28,[37,1],[[28,[37,1],[[30,1,["rows"]]],null]],null],null,[[[1,"              "],[10,0],[14,0,"chat-skeleton__message-msg"],[15,5,[30,2]],[12],[13],[1,"\\n"]],[2]],null],[1,"          "],[13],[1,"\\n\\n"],[41,[30,1,["reactions"]],[[[1,"            "],[10,0],[14,0,"chat-skeleton__message-reactions"],[12],[1,"\\n"],[42,[28,[37,1],[[28,[37,1],[[30,1,["reactions"]]],null]],null],null,[[[1,"                "],[10,0],[14,0,"chat-skeleton__message-reaction"],[12],[13],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[1]],null],[13]],["placeholder","row"],false,["each","-track-array","if"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-skeleton.hbs",isStrictMode:!1})
var l=new WeakSet
class c extends i.default{constructor(){super(...arguments),a(this,l)}get placeholders(){return Array.from({length:15},(()=>({image:5===s(this,l,u).call(this,1,10),rows:Array.from({length:s(this,l,u).call(this,1,5)},(()=>(0,n.htmlSafe)(`width: ${s(this,l,u).call(this,20,95)}%`))),reactions:Array.from({length:s(this,l,u).call(this,0,3)})})))}}function u(e,t){return Math.floor(Math.random()*(t-e+1)+e)}e.default=c,(0,t.setComponentTemplate)(o,c)})),define("discourse/plugins/chat/discourse/components/chat-thread-list",["exports","@glimmer/component","@glimmer/tracking","@ember/service","ember-modifier","discourse/components/conditional-loading-spinner","discourse/lib/is-element-in-viewport","discourse-common/utils/decorators","discourse-i18n","truth-helpers/helpers/eq","discourse/plugins/chat/discourse/components/chat/thread-list/header","discourse/plugins/chat/discourse/components/chat/thread-list/item","discourse/plugins/chat/discourse/modifiers/chat/track-message","ember-this-fallback/deprecations-helper","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b){"use strict"
var g,f,v,y,w,_
function j(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function M(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function z(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(_=class extends t.default{constructor(){super(...arguments),j(this,"chat",f,this),j(this,"chatApi",v,this),j(this,"messageBus",y,this),j(this,"chatTrackingStateManager",w,this),M(this,"noThreadsLabel",l.default.t("chat.threads.none")),M(this,"subscribe",(0,r.modifier)(((e,t)=>{let[i]=t
return this.messageBus.subscribe(`/chat/${i.id}`,this.onMessageBus,i.channelMessageBusLastId),()=>{i&&this.messageBus.unsubscribe(`/chat/${i.id}`,this.onMessageBus)}}))),M(this,"fill",(0,r.modifier)((e=>(this.resizeObserver=new ResizeObserver((()=>{(0,s.default)(e)&&this.loadThreads()})),this.resizeObserver.observe(e),()=>{this.resizeObserver.disconnect()})))),M(this,"loadMore",(0,r.modifier)((e=>(this.intersectionObserver=new IntersectionObserver(this.loadThreads),this.intersectionObserver.observe(e),()=>{this.intersectionObserver.disconnect()}))))}get threadsCollection(){return this.chatApi.threads(this.args.channel.id,this.handleLoadedThreads)}loadThreads(){this.threadsCollection.load({limit:10})}get threadsManager(){return this.args.channel.threadsManager}get sortedThreads(){return this.threadsManager.threads.filter((e=>e.currentUserMembership&&!e.originalMessage.deletedAt)).sort(((e,t)=>e.tracking.unreadCount&&t.tracking.unreadCount?e.preview.lastReplyCreatedAt>t.preview.lastReplyCreatedAt?-1:1:e.tracking.unreadCount?-1:t.tracking.unreadCount?1:e.preview.lastReplyCreatedAt>t.preview.lastReplyCreatedAt?-1:1))}get lastThread(){return this.sortedThreads[this.sortedThreads.length-1]}get shouldRender(){return!!this.args.channel}onMessageBus(e){switch(e.type){case"delete":this.handleDeleteMessage(e)
break
case"restore":this.handleRestoreMessage(e)}}handleDeleteMessage(e){const t=this.threadsManager.threads.findBy("originalMessage.id",e.deleted_id)
t&&(t.originalMessage.deletedAt=new Date)}handleRestoreMessage(e){const t=this.threadsManager.threads.findBy("originalMessage.id",e.chat_message.id)
t&&(t.originalMessage.deletedAt=null)}handleLoadedThreads(e){return e.threads.map((t=>{const i=this.threadsManager.add(this.args.channel,t,{replace:!0})
return this.chatTrackingStateManager.setupChannelThreadState(this.args.channel,e.tracking),i}))}},(0,b.setComponentTemplate)((0,m.createTemplateFactory)({id:"khnPjsJh",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[11,0],[24,0,"chat-thread-list"],[4,[30,0,["subscribe"]],[[30,1]],null],[12],[1,"\\n"],[41,[30,2],[[[1,"          "],[8,[32,0],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],null],[1,"\\n        "],[11,0],[24,0,"chat-thread-list__items"],[4,[30,0,["fill"]],null,null],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["sortedThreads"]]],null]],null],"id",[[[1,"            "],[8,[32,1],[[4,[52,[28,[32,2],[[30,3],[30,0,["lastThread"]]],null],[50,[30,0,["ChatTrackMessage"]],2,[[30,0,["load"]]],null]],null,null]],[["@thread"],[[30,3]]],null],[1,"\\n"]],[3]],[[[41,[30,0,["threadsCollection","fetchedOnce"]],[[[1,"              "],[10,0],[14,0,"chat-thread-list__no-threads"],[12],[1,"\\n                "],[1,[30,0,["noThreadsLabel"]]],[1,"\\n              "],[13],[1,"\\n"]],[]],null]],[]]],[1,"\\n          "],[8,[32,3],null,[["@condition"],[[30,0,["threadsCollection","loading"]]]],null],[1,"\\n\\n          "],[11,0],[4,[30,0,["loadMore"]],null,null],[12],[1,"\\n            "],[10,"br"],[12],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[1,[28,[32,4],["[[\\"The `ChatTrackMessage` property path was used in the `/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-thread-list.js` template without using `this`. This fallback behavior has been deprecated, all properties must be looked up on `this` when used in the template: {{this.ChatTrackMessage}}\\",false,{\\"id\\":\\"ember-this-fallback.this-property-fallback\\",\\"until\\":\\"n/a\\",\\"for\\":\\"ember-this-fallback\\",\\"url\\":\\"https://deprecations.emberjs.com/v3.x#toc_this-property-fallback\\",\\"since\\":{\\"available\\":\\"0.2.0\\"}}]]"],null]]],["@channel","@includeHeader","thread"],false,["if","each","-track-array","modifier"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-thread-list.js",scope:()=>[u.default,d.default,c.default,a.default,p.default],isStrictMode:!0}),_),f=z((g=_).prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=z(g.prototype,"chatApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=z(g.prototype,"messageBus",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=z(g.prototype,"chatTrackingStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z(g.prototype,"threadsCollection",[i.cached],Object.getOwnPropertyDescriptor(g.prototype,"threadsCollection"),g.prototype),z(g.prototype,"loadThreads",[o.bind],Object.getOwnPropertyDescriptor(g.prototype,"loadThreads"),g.prototype),z(g.prototype,"onMessageBus",[o.bind],Object.getOwnPropertyDescriptor(g.prototype,"onMessageBus"),g.prototype),z(g.prototype,"handleLoadedThreads",[o.bind],Object.getOwnPropertyDescriptor(g.prototype,"handleLoadedThreads"),g.prototype),g)})),define("discourse/plugins/chat/discourse/components/chat-thread-participants",["exports","@glimmer/component","discourse-i18n","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a){"use strict"
var s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get showParticipants(){return this.includeOriginalMessageUser?this.participantsUsers.length>1:this.participantsUsers.length>0}get includeOriginalMessageUser(){return this.args.includeOriginalMessageUser??!0}get participantsUsers(){const e=this.args.thread.preview.participantUsers
return this.includeOriginalMessageUser?e.length>3?e.slice(0,2).concat(e[e.length-1]):e:e.filter((e=>e.id!==this.args.thread.originalMessage.user.id))}get otherCountLabel(){return i.default.t("chat.thread.participants_other_count",{count:this.args.thread.preview.otherParticipantCount})}}e.default=o,s=o,(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"uIyMf295",block:'[[[1,"\\n"],[41,[30,0,["showParticipants"]],[[[1,"      "],[11,0],[24,0,"chat-thread-participants"],[17,1],[12],[1,"\\n        "],[10,0],[14,0,"chat-thread-participants__avatar-group"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["participantsUsers"]]],null]],null],null,[[[1,"            "],[8,[32,0],null,[["@user","@avatarSize","@showPresence","@interactive"],[[30,2],"tiny",false,false]],null],[1,"\\n"]],[2]],null],[1,"        "],[13],[1,"\\n"],[41,[30,3,["preview","otherParticipantCount"]],[[[1,"          "],[10,0],[14,0,"chat-thread-participants__other-count"],[12],[1,"\\n            "],[1,[30,0,["otherCountLabel"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["&attrs","user","@thread"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-thread-participants.js",scope:()=>[n.default],isStrictMode:!0}),s)})),define("discourse/plugins/chat/discourse/components/chat-thread",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/application","@ember/object","@ember/runloop","@ember/service","discourse/lib/ajax-error","discourse/lib/desktop-notifications","discourse/lib/notification-levels","discourse-common/lib/debounce","discourse-common/utils/decorators","discourse/plugins/chat/discourse/lib/chat-constants","discourse/plugins/chat/discourse/lib/chat-ios-hacks","discourse/plugins/chat/discourse/lib/chat-messages-loader","discourse/plugins/chat/discourse/lib/scroll-helpers","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/user-chat-thread-membership","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y){"use strict"
var w,_,j,M,z,k,C,O,S,P,T,E,x,D,A,I,U,L,N,R,F
function W(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function B(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function H(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function $(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function V(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const q=(0,y.createTemplateFactory)({id:"xHITlXmV",block:'[[[11,0],[16,0,[28,[37,0],["chat-thread",[52,[30,0,["messagesLoader","loading"]],"loading"]],null]],[16,"data-id",[30,1,["id"]]],[4,[38,2],[[30,0,["setUploadDropZone"]]],null],[4,[38,2],[[30,0,["didUpdateThread"]]],null],[4,[38,3],[[30,0,["didUpdateThread"]],[30,1,["id"]]],null],[4,[38,4],[[30,0,["teardown"]]],null],[12],[1,"\\n"],[41,[30,2],[[[1,"    "],[8,[39,5],null,[["@channel","@thread"],[[30,1,["channel"]],[30,1]]],null],[1,"\\n"]],[]],null],[1,"\\n  "],[11,0],[24,0,"chat-thread__body popper-viewport chat-messages-scroll"],[4,[38,2],[[30,0,["setScrollable"]]],null],[4,[38,6],[[28,[37,7],null,[["onScroll","onScrollEnd","reverse"],[[30,0,["onScroll"]],[30,0,["onScrollEnd"]],true]]]],null],[12],[1,"\\n    "],[11,0],[24,0,"chat-messages-container"],[4,[38,8],[[30,0,["didResizePane"]],[28,[37,7],null,[["delay","immediate"],[100,true]]]],null],[12],[1,"\\n"],[42,[28,[37,10],[[28,[37,10],[[30,0,["messagesManager","messages"]]],null]],null],"id",[[[1,"        "],[8,[39,11],null,[["@message","@disableMouseEvents","@resendStagedMessage","@context"],[[30,3],[30,0,["isScrolling"]],[30,0,["resendStagedMessage"]],"thread"]],null],[1,"\\n"]],[3]],null],[1,"\\n"],[41,[51,[30,0,["messagesLoader","fetchedOnce"]]],[[[41,[30,0,["messagesLoader","loading"]],[[[1,"          "],[8,[39,13],null,null,null],[1,"\\n"]],[]],null]],[]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,14],null,[["@onScrollToBottom","@isVisible"],[[30,0,["scrollToLatestMessage"]],[30,0,["needsArrow"]]]],null],[1,"\\n\\n"],[41,[30,0,["chatThreadPane","selectingMessages"]],[[[1,"    "],[8,[39,15],null,[["@pane"],[[30,0,["chatThreadPane"]]]],null],[1,"\\n"]],[]],[[[1,"    "],[8,[39,16],null,[["@channel","@thread","@onSendMessage","@uploadDropZone"],[[30,4],[30,1],[30,0,["onSendMessage"]],[30,0,["uploadDropZone"]]]],null],[1,"\\n"]],[]]],[1,"\\n  "],[8,[39,17],null,[["@model"],[[30,1]]],null],[1,"\\n"],[13]],["@thread","@includeHeader","message","@channel"],false,["concat-class","if","did-insert","did-update","will-destroy","chat/thread/header","chat/scrollable-list","hash","chat/on-resize","each","-track-array","chat-message","unless","chat-skeleton","chat/scroll-to-bottom-arrow","chat/selection-manager","chat/composer/thread","chat-upload-drop-zone"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-thread.hbs",isStrictMode:!1})
let K=e.default=(L=new WeakSet,N=new WeakSet,R=new WeakSet,F=new WeakSet,w=class extends i.default{constructor(){super(...arguments),B(this,F),B(this,R),B(this,N),B(this,L),W(this,"appEvents",_,this),W(this,"capabilities",j,this),W(this,"chat",M,this),W(this,"chatApi",z,this),W(this,"chatComposerPresenceManager",k,this),W(this,"chatHistory",C,this),W(this,"chatThreadComposer",O,this),W(this,"chatThreadPane",S,this),W(this,"chatThreadPaneSubscriptionsManager",P,this),W(this,"currentUser",T,this),W(this,"router",E,this),W(this,"siteSettings",x,this),W(this,"isAtBottom",D,this),W(this,"isScrolling",A,this),W(this,"needsArrow",I,this),W(this,"uploadDropZone",U,this),H(this,"scrollable",null)}resetIdle(){(0,c.resetIdle)()}get messagesLoader(){return new b.default((0,r.getOwner)(this),this.args.thread)}get messagesManager(){return this.args.thread.messagesManager}handleKeydown(e){if("Escape"===e.key)return this.router.transitionTo("chat.channel",...this.args.thread.channel.routeModels)}didUpdateThread(){this.messagesManager.clear(),this.chatThreadComposer.focus(),this.loadMessages(),this.resetComposerMessage()}setUploadDropZone(e){this.uploadDropZone=e}subscribeToUpdates(){this.chatThreadPaneSubscriptionsManager.subscribe(this.args.thread)}teardown(){this.chatThreadPaneSubscriptionsManager.unsubscribe(),(0,s.cancel)(this._debouncedFillPaneAttemptHandler),(0,s.cancel)(this._debounceUpdateLastReadMessageHandler)}onScroll(e){(0,s.next)((()=>{$(this,F,Z).call(this)||((0,m.bodyScrollFix)(),this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!0,this.debounceUpdateLastReadMessage(),e.atTop||!this.capabilities.isIOS&&e.up&&e.distanceToTop.percentage<40?this.fetchMoreMessages({direction:p.PAST}):e.atBottom&&this.fetchMoreMessages({direction:p.FUTURE}))}))}onScrollEnd(e){this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!1,this.resetIdle(),this.atBottom=e.atBottom,e.atBottom&&this.fetchMoreMessages({direction:p.FUTURE})}debounceUpdateLastReadMessage(){this._debounceUpdateLastReadMessageHandler=(0,d.default)(this,this.updateLastReadMessage,p.READ_INTERVAL_MS)}updateLastReadMessage(){this.markThreadAsRead()}setScrollable(e){this.scrollable=e}loadMessages(){this.fetchMessages(),this.subscribeToUpdates()}didResizePane(){this._ignoreNextScroll=!0,this.debounceFillPaneAttempt(),this.debounceUpdateLastReadMessage()}async fetchMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(this.messagesLoader.loading)return
this.messagesManager.clear(),e.targetMessageId??=this.args.targetMessageId||this.args.thread.currentUserMembership?.lastReadMessageId,e.targetMessageId||(e.direction=p.FUTURE)
const t=await this.messagesLoader.load(e)
if(!t)return
const[i,n]=this.processMessages(this.args.thread,t);(0,m.stackingContextFix)(this.scrollable,(()=>{this.messagesManager.addMessages(i)})),this.args.thread.details=n,this.args.targetMessageId?this.scrollToMessageId(this.args.targetMessageId,{highlight:!0}):this.args.thread.currentUserMembership?.lastReadMessageId?this.scrollToMessageId(this.args.thread.currentUserMembership?.lastReadMessageId):this.scrollToTop(),this.debounceFillPaneAttempt()}async fetchMoreMessages(e){let{direction:t}=e
if(this.messagesLoader.loading)return
const i=await this.messagesLoader.loadMore({direction:t})
if(!i)return
const[n,r]=this.processMessages(this.args.thread,i)
n?.length&&((0,m.stackingContextFix)(this.scrollable,(()=>{this.messagesManager.addMessages(n)})),this.args.thread.details=r,t===p.FUTURE?this.scrollToMessageId(n.firstObject.id,{position:"end",behavior:"auto"}):t===p.PAST&&this.scrollToMessageId(n.lastObject.id),this.debounceFillPaneAttempt())}scrollToLatestMessage(){this.messagesLoader.canLoadMoreFuture?this.fetchMessages():this.messagesManager.messages.length>0&&this.scrollToBottom()}debounceFillPaneAttempt(){this.messagesLoader.fetchedOnce&&(this._debouncedFillPaneAttemptHandler=(0,d.default)(this,this.fillPaneAttempt,500))}async fillPaneAttempt(){if(this.messagesManager.messages.length>200)return
if(!this.messagesLoader.canLoadMorePast)return
const e=this.messagesManager.messages.firstObject
e?.visible&&await this.fetchMoreMessages({direction:p.PAST})}scrollToMessageId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{highlight:!1,position:"start",autoExpand:!1}
this._ignoreNextScroll=!0
const i=this.messagesManager.findMessage(e);(0,g.scrollListToMessage)(this.scrollable,i,t)}processMessages(e,t){return[t.messages.map((t=>{const i=(this.currentUser.ignored_users||[]).includes(t.user.username)
return f.default.create(e.channel,{...t,hidden:i,expanded:!(i||t.deleted_at),manager:this.messagesManager,thread:e})})),t.meta]}markThreadAsRead(){if(this.args.thread)return this.chatApi.markThreadAsRead(this.args.thread.channel.id,this.args.thread.id)}async onSendMessage(e){(0,c.resetIdle)(),await e.cook(),e.editing?await $(this,N,J).call(this,e):await $(this,L,G).call(this,e)}resetComposerMessage(){this.chatThreadComposer.reset(this.args.thread)}scrollToBottom(){this._ignoreNextScroll=!0,(0,g.scrollListToBottom)(this.scrollable)}scrollToTop(){this._ignoreNextScroll=!0,(0,g.scrollListToTop)(this.scrollable)}resendStagedMessage(){}},_=V(w.prototype,"appEvents",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=V(w.prototype,"capabilities",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=V(w.prototype,"chat",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=V(w.prototype,"chatApi",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=V(w.prototype,"chatComposerPresenceManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=V(w.prototype,"chatHistory",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=V(w.prototype,"chatThreadComposer",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=V(w.prototype,"chatThreadPane",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=V(w.prototype,"chatThreadPaneSubscriptionsManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=V(w.prototype,"currentUser",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=V(w.prototype,"router",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=V(w.prototype,"siteSettings",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=V(w.prototype,"isAtBottom",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),A=V(w.prototype,"isScrolling",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),I=V(w.prototype,"needsArrow",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),U=V(w.prototype,"uploadDropZone",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V(w.prototype,"resetIdle",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"resetIdle"),w.prototype),V(w.prototype,"messagesLoader",[n.cached],Object.getOwnPropertyDescriptor(w.prototype,"messagesLoader"),w.prototype),V(w.prototype,"handleKeydown",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"handleKeydown"),w.prototype),V(w.prototype,"didUpdateThread",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"didUpdateThread"),w.prototype),V(w.prototype,"setUploadDropZone",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"setUploadDropZone"),w.prototype),V(w.prototype,"subscribeToUpdates",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"subscribeToUpdates"),w.prototype),V(w.prototype,"teardown",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"teardown"),w.prototype),V(w.prototype,"onScroll",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"onScroll"),w.prototype),V(w.prototype,"onScrollEnd",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"onScrollEnd"),w.prototype),V(w.prototype,"updateLastReadMessage",[h.bind],Object.getOwnPropertyDescriptor(w.prototype,"updateLastReadMessage"),w.prototype),V(w.prototype,"setScrollable",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"setScrollable"),w.prototype),V(w.prototype,"loadMessages",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"loadMessages"),w.prototype),V(w.prototype,"didResizePane",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"didResizePane"),w.prototype),V(w.prototype,"fetchMoreMessages",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"fetchMoreMessages"),w.prototype),V(w.prototype,"scrollToLatestMessage",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"scrollToLatestMessage"),w.prototype),V(w.prototype,"processMessages",[h.bind],Object.getOwnPropertyDescriptor(w.prototype,"processMessages"),w.prototype),V(w.prototype,"onSendMessage",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"onSendMessage"),w.prototype),V(w.prototype,"resetComposerMessage",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"resetComposerMessage"),w.prototype),V(w.prototype,"scrollToBottom",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"scrollToBottom"),w.prototype),V(w.prototype,"scrollToTop",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"scrollToTop"),w.prototype),V(w.prototype,"resendStagedMessage",[a.action],Object.getOwnPropertyDescriptor(w.prototype,"resendStagedMessage"),w.prototype),w)
async function G(e){if(!this.chatThreadPane.sending){this.chatThreadPane.sending=!0,this._ignoreNextScroll=!0,(0,m.stackingContextFix)(this.scrollable,(async()=>{await this.args.thread.stageMessage(e)})),this.resetComposerMessage(),this.messagesLoader.canLoadMoreFuture||this.scrollToLatestMessage()
try{const t=await this.chatApi.sendMessage(this.args.thread.channel.id,{message:e.message,in_reply_to_id:null,staged_id:e.id,upload_ids:e.uploads.map((e=>e.id)),thread_id:e.thread.id})
this.args.thread.currentUserMembership??=v.default.create({notification_level:u.NotificationLevels.TRACKING,last_read_message_id:t.message_id}),this.scrollToLatestMessage()}catch(t){$(this,R,Y).call(this,e.id,t)}finally{this.chatThreadPane.sending=!1}}}async function J(e){this.chatThreadPane.sending=!0
const t={message:e.message,upload_ids:e.uploads.map((e=>e.id))}
this.resetComposerMessage()
try{return await this.chatApi.editMessage(e.channel.id,e.id,t)}catch(i){(0,l.popupAjaxError)(i)}finally{this.chatThreadPane.sending=!1}}function Y(e,t){const i=this.args.thread.messagesManager.findStagedMessage(e)
i&&(t.jqXHR?.responseJSON?.errors?.length?i.error=t.jqXHR.responseJSON.errors[0]:(this.chat.markNetworkAsUnreliable(),i.error="network_error")),this.resetComposerMessage()}function Z(){const e=this._ignoreNextScroll
return this._ignoreNextScroll=!1,e}(0,t.setComponentTemplate)(q,K)})),define("discourse/plugins/chat/discourse/components/chat-to-topic-selector",["exports","@ember/component","@ember/object/computed","@ember/template","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.NEW_TOPIC_SELECTION=e.NEW_MESSAGE_SELECTION=e.EXISTING_TOPIC_SELECTION=void 0
const d=(0,a.createTemplateFactory)({id:"NiQ70pNF",block:'[[[10,0],[14,0,"chat-to-topic-selector"],[12],[1,"\\n  "],[10,0],[14,0,"radios"],[12],[1,"\\n    "],[10,"label"],[14,0,"radio-label"],[14,"for","move-to-new-topic"],[12],[1,"\\n      "],[8,[39,0],null,[["@id","@name","@value","@selection"],["move-to-new-topic","move-to-entity",[30,0,["newTopicSelection"]],[30,0,["selection"]]]],null],[1,"\\n      "],[10,"b"],[12],[1,[28,[35,1],["topic.split_topic.radio_label"],null]],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,"label"],[14,0,"radio-label"],[14,"for","move-to-existing-topic"],[12],[1,"\\n      "],[8,[39,0],null,[["@id","@name","@value","@selection"],["move-to-existing-topic","move-to-entity",[30,0,["existingTopicSelection"]],[30,0,["selection"]]]],null],[1,"\\n      "],[10,"b"],[12],[1,[28,[35,1],["topic.merge_topic.radio_label"],null]],[13],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,0,["allowNewMessage"]],[[[1,"      "],[10,"label"],[14,0,"radio-label"],[14,"for","move-to-new-message"],[12],[1,"\\n        "],[8,[39,0],null,[["@id","@name","@value","@selection"],["move-to-new-message","move-to-entity",[30,0,["newMessageSelection"]],[30,0,["selection"]]]],null],[1,"\\n        "],[10,"b"],[12],[1,[28,[35,1],["topic.move_to_new_message.radio_label"],null]],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n\\n"],[41,[30,0,["newTopic"]],[[[1,"    "],[10,2],[12],[1,[30,0,["newTopicInstruction"]]],[13],[1,"\\n\\n    "],[10,"form"],[12],[1,"\\n      "],[10,"label"],[14,"for","split-topic-name"],[12],[1,"\\n        "],[1,[28,[35,1],["topic.split_topic.topic_name"],null]],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,3],null,[["@value","@placeholderKey","@id"],[[30,0,["topicTitle"]],"composer.title_placeholder","split-topic-name"]],null],[1,"\\n\\n      "],[10,"label"],[12],[1,[28,[35,1],["categories.category"],null]],[13],[1,"\\n\\n      "],[8,[39,4],null,[["@id","@value","@class","@onChange"],["new-topic-category-selector",[30,0,["categoryId"]],"small",[28,[37,5],[[30,0],[28,[37,6],[[30,0,["categoryId"]]],null]],null]]],null],[1,"\\n\\n"],[41,[30,0,["canAddTags"]],[[[1,"        "],[10,"label"],[12],[1,[28,[35,1],["tagging.tags"],null]],[13],[1,"\\n        "],[8,[39,7],null,[["@tags","@filterable","@categoryId"],[[30,0,["tags"]],true,[30,0,["categoryId"]]]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["existingTopic"]],[[[1,"    "],[10,2],[12],[1,[30,0,["existingTopicInstruction"]]],[13],[1,"\\n    "],[10,"form"],[12],[1,"\\n      "],[8,[39,8],null,[["@selectedTopicId"],[[30,0,["selectedTopicId"]]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[28,[37,9],[[30,0,["allowNewMessage"]],[30,0,["newMessage"]]],null],[[[1,"    "],[10,2],[12],[1,[30,0,["newMessageInstruction"]]],[13],[1,"\\n\\n    "],[10,"form"],[12],[1,"\\n      "],[10,"label"],[14,"for","split-message-title"],[12],[1,"\\n        "],[1,[28,[35,1],["topic.move_to_new_message.message_title"],null]],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,3],null,[["@value","@placeholderKey","@id"],[[30,0,["topicTitle"]],"composer.title_placeholder","split-message-title"]],null],[1,"\\n\\n"],[41,[30,0,["canTagMessages"]],[[[1,"        "],[10,"label"],[12],[1,[28,[35,1],["tagging.tags"],null]],[13],[1,"\\n        "],[8,[39,7],null,[["@tags","@filterable"],[[30,0,["tags"]],true]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]],null],[13]],[],false,["radio-button","i18n","if","text-field","category-chooser","action","mut","tag-chooser","choose-topic","and"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-to-topic-selector.hbs",isStrictMode:!1}),h=e.NEW_TOPIC_SELECTION="new_topic",p=e.EXISTING_TOPIC_SELECTION="existing_topic",m=e.NEW_MESSAGE_SELECTION="new_message"
e.default=(0,t.setComponentTemplate)(d,t.default.extend((s=(0,r.default)(),o=(0,r.default)(),l=(0,r.default)(),u(c={newTopicSelection:h,existingTopicSelection:p,newMessageSelection:m,selection:null,newTopic:(0,i.equal)("selection",h),existingTopic:(0,i.equal)("selection",p),newMessage:(0,i.equal)("selection",m),canAddTags:(0,i.alias)("site.can_create_tag"),canTagMessages:(0,i.alias)("site.can_tag_pms"),topicTitle:null,categoryId:null,tags:null,selectedTopicId:null,chatMessageIds:null,chatChannelId:null,newTopicInstruction(){return(0,n.htmlSafe)(this.instructionLabels[h])},existingTopicInstruction(){return(0,n.htmlSafe)(this.instructionLabels[p])},newMessageInstruction(){return(0,n.htmlSafe)(this.instructionLabels[m])}},"newTopicInstruction",[s],Object.getOwnPropertyDescriptor(c,"newTopicInstruction"),c),u(c,"existingTopicInstruction",[o],Object.getOwnPropertyDescriptor(c,"existingTopicInstruction"),c),u(c,"newMessageInstruction",[l],Object.getOwnPropertyDescriptor(c,"newMessageInstruction"),c),c)))})),define("discourse/plugins/chat/discourse/components/chat-upload-drop-zone",["exports","@ember/component","@glimmer/component","discourse-i18n","discourse/plugins/chat/discourse/models/chat-thread","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
function s(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,a.createTemplateFactory)({id:"N5UT4JeN",block:'[[[10,0],[14,0,"chat-upload-drop-zone"],[12],[1,"\\n  "],[10,0],[14,0,"chat-upload-drop-zone__content"],[12],[1,"\\n    "],[10,0],[14,0,"chat-upload-drop-zone__background"],[12],[1,"\\n      "],[10,"svg"],[14,"width","94"],[14,"height","90"],[14,"viewBox","0 0 94 90"],[14,"fill","none"],[14,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12],[1,"\\n        "],[10,"path"],[14,"d","M94 40.5591C94 69.8685 64.0686 90 40.9592 90C17.8499 90 0 83.9085 0 60.6907C0 37.4729 28.458 0 51.5674 0C74.6768 0 94 17.3413 94 40.5591Z"],[14,"fill","#D1F0FF"],[12],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n    "],[10,0],[14,0,"chat-upload-drop-zone__illustration"],[12],[1,"\\n      "],[10,"svg"],[14,"width","106"],[14,"height","84"],[14,"viewBox","0 0 106 84"],[14,"fill","none"],[14,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12],[1,"\\n        "],[10,"rect"],[14,"x","55.832"],[14,"y","6.82959"],[14,"width","45.7854"],[14,"height","33.8408"],[14,"transform","rotate(13.4039 55.832 6.82959)"],[14,"fill","#D9D9D9"],[12],[13],[1,"\\n        "],[10,"path"],[14,"d","M100.66 13.7645L61.1414 4.34705C58.6715 3.75846 56.1786 5.37298 55.59 7.84288L47.6214 41.2815C47.0102 43.8464 48.5297 46.3167 50.9996 46.9053L90.518 56.3227C92.9879 56.9113 95.5532 55.4145 96.1644 52.8496L104.133 19.4109C104.722 16.941 103.225 14.3757 100.66 13.7645ZM58.7093 41.5144C58.5961 41.9894 58.1482 42.1838 57.7682 42.0933L53.2084 41.0067C52.7334 40.8935 52.5163 40.5406 52.6295 40.0656L53.7161 35.5058C53.8067 35.1258 54.1822 34.8137 54.6572 34.9269L59.122 35.9909C59.502 36.0815 59.7915 36.552 59.7009 36.932L58.7093 41.5144ZM61.6069 29.3549C61.4938 29.8299 61.0459 30.0243 60.6659 29.9338L56.1061 28.8472C55.6311 28.734 55.414 28.3811 55.5272 27.9061L56.6138 23.3463C56.7044 22.9663 57.0799 22.6542 57.5549 22.7674L62.0197 23.8314C62.3997 23.922 62.6891 24.3925 62.5986 24.7725L61.5119 29.3323L61.6069 29.3549ZM64.5046 17.1954C64.3914 17.6704 63.9435 17.8648 63.5635 17.7743L59.0037 16.6877C58.5287 16.5745 58.3117 16.2216 58.4249 15.7466L59.5115 11.1868C59.602 10.8068 59.9776 10.4947 60.4526 10.6079L64.9174 11.6719C65.2974 11.7625 65.5868 12.233 65.4962 12.613L64.5046 17.1954ZM81.6894 46.1876C81.4857 47.0426 80.5673 47.5264 79.8073 47.3453L64.6079 43.7232C63.753 43.5195 63.2464 42.6961 63.4502 41.8411L65.6234 32.7215C65.8045 31.9615 66.6506 31.36 67.5056 31.5637L82.705 35.1858C83.4649 35.3669 84.0438 36.308 83.8627 37.068L81.6894 46.1876ZM86.036 27.9483C85.8322 28.8033 84.9138 29.2872 84.1538 29.1061L68.9544 25.484C68.0995 25.2802 67.593 24.4568 67.7967 23.6018L69.97 14.4822C70.1511 13.7222 70.9971 13.1207 71.8521 13.3245L87.0515 16.9466C87.8114 17.1277 88.3903 18.0687 88.2092 18.8287L86.036 27.9483ZM92.1479 49.483C92.0347 49.958 91.5868 50.1524 91.2068 50.0619L86.742 48.9979C86.267 48.8847 86.05 48.5318 86.1631 48.0568L87.2498 43.497C87.3403 43.117 87.8109 42.8276 88.1908 42.9181L92.7507 44.0048C93.1306 44.0953 93.4201 44.5659 93.3295 44.9458L92.2429 49.5057L92.1479 49.483ZM95.0456 37.3235C94.9324 37.7985 94.4845 37.9929 94.1045 37.9024L89.6397 36.8384C89.1647 36.7252 88.9476 36.3723 89.0608 35.8973L90.1474 31.3375C90.238 30.9575 90.6135 30.6455 91.0885 30.7586L95.5533 31.8226C95.9333 31.9132 96.2228 32.3837 96.1322 32.7637L95.0456 37.3235ZM97.9432 25.164C97.8301 25.639 97.3822 25.8334 97.0022 25.7429L92.5374 24.6789C92.0624 24.5657 91.8453 24.2128 91.9585 23.7378L93.0451 19.178C93.1357 18.798 93.5112 18.486 93.8912 18.5765L98.356 19.6405C98.736 19.731 99.0254 20.2016 98.9349 20.5816L97.8483 25.1414L97.9432 25.164Z"],[14,"fill","#AFAFAF"],[12],[13],[1,"\\n        "],[10,"path"],[14,"d","M30.7898 24.814L27.2823 9.2672L4.41944 14.4252C2.81904 14.7863 1.95958 16.3017 2.29486 17.7878L14.2615 70.8296C14.6226 72.43 16.0236 73.3153 17.624 72.9542L56.0337 64.2887C57.5198 63.9534 58.5193 62.5266 58.1582 60.9262L49.699 23.4311L34.1523 26.9385C32.5519 27.2996 31.1508 26.4144 30.7898 24.814ZM48.719 19.0871C48.5643 18.4012 48.0666 17.7927 47.4804 17.3243L33.7501 8.64894C33.0754 8.32063 32.3121 8.13243 31.6263 8.28717L30.9404 8.44191L34.2415 23.0742L48.8738 19.773L48.719 19.0871Z"],[14,"fill","#0AADFF"],[12],[13],[1,"\\n        "],[10,"rect"],[14,"x","41.7334"],[14,"y","40.3967"],[14,"width","37.6309"],[14,"height","28.6511"],[14,"transform","rotate(6.29289 41.7334 40.3967)"],[14,"fill","#66CCFF"],[12],[13],[1,"\\n        "],[10,"path"],[14,"d","M76.768 40.4721L44.4638 36.9097C42.3671 36.6785 40.548 38.2071 40.3254 40.2261L37.8591 62.5905C37.6279 64.6872 39.0788 66.4977 41.1755 66.729L73.4796 70.2913C75.4987 70.514 77.3869 69.0716 77.6181 66.9749L80.0843 44.6105C80.307 42.5915 78.787 40.6947 76.768 40.4721ZM73.4248 66.5125L42.0524 63.0529C41.7418 63.0187 41.6036 62.8462 41.6379 62.5356L44.0014 41.103C44.0271 40.8701 44.2081 40.6542 44.5187 40.6885L75.891 44.1481C76.124 44.1738 76.3312 44.4324 76.3056 44.6654L73.9421 66.098C73.9078 66.4086 73.6577 66.5382 73.4248 66.5125ZM49.9226 44.4284C48.1365 44.2314 46.6623 45.4836 46.4739 47.192C46.2769 48.978 47.4514 50.4437 49.2375 50.6407C50.9459 50.8291 52.4892 49.6631 52.6862 47.8771C52.8746 46.1687 51.631 44.6168 49.9226 44.4284ZM45.725 59.6852L70.5743 62.4255L71.2594 56.2131L65.1708 48.7036C64.8254 48.2725 64.2818 48.2126 63.8507 48.558L53.5908 56.7799L50.8186 53.4088C50.4732 52.9777 49.9296 52.9178 49.4985 53.2632L46.136 55.9578L45.725 59.6852Z"],[14,"fill","white"],[12],[13],[1,"\\n        "],[10,"path"],[14,"d","M37.8174 63.0181L77.5892 66.862L77.012 72.8342C76.9057 73.9336 75.9283 74.7388 74.8288 74.6325L39.0385 71.1734C37.939 71.0671 37.1339 70.0897 37.2402 68.9902L37.8174 63.0181Z"],[14,"fill","white"],[12],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n    "],[10,0],[14,0,"chat-upload-drop-zone__text"],[12],[1,"\\n      "],[10,1],[14,0,"chat-upload-drop-zone__text__title"],[12],[1,"\\n        "],[1,[30,0,["title"]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],[],false,[]]',moduleName:"discourse/plugins/chat/discourse/components/chat-upload-drop-zone.hbs",isStrictMode:!1})
var l=new WeakSet
class c extends i.default{constructor(){super(...arguments),s(this,l)}get title(){return function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,l,u).call(this)?n.default.t("chat.upload_to_thread"):n.default.t("chat.upload_to_channel",{title:this.args.model.title})}}function u(){return this.args.model instanceof r.default}e.default=c,(0,t.setComponentTemplate)(o,c)})),define("discourse/plugins/chat/discourse/components/chat-upload",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember/template","discourse/lib/uploads","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,l.createTemplateFactory)({id:"O4AMyIEH",block:'[[[41,[28,[37,1],[[30,0,["type"]],[30,0,["IMAGE_TYPE"]]],null],[[[1,"  "],[11,"img"],[24,0,"chat-img-upload"],[16,"data-orig-src",[30,1,["short_url"]]],[16,"height",[30,0,["size","height"]]],[16,"width",[30,0,["size","width"]]],[16,"src",[30,1,["url"]]],[16,5,[30,0,["imageStyle"]]],[24,"loading","lazy"],[24,"tabindex","0"],[16,"data-dominant-color",[30,1,["dominant_color"]]],[4,[38,2],["load",[30,0,["imageLoaded"]]],null],[12],[13],[1,"\\n"]],[]],[[[41,[28,[37,1],[[30,0,["type"]],[30,0,["VIDEO_TYPE"]]],null],[[[1,"  "],[10,"video"],[14,0,"chat-video-upload"],[14,"preload","metadata"],[14,"height","150"],[14,"controls",""],[12],[1,"\\n    "],[10,"source"],[15,"src",[30,1,["url"]]],[12],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[41,[28,[37,1],[[30,0,["type"]],[30,0,["AUDIO_TYPE"]]],null],[[[1,"  "],[10,"audio"],[14,0,"chat-audio-upload"],[14,"preload","metadata"],[14,"controls",""],[12],[1,"\\n    "],[10,"source"],[15,"src",[30,1,["url"]]],[12],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[1,"  "],[10,3],[14,0,"chat-other-upload"],[15,"data-orig-href",[30,1,["short_url"]]],[15,6,[30,1,["url"]]],[12],[1,"\\n    "],[1,[30,1,["original_filename"]]],[1,"\\n  "],[13],[1,"\\n"]],[]]]],[]]]],[]]]],["@upload"],false,["if","eq","on"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-upload.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(b,(c=class extends i.default{constructor(){super(...arguments),h(this,"siteSettings",u,this),h(this,"loaded",d,this),p(this,"IMAGE_TYPE","image"),p(this,"VIDEO_TYPE","video"),p(this,"AUDIO_TYPE","audio"),p(this,"ATTACHMENT_TYPE","attachment")}get type(){return(0,o.isImage)(this.args.upload.original_filename)?this.IMAGE_TYPE:(0,o.isVideo)(this.args.upload.original_filename)?this.VIDEO_TYPE:(0,o.isAudio)(this.args.upload.original_filename)?this.AUDIO_TYPE:this.ATTACHMENT_TYPE}get size(){const e=this.args.upload.width,t=this.args.upload.height,i=Math.min(this.siteSettings.max_image_width/e,this.siteSettings.max_image_height/t)
return{width:e*i,height:t*i}}get imageStyle(){if(this.args.upload.dominant_color&&!this.loaded)return(0,s.htmlSafe)(`background-color: #${this.args.upload.dominant_color};`)}imageLoaded(){this.loaded=!0}},u=m(c.prototype,"siteSettings",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(c.prototype,"loaded",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m(c.prototype,"imageLoaded",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"imageLoaded"),c.prototype),c))})),define("discourse/plugins/chat/discourse/components/chat-user-avatar",["exports","@glimmer/component","@ember/service","@ember/template","discourse/helpers/concat-class","discourse/helpers/user-avatar","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get avatar(){return(0,n.htmlSafe)((0,a.renderAvatar)(this.args.user,{imageSize:this.avatarSize}))}get interactive(){return this.args.interactive??!0}get avatarSize(){return this.args.avatarSize||"tiny"}get showPresence(){return this.args.showPresence??!0}get isOnline(){const e=(this.args.chat||this.chat).presenceChannel?.users
return this.showPresence&&!!e?.find((e=>{let{id:t,username:i}=e
return this.args.user?.id===t||this.args.user?.username===i}))}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"d7cL2Rn9",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],["chat-user-avatar",[52,[30,0,["isOnline"]],"is-online"]],null]],[15,"data-username",[30,1,["username"]]],[12],[1,"\\n"],[41,[30,0,["interactive"]],[[[1,"        "],[10,0],[14,"role","button"],[14,0,"chat-user-avatar__container clickable"],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n          "],[1,[30,0,["avatar"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[1,[30,0,["avatar"]]],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n  "]],["@user"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-user-avatar.js",scope:()=>[r.default],isStrictMode:!0}),u),d=(l=u).prototype,h="chat",p=[i.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),c=g,l)
var d,h,p,m,b,g})),define("discourse/plugins/chat/discourse/components/chat-user-display-name",["exports","@ember/component","@glimmer/component","@ember/service","discourse/lib/utilities","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,a.createTemplateFactory)({id:"l+SlWfo/",block:'[[[10,1],[14,0,"chat-user-display-name"],[12],[1,"\\n"],[41,[30,0,["shouldShowNameFirst"]],[[[1,"    "],[10,1],[14,0,"chat-user-display-name__name -first"],[12],[1,[30,1,["name"]]],[13],[1,"\\n    "],[10,1],[14,0,"separator"],[12],[1,""],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[10,1],[15,0,[28,[37,1],["chat-user-display-name__username",[52,[51,[30,0,["shouldShowNameFirst"]]],"-first"]],null]],[12],[1,"\\n    "],[1,[30,0,["formattedUsername"]]],[1,"\\n  "],[13],[1,"\\n\\n"],[41,[30,0,["shouldShowNameLast"]],[[[1,"    "],[10,1],[14,0,"separator"],[12],[1,""],[13],[1,"\\n    "],[10,1],[14,0,"chat-user-display-name__name"],[12],[1,[30,1,["name"]]],[13],[1,"\\n"]],[]],null],[13]],["@user"],false,["if","concat-class","unless"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-user-display-name.hbs",isStrictMode:!1})
let c=e.default=(s=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="siteSettings",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get shouldPrioritizeNameInUx(){return!this.siteSettings.prioritize_username_in_ux}get hasValidName(){return this.args.user?.name&&this.args.user.name.trim().length>0}get formattedUsername(){return(0,r.formatUsername)(this.args.user?.username)}get shouldShowNameFirst(){return this.shouldPrioritizeNameInUx&&this.hasValidName}get shouldShowNameLast(){return!this.shouldPrioritizeNameInUx&&this.hasValidName}},u=s.prototype,d="siteSettings",h=[n.inject],p={configurable:!0,enumerable:!0,writable:!0,initializer:null},b={},Object.keys(p).forEach((function(e){b[e]=p[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=h.slice().reverse().reduce((function(e,t){return t(u,d,e)||e}),b),m&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(m):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(u,d,b),b=null),o=b,s)
var u,d,h,p,m,b;(0,t.setComponentTemplate)(l,c)})),define("discourse/plugins/chat/discourse/components/chat-user-info",["exports","@glimmer/component","discourse/lib/url","discourse/plugins/chat/discourse/components/chat-user-avatar","discourse/plugins/chat/discourse/components/chat-user-display-name","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{get avatarSize(){return this.args.avatarSize??"medium"}get userPath(){return(0,i.userPath)(this.args.user.username)}}e.default=l,o=l,(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"YykWQzZj",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[10,3],[15,6,[30,0,["userPath"]]],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n        "],[8,[32,0],null,[["@user","@avatarSize"],[[30,1],[30,0,["avatarSize"]]]],null],[1,"\\n      "],[13],[1,"\\n      "],[10,3],[15,6,[30,0,["userPath"]]],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n        "],[8,[32,1],null,[["@user"],[[30,1]]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@user"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-user-info.js",scope:()=>[n.default,r.default],isStrictMode:!0}),o)})),define("discourse/plugins/chat/discourse/components/chat-vh",["exports","@ember/component","@ember/service","discourse-common/utils/decorators","discourse/plugins/chat/discourse/lib/zoom-check"],(function(e,t,i,n,r){"use strict"
var a,s,o
function l(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function c(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let d
e.default=(o=new WeakSet,a=class extends t.default{constructor(){var e,t,i,n
super(...arguments),l(this,o),e=this,t="capabilities",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),c(this,"tagName","")}didInsertElement(){this._super(...arguments),"virtualKeyboard"in navigator&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.addEventListener("geometrychange",this.setVH)),this.activeWindow=window.visualViewport||window,this.activeWindow.addEventListener("resize",this.setVH),this.setVH()}willDestroyElement(){this._super(...arguments),this.activeWindow?.removeEventListener("resize",this.setVH),d=null,"virtualKeyboard"in navigator&&navigator.virtualKeyboard.removeEventListener("geometrychange",this.setVH)}setVH(){if((0,r.default)())return
let e
e="virtualKeyboard"in navigator?window.visualViewport.height-navigator.virtualKeyboard.boundingRect.height:this.activeWindow?.height||window.innerHeight
const t=.01*e
d!==t&&(d=t,document.documentElement.style.setProperty("--chat-vh",`${t}px`))}},s=u(a.prototype,"capabilities",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(a.prototype,"setVH",[n.bind],Object.getOwnPropertyDescriptor(a.prototype,"setVH"),a.prototype),a)})),define("discourse/plugins/chat/discourse/components/chat/admin/export-messages",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/lib/ajax-error","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,o.createTemplateFactory)({id:"wUXHHyUe",block:'[[[10,"section"],[14,0,"admin-section"],[12],[1,"\\n  "],[10,"h3"],[12],[1,[28,[35,0],["chat.admin.export_messages.title"],null]],[13],[1,"\\n  "],[10,2],[12],[1,[28,[35,0],["chat.admin.export_messages.description"],null]],[13],[1,"\\n  "],[8,[39,1],[[24,0,"btn-primary"]],[["@label","@title","@action"],["chat.admin.export_messages.create_export","chat.admin.export_messages.create_export",[30,0,["exportMessages"]]]],null],[1,"\\n"],[13]],[],false,["i18n","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/admin/export-messages.hbs",isStrictMode:!1})
let m=e.default=(l=class extends i.default{constructor(){super(...arguments),d(this,"chatAdminApi",c,this),d(this,"dialog",u,this)}async exportMessages(){try{await this.chatAdminApi.exportMessages(),this.dialog.alert(s.default.t("chat.admin.export_messages.export_has_started"))}catch(e){(0,a.popupAjaxError)(e)}}},c=h(l.prototype,"chatAdminApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(l.prototype,"dialog",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(l.prototype,"exportMessages",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"exportMessages"),l.prototype),l);(0,t.setComponentTemplate)(p,m)})),define("discourse/plugins/chat/discourse/components/chat/composer/button",["exports","@ember/component","@glimmer/component","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"UWG6Qkfs",block:'[[[10,0],[14,0,"chat-composer-button__wrapper"],[12],[1,"\\n  "],[11,"button"],[24,4,"button"],[24,0,"chat-composer-button"],[17,1],[12],[1,"\\n    "],[1,[28,[35,0],[[30,2]],null]],[1,"\\n  "],[13],[1,"\\n"],[13]],["&attrs","@icon"],false,["d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/composer/button.hbs",isStrictMode:!1})
class a extends i.default{}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/chat/composer/channel",["exports","@ember/object","@ember/service","discourse-common/lib/debounce","discourse-i18n","discourse/plugins/chat/discourse/components/chat-composer"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function g(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(s=(0,i.inject)("chat-channel-composer"),o=(0,i.inject)("chat-channel-pane"),p=new WeakSet,l=class extends a.default{constructor(){super(...arguments),b(this,p),m(this,"composer",c,this),m(this,"pane",u,this),m(this,"chatDraftsManager",d,this),m(this,"currentUser",h,this),g(this,"context","channel"),g(this,"composerId","channel-composer")}get shouldRenderReplyingIndicator(){return this.args.channel}get presenceChannelName(){return`/chat-reply/${this.args.channel.id}`}get disabled(){return!this.chat.userCanInteractWithChat||!this.args.channel.canModifyMessages(this.currentUser)}reset(){this.composer.reset(this.args.channel)}persistDraft(){this.chatDraftsManager.add(this.currentMessage),this._persistHandler=(0,n.default)(this,this._debouncedPersistDraft,this.args.channel.id,this.currentMessage.toJSONDraft(),2e3)}_debouncedPersistDraft(e,t){this.chatApi.saveDraft(e,t).then((()=>{this.currentMessage&&(this.currentMessage.draftSaved=!0)}))}get lastMessage(){return this.args.channel.lastMessage}lastUserMessage(e){return this.args.channel.messagesManager.findLastUserMessage(e)}get placeholder(){return this.args.channel.canModifyMessages(this.currentUser)?this.chat.userCanInteractWithChat?function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,p,v).call(this,this.args.channel):r.default.t("chat.placeholder_silenced"):r.default.t(`chat.placeholder_new_message_disallowed.${this.args.channel.status}`)}handleEscape(e){e.stopPropagation(),this.currentMessage?.inReplyTo?this.reset():this.currentMessage?.editing?this.composer.cancel(this.args.channel):e.target.blur()}},c=f(l.prototype,"composer",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=f(l.prototype,"pane",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=f(l.prototype,"chatDraftsManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=f(l.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(l.prototype,"reset",[t.action],Object.getOwnPropertyDescriptor(l.prototype,"reset"),l.prototype),f(l.prototype,"persistDraft",[t.action],Object.getOwnPropertyDescriptor(l.prototype,"persistDraft"),l.prototype),f(l.prototype,"_debouncedPersistDraft",[t.action],Object.getOwnPropertyDescriptor(l.prototype,"_debouncedPersistDraft"),l.prototype),l)
function v(e){if(e.isDirectMessageChannel){const t=e.chatable.users
return 1===t.length&&t[0].id===this.currentUser.id?r.default.t("chat.placeholder_self"):r.default.t("chat.placeholder_users",{commaSeparatedNames:t.map((e=>e.name||`@${e.username}`)).join(r.default.t("word_connector.comma"))})}return r.default.t("chat.placeholder_channel",{channelName:`#${e.title}`})}})),define("discourse/plugins/chat/discourse/components/chat/composer/separator",["exports","@ember/component","@glimmer/component","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"eEB+qb1x",block:'[[[10,0],[14,0,"chat-composer-separator"],[12],[13]],[],false,[]]',moduleName:"discourse/plugins/chat/discourse/components/chat/composer/separator.hbs",isStrictMode:!1})
class a extends i.default{}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/chat/composer/thread",["exports","@ember/object","@ember/service","discourse-i18n","discourse/plugins/chat/discourse/components/chat-composer"],(function(e,t,i,n,r){"use strict"
var a,s,o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(a=(0,i.inject)("chat-channel-composer"),s=(0,i.inject)("chat-thread-composer"),o=(0,i.inject)("chat-thread-pane"),l=class extends r.default{constructor(){super(...arguments),p(this,"channelComposer",c,this),p(this,"composer",u,this),p(this,"pane",d,this),p(this,"currentUser",h,this),m(this,"context","thread"),m(this,"composerId","thread-composer")}reset(){this.composer.reset(this.args.thread)}get shouldRenderReplyingIndicator(){return this.args.thread}get disabled(){return!this.chat.userCanInteractWithChat||!this.args.thread.channel.canModifyMessages(this.currentUser)}get presenceChannelName(){const e=this.args.thread
return`/chat-reply/${e.channel.id}/thread/${e.id}`}get placeholder(){return n.default.t("chat.placeholder_thread")}lastUserMessage(e){return this.args.thread.messagesManager.findLastUserMessage(e)}handleEscape(e){if(this.currentMessage.editing)return e.stopPropagation(),void this.composer.cancel(this.args.thread)
this.isFocused?(e.stopPropagation(),this.composer.blur()):this.pane.close().then((()=>{this.channelComposer.focus()}))}},c=b(l.prototype,"channelComposer",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=b(l.prototype,"composer",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=b(l.prototype,"pane",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=b(l.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b(l.prototype,"reset",[t.action],Object.getOwnPropertyDescriptor(l.prototype,"reset"),l.prototype),l)})),define("discourse/plugins/chat/discourse/components/chat/form",["exports","@glimmer/component","discourse/plugins/chat/discourse/components/chat/form/section","@ember/template-factory","@ember/component"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{get yieldableArgs(){return{section:i.default}}}e.default=s,a=s,(0,r.setComponentTemplate)((0,n.createTemplateFactory)({id:"Q+UnUyWk",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-form"],[12],[1,"\\n      "],[18,1,[[30,0,["yieldableArgs"]]]],[1,"\\n    "],[13],[1,"\\n  "]],["&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/form.js",isStrictMode:!0}),a)})),define("discourse/plugins/chat/discourse/components/chat/form/row",["exports","@glimmer/component","@ember/routing","discourse/helpers/concat-class","discourse-common/helpers/d-icon","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{}e.default=l,o=l,(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"JLwxJyGF",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[8,[32,0],[[16,0,[28,[32,1],["chat-form__row -link",[52,[30,2],"-separator"]],null]]],[["@route","@models"],[[30,1],[30,3]]],[["default"],[[[[1,"\\n        "],[10,0],[14,0,"chat-form__row-content"],[12],[1,"\\n          "],[1,[30,4]],[1,"\\n          "],[1,[28,[32,2],["chevron-right"],[["class"],["chat-form__row-icon"]]]],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],[[[1,"      "],[10,0],[15,0,[28,[32,1],["chat-form__row",[52,[30,2],"-separator"]],null]],[12],[1,"\\n        "],[10,0],[14,0,"chat-form__row-content"],[12],[1,"\\n"],[41,[30,4],[[[1,"            "],[10,1],[14,0,"chat-form__row-label"],[12],[1,[30,4]],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[48,[30,5]],[[[1,"            "],[10,1],[14,0,"chat-form__row-label"],[12],[1,"\\n              "],[18,5,null],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[48,[30,6]],[[[1,"            "],[10,0],[14,0,"chat-form__row-action"],[12],[18,6,null],[13],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n\\n"],[41,[48,[30,7]],[[[1,"          "],[10,0],[14,0,"chat-form__row-description"],[12],[1,"\\n            "],[18,7,null],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]]],[1,"  "]],["@route","@separator","@routeModels","@label","&default","&action","&description"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/form/row.js",scope:()=>[i.LinkTo,n.default,r.default],isStrictMode:!0}),o)})),define("discourse/plugins/chat/discourse/components/chat/form/section",["exports","@glimmer/component","discourse/plugins/chat/discourse/components/chat/form/row","@ember/template-factory","@ember/component"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{get yieldableArgs(){return{row:i.default}}}e.default=s,a=s,(0,r.setComponentTemplate)((0,n.createTemplateFactory)({id:"/xrcZgND",block:'[[[1,"\\n    "],[11,0],[24,0,"chat-form__section"],[17,1],[12],[1,"\\n"],[41,[30,2],[[[1,"        "],[10,0],[14,0,"chat-form__section-title"],[12],[1,"\\n          "],[1,[30,2]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[10,0],[14,0,"chat-form__section-content"],[12],[1,"\\n        "],[18,3,[[30,0,["yieldableArgs"]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["&attrs","@title","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/form/section.js",isStrictMode:!0}),a)})),define("discourse/plugins/chat/discourse/components/chat/header/icon",["exports","@glimmer/component","@ember/service","discourse/helpers/concat-class","discourse-common/helpers/d-icon","discourse-common/lib/get-url","discourse-i18n","discourse/plugins/chat/discourse/components/chat/header/icon/unread-indicator","discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(g=class extends t.default{constructor(){super(...arguments),f(this,"currentUser",h,this),f(this,"site",p,this),f(this,"chatStateManager",m,this),f(this,"router",b,this)}get showUnreadIndicator(){return(!this.chatStateManager.isFullPageActive||!this.site.desktopView)&&!this.currentUserInDnD}get currentUserInDnD(){return this.args.currentUserInDnD||this.currentUser.isInDoNotDisturb()}get chatSeparateSidebarMode(){return(0,l.getUserChatSeparateSidebarMode)(this.currentUser)}get isActive(){return this.args.isActive||this.chatStateManager.isFullPageActive||this.chatStateManager.isDrawerActive}get title(){return!this.chatStateManager.isFullPageActive||this.chatSeparateSidebarMode.never||this.site.mobileView?s.default.t("chat.title_capitalized"):s.default.t("sidebar.panels.forum.label")}get icon(){return!this.chatStateManager.isFullPageActive||this.chatSeparateSidebarMode.never||this.site.mobileView?"d-chat":"random"}get href(){return this.site.mobileView&&this.chatStateManager.isFullPageActive?(0,a.default)("/chat"):this.chatStateManager.isFullPageActive&&!this.chatSeparateSidebarMode.never?(0,a.default)(this.chatStateManager.lastKnownAppURL||"/"):this.chatStateManager.isDrawerActive?(0,a.default)("/chat"):(0,a.default)(this.chatStateManager.lastKnownChatURL||"/chat")}},(0,u.setComponentTemplate)((0,c.createTemplateFactory)({id:"lQkZgVeM",block:'[[[1,"\\n    "],[10,3],[15,6,[30,0,["href"]]],[14,"tabindex","0"],[15,0,[28,[32,0],["icon","btn-flat",[52,[30,0,["isActive"]],"active"]],null]],[15,"title",[30,0,["title"]]],[12],[1,[28,[32,1],[[30,0,["icon"]]],null]],[41,[30,0,["showUnreadIndicator"]],[[[1,"        "],[8,[32,2],null,[["@urgentCount","@unreadCount","@indicatorPreference"],[[30,1],[30,2],[30,3]]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@urgentCount","@unreadCount","@indicatorPreference"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/header/icon.js",scope:()=>[n.default,r.default,o.default],isStrictMode:!0}),g),h=v((d=g).prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=v(d.prototype,"site",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=v(d.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=v(d.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d)})),define("discourse/plugins/chat/discourse/components/chat/header/icon/unread-indicator",["exports","@glimmer/component","@ember/service","discourse/plugins/chat/discourse/controllers/preferences-chat","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function p(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=new WeakSet,c=class extends t.default{constructor(){super(...arguments),h(this,u),d(this,"chatTrackingStateManager",o,this),d(this,"currentUser",l,this)}get urgentCount(){return this.args.urgentCount||this.chatTrackingStateManager.allChannelUrgentCount}get mentionCount(){return this.args.mentionCount||this.chatTrackingStateManager.allChannelMentionCount}get unreadCount(){return this.args.unreadCount||this.chatTrackingStateManager.publicChannelUnreadCount}get indicatorPreference(){return this.args.indicatorPreference||this.currentUser.user_option.chat_header_indicator_preference}get showUrgentIndicator(){return this.onlyMentions?this.mentionCount>0:this.urgentCount>0&&p(this,u,b).call(this,[n.HEADER_INDICATOR_PREFERENCE_ALL_NEW,n.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS])}get showUnreadIndicator(){return this.unreadCount>0&&p(this,u,b).call(this,[n.HEADER_INDICATOR_PREFERENCE_ALL_NEW])}get urgentCountLabel(){let e=this.onlyMentions?this.mentionCount:this.urgentCount
return e>99?"99+":e}get onlyMentions(){return p(this,u,b).call(this,[n.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS])}},(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"ZelwfVyf",block:'[[[1,"\\n"],[41,[30,0,["showUrgentIndicator"]],[[[1,"      "],[10,0],[14,0,"chat-channel-unread-indicator -urgent"],[12],[1,"\\n        "],[10,0],[14,0,"chat-channel-unread-indicator__number"],[12],[1,"\\n          "],[1,[30,0,["urgentCountLabel"]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[30,0,["showUnreadIndicator"]],[[[1,"      "],[10,0],[14,0,"chat-channel-unread-indicator"],[12],[13],[1,"\\n    "]],[]],null]],[]]],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/header/icon/unread-indicator.js",isStrictMode:!0}),c),o=m((s=c).prototype,"chatTrackingStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=m(s.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s)
function b(e){return!(!this.currentUser||this.indicatorPreference===n.HEADER_INDICATOR_PREFERENCE_NEVER)&&e.includes(this.indicatorPreference)}})),define("discourse/plugins/chat/discourse/components/chat/message-creator",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/application","@ember/object","@ember/runloop","@ember/service","@ember/template","@ember-compat/tracked-built-ins","discourse/lib/utilities","discourse-common/config/environment","discourse-common/lib/debounce","discourse-i18n","discourse/plugins/chat/discourse/models/chat-chatable","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b){"use strict"
var g,f,v,y,w,_,j,M,z,k,C,O,S,P,T,E,x,D,A,I,U,L,N,R,F,W,B,H,$,V,q,K,G,J,Y,Z,X
function Q(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ee(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function te(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function ie(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const ne=(0,b.createTemplateFactory)({id:"2/zTAMN2",block:'[[[10,0],[14,0,"chat-message-creator__container"],[12],[1,"\\n  "],[10,0],[14,0,"chat-message-creator"],[12],[1,"\\n    "],[11,0],[24,0,"chat-message-creator__selection-container"],[17,1],[4,[38,0],[[30,0,["focusInput"]]],null],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__selection"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-creator__search-icon-container"],[12],[1,"\\n          "],[1,[28,[35,1],["search"],[["class"],["chat-message-creator__search-icon"]]]],[1,"\\n        "],[13],[1,"\\n\\n"],[42,[28,[37,3],[[28,[37,3],[[30,0,["selection"]]],null]],null],null,[[[1,"          "],[11,0],[16,0,[28,[37,4],["chat-message-creator__selection-item",[28,[37,5],["-",[30,2,["type"]]],null],[52,[28,[37,7],[[30,0,["activeSelectionIdentifiers"]],[30,2,["identifier"]]],null],"-active"]],null]],[24,"tabindex","-1"],[16,"data-id",[30,2,["identifier"]]],[4,[38,8],["click",[28,[37,9],[[30,0,["removeSelection"]],[30,2,["identifier"]]],null]],null],[12],[1,"\\n            "],[46,[28,[37,5],["chat/message-creator/",[30,2,["type"]],"-selection"],null],null,[["selection"],[[30,2]]],null],[1,"\\n            "],[10,"i"],[14,0,"chat-message-creator__selection__remove-btn"],[14,"aria-hidden","true"],[12],[1,"\\n              "],[1,[28,[35,1],["times"],null]],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[2]],null],[1,"\\n        "],[8,[39,11],[[24,0,"chat-message-creator__input"],[16,"placeholder",[30,0,["placeholder"]]],[4,[38,0],[[30,0,["setQueryElement"]]],null],[4,[38,8],["input",[30,0,["handleInput"]]],null],[4,[38,8],["keydown",[30,0,["handleKeydown"]]],null]],[["@value","@type"],[[28,[37,12],[[30,0,["query"]]],null],"text"]],null],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,13],[[24,0,"chat-message-creator__close-btn btn-flat"]],[["@icon","@action"],["times",[30,3]]],null],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,0,["showResults"]],[[[1,"      "],[10,0],[14,0,"chat-message-creator__content-container"],[14,"role","presentation"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-creator__content"],[14,"role","listbox"],[14,"aria-multiselectable","true"],[14,"tabindex","-1"],[12],[1,"\\n"],[41,[30,0,["searchRequest","loading"]],[[[1,"            "],[10,0],[14,0,"chat-message-creator__loader-container"],[12],[1,"\\n              "],[10,0],[14,0,"chat-message-creator__loader spinner small"],[12],[13],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[42,[28,[37,3],[[28,[37,3],[[30,0,["searchRequest","value"]]],null]],null],null,[[[1,"              "],[11,0],[16,0,[28,[37,4],["chat-message-creator__row",[28,[37,5],["-",[30,4,["type"]]],null],[52,[51,[30,4,["enabled"]]],"-disabled"],[52,[28,[37,15],[[30,0,["activeResultIdentifier"]],[30,4,["identifier"]]],null],"-active"],[52,[28,[37,7],[[30,0,["selectionIdentifiers"]],[30,4,["identifier"]]],null],"-selected"]],null]],[16,"data-id",[30,4,["identifier"]]],[24,"tabindex","-1"],[24,"role","option"],[16,"aria-selected",[52,[28,[37,7],[[30,0,["selectionIdentifiers"]],[30,4,["identifier"]]],null],"true","false"]],[4,[38,8],["click",[28,[37,9],[[30,0,["handleRowClick"]],[30,4,["identifier"]]],null]],null],[4,[38,8],["mousemove",[28,[37,9],[[28,[37,16],[[30,0,["activeResult"]]],null],[30,4]],null]],null],[4,[38,8],["keydown",[30,0,["handleKeydown"]]],null],[12],[1,"\\n                "],[46,[28,[37,5],["chat/message-creator/",[30,4,["type"]],"-row"],null],null,[["content","selected","active","hasSelectedUsers"],[[30,4],[28,[37,7],[[30,0,["selectionIdentifiers"]],[30,4,["identifier"]]],null],[28,[37,15],[[30,0,["activeResultIdentifier"]],[30,4,["identifier"]]],null],[30,0,["hasSelectedUsers"]]]],null],[1,"\\n              "],[13],[1,"\\n"]],[4]],[[[41,[30,0,["query","length"]],[[[1,"                "],[10,0],[14,0,"chat-message-creator__no-items-container"],[12],[1,"\\n                  "],[10,1],[14,0,"chat-message-creator__no-items"],[12],[1,"\\n                    "],[1,[28,[35,17],["chat.new_message_modal.no_items"],null]],[1,"\\n                  "],[13],[1,"\\n                "],[13],[1,"\\n"]],[]],null]],[]]]],[]]],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["showFooter"]],[[[1,"      "],[10,0],[14,0,"chat-message-creator__footer-container"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-creator__footer"],[12],[1,"\\n"],[41,[30,0,["showShortcut"]],[[[1,"            "],[10,0],[14,0,"chat-message-creator__shortcut"],[12],[1,"\\n              "],[1,[30,0,["shortcutLabel"]]],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["hasSelectedUsers"]],[[[1,"            "],[8,[39,13],[[24,0,"chat-message-creator__open-dm-btn btn-primary"]],[["@action","@translatedLabel"],[[28,[37,9],[[30,0,["openChannel"]],[30,0,["selection"]]],null],[30,0,["openChannelLabel"]]]],null],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"],[13]],["&attrs","selection","@onClose","result"],false,["did-insert","d-icon","each","-track-array","concat-class","concat","if","includes","on","fn","component","input","readonly","d-button","unless","eq","mut","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message-creator.hbs",isStrictMode:!1}),re="channel",ae="user"
let se=(g=(0,o.inject)("chat-api"),z=new WeakSet,k=new WeakSet,f=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
ee(this,k),ee(this,z),Q(this,"api",v,this),Q(this,"chat",y,this),Q(this,"chatChannelsManager",w,this),Q(this,"loading",_,this),Q(this,"value",j,this),Q(this,"query",M,this),(0,r.setOwner)(this,e),t.preload??=!1,t.onlyUsers??=!1,(t.term||t.preload)&&(t.term||!t.preload?(this.loading=!0,this.api.chatables({term:t.term}).then((e=>{let i=[...e.users,...e.direct_message_channels,...e.category_channels]
t.excludeUserId&&(i=i.filter((e=>e.identifier!==`u-${t.excludeUserId}`))),this.value=i.map((e=>{const t=m.default.create(e)
return t.tracking=te(this,k,le).call(this,t),t})).slice(0,10)})).catch((()=>this.value=[])).finally((()=>this.loading=!1))):this.value=te(this,z,oe).call(this))}},v=ie(f.prototype,"api",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=ie(f.prototype,"chat",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=ie(f.prototype,"chatChannelsManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=ie(f.prototype,"loading",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=ie(f.prototype,"value",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=ie(f.prototype,"query",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f)
function oe(){return this.chatChannelsManager.allChannels.map((e=>{let t
return 1===e.chatable?.users?.length?(t=m.default.createUser(e.chatable.users[0]),t.tracking=te(this,k,le).call(this,t)):(t=m.default.createChannel(e),t.tracking=e.tracking),t})).filter(Boolean).slice(0,10)}function le(e){switch(e.type){case re:return this.chatChannelsManager.allChannels.find((t=>t.id===e.model.id))?.tracking
case ae:return this.chatChannelsManager.directMessageChannels.find((t=>1===t.chatable.users.length&&t.chatable.users[0].id===e.model.id))?.tracking}}let ce=e.default=(C=(0,o.inject)("chat-api"),O=(0,o.inject)("chat-channel-composer"),$=new WeakSet,V=new WeakSet,q=new WeakSet,K=new WeakSet,G=new WeakSet,J=new WeakSet,Y=new WeakSet,Z=new WeakSet,X=new WeakSet,S=class extends i.default{constructor(){super(...arguments),ee(this,X),ee(this,Z),ee(this,Y),ee(this,J),ee(this,G),ee(this,K),ee(this,q),ee(this,V),ee(this,$),Q(this,"api",P,this),Q(this,"composer",T,this),Q(this,"chat",E,this),Q(this,"site",x,this),Q(this,"router",D,this),Q(this,"currentUser",A,this),Q(this,"siteSettings",I,this),Q(this,"selection",U,this),Q(this,"activeSelection",L,this),Q(this,"query",N,this),Q(this,"queryElement",R,this),Q(this,"loading",F,this),Q(this,"activeSelectionIdentifiers",W,this),Q(this,"selectedIdentifiers",B,this),Q(this,"_activeResultIdentifier",H,this)}get placeholder(){return this.siteSettings.enable_public_channels&&this.chat.userCanDirectMessage?this.hasSelectedUsers?p.default.t("chat.new_message_modal.user_search_placeholder"):p.default.t("chat.new_message_modal.default_search_placeholder"):this.siteSettings.enable_public_channels?p.default.t("chat.new_message_modal.default_channel_search_placeholder"):this.chat.userCanDirectMessage?this.hasSelectedUsers?p.default.t("chat.new_message_modal.user_search_placeholder"):p.default.t("chat.new_message_modal.default_user_search_placeholder"):void 0}get showFooter(){return this.showShortcut||this.hasSelectedUsers}get showResults(){return!(this.hasSelectedUsers&&!this.query.length)}get shortcutLabel(){let e
return e=this.activeResult?.isUser?this.activeResult.model.username:this.activeResult.model.chatable.users[0].username,(0,l.htmlSafe)(p.default.t("chat.new_message_modal.add_user_long",{username:(0,u.escapeExpression)(e)}))}get showShortcut(){return!this.hasSelectedUsers&&this.searchRequest?.value?.length&&this.site.desktopView&&(this.activeResult?.isUser||this.activeResult?.isSingleUserChannel)}get activeResultIdentifier(){return this._activeResultIdentifier||this.searchRequest.value.find((e=>e.enabled))?.identifier}get hasSelectedUsers(){return this.selection.some((e=>e.isUser))}get activeResult(){return this.searchRequest.value.findBy("identifier",this.activeResultIdentifier)}set activeResult(e){e?.enabled&&(this._activeResultIdentifier=e?.identifier)}get selectionIdentifiers(){return this.selection.mapBy("identifier")}get openChannelLabel(){const e=this.selection.mapBy("model")
return p.default.t("chat.placeholder_users",{commaSeparatedNames:e.map((e=>e.name||e.username)).join(p.default.t("word_connector.comma"))})}get searchRequest(){let e=this.query
return e?.length&&(this.hasSelectedUsers&&e.startsWith("#")&&(e=e.replace(/^#/,"@")),this.hasSelectedUsers&&!e.startsWith("@")&&(e="@"+e)),new se((0,r.getOwner)(this),{term:e,preload:!this.selection?.length,onlyUsers:this.hasSelectedUsers,excludeUserId:this.hasSelectedUsers?this.currentUser?.id:null})}onFilter(e){this._activeResultIdentifier=null,this.activeSelectionIdentifiers=[],this.query=e}setQueryElement(e){this.queryElement=e}focusInput(){(0,s.schedule)("afterRender",(()=>{this.queryElement.focus()}))}handleKeydown(e){if("Escape"===e.key&&this.activeSelectionIdentifiers.length>0)return this.activeSelectionIdentifiers=[],e.preventDefault(),void e.stopPropagation()
if("a"===e.key&&(e.metaKey||e.ctrlKey))return void(this.activeSelectionIdentifiers=this.selection.mapBy("identifier"))
if("Enter"===e.key){if(this.activeSelectionIdentifiers.length>0)return this.activeSelectionIdentifiers.forEach((e=>{this.removeSelection(e)})),this.activeSelectionIdentifiers=[],void e.preventDefault()
if(this.activeResultIdentifier)return this.toggleSelection(this.activeResultIdentifier,{altSelection:e.shiftKey||e.ctrlKey}),void e.preventDefault()
if(0===this.query?.length)return this.openChannel(this.selection),void e.preventDefault()}if("ArrowDown"===e.key&&this.searchRequest.value.length>0)return this.activeSelectionIdentifiers=[],this._activeResultIdentifier=te(this,J,be).call(this)?.identifier,void e.preventDefault()
if("ArrowUp"===e.key&&this.searchRequest.value.length>0)return this.activeSelectionIdentifiers=[],this._activeResultIdentifier=te(this,G,me).call(this)?.identifier,void e.preventDefault()
const t=te(this,X,ve).call(this,e.code)
return e.ctrlKey&&t?(this._activeResultIdentifier=this.searchRequest.value.objectAt(t-1)?.identifier,void e.preventDefault()):0===e.target.selectionEnd&&0===e.target.selectionStart?"Backspace"===e.key&&this.selection.length?this.activeSelectionIdentifiers.length?(this.activeSelectionIdentifiers.forEach((e=>{this.removeSelection(e)})),this.activeSelectionIdentifiers=[],void e.preventDefault()):(this.activeSelectionIdentifiers=[te(this,K,pe).call(this).identifier],void e.preventDefault()):"ArrowLeft"!==e.key||e.shiftKey?"ArrowRight"!==e.key||e.shiftKey?void 0:(this._activeResultIdentifier=null,this.activeSelectionIdentifiers=[te(this,q,he).call(this)?.identifier].filter(Boolean),void e.preventDefault()):(this._activeResultIdentifier=null,this.activeSelectionIdentifiers=[te(this,V,de).call(this)?.identifier].filter(Boolean),void e.preventDefault()):void 0}replaceActiveSelection(e){this.activeSelection.clear(),this.activeSelection.push(e.identifier)}handleInput(e){(0,h.default)(this,this.onFilter,e.target.value,d.INPUT_DELAY)}toggleSelection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
this.selectionIdentifiers.includes(e)?this.removeSelection(e,t):this.addSelection(e,t),this.focusInput()}handleRowClick(e,t){this.toggleSelection(e,{altSelection:t.shiftKey||t.ctrlKey}),t.preventDefault()}removeSelection(e){this.selection=this.selection.filter((t=>t.identifier!==e)),te(this,$,ue).call(this)}addSelection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.searchRequest.value.findBy("identifier",e)
if(i&&i.enabled)if(i.type!==re||i.isSingleUserChannel)if(this.hasSelectedUsers||t.altSelection||this.site.mobileView){if(i.isSingleUserChannel){const e=i.model.chatable.users[0]
i=new m.default({identifier:`u-${e.id}`,type:ae,model:e})}this.selection=[...this.selection.filter((e=>e.type!==re)),i],te(this,$,ue).call(this)}else this.openChannel([i])
else this.openChannel([i])}openChannel(e){if(1===e.length&&e[0].type===re){const t=e[0].model
return this.router.transitionTo("chat.channel",...t.routeModels),void this.args.onClose?.()}const t=e.filterBy("type",ae).mapBy("model")
this.chat.upsertDmChannelForUsernames(t.mapBy("username")).then((e=>{e&&(this.router.transitionTo("chat.channel",...e.routeModels),this.args.onClose?.())}))}},P=ie(S.prototype,"api",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=ie(S.prototype,"composer",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=ie(S.prototype,"chat",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=ie(S.prototype,"site",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=ie(S.prototype,"router",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=ie(S.prototype,"currentUser",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=ie(S.prototype,"siteSettings",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=ie(S.prototype,"selection",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c.TrackedArray}}),L=ie(S.prototype,"activeSelection",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c.TrackedArray}}),N=ie(S.prototype,"query",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),R=ie(S.prototype,"queryElement",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=ie(S.prototype,"loading",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),W=ie(S.prototype,"activeSelectionIdentifiers",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c.TrackedArray}}),B=ie(S.prototype,"selectedIdentifiers",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=ie(S.prototype,"_activeResultIdentifier",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie(S.prototype,"searchRequest",[n.cached],Object.getOwnPropertyDescriptor(S.prototype,"searchRequest"),S.prototype),ie(S.prototype,"onFilter",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"onFilter"),S.prototype),ie(S.prototype,"setQueryElement",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"setQueryElement"),S.prototype),ie(S.prototype,"focusInput",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"focusInput"),S.prototype),ie(S.prototype,"handleKeydown",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"handleKeydown"),S.prototype),ie(S.prototype,"replaceActiveSelection",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"replaceActiveSelection"),S.prototype),ie(S.prototype,"handleInput",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"handleInput"),S.prototype),ie(S.prototype,"toggleSelection",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"toggleSelection"),S.prototype),ie(S.prototype,"handleRowClick",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"handleRowClick"),S.prototype),ie(S.prototype,"removeSelection",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"removeSelection"),S.prototype),ie(S.prototype,"addSelection",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"addSelection"),S.prototype),ie(S.prototype,"openChannel",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"openChannel"),S.prototype),S)
function ue(){this.query="",this.activeSelectionIdentifiers=[],this._activeResultIdentifier=null}function de(){return te(this,Z,fe).call(this,this.selection,this.activeSelectionIdentifiers?.[0])}function he(){return te(this,Y,ge).call(this,this.selection,this.activeSelectionIdentifiers?.[0])}function pe(){return this.selection[this.selection.length-1]}function me(){return te(this,Z,fe).call(this,this.searchRequest.value,this.activeResultIdentifier)}function be(){return te(this,Y,ge).call(this,this.searchRequest.value,this.activeResultIdentifier)}function ge(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
if(0===e.length)return null
if(e=e.filterBy("enabled"),t){const i=e.mapBy("identifier").indexOf(t)
return i<e.length-1?e.objectAt(i+1):e[0]}return e[0]}function fe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
if(0===e.length)return null
if(e=e.filterBy("enabled"),t){const i=e.mapBy("identifier").indexOf(t)
return i>0?e.objectAt(i-1):e.objectAt(e.length-1)}return e.objectAt(e.length-1)}function ve(e){if("string"==typeof e){const t=e.match(/Digit(\d+)/)
if(t)return parseInt(t[1],10)}return!1}(0,t.setComponentTemplate)(ne,ce)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/channel-row",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s){"use strict"
var o,l
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,s.createTemplateFactory)({id:"1z+h1Cq0",block:'[[[8,[39,0],null,[["@channel"],[[30,1,["model"]]]],null],[1,"\\n\\n"],[41,[28,[37,2],[[30,1,["tracking","unreadCount"]],0],null],[[[1,"  "],[10,0],[15,0,[28,[37,3],["unread-indicator",[52,[30,0,["isUrgent"]],"-urgent"]],null]],[12],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"  "],[10,1],[14,0,"action-indicator"],[12],[1,[30,0,["openChannelLabel"]]],[13],[1,"\\n"]],[]],null]],["@content"],false,["chat-channel-title","if","gt","concat-class"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message-creator/channel-row.hbs",isStrictMode:!1})
let u=e.default=(o=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="site",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get openChannelLabel(){return(0,r.htmlSafe)(a.default.t("chat.new_message_modal.open_channel"))}get isUrgent(){return this.args.content.model.isDirectMessageChannel||this.args.content.model.isCategoryChannel&&this.args.content.model.tracking.mentionCount>0}},d=o.prototype,h="site",p=[n.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),l=g,o)
var d,h,p,m,b,g;(0,t.setComponentTemplate)(c,u)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/user-row",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,s.createTemplateFactory)({id:"gxqW91gC",block:'[[[8,[39,0],null,[["@user"],[[30,1,["model"]]]],null],[1,"\\n"],[8,[39,1],null,[["@user"],[[30,1,["model"]]]],null],[1,"\\n\\n"],[41,[28,[37,3],[[30,1,["tracking","unreadCount"]],0],null],[[[1,"  "],[10,0],[14,0,"unread-indicator -urgent"],[12],[13],[1,"\\n"]],[]],null],[1,"\\n"],[1,[28,[35,4],[[30,1,["model"]]],[["currentUser"],[[30,0,["currentUser"]]]]]],[1,"\\n\\n"],[41,[51,[30,1,["enabled"]]],[[[1,"  "],[10,1],[14,0,"disabled-text"],[12],[1,"\\n    "],[1,[28,[35,6],["chat.new_message_modal.disabled_user"],null]],[1,"\\n  "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,2],[[[41,[30,0,["site","mobileView"]],[[[1,"    "],[10,1],[14,0,"selection-indicator -add"],[12],[1,"\\n      "],[1,[28,[35,7],["check"],null]],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[1,"    "],[10,1],[15,0,[28,[37,8],["selection-indicator",[52,[30,3],"-remove","-add"]],null]],[12],[1,"\\n      "],[1,[28,[35,7],[[52,[30,3],"times","check"]],null]],[1,"\\n    "],[13],[1,"\\n"]],[]]]],[]],[[[41,[30,0,["site","desktopView"]],[[[41,[30,4],[[[1,"      "],[10,1],[14,0,"action-indicator"],[12],[1,[30,0,["addUserLabel"]]],[13],[1,"\\n"]],[]],[[[1,"      "],[10,1],[14,0,"action-indicator"],[12],[1,[30,0,["openChannelLabel"]]],[13],[1,"\\n"]],[]]]],[]],null]],[]]]],["@content","@selected","@active","@hasSelectedUsers"],false,["chat-user-avatar","chat-user-display-name","if","gt","user-status","unless","i18n","d-icon","concat-class"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message-creator/user-row.hbs",isStrictMode:!1})
let p=e.default=(o=class extends i.default{constructor(){super(...arguments),u(this,"currentUser",l,this),u(this,"site",c,this)}get openChannelLabel(){return(0,r.htmlSafe)(a.default.t("chat.new_message_modal.open_channel"))}get addUserLabel(){return(0,r.htmlSafe)(a.default.t("chat.new_message_modal.add_user_short"))}},l=d(o.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=d(o.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o);(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/user-selection",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"RENqX/aa",block:'[[[8,[39,0],null,[["@user","@showPresence"],[[30,1,["model"]],false]],null],[1,"\\n\\n"],[10,1],[14,0,"chat-message-creator__selection-item__username"],[12],[1,"\\n  "],[1,[30,1,["model","username"]]],[1,"\\n"],[13]],["@selection"],false,["chat-user-avatar"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message-creator/user-selection.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/chat/message/avatar",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"t5fi35wL",block:'[[[10,0],[14,0,"chat-message-avatar"],[12],[1,"\\n"],[41,[30,1,["chatWebhookEvent","emoji"]],[[[1,"    "],[8,[39,1],null,[["@emoji"],[[30,1,["chatWebhookEvent","emoji"]]]],null],[1,"\\n"]],[]],[[[1,"    "],[8,[39,2],null,[["@user","@avatarSize"],[[30,1,["user"]],"medium"]],null],[1,"\\n"]],[]]],[13]],["@message"],false,["if","chat-emoji-avatar","chat-user-avatar"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message/avatar.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/chat/message/error",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"Ut7WvhJu",block:'[[[41,[30,1,["error"]],[[[1,"  "],[10,0],[14,0,"chat-message-error"],[12],[1,"\\n"],[41,[28,[37,1],[[30,1,["error"]],"network_error"],null],[[[1,"      "],[8,[39,2],[[24,0,"chat-message-error__retry-btn"]],[["@action","@icon"],[[28,[37,3],[[30,2],[30,1]],null],"exclamation-circle"]],[["default"],[[[[1,"\\n        "],[10,1],[14,0,"chat-message-error__retry-btn-title"],[12],[1,"\\n          "],[1,[28,[35,4],["chat.retry_staged_message.title"],null]],[1,"\\n        "],[13],[1,"\\n        "],[10,1],[14,0,"chat-message-error__retry-btn-action"],[12],[1,"\\n          "],[1,[28,[35,4],["chat.retry_staged_message.action"],null]],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],[[[1,"      "],[1,[30,1,["error"]]],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"]],[]],null]],["@message","@onRetry"],false,["if","eq","d-button","fn","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message/error.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/chat/message/info",["exports","@ember/component","@glimmer/component","@ember/service","discourse/lib/settings","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function h(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,s.createTemplateFactory)({id:"gbE9+Tf/",block:'[[[41,[30,1],[[[1,"  "],[11,0],[24,0,"chat-message-info"],[4,[38,1],[[30,0,["trackStatus"]]],null],[4,[38,2],[[30,0,["stopTrackingStatus"]]],null],[12],[1,"\\n"],[41,[30,2,["chatWebhookEvent"]],[[[41,[30,2,["chatWebhookEvent","username"]],[[[1,"        "],[10,1],[15,0,[28,[37,3],["chat-message-info__username",[30,0,["usernameClasses"]]],null]],[12],[1,"\\n          "],[1,[30,2,["chatWebhookEvent","username"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[10,1],[14,0,"chat-message-info__bot-indicator"],[12],[1,"\\n        "],[1,[28,[35,4],["chat.bot"],null]],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,1],[14,"role","button"],[15,0,[28,[37,3],["chat-message-info__username",[30,0,["usernameClasses"]],"clickable"],null]],[15,"data-user-card",[30,2,["user","username"]]],[12],[1,"\\n        "],[10,1],[14,0,"chat-message-info__username__name"],[12],[1,[30,0,["name"]]],[13],[1,"\\n"],[41,[30,0,["showStatus"]],[[[1,"          "],[10,0],[14,0,"chat-message-info__status"],[12],[1,"\\n            "],[8,[39,5],null,[["@status"],[[30,2,["user","status"]]]],null],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]]],[1,"\\n    "],[10,1],[14,0,"chat-message-info__date"],[12],[1,"\\n      "],[1,[28,[35,6],[[30,2]],null]],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,2,["bookmark"]],[[[1,"      "],[10,1],[14,0,"chat-message-info__bookmark"],[12],[1,"\\n        "],[8,[39,7],null,[["@bookmark"],[[30,2,["bookmark"]]]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["isFlagged"]],[[[1,"      "],[10,1],[14,0,"chat-message-info__flag"],[12],[1,"\\n"],[41,[30,2,["reviewableId"]],[[[1,"          "],[8,[39,8],null,[["@route","@model"],["review.show",[30,2,["reviewableId"]]]],[["default"],[[[[1,"\\n            "],[1,[28,[35,9],["flag"],[["title"],["chat.flagged"]]]],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[35,9],["flag"],[["title"],["chat.you_flagged"]]]],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@show","@message"],false,["if","did-insert","will-destroy","concat-class","i18n","user-status-message","format-chat-date","bookmark-icon","link-to","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message/info.hbs",isStrictMode:!1})
let b=e.default=(c=new WeakMap,u=new WeakMap,o=class extends i.default{constructor(){var e,t,i,n
super(...arguments),d(this,u,{get:f,set:void 0}),d(this,c,{get:g,set:void 0}),e=this,t="siteSettings",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}trackStatus(){h(this,c)?.trackStatus?.()}stopTrackingStatus(){h(this,c)?.stopTrackingStatus?.()}get usernameClasses(){const e=h(this,c),t=this.prioritizeName?["is-full-name"]:["is-username"]
return e?(e.staff&&t.push("is-staff"),e.admin&&t.push("is-admin"),e.moderator&&t.push("is-moderator"),e.new_user&&t.push("is-new-user"),e.primary_group_name&&t.push("group--"+e.primary_group_name),t.join(" ")):t}get name(){return this.prioritizeName?h(this,c)?.get("name"):h(this,c)?.get("username")}get isFlagged(){return h(this,u)?.reviewableId||0===h(this,u)?.userFlagStatus}get prioritizeName(){return this.siteSettings.display_name_on_posts&&(0,r.prioritizeNameInUx)(h(this,c)?.get("name"))}get showStatus(){return!!h(this,c)?.get("status")}},l=p(o.prototype,"siteSettings",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(o.prototype,"trackStatus",[a.bind],Object.getOwnPropertyDescriptor(o.prototype,"trackStatus"),o.prototype),p(o.prototype,"stopTrackingStatus",[a.bind],Object.getOwnPropertyDescriptor(o.prototype,"stopTrackingStatus"),o.prototype),o)
function g(){return h(this,u)?.user}function f(){return this.args.message}(0,t.setComponentTemplate)(m,b)}))
define("discourse/plugins/chat/discourse/components/chat/message/left-gutter",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"aZfQa7lM",block:'[[[10,0],[14,0,"chat-message-left-gutter"],[12],[1,"\\n"],[41,[30,1,["reviewableId"]],[[[1,"    "],[8,[39,1],[[24,0,"chat-message-left-gutter__flag"]],[["@route","@model"],["review.show",[30,1,["reviewableId"]]]],[["default"],[[[[1,"\\n      "],[1,[28,[35,2],["flag"],[["title"],["chat.flagged"]]]],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],[[[41,[28,[37,3],[[30,1,["userFlagStatus"]],0],null],[[[1,"    "],[10,0],[14,0,"chat-message-left-gutter__flag"],[12],[1,"\\n      "],[1,[28,[35,2],["flag"],[["title"],["chat.you_flagged"]]]],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[41,[30,0,["site","desktopView"]],[[[1,"    "],[10,1],[14,0,"chat-message-left-gutter__date"],[12],[1,"\\n      "],[1,[28,[35,4],[[30,1],"tiny"],null]],[1,"\\n    "],[13],[1,"\\n  "]],[]],null]],[]]]],[]]],[41,[30,1,["bookmark"]],[[[1,"    "],[10,1],[14,0,"chat-message-left-gutter__bookmark"],[12],[1,"\\n      "],[8,[39,5],null,[["@bookmark"],[[30,1,["bookmark"]]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[13]],["@message"],false,["if","link-to","d-icon","eq","format-chat-date","bookmark-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message/left-gutter.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="site",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="site",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat/modal/archive-channel",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember/template","@ember/utils","discourse/lib/ajax-error","discourse-common/lib/later","discourse-i18n","discourse/plugins/chat/discourse/components/chat-to-topic-selector","discourse/plugins/chat/discourse/models/chat-channel","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g,f,v,y,w,_,j,M,z,k
function C(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function O(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function S(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const P=(0,p.createTemplateFactory)({id:"foIIvFQ7",block:'[[[8,[39,0],[[24,0,"chat-modal-archive-channel"]],[["@closeModal","@inline","@title","@flash","@flashType"],[[30,1],[30,2],[28,[37,1],["chat.channel_archive.title"],null],[30,0,["flash"]],[30,0,["flashType"]]]],[["body","footer"],[[[[1,"\\n    "],[10,2],[14,0,"chat-modal-archive-channel__instructions"],[12],[1,"\\n      "],[1,[30,0,["instructionsText"]]],[1,"\\n    "],[13],[1,"\\n    "],[8,[39,2],null,[["@selection","@topicTitle","@categoryId","@tags","@selectedTopicId","@instructionLabels","@allowNewMessage"],[[30,0,["selection"]],[30,0,["topicTitle"]],[30,0,["categoryId"]],[30,0,["tags"]],[30,0,["selectedTopicId"]],[30,0,["instructionLabels"]],false]],null],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,3],[[24,1,"chat-confirm-archive-channel"],[24,0,"btn-primary"]],[["@disabled","@action","@label"],[[30,0,["buttonDisabled"]],[30,0,["archiveChannel"]],"chat.channel_archive.title"]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","chat-to-topic-selector","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/archive-channel.hbs",isStrictMode:!1})
let T=e.default=(k=new WeakSet,m=class extends i.default{constructor(){super(...arguments),O(this,k),C(this,"chatApi",b,this),C(this,"siteSettings",g,this),C(this,"selection",f,this),C(this,"saving",v,this),C(this,"topicTitle",y,this),C(this,"categoryId",w,this),C(this,"tags",_,this),C(this,"selectedTopicId",j,this),C(this,"flash",M,this),C(this,"flashType",z,this)}get channel(){return this.args.model.channel}get newTopic(){return this.selection===d.NEW_TOPIC_SELECTION}get existingTopic(){return this.selection===d.EXISTING_TOPIC_SELECTION}get buttonDisabled(){return!!this.saving||(!(!this.newTopic||!(!this.topicTitle||this.topicTitle.length<this.siteSettings.min_topic_title_length||this.topicTitle.length>this.siteSettings.max_topic_title_length))||!(!this.existingTopic||!(0,o.isEmpty)(this.selectedTopicId)))}get instructionLabels(){const e={}
return e[d.NEW_TOPIC_SELECTION]=u.default.t("chat.selection.new_topic.instructions_channel_archive"),e[d.EXISTING_TOPIC_SELECTION]=u.default.t("chat.selection.existing_topic.instructions_channel_archive"),e}get instructionsText(){return(0,s.htmlSafe)(u.default.t("chat.channel_archive.instructions",{channelTitle:this.channel.escapedTitle}))}archiveChannel(){return this.saving=!0,this.chatApi.createChannelArchive(this.channel.id,function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,k,E).call(this)).then((()=>{this.flash=u.default.t("chat.channel_archive.process_started"),this.flashType="success",this.channel.status=h.CHANNEL_STATUSES.archived,(0,c.default)((()=>{this.args.closeModal()}),3e3)})).catch(l.popupAjaxError).finally((()=>this.saving=!1))}},b=S(m.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=S(m.prototype,"siteSettings",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=S(m.prototype,"selection",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return d.NEW_TOPIC_SELECTION}}),v=S(m.prototype,"saving",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=S(m.prototype,"topicTitle",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=S(m.prototype,"categoryId",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=S(m.prototype,"tags",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=S(m.prototype,"selectedTopicId",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=S(m.prototype,"flash",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=S(m.prototype,"flashType",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S(m.prototype,"archiveChannel",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"archiveChannel"),m.prototype),m)
function E(){const e={type:this.selection}
return this.newTopic&&(e.title=this.topicTitle,e.category_id=this.categoryId,e.tags=this.tags),this.existingTopic&&(e.topic_id=this.selectedTopicId),e}(0,t.setComponentTemplate)(P,T)})),define("discourse/plugins/chat/discourse/components/chat/modal/channel-summary",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/lib/ajax-error","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const f=(0,l.createTemplateFactory)({id:"k3KLu8u/",block:'[[[8,[39,0],[[24,0,"chat-modal-channel-summary"]],[["@closeModal","@title"],[[30,1],[28,[37,1],["chat.summarization.title"],null]]],[["body","footer"],[[[[1,"\\n    "],[10,1],[12],[1,[28,[35,1],["chat.summarization.description"],null]],[13],[1,"\\n    "],[8,[39,2],null,[["@value","@content","@onChange","@valueProperty","@class"],[[30,0,["sinceHours"]],[30,0,["sinceOptions"]],[30,0,["summarize"]],"value","summarization-since"]],null],[1,"\\n    "],[8,[39,3],null,[["@isLoading"],[[30,0,["loading"]]]],[["default"],[[[[1,"\\n      "],[10,2],[14,0,"summary-area"],[12],[1,[30,0,["summary"]]],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,4],null,[["@close"],[[30,1]]],null],[1,"\\n  "]],[]]]]]],["@closeModal"],false,["d-modal","i18n","combo-box","conditional-loading-section","d-modal-cancel"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/channel-summary.hbs",isStrictMode:!1})
let v=e.default=(c=class extends i.default{constructor(){super(...arguments),m(this,"chatApi",u,this),m(this,"sinceHours",d,this),m(this,"loading",h,this),m(this,"summary",p,this),b(this,"availableSummaries",{}),b(this,"sinceOptions",[1,3,6,12,24,72,168].map((e=>({name:o.default.t("chat.summarization.since",{count:e}),value:e}))))}get channelId(){return this.args.model.channelId}summarize(e){return this.sinceHours=e,this.loading=!0,this.availableSummaries[e]?(this.summary=this.availableSummaries[e],void(this.loading=!1)):this.chatApi.summarize(this.channelId,{since:e}).then((e=>{this.availableSummaries[this.sinceHours]=e.summary,this.summary=this.availableSummaries[this.sinceHours]})).catch(s.popupAjaxError).finally((()=>this.loading=!1))}},u=g(c.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=g(c.prototype,"sinceHours",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=g(c.prototype,"loading",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=g(c.prototype,"summary",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g(c.prototype,"summarize",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"summarize"),c.prototype),c);(0,t.setComponentTemplate)(f,v)})),define("discourse/plugins/chat/discourse/components/chat/modal/create-channel",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","@ember/template","@ember/utils","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/utilities","discourse-common/lib/debounce","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m){"use strict"
var b,g,f,v,y,w,_,j,M,z,k,C,O,S,P,T,E,x,D,A,I,U,L,N
function R(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function F(e,t){W(e,t),t.add(e)}function W(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function B(e,t,i){return function(e,t,i){if(t.set)t.set.call(e,i)
else{if(!t.writable)throw new TypeError("attempted to set read only private field")
t.value=i}}(e,V(e,t,"set"),i),i}function H(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function $(e,t){return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,V(e,t,"get"))}function V(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}function q(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const K=(0,m.createTemplateFactory)({id:"d48yUZBc",block:'[[[8,[39,0],[[24,0,"chat-modal-create-channel"],[4,[38,2],["submit",[30,0,["onSave"]]],null]],[["@closeModal","@inline","@title","@flash","@tagName"],[[30,1],[30,2],[28,[37,1],["chat.create_channel.title"],null],[30,0,["flash"]],"form"]],[["body","footer"],[[[[1,"\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -name"],[12],[1,"\\n      "],[10,"label"],[14,"for","name"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.name"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,3],[[24,3,"name"],[24,0,"chat-modal-create-channel__input"],[4,[38,2],["input",[28,[37,4],[[30,0],[30,0,["onNameChange"]]],[["value"],["target.value"]]]],null]],[["@type","@value"],["text",[30,0,["name"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -slug"],[12],[1,"\\n      "],[10,"label"],[14,"for","slug"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.slug"],null]],[1,"\\n        "],[10,1],[12],[1,"\\n          "],[1,[28,[35,5],["info-circle"],null]],[1,"\\n          "],[8,[39,6],null,null,[["default"],[[[[1,"\\n            "],[1,[28,[35,1],["chat.channel_edit_name_slug_modal.slug_description"],null]],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,3],[[24,3,"slug"],[24,0,"chat-modal-create-channel__input"],[16,"placeholder",[30,0,["autoGeneratedSlug"]]]],[["@type","@value"],["text",[30,0,["slug"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -description"],[12],[1,"\\n      "],[10,"label"],[14,"for","description"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.description"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,3],[[24,3,"description"],[24,0,"chat-modal-create-channel__input"]],[["@type","@value"],["textarea",[30,0,["description"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-modal-create-channel__control"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.choose_category.label"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,7],null,[["@value","@onChange","@options"],[[30,0,["categoryId"]],[28,[37,4],[[30,0],[30,0,["onCategoryChange"]]],null],[28,[37,8],null,[["formName","none"],["chatable_id","chat.create_channel.choose_category.none"]]]]],null],[1,"\\n\\n"],[41,[30,0,["categoryPermissionsHint"]],[[[1,"        "],[10,0],[15,0,[28,[37,10],["chat-modal-create-channel__hint",[52,[30,0,["loadingPermissionHint"]],"loading-permissions"]],null]],[12],[1,"\\n          "],[1,[30,0,["categoryPermissionsHint"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n\\n"],[41,[30,0,["autoJoinAvailable"]],[[[1,"      "],[10,0],[14,0,"chat-modal-create-channel__control -auto-join"],[12],[1,"\\n        "],[10,"label"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n          "],[8,[39,3],[[24,3,"auto_join_users"]],[["@type","@checked"],["checkbox",[30,0,["autoJoinUsers"]]]],null],[1,"\\n          "],[10,0],[14,0,"auto-join-channel"],[12],[1,"\\n            "],[10,1],[14,0,"chat-modal-create-channel__label-title"],[12],[1,"\\n              "],[1,[28,[35,1],["chat.settings.auto_join_users_label"],null]],[1,"\\n            "],[13],[1,"\\n            "],[10,2],[14,0,"chat-modal-create-channel__label-description"],[12],[1,"\\n"],[41,[30,0,["categoryName"]],[[[1,"                "],[1,[28,[35,1],["chat.settings.auto_join_users_info"],[["category"],[[30,0,["categoryName"]]]]]],[1,"\\n"]],[]],[[[1,"                "],[1,[28,[35,1],["chat.settings.auto_join_users_info_no_category"],null]],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -threading-toggle"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[8,[39,3],[[24,3,"threading_enabled"]],[["@type","@checked"],["checkbox",[30,0,["threadingEnabled"]]]],null],[1,"\\n        "],[10,0],[14,0,"threading-channel"],[12],[1,"\\n          "],[10,1],[14,0,"chat-modal-create-channel__label-title"],[12],[1,"\\n            "],[1,[28,[35,1],["chat.create_channel.threading.label"],null]],[1,"\\n          "],[13],[1,"\\n          "],[10,2],[14,0,"chat-modal-create-channel__label-description"],[12],[1,"\\n            "],[1,[28,[35,1],["chat.settings.channel_threading_description"],null]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[]],[[[1,"\\n    "],[10,"button"],[14,0,"btn btn-primary create"],[15,"disabled",[30,0,["createDisabled"]]],[14,4,"submit"],[12],[1,"\\n      "],[1,[28,[35,1],["chat.create_channel.create"],null]],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","on","input","action","d-icon","d-tooltip","category-chooser","hash","if","concat-class"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/create-channel.hbs",isStrictMode:!1}),G=(0,o.htmlSafe)(p.default.t("chat.create_channel.choose_category.default_hint",{link:"/categories",category:"category"}))
let J=e.default=(x=new WeakMap,D=new WeakSet,A=new WeakSet,I=new WeakSet,U=new WeakSet,L=new WeakSet,N=new WeakSet,b=class extends i.default{constructor(){var e,t,i
super(...arguments),F(this,N),F(this,L),F(this,U),F(this,I),F(this,A),F(this,D),R(this,"chat",g,this),R(this,"dialog",f,this),R(this,"chatChannelsManager",v,this),R(this,"chatApi",y,this),R(this,"router",w,this),R(this,"currentUser",_,this),R(this,"siteSettings",j,this),R(this,"site",M,this),R(this,"flash",z,this),R(this,"name",k,this),R(this,"category",C,this),R(this,"categoryId",O,this),R(this,"autoGeneratedSlug",S,this),R(this,"categoryPermissionsHint",P,this),R(this,"autoJoinWarning",T,this),R(this,"loadingPermissionHint",E,this),i={writable:!0,value:null},W(e=this,t=x),t.set(e,i)}willDestroy(){(0,a.cancel)($(this,x))}get autoJoinAvailable(){return this.siteSettings.max_chat_auto_joined_users>0}get categorySelected(){return(0,l.isPresent)(this.category)}get createDisabled(){return!this.categorySelected||(0,l.isBlank)(this.name)}get categoryName(){return this.categorySelected&&(0,l.isPresent)(this.name)?(0,d.escapeExpression)(this.name):null}onShow(){this.categoryPermissionsHint=G}onCategoryChange(e){const t=e?this.site.categories.findBy("id",e):null
H(this,U,Q).call(this,t)
const i=this.name||t?.name||""
this.categoryId=e,this.category=t,this.name=i,H(this,N,te).call(this,i)}onNameChange(e){H(this,N,te).call(this,e)}onSave(e){if(e.preventDefault(),this.createDisabled)return
const t=new FormData(e.currentTarget),i=Object.fromEntries(t.entries())
i.auto_join_users="on"===i.auto_join_users,i.slug??=this.autoGeneratedSlug,i.threading_enabled="on"===i.threading_enabled,i.auto_join_users?this.dialog.yesNoConfirm({message:this.autoJoinWarning,didConfirm:()=>H(this,D,Y).call(this,i)}):H(this,D,Y).call(this,i)}},g=q(b.prototype,"chat",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=q(b.prototype,"dialog",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=q(b.prototype,"chatChannelsManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=q(b.prototype,"chatApi",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=q(b.prototype,"router",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=q(b.prototype,"currentUser",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=q(b.prototype,"siteSettings",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=q(b.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=q(b.prototype,"flash",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=q(b.prototype,"name",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=q(b.prototype,"category",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=q(b.prototype,"categoryId",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=q(b.prototype,"autoGeneratedSlug",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),P=q(b.prototype,"categoryPermissionsHint",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=q(b.prototype,"autoJoinWarning",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),E=q(b.prototype,"loadingPermissionHint",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),q(b.prototype,"onShow",[r.action],Object.getOwnPropertyDescriptor(b.prototype,"onShow"),b.prototype),q(b.prototype,"onCategoryChange",[r.action],Object.getOwnPropertyDescriptor(b.prototype,"onCategoryChange"),b.prototype),q(b.prototype,"onNameChange",[r.action],Object.getOwnPropertyDescriptor(b.prototype,"onNameChange"),b.prototype),q(b.prototype,"onSave",[r.action],Object.getOwnPropertyDescriptor(b.prototype,"onSave"),b.prototype),b)
async function Y(e){try{const t=await this.chatApi.createChannel(e)
this.args.closeModal(),this.chatChannelsManager.follow(t),this.router.transitionTo("chat.channel",...t.routeModels)}catch(t){this.flash=(0,u.extractError)(t)}}function Z(e){const t=e.parentCategory
return t?`${H(this,A,Z).call(this,t)}/${e.slug}`:e.slug}function X(e,t){const i=t.allowed_groups
let n
if(t.private)switch(i.length){case 1:n=p.default.t("chat.create_channel.auto_join_users.warning_1_group",{count:t.members_count,group:(0,d.escapeExpression)(i[0])})
break
case 2:n=p.default.t("chat.create_channel.auto_join_users.warning_2_groups",{count:t.members_count,group1:(0,d.escapeExpression)(i[0]),group2:(0,d.escapeExpression)(i[1])})
break
default:n=p.default.messageFormat("chat.create_channel.auto_join_users.warning_multiple_groups_MF",{groupCount:i.length-1,userCount:t.members_count,groupName:(0,d.escapeExpression)(i[0])})}else n=p.default.t("chat.create_channel.auto_join_users.public_category_warning",{category:(0,d.escapeExpression)(e.name)})
this.autoJoinWarning=n}function Q(e){if(e){const t=H(this,A,Z).call(this,e)
return this.loadingPermissionHint=!0,this.chatApi.categoryPermissions(e.id).then((i=>{H(this,I,X).call(this,e,i)
const n=i.allowed_groups,r=`/c/${(0,d.escapeExpression)(t)}/edit/security`
let a
switch(n.length){case 1:a=p.default.t("chat.create_channel.choose_category.hint_1_group",{settingLink:r,group:(0,d.escapeExpression)(n[0])})
break
case 2:a=p.default.t("chat.create_channel.choose_category.hint_2_groups",{settingLink:r,group1:(0,d.escapeExpression)(n[0]),group2:(0,d.escapeExpression)(n[1])})
break
default:a=p.default.t("chat.create_channel.choose_category.hint_multiple_groups",{settingLink:r,group:(0,d.escapeExpression)(n[0]),count:n.length-1})}this.categoryPermissionsHint=(0,o.htmlSafe)(a)})).finally((()=>{this.loadingPermissionHint=!1}))}this.categoryPermissionsHint=G,this.autoJoinWarning=""}function ee(e){return(0,c.ajax)("/slugs.json",{type:"POST",data:{name:e}}).then((e=>{this.autoGeneratedSlug=e.slug}))}function te(e){(0,a.cancel)($(this,x)),this.autoGeneratedSlug="",e&&B(this,x,(0,h.default)(this,H(this,L,ee),e,300))}(0,t.setComponentTemplate)(K,J)})),define("discourse/plugins/chat/discourse/components/chat/modal/delete-channel",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember/template","@ember/utils","discourse/lib/ajax-error","discourse-common/lib/later","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d){"use strict"
var h,p,m,b,g,f,v,y
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const j=(0,d.createTemplateFactory)({id:"PzSml1dG",block:'[[[8,[39,0],[[24,0,"chat-modal-delete-channel"]],[["@closeModal","@inline","@title","@flash","@flashType"],[[30,1],[30,2],[28,[37,1],["chat.channel_delete.title"],null],[30,0,["flash"]],[30,0,["flashType"]]]],[["body","footer"],[[[[1,"\\n    "],[10,2],[14,0,"chat-modal-delete-channel__instructions"],[12],[1,"\\n      "],[1,[30,0,["instructionsText"]]],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[39,2],null,[["@value","@id","@placeholderKey","@autocorrect","@autocapitalize"],[[30,0,["channelNameConfirmation"]],"channel-delete-confirm-name","chat.channel_delete.confirm_channel_name","off","off"]],null],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,3],[[24,1,"chat-confirm-delete-channel"],[24,0,"btn-danger"]],[["@disabled","@action","@label"],[[30,0,["buttonDisabled"]],[30,0,["deleteChannel"]],"chat.channel_delete.confirm"]],null],[1,"\\n    "],[8,[39,3],[[24,0,"btn-flat"]],[["@label","@action"],["cancel",[30,1]]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","text-field","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/delete-channel.hbs",isStrictMode:!1})
let M=e.default=(h=class extends i.default{constructor(){super(...arguments),w(this,"chatApi",p,this),w(this,"router",m,this),w(this,"channelNameConfirmation",b,this),w(this,"deleting",g,this),w(this,"confirmed",f,this),w(this,"flash",v,this),w(this,"flashType",y,this)}get channel(){return this.args.model.channel}get buttonDisabled(){return!(!this.deleting&&!this.confirmed)||!(!(0,o.isEmpty)(this.channelNameConfirmation)&&this.channelNameConfirmation.toLowerCase()===this.channel.title.toLowerCase())}get instructionsText(){return(0,s.htmlSafe)(u.default.t("chat.channel_delete.instructions",{name:this.channel.escapedTitle}))}deleteChannel(){return this.deleting=!0,this.chatApi.destroyChannel(this.channel.id,this.channelNameConfirmation).then((()=>{this.confirmed=!0,this.flash=u.default.t("chat.channel_delete.process_started"),this.flashType="success",(0,c.default)((()=>{this.args.closeModal(),this.router.transitionTo("chat")}),3e3)})).catch(l.popupAjaxError).finally((()=>this.deleting=!1))}},p=_(h.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=_(h.prototype,"router",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=_(h.prototype,"channelNameConfirmation",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=_(h.prototype,"deleting",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=_(h.prototype,"confirmed",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),v=_(h.prototype,"flash",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=_(h.prototype,"flashType",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_(h.prototype,"deleteChannel",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"deleteChannel"),h.prototype),h);(0,t.setComponentTemplate)(j,M)})),define("discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/lib/ajax-error","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,o.createTemplateFactory)({id:"TZprB0qD",block:'[[[8,[39,0],[[24,0,"chat-modal-edit-channel-description"]],[["@closeModal","@inline","@title","@flash"],[[30,1],[30,2],[28,[37,1],["chat.channel_edit_description_modal.title"],null],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n    "],[10,1],[14,0,"chat-modal-edit-channel-description__description"],[12],[1,[28,[35,1],["chat.channel_edit_description_modal.description"],null]],[13],[1,"\\n    "],[8,[39,2],null,[["@value","@max"],[[30,0,["editedDescription"]],[30,0,["descriptionMaxLength"]]]],[["default"],[[[[1,"\\n      "],[11,"textarea"],[24,0,"chat-modal-edit-channel-description__description-input"],[16,"placeholder",[28,[37,1],["chat.channel_edit_description_modal.input_placeholder"],null]],[4,[38,3],["input",[28,[37,4],[[30,0],[30,0,["onChangeChatChannelDescription"]]],[["value"],["target.value"]]]],null],[12],[1,[30,0,["editedDescription"]]],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,5],[[24,0,"btn-primary create"]],[["@action","@label","@disabled"],[[30,0,["onSaveChatChannelDescription"]],"save",[30,0,["isSaveDisabled"]]]],null],[1,"\\n    "],[8,[39,6],null,[["@close"],[[30,1]]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","char-counter","on","action","d-button","d-modal-cancel"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description.hbs",isStrictMode:!1})
let b=e.default=(l=class extends i.default{constructor(){super(...arguments),h(this,"chatApi",c,this),h(this,"editedDescription",u,this),h(this,"flash",d,this)}get channel(){return this.args.model}get isSaveDisabled(){return this.channel.description===this.editedDescription||this.editedDescription?.length>280}get descriptionMaxLength(){return 280}async onSaveChatChannelDescription(){try{const e=await this.chatApi.updateChannel(this.channel.id,{description:this.editedDescription})
this.channel.description=e.channel.description,this.args.closeModal()}catch(e){this.flash=(0,s.extractError)(e)}}onChangeChatChannelDescription(e){this.flash=null,this.editedDescription=e}},c=p(l.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"editedDescription",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.channel.description||""}}),d=p(l.prototype,"flash",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(l.prototype,"onSaveChatChannelDescription",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"onSaveChatChannelDescription"),l.prototype),p(l.prototype,"onChangeChatChannelDescription",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"onChangeChatChannelDescription"),l.prototype),l);(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","discourse/lib/ajax","discourse/lib/ajax-error","discourse-common/lib/debounce","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g,f,v,y,w
function _(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e,t){M(e,t),t.add(e)}function M(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z(e,t,i){return function(e,t,i){if(t.set)t.set.call(e,i)
else{if(!t.writable)throw new TypeError("attempted to set read only private field")
t.value=i}}(e,k(e,t,"set"),i),i}function k(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}function C(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function O(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const S=(0,u.createTemplateFactory)({id:"ZG/fvtaW",block:'[[[8,[39,0],[[24,0,"chat-modal-edit-channel-name"]],[["@closeModal","@inline","@title","@flash"],[[30,1],[30,2],[28,[37,1],["chat.channel_edit_name_slug_modal.title"],null],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n    "],[10,0],[14,0,"edit-channel-control"],[12],[1,"\\n      "],[10,"label"],[14,"for","channel-name"],[14,0,"edit-channel-label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.channel_edit_name_slug_modal.name"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,2],[[24,3,"channel-name"],[24,0,"chat-channel-edit-name-slug-modal__name-input"],[16,"placeholder",[28,[37,1],["chat.channel_edit_name_slug_modal.input_placeholder"],null]],[4,[38,3],["input",[28,[37,4],[[30,0],"onChangeChatChannelName"],[["value"],["target.value"]]]],null]],[["@type","@value"],["text",[30,0,["editedName"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"edit-channel-control"],[12],[1,"\\n      "],[10,"label"],[14,"for","channel-slug"],[14,0,"edit-channel-label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.channel_edit_name_slug_modal.slug"],null]],[1,"\\n        "],[8,[39,5],null,[["@icon","@content"],["info-circle",[28,[37,1],["chat.channel_edit_name_slug_modal.slug_description"],null]]],null],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,2],[[24,3,"channel-slug"],[24,0,"chat-channel-edit-name-slug-modal__slug-input"],[16,"placeholder",[30,0,["autoGeneratedSlug"]]],[4,[38,3],["input",[28,[37,4],[[30,0],"onChangeChatChannelSlug"],[["value"],["target.value"]]]],null]],[["@type","@value"],["text",[30,0,["editedSlug"]]]],null],[1,"\\n    "],[13],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,6],[[24,0,"btn-primary create"]],[["@action","@label","@disabled"],[[30,0,["onSave"]],"save",[30,0,["isSaveDisabled"]]]],null],[1,"\\n    "],[8,[39,7],null,[["@close"],[[30,1]]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","input","on","action","d-tooltip","d-button","d-modal-cancel"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name.hbs",isStrictMode:!1})
let P=e.default=(v=new WeakMap,y=new WeakSet,w=new WeakSet,d=class extends i.default{constructor(){var e,t,i
super(...arguments),j(this,w),j(this,y),_(this,"chatApi",h,this),_(this,"siteSettings",p,this),_(this,"editedName",m,this),_(this,"editedSlug",b,this),_(this,"autoGeneratedSlug",g,this),_(this,"flash",f,this),i={writable:!0,value:null},M(e=this,t=v),t.set(e,i)}get channel(){return this.args.model}get isSaveDisabled(){return this.channel.title===this.editedName&&this.channel.slug===this.editedSlug||this.editedName?.length>this.siteSettings.max_topic_title_length||this.editedSlug?.length>100}onSave(){return this.chatApi.updateChannel(this.channel.id,{name:this.editedName,slug:this.editedSlug||this.autoGeneratedSlug||this.channel.slug}).then((e=>{this.channel.title=e.channel.title,this.args.closeModal()})).catch((e=>this.flash=(0,l.extractError)(e)))}onChangeChatChannelName(e){this.flash=null,C(this,y,T).call(this,e)}onChangeChatChannelSlug(){this.flash=null,C(this,y,T).call(this,this.editedName)}},h=O(d.prototype,"chatApi",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=O(d.prototype,"siteSettings",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=O(d.prototype,"editedName",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.channel.title}}),b=O(d.prototype,"editedSlug",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.channel.slug}}),g=O(d.prototype,"autoGeneratedSlug",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f=O(d.prototype,"flash",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O(d.prototype,"onSave",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"onSave"),d.prototype),O(d.prototype,"onChangeChatChannelName",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"onChangeChatChannelName"),d.prototype),O(d.prototype,"onChangeChatChannelSlug",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"onChangeChatChannelSlug"),d.prototype),d)
function T(e){var t;(0,a.cancel)(function(e,t){return t.get?t.get.call(e):t.value}(t=this,k(t,v,"get"))),this.autoGeneratedSlug="",e&&z(this,v,(0,c.default)(this,C(this,w,E),e,300))}function E(e){return(0,o.ajax)("/slugs.json",{type:"POST",data:{name:e}}).then((e=>{this.autoGeneratedSlug=e.slug}))}(0,t.setComponentTemplate)(S,P)})),define("discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember/template","@ember/utils","discourse/lib/ajax-error","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const y=(0,u.createTemplateFactory)({id:"CzuLeqnZ",block:'[[[8,[39,0],[[24,0,"chat-modal-move-message-to-channel"]],[["@closeModal","@inline","@title"],[[30,1],[30,2],[28,[37,1],["chat.move_to_channel.title"],null]]],[["body","footer"],[[[[1,"\\n"],[41,[30,0,["selectedMessageCount"]],[[[1,"      "],[10,2],[12],[1,[30,0,["instructionsText"]]],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[8,[39,3],null,[["@class","@content","@value","@nameProperty"],["chat-modal-move-message-to-channel__channel-chooser",[30,0,["availableChannels"]],[30,0,["destinationChannelId"]],"title"]],null],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,4],[[24,0,"btn-primary"]],[["@icon","@disabled","@action","@label"],["sign-out-alt",[30,0,["disableMoveButton"]],[30,0,["moveMessages"]],"chat.move_to_channel.confirm_move"]],null],[1,"\\n    "],[8,[39,4],[[24,0,"btn-flat"]],[["@label","@action"],["cancel",[30,1]]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","if","chat-channel-chooser","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel.hbs",isStrictMode:!1})
let w=e.default=(d=class extends i.default{constructor(){super(...arguments),f(this,"chat",h,this),f(this,"chatApi",p,this),f(this,"router",m,this),f(this,"chatChannelsManager",b,this),f(this,"destinationChannelId",g,this)}get sourceChannel(){return this.args.model.sourceChannel}get selectedMessageIds(){return this.args.model.selectedMessageIds}get selectedMessageCount(){return this.selectedMessageIds?.length}get disableMoveButton(){return(0,o.isBlank)(this.destinationChannelId)}get availableChannels(){return(this.args.model.availableChannels||this.chatChannelsManager.publicMessageChannels).rejectBy("id",this.sourceChannel.id)}get instructionsText(){return(0,s.htmlSafe)(c.default.t("chat.move_to_channel.instructions",{channelTitle:this.sourceChannel.escapedTitle,count:this.selectedMessageCount}))}moveMessages(){return this.chatApi.moveChannelMessages(this.sourceChannel.id,{message_ids:this.selectedMessageIds,destination_channel_id:this.destinationChannelId}).then((e=>{this.args.closeModal(),this.router.transitionTo("chat.channel.near-message","-",e.destination_channel_id,e.first_moved_message_id)})).catch(l.popupAjaxError)}},h=v(d.prototype,"chat",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=v(d.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=v(d.prototype,"router",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=v(d.prototype,"chatChannelsManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=v(d.prototype,"destinationChannelId",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v(d.prototype,"moveMessages",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"moveMessages"),d.prototype),d);(0,t.setComponentTemplate)(y,w)})),define("discourse/plugins/chat/discourse/components/chat/modal/new-message",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u=(0,r.createTemplateFactory)({id:"RbZVRt9q",block:'[[[41,[30,0,["shouldRender"]],[[[1,"  "],[8,[39,1],[[24,0,"chat-modal-new-message"]],[["@closeModal","@title","@inline"],[[30,1],"chat.new_message_modal.title",[30,2]]],[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@onClose"],[[30,1]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]],null]],["@closeModal","@inline"],false,["if","d-modal","chat/message-creator"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/new-message.hbs",isStrictMode:!1})
let d=e.default=(a=class extends i.default{constructor(){super(...arguments),l(this,"chat",s,this),l(this,"siteSettings",o,this)}get shouldRender(){return this.siteSettings.enable_public_channels||this.chat.userCanDirectMessage}},s=c(a.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(a.prototype,"siteSettings",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a);(0,t.setComponentTemplate)(u,d)})),define("discourse/plugins/chat/discourse/components/chat/modal/thread-settings",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/lib/ajax-error","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,o.createTemplateFactory)({id:"bSa9FKpV",block:'[[[8,[39,0],[[24,0,"chat-modal-thread-settings"]],[["@closeModal","@inline","@title"],[[30,1],[30,2],[28,[37,1],["chat.thread.settings"],null]]],[["body","footer"],[[[[1,"\\n    "],[10,"label"],[14,"for","thread-title"],[14,0,"thread-title-label"],[12],[1,"\\n      "],[1,[28,[35,1],["chat.thread.title"],null]],[1,"\\n    "],[13],[1,"\\n    "],[8,[39,2],[[24,3,"thread-title"],[24,0,"chat-modal-thread-settings__title-input"]],[["@type","@value"],["text",[30,0,["editedTitle"]]]],null],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,3],[[24,0,"btn-primary"]],[["@disabled","@action","@label"],[[30,0,["buttonDisabled"]],[30,0,["saveThread"]],"save"]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","input","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/thread-settings.hbs",isStrictMode:!1})
let b=e.default=(l=class extends i.default{constructor(){super(...arguments),h(this,"chatApi",c,this),h(this,"editedTitle",u,this),h(this,"saving",d,this)}get buttonDisabled(){return this.saving}get thread(){return this.args.model}saveThread(){this.saving=!0,this.chatApi.editThread(this.thread.channel.id,this.thread.id,{title:this.editedTitle}).then((()=>{this.thread.title=this.editedTitle,this.args.closeModal()})).catch(s.popupAjaxError).finally((()=>{this.saving=!1}))}},c=p(l.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"editedTitle",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.thread.title||""}}),d=p(l.prototype,"saving",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p(l.prototype,"saveThread",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"saveThread"),l.prototype),l);(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","@ember/template","discourse/lib/ajax-error","discourse-i18n","discourse/plugins/chat/discourse/models/chat-channel","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,c.createTemplateFactory)({id:"yZuFKWSS",block:'[[[8,[39,0],[[24,0,"chat-modal-toggle-channel-status"]],[["@closeModal","@inline","@title"],[[30,1],[30,2],[28,[37,1],[[30,0,["modalTitle"]]],null]]],[["body","footer"],[[[[1,"\\n    "],[10,2],[14,0,"chat-modal-toggle-channel-status__instructions"],[12],[1,[30,0,["instructions"]]],[13],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,2],[[24,1,"chat-channel-toggle-btn"],[24,0,"btn-primary"]],[["@action","@label"],[[30,0,["onStatusChange"]],[30,0,["buttonLabel"]]]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status.hbs",isStrictMode:!1})
let g=e.default=(u=class extends i.default{constructor(){super(...arguments),p(this,"chatApi",d,this),p(this,"router",h,this)}get channel(){return this.args.model}get buttonLabel(){return this.channel?.isClosed?"chat.channel_settings.open_channel":"chat.channel_settings.close_channel"}get instructions(){return this.channel?.isClosed?(0,a.htmlSafe)(o.default.t("chat.channel_open.instructions")):(0,a.htmlSafe)(o.default.t("chat.channel_close.instructions"))}get modalTitle(){return this.channel?.isClosed?"chat.channel_open.title":"chat.channel_close.title"}onStatusChange(){const e=this.channel.isClosed?l.CHANNEL_STATUSES.open:l.CHANNEL_STATUSES.closed
return this.chatApi.updateChannelStatus(this.channel.id,e).then((()=>{this.args.closeModal(),this.router.transitionTo("chat.channel",...this.channel.routeModels)})).catch(s.popupAjaxError)}},d=m(u.prototype,"chatApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(u.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m(u.prototype,"onStatusChange",[n.action],Object.getOwnPropertyDescriptor(u.prototype,"onStatusChange"),u.prototype),u);(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/chat/notices/mention_without_membership",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/lib/ajax-error","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,o.createTemplateFactory)({id:"pRXG5pS2",block:'[[[10,0],[14,0,"mention-without-membership-notice"],[12],[1,"\\n"],[41,[30,0,["invitationsSent"]],[[[1,"    "],[11,1],[24,0,"mention-without-membership-notice__invitation-sent"],[4,[38,1],[[30,1],3000],null],[12],[1,"\\n      "],[1,[28,[35,2],["check"],null]],[1,"\\n      "],[10,1],[12],[1,"\\n        "],[1,[28,[35,3],["chat.mention_warning.invitations_sent"],[["count"],[[30,0,["userIds","length"]]]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[1,"    "],[10,2],[14,0,"mention-without-membership-notice__body -without-membership"],[12],[1,"\\n      "],[10,1],[14,0,"mention-without-membership-notice__body__text"],[12],[1,[30,2,["data","text"]]],[13],[1,"\\n      "],[11,3],[24,0,"mention-without-membership-notice__body__link"],[24,6,""],[4,[38,4],["click",[30,0,["sendInvitations"]]],null],[12],[1,"\\n        "],[1,[28,[35,3],["chat.mention_warning.invite"],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]]],[13]],["@clearNotice","@notice"],false,["if","chat/later-fn","d-icon","i18n","on"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/notices/mention_without_membership.hbs",isStrictMode:!1})
let b=e.default=(l=(0,a.inject)("chat-api"),c=class extends i.default{constructor(){super(...arguments),h(this,"chatApi",u,this),h(this,"invitationsSent",d,this)}get userIds(){return this.args.notice.data.user_ids}async sendInvitations(e){e.preventDefault()
try{await this.chatApi.invite(this.args.channel.id,this.userIds,{messageId:this.args.notice.data.messageId}),this.invitationsSent=!0}catch(t){(0,s.popupAjaxError)(t)}}},u=p(c.prototype,"chatApi",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=p(c.prototype,"invitationsSent",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p(c.prototype,"sendInvitations",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"sendInvitations"),c.prototype),c);(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/chat/scroll-to-bottom-arrow",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"FdcovQgc",block:'[[[10,0],[14,0,"chat-scroll-to-bottom"],[12],[1,"\\n  "],[8,[39,0],[[16,0,[28,[37,1],["btn-flat","chat-scroll-to-bottom__button",[52,[30,1],"visible"]],null]]],[["@action"],[[30,2]]],[["default"],[[[[1,"\\n    "],[10,1],[14,0,"chat-scroll-to-bottom__arrow"],[12],[1,"\\n      "],[1,[28,[35,3],["arrow-down"],null]],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]],[1,"\\n"],[13]],["@isVisible","@onScrollToBottom"],false,["d-button","concat-class","if","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/scroll-to-bottom-arrow.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/chat/selection-manager",["exports","@glimmer/component","@ember/application","@ember/object","@ember/service","discourse/components/d-button","discourse/lib/ajax-error","discourse/lib/utilities","discourse-common/config/environment","discourse-common/utils/decorators","discourse-i18n","truth-helpers/helpers/not","discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m){"use strict"
var b,g,f,v,y,w,_,j,M,z
function k(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function C(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(b=(0,r.inject)("composer"),g=(0,r.inject)("chat-api"),z=class extends t.default{constructor(){super(...arguments),k(this,"topicComposer",v,this),k(this,"router",y,this),k(this,"modal",w,this),k(this,"site",_,this),k(this,"toasts",j,this),k(this,"api",M,this)}get enableMove(){return this.args.enableMove??!1}get anyMessagesSelected(){return this.args.pane.selectedMessageIds.length>0}async generateQuote(){const{markdown:e}=await this.api.generateQuote(this.args.pane.channel.id,this.args.pane.selectedMessageIds)
return new Blob([e],{type:"text/plain"})}openMoveMessageModal(){this.modal.show(h.default,{model:{sourceChannel:this.args.pane.channel,selectedMessageIds:this.args.pane.selectedMessageIds}})}async quoteMessages(){let e
try{const t=await this.generateQuote()
e=await t.text()}catch(n){(0,s.popupAjaxError)(n)}const t={}
if(this.args.pane.channel.isCategoryChannel&&(t.categoryId=this.args.pane.channel.chatableId),this.site.mobileView)this.args.pane.channel.chatableUrl&&this.router.transitionTo(this.args.pane.channel.chatableUrl),await this.topicComposer.focusComposer({fallbackToNewTopic:!0,insertText:e,openOpts:t})
else{const n=(0,i.getOwner)(this).lookup("controller:topic")
await this.topicComposer.focusComposer({fallbackToNewTopic:!0,topic:n?.model,insertText:e,openOpts:t})}}async copyMessages(){try{(0,l.isTesting)()||(await(0,o.clipboardCopyAsync)(this.generateQuote),this.toasts.success({duration:3e3,data:{message:u.default.t("chat.quote.copy_success")}}))}catch(e){(0,s.popupAjaxError)(e)}}},(0,m.setComponentTemplate)((0,p.createTemplateFactory)({id:"pwb+T3M4",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-selection-management"],[15,"data-last-copy-successful",[30,0,["lastCopySuccessful"]]],[12],[1,"\\n      "],[10,0],[14,0,"chat-selection-management__buttons"],[12],[1,"\\n        "],[8,[32,0],[[24,1,"chat-quote-btn"]],[["@icon","@label","@disabled","@action"],["quote-left","chat.selection.quote_selection",[28,[32,1],[[30,0,["anyMessagesSelected"]]],null],[30,0,["quoteMessages"]]]],null],[1,"\\n\\n        "],[8,[32,0],[[24,1,"chat-copy-btn"]],[["@icon","@label","@disabled","@action"],["copy","chat.selection.copy",[28,[32,1],[[30,0,["anyMessagesSelected"]]],null],[30,0,["copyMessages"]]]],null],[1,"\\n\\n"],[41,[30,0,["enableMove"]],[[[1,"          "],[8,[32,0],[[24,1,"chat-move-to-channel-btn"]],[["@icon","@label","@disabled","@action"],["sign-out-alt","chat.selection.move_selection_to_channel",[28,[32,1],[[30,0,["anyMessagesSelected"]]],null],[30,0,["openMoveMessageModal"]]]],null],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[32,0],[[24,1,"chat-cancel-selection-btn"],[24,0,"btn-secondary cancel-btn"]],[["@icon","@label","@action"],["times","chat.selection.cancel",[30,1,["cancelSelecting"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@pane"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/selection-manager.js",scope:()=>[a.default,d.default],isStrictMode:!0}),z),v=C((f=z).prototype,"topicComposer",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=C(f.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=C(f.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=C(f.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=C(f.prototype,"toasts",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=C(f.prototype,"api",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C(f.prototype,"generateQuote",[c.bind],Object.getOwnPropertyDescriptor(f.prototype,"generateQuote"),f.prototype),C(f.prototype,"openMoveMessageModal",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"openMoveMessageModal"),f.prototype),C(f.prototype,"quoteMessages",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"quoteMessages"),f.prototype),C(f.prototype,"copyMessages",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"copyMessages"),f.prototype),f)})),define("discourse/plugins/chat/discourse/components/chat/thread-list/header",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"5OYm993C",block:'[[[10,0],[14,0,"chat-thread-header"],[12],[1,"\\n  "],[10,1],[14,0,"chat-thread-header__label"],[12],[1,"\\n    "],[1,[28,[35,0],[[28,[37,1],["chat.threads.list"],null]],null]],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"chat-thread-header__buttons"],[12],[1,"\\n    "],[8,[39,2],[[24,0,"chat-thread__close btn-flat btn btn-icon no-text"],[16,"title",[28,[37,1],["chat.thread.close"],null]]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n      "],[1,[28,[35,3],["times"],null]],[1,"\\n    "]],[]]]]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@channel"],false,["replace-emoji","i18n","link-to","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread-list/header.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/chat/thread-list/item",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o
function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,a.createTemplateFactory)({id:"ZGab0kWx",block:'[[[11,0],[16,0,[28,[37,0],["chat-thread-list-item",[52,[28,[37,2],[[30,1,["tracking","unreadCount"]],0],null],"-is-unread"]],null]],[16,"data-thread-id",[30,1,["id"]]],[17,2],[12],[1,"\\n  "],[10,0],[14,0,"chat-thread-list-item__main"],[12],[1,"\\n    "],[11,0],[16,"title",[28,[37,3],["chat.thread.view_thread"],null]],[24,"role","button"],[24,0,"chat-thread-list-item__open-button"],[4,[38,4],["click",[28,[37,5],[[30,0,["openThread"]],[30,1]],null]],[["passive"],[true]]],[12],[1,"\\n      "],[10,0],[14,0,"chat-thread-list-item__header"],[12],[1,"\\n        "],[10,0],[14,0,"chat-thread-list-item__title"],[12],[1,"\\n"],[41,[30,1,["title"]],[[[1,"            "],[1,[28,[35,6],[[30,1,["title"]]],null]],[1,"\\n"]],[]],[[[1,"            "],[1,[28,[35,6],[[30,1,["originalMessage","excerpt"]]],null]],[1,"\\n"]],[]]],[1,"        "],[13],[1,"\\n        "],[10,0],[14,0,"chat-thread-list-item__unread-indicator"],[12],[1,"\\n          "],[8,[39,7],null,[["@thread"],[[30,1]]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"chat-thread-list-item__metadata"],[12],[1,"\\n\\n        "],[10,0],[14,0,"chat-thread-list-item__members"],[12],[1,"\\n          "],[8,[39,8],null,[["@user","@showPresence","@interactive"],[[30,1,["originalMessage","user"]],false,false]],null],[1,"\\n          "],[8,[39,9],[[24,0,"chat-thread-list-item__participants"]],[["@thread","@includeOriginalMessageUser"],[[30,1],false]],null],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"chat-thread-list-item__last-reply-timestamp"],[12],[1,"\\n"],[41,[30,1,["preview","lastReplyCreatedAt"]],[[[1,"            "],[1,[28,[35,10],[[30,1,["preview","lastReplyCreatedAt"]]],[["leaveAgo"],["true"]]]],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],["@thread","&attrs"],false,["concat-class","if","gt","i18n","on","fn","replace-emoji","chat/thread-list/item/unread-indicator","chat-user-avatar","chat-thread-participants","format-date"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread-list/item.hbs",isStrictMode:!1})
let u=e.default=(s=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openThread(e){this.router.transitionTo("chat.channel.thread",...e.routeModels)}},o=l(s.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l(s.prototype,"openThread",[n.action],Object.getOwnPropertyDescriptor(s.prototype,"openThread"),s.prototype),s);(0,t.setComponentTemplate)(c,u)})),define("discourse/plugins/chat/discourse/components/chat/thread-list/item/unread-indicator",["exports","@ember/component","@glimmer/component","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"rDctiubz",block:'[[[41,[30,0,["showUnreadIndicator"]],[[[1,"  "],[10,0],[14,0,"chat-thread-list-item-unread-indicator"],[12],[1,"\\n    "],[10,0],[14,0,"chat-thread-list-item-unread-indicator__number"],[12],[1,"\\n      "],[1,[30,0,["unreadCountLabel"]]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread-list/item/unread-indicator.hbs",isStrictMode:!1})
class a extends i.default{get unreadCount(){return this.args.thread.tracking.unreadCount}get showUnreadIndicator(){return this.unreadCount>0}get unreadCountLabel(){return this.unreadCount>99?"99+":this.unreadCount}}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/chat/thread/header-unread-indicator",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"03TVnh5M",block:'[[[41,[30,0,["showUnreadIndicator"]],[[[1,"  "],[10,0],[14,0,"chat-thread-header-unread-indicator"],[15,"aria-label",[28,[37,1],["chat.unread_threads_count"],[["count"],[[30,0,["unreadCountLabel"]]]]]],[15,"title",[28,[37,1],["chat.unread_threads_count"],[["count"],[[30,0,["unreadCountLabel"]]]]]],[12],[1,"\\n    "],[10,0],[14,0,"chat-thread-header-unread-indicator__number"],[12],[1,[30,0,["unreadCountLabel"]]],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread/header-unread-indicator.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get currentUserInDnD(){return this.currentUser.isInDoNotDisturb()}get unreadCount(){return this.args.channel.threadsManager.unreadThreadCount}get showUnreadIndicator(){return!this.currentUserInDnD&&this.unreadCount>0}get unreadCountLabel(){return this.unreadCount>99?"99+":this.unreadCount}},c=a.prototype,u="currentUser",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat/thread/header",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/lib/ajax-error","discourse/lib/notification-levels","discourse/plugins/chat/discourse/components/chat/modal/thread-settings","discourse/plugins/chat/discourse/models/user-chat-thread-membership","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g,f,v,y
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const j=(0,u.createTemplateFactory)({id:"yIXnh4Vy",block:'[[[10,0],[14,0,"chat-thread-header"],[12],[1,"\\n  "],[10,0],[14,0,"chat-thread-header__left-buttons"],[12],[1,"\\n"],[41,[30,1],[[[1,"      "],[8,[39,1],[[24,0,"chat-thread__back-to-previous-route btn-flat btn btn-icon no-text"],[16,"title",[28,[37,2],["chat.return_to_threads_list"],null]]],[["@route","@models"],[[30,0,["backLink","route"]],[30,0,["backLink","models"]]]],[["default"],[[[[1,"\\n        "],[8,[39,3],null,[["@channel"],[[30,1,["channel"]]]],null],[1,"\\n        "],[1,[28,[35,4],["chevron-left"],null]],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n\\n  "],[10,1],[14,0,"chat-thread-header__label overflow-ellipsis"],[12],[1,"\\n    "],[1,[28,[35,5],[[30,1,["title"]]],null]],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[15,0,[28,[37,6],["chat-thread-header__buttons",[52,[30,0,["persistedNotificationLevel"]],"-persisted"]],null]],[12],[1,"\\n    "],[8,[39,7],null,[["@value","@onChange"],[[30,0,["threadNotificationLevel"]],[30,0,["updateThreadNotificationLevel"]]]],null],[1,"\\n"],[41,[30,0,["canChangeThreadSettings"]],[[[1,"      "],[8,[39,8],[[24,0,"btn-flat chat-thread-header__settings"]],[["@action","@icon","@title"],[[30,0,["openThreadSettings"]],"cog","chat.thread.settings"]],null],[1,"\\n"]],[]],null],[1,"    "],[8,[39,1],[[24,0,"chat-thread__close btn-flat btn btn-icon no-text"],[16,"title",[28,[37,2],["chat.thread.close"],null]]],[["@route","@models"],["chat.channel",[30,1,["channel","routeModels"]]]],[["default"],[[[[1,"\\n      "],[1,[28,[35,4],["times"],null]],[1,"\\n    "]],[]]]]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@thread"],false,["if","link-to","i18n","chat/thread/header-unread-indicator","d-icon","replace-emoji","concat-class","thread-notifications-button","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread/header.hbs",isStrictMode:!1})
let M=e.default=(d=class extends i.default{constructor(){super(...arguments),w(this,"currentUser",h,this),w(this,"chatApi",p,this),w(this,"router",m,this),w(this,"chatStateManager",b,this),w(this,"chatHistory",g,this),w(this,"site",f,this),w(this,"modal",v,this),w(this,"persistedNotificationLevel",y,this)}get backLink(){let e
return e="chat.channel.index"===this.chatHistory.previousRoute?.name&&this.site.mobileView?"chat.channel.index":"chat.channel.threads",{route:e,models:this.args.channel.routeModels}}get canChangeThreadSettings(){return!!this.args.thread&&(this.currentUser.staff||this.currentUser.id===this.args.thread.originalMessage.user.id)}get threadNotificationLevel(){return this.membership?.notificationLevel||o.NotificationLevels.REGULAR}get membership(){return this.args.thread.currentUserMembership}openThreadSettings(){this.modal.show(l.default,{model:this.args.thread})}updateThreadNotificationLevel(e){let t
this.persistedNotificationLevel=!1,this.membership?(t=this.membership.notificationLevel,this.membership.notificationLevel=e):this.args.thread.currentUserMembership=c.default.create({notification_level:e,last_read_message_id:null}),this.chatApi.updateCurrentUserThreadNotificationsSettings(this.args.thread.channel.id,this.args.thread.id,{notificationLevel:e}).then((e=>{this.membership.last_read_message_id=e.membership.last_read_message_id,this.persistedNotificationLevel=!0})).catch((e=>{this.membership.notificationLevel=t,(0,s.popupAjaxError)(e)}))}},h=_(d.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=_(d.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=_(d.prototype,"router",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=_(d.prototype,"chatStateManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=_(d.prototype,"chatHistory",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=_(d.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=_(d.prototype,"modal",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=_(d.prototype,"persistedNotificationLevel",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),_(d.prototype,"openThreadSettings",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"openThreadSettings"),d.prototype),_(d.prototype,"updateThreadNotificationLevel",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"updateThreadNotificationLevel"),d.prototype),d);(0,t.setComponentTemplate)(j,M)})),define("discourse/plugins/chat/discourse/components/chat/thread/threads-list-button",["exports","@ember/component","@glimmer/component","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"S775/LGw",block:'[[[8,[39,0],[[16,"title",[28,[37,1],["chat.threads.list"],null]],[16,0,[28,[37,2],["chat-threads-list-button btn btn-flat",[52,[30,1,["threadsManager","unreadThreadCount"]],"has-unreads"]],null]]],[["@route","@models"],["chat.channel.threads",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n  "],[1,[28,[35,4],["discourse-threads"],null]],[1,"\\n\\n  "],[8,[39,5],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]]]]]],["@channel"],false,["link-to","i18n","concat-class","if","d-icon","chat/thread/header-unread-indicator"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread/threads-list-button.hbs",isStrictMode:!1})
class a extends i.default{}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/chat/user-card-button",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,a.createTemplateFactory)({id:"BpDCKAWc",block:'[[[41,[30,0,["shouldRender"]],[[[1,"  "],[8,[39,1],[[24,0,"btn-primary chat-user-card-btn"]],[["@action","@label","@icon"],[[30,0,["startChatting"]],"chat.title_capitalized","d-chat"]],null],[1,"\\n"]],[]],null]],[],false,["if","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/user-card-button.hbs",isStrictMode:!1})
let p=e.default=(s=class extends i.default{constructor(){super(...arguments),u(this,"chat",o,this),u(this,"appEvents",l,this),u(this,"router",c,this)}get shouldRender(){return this.chat.userCanDirectMessage&&!this.args.user.suspended}startChatting(){return this.chat.upsertDmChannelForUsernames([this.args.user.username]).then((e=>{this.router.transitionTo("chat.channel",...e.routeModels),this.appEvents.trigger("card:close")}))}},o=d(s.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=d(s.prototype,"appEvents",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=d(s.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(s.prototype,"startChatting",[n.action],Object.getOwnPropertyDescriptor(s.prototype,"startChatting"),s.prototype),s);(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/collapser",["exports","@ember/component","@ember/object","@ember/template-factory"],(function(e,t,i,n){"use strict"
var r
function a(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const s=(0,n.createTemplateFactory)({id:"hDh7V21u",block:'[[[10,0],[14,0,"chat-message-collapser-header"],[12],[1,"\\n  "],[1,[30,0,["header"]]],[1,"\\n\\n"],[41,[30,0,["collapsed"]],[[[1,"    "],[8,[39,1],[[24,0,"chat-message-collapser-button chat-message-collapser-closed"]],[["@action","@icon"],[[30,0,["open"]],"caret-right"]],null],[1,"\\n"]],[]],[[[1,"    "],[8,[39,1],[[24,0,"chat-message-collapser-button chat-message-collapser-opened"]],[["@action","@icon"],[[30,0,["close"]],"caret-down"]],null],[1,"\\n"]],[]]],[13],[1,"\\n\\n"],[10,0],[15,0,[28,[37,2],["chat-message-collapser-body",[52,[30,0,["collapsed"]],"hidden"]],null]],[12],[1,"\\n  "],[18,1,[[30,0,["collapsed"]]]],[1,"\\n"],[13]],["&default"],false,["if","d-button","concat-class","yield"]]',moduleName:"discourse/plugins/chat/discourse/components/collapser.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(s,t.default.extend((a(r={tagName:"",collapsed:!1,header:null,onToggle:null,open(){this.set("collapsed",!1),this.onToggle?.(!1)},close(){this.set("collapsed",!0),this.onToggle?.(!0)}},"open",[i.action],Object.getOwnPropertyDescriptor(r,"open"),r),a(r,"close",[i.action],Object.getOwnPropertyDescriptor(r,"close"),r),r)))})),define("discourse/plugins/chat/discourse/components/dc-filter-input",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/modifier","ember-modifier","discourse/helpers/concat-class","discourse/helpers/noop","discourse-common/helpers/d-icon","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h
function p(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(h=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="isFocused",n=this,(i=d)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),p(this,"focusState",(0,a.modifier)((e=>{const t=()=>{this.isFocused=!0},i=()=>{this.isFocused=!1}
return e.addEventListener("focusin",t),e.addEventListener("focusout",i),()=>{e.removeEventListener("focusin",t),e.removeEventListener("focusout",i)}})))}},(0,n.setComponentTemplate)((0,c.createTemplateFactory)({id:"2icxyEEN",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],[[30,1],"dc-filter-input-container",[52,[30,0,["isFocused"]]," is-focused"]],null]],[12],[1,"\\n"],[41,[30,2,["left"]],[[[1,"        "],[1,[28,[32,1],[[30,2,["left"]]],[["class"],["-left"]]]],[1,"\\n"]],[]],null],[1,"\\n      "],[8,[32,2],[[24,0,"dc-filter-input"],[17,3],[4,[32,3],["input",[52,[30,5],[30,5],[28,[32,4],null,null]]],null],[4,[30,0,["focusState"]],null,null]],[["@value"],[[30,4]]],null],[1,"\\n\\n      "],[18,6,null],[1,"\\n\\n"],[41,[30,2,["right"]],[[[1,"        "],[1,[28,[32,1],[[30,2,["right"]]],[["class"],["-right"]]]],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@class","@icons","&attrs","@value","@filterAction","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/dc-filter-input.js",scope:()=>[s.default,l.default,n.Input,r.on,o.default],isStrictMode:!0}),h),m=(u=h).prototype,b="isFocused",g=[i.tracked],f={configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}},y={},Object.keys(f).forEach((function(e){y[e]=f[e]})),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=g.slice().reverse().reduce((function(e,t){return t(m,b,e)||e}),y),v&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(v):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(m,b,y),y=null),d=y,u)
var m,b,g,f,v,y})),define("discourse/plugins/chat/discourse/components/full-page-chat",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"K2Yc+5gj",block:'[[[42,[28,[37,1],[[28,[37,1],[[28,[37,2],[[30,1]],null]],null]],null],null,[[[1,"  "],[8,[39,3],null,[["@channel","@targetMessageId"],[[30,2],[30,3]]],null],[1,"\\n"]],[2]],null]],["@channel","channel","@targetMessageId"],false,["each","-track-array","array","chat-channel"]]',moduleName:"discourse/plugins/chat/discourse/components/full-page-chat.hbs",isStrictMode:!1})
let l=e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chat",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m;(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/reviewable-chat-message",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/service","discourse/plugins/chat/discourse/models/chat-channel","@ember/template-factory"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,s.createTemplateFactory)({id:"NmMCpC+0",block:'[[[10,0],[14,0,"flagged-post-header"],[12],[1,"\\n  "],[8,[39,0],null,[["@route","@models"],["chat.channel.near-message",[28,[37,1],[[30,0,["chatChannel","slugifiedTitle"]],[30,0,["chatChannel","id"]],[30,1,["target_id"]]],null]]],[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@channel"],[[30,0,["chatChannel"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"post-contents-wrapper"],[12],[1,"\\n  "],[8,[39,3],null,[["@user","@tagName"],[[30,1,["target_created_by"]],""]],null],[1,"\\n  "],[10,0],[14,0,"post-contents"],[12],[1,"\\n    "],[8,[39,4],null,[["@reviewable","@createdBy","@tagName"],[[30,1],[30,1,["target_created_by"]],""]],null],[1,"\\n\\n    "],[10,0],[14,0,"post-body"],[12],[1,"\\n      "],[1,[28,[35,5],[[28,[37,6],[[30,1,["payload","message_cooked"]],[30,1,["cooked"]]],null]],null]],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,1,["payload","transcript_topic_id"]],[[[1,"      "],[10,0],[14,0,"transcript"],[12],[1,"\\n        "],[8,[39,0],[[24,0,"btn btn-small"]],[["@route","@models"],["topic",[28,[37,1],["-",[30,1,["payload","transcript_topic_id"]]],null]]],[["default"],[[[[1,"\\n          "],[1,[28,[35,8],["review.transcript.view"],null]],[1,"\\n        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[18,2,null],[1,"\\n  "],[13],[1,"\\n"],[13]],["@reviewable","&default"],false,["link-to","array","chat-channel-title","reviewable-created-by","reviewable-post-header","html-safe","or","if","i18n","yield"]]',moduleName:"discourse/plugins/chat/discourse/components/reviewable-chat-message.hbs",isStrictMode:!1})
let p=e.default=(o=class extends i.default{constructor(){super(...arguments),u(this,"store",l,this),u(this,"chatChannelsManager",c,this)}get chatChannel(){return a.default.create(this.args.reviewable.chat_channel)}},l=d(o.prototype,"store",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=d(o.prototype,"chatChannelsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(o.prototype,"chatChannel",[n.cached],Object.getOwnPropertyDescriptor(o.prototype,"chatChannel"),o.prototype),o);(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-composer-message-details",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,o.createTemplateFactory)({id:"UdTTMEaX",block:'[[[8,[39,0],null,[["@title"],["<ChatComposerMessageDetails>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@message"],[[30,0,["message"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["Mode"]],[["default"],[[[[1,"\\n"],[41,[30,0,["message","editing"]],[[[1,"        "],[8,[39,6],null,[["@action","@translatedLabel"],[[30,0,["toggleMode"]],"Reply"]],null],[1,"\\n"]],[]],[[[1,"        "],[8,[39,6],null,[["@action","@translatedLabel"],[[30,0,["toggleMode"]],"Editing"]],null],[1,"\\n"]],[]]],[1,"    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat-composer-message-details","styleguide/controls","styleguide/controls/row","if","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-composer-message-details.hbs",isStrictMode:!1})
let g=e.default=(l=class extends i.default{constructor(){super(...arguments),p(this,"site",c,this),p(this,"session",u,this),p(this,"keyValueStore",d,this),p(this,"currentUser",h,this)}get message(){return s.default.message({user:this.currentUser})}toggleMode(){this.message.editing?(this.message.editing=!1,this.message.inReplyTo=s.default.message()):(this.message.editing=!0,this.message.inReplyTo=null)}},c=m(l.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=m(l.prototype,"session",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(l.prototype,"keyValueStore",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(l.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m(l.prototype,"message",[n.cached],Object.getOwnPropertyDescriptor(l.prototype,"message"),l.prototype),m(l.prototype,"toggleMode",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"toggleMode"),l.prototype),l);(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-composer",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/lib/fabricators","discourse/plugins/chat/discourse/models/chat-channel","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,o.createTemplateFactory)({id:"44rPT0VR",block:'[[[8,[39,0],null,[["@title"],["<ChatComposer>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@channel","@onSendMessage"],[[30,0,["channel"]],[30,0,["onSendMessage"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["Disabled"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleDisabled"]]],null]],[["@state"],[[30,0,["channel","isReadOnly"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Sending"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleSending"]]],null]],[["@state"],[[30,0,["chatChannelPane","sending"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/composer/channel","styleguide/controls","styleguide/controls/row","d-toggle-switch","on"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-composer.hbs",isStrictMode:!1})
let b=e.default=(l=class extends i.default{constructor(){super(...arguments),d(this,"chatChannelComposer",c,this),d(this,"chatChannelPane",u,this),h(this,"channel",a.default.channel({id:-999}))}toggleDisabled(){this.channel.status===s.CHANNEL_STATUSES.open?this.channel.status=s.CHANNEL_STATUSES.readOnly:this.channel.status=s.CHANNEL_STATUSES.open}toggleSending(){this.chatChannelPane.sending=!this.chatChannelPane.sending}onSendMessage(){this.chatChannelComposer.reset()}},c=p(l.prototype,"chatChannelComposer",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"chatChannelPane",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(l.prototype,"toggleDisabled",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"toggleDisabled"),l.prototype),p(l.prototype,"toggleSending",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"toggleSending"),l.prototype),p(l.prototype,"onSendMessage",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"onSendMessage"),l.prototype),l);(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-header-icon",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","discourse/plugins/chat/discourse/controllers/preferences-chat","@ember/template-factory"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,s.createTemplateFactory)({id:"3vsUy2AB",block:'[[[8,[39,0],null,[["@title"],["<Chat::Header::Icon>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[10,"header"],[14,0,"d-header"],[14,5,"display: flex; align-items: center; justify-content: center;"],[12],[1,"\\n      "],[10,"ul"],[14,0,"d-header-icons"],[12],[1,"\\n        "],[10,"li"],[14,0,"header-dropdown-toggle chat-header-icon"],[12],[1,"\\n          "],[8,[39,2],null,[["@isActive","@currentUserInDnD","@unreadCount","@urgentCount","@indicatorPreference"],[[30,0,["isActive"]],[30,0,["currentUserInDnD"]],[30,0,["unreadCount"]],[30,0,["urgentCount"]],[30,0,["indicatorPreference"]]]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["isActive"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleIsActive"]]],null]],[["@state"],[[30,0,["isActive"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["currentUserInDnD"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleCurrentUserInDnD"]]],null]],[["@state"],[[30,0,["currentUserInDnD"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,4],null,[["@name"],["Unread count"]],[["default"],[[[[1,"\\n    "],[11,"input"],[16,2,[30,0,["unreadCount"]]],[24,4,"number"],[4,[38,6],["input",[30,0,["updateUnreadCount"]]],null],[12],[13],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,4],null,[["@name"],["Urgent count"]],[["default"],[[[[1,"\\n    "],[11,"input"],[16,2,[30,0,["urgentCount"]]],[24,4,"number"],[4,[38,6],["input",[30,0,["updateUrgentCount"]]],null],[12],[13],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,4],null,[["@name"],["Indicator preference"]],[["default"],[[[[1,"\\n    "],[8,[39,7],null,[["@value","@content","@onChange","@valueProperty","@nameProperty"],[[30,0,["indicatorPreference"]],[30,0,["indicatorPreferences"]],[30,0,["updateIndicatorPreference"]],null,null]],null],[1,"\\n\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/header/icon","styleguide/controls","styleguide/controls/row","d-toggle-switch","on","combo-box"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-header-icon.hbs",isStrictMode:!1})
let g=e.default=(o=class extends i.default{constructor(){super(...arguments),p(this,"isActive",l,this),p(this,"currentUserInDnD",c,this),p(this,"urgentCount",u,this),p(this,"unreadCount",d,this),p(this,"indicatorPreference",h,this)}get indicatorPreferences(){return[a.HEADER_INDICATOR_PREFERENCE_ALL_NEW,a.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS,a.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS,a.HEADER_INDICATOR_PREFERENCE_NEVER]}toggleIsActive(){this.isActive=!this.isActive}toggleCurrentUserInDnD(){this.currentUserInDnD=!this.currentUserInDnD}updateUnreadCount(e){this.unreadCount=e.target.value}updateUrgentCount(e){this.urgentCount=e.target.value}updateIndicatorPreference(e){this.indicatorPreference=e}},l=m(o.prototype,"isActive",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=m(o.prototype,"currentUserInDnD",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=m(o.prototype,"urgentCount",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(o.prototype,"unreadCount",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(o.prototype,"indicatorPreference",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return a.HEADER_INDICATOR_PREFERENCE_ALL_NEW}}),m(o.prototype,"toggleIsActive",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"toggleIsActive"),o.prototype),m(o.prototype,"toggleCurrentUserInDnD",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"toggleCurrentUserInDnD"),o.prototype),m(o.prototype,"updateUnreadCount",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"updateUnreadCount"),o.prototype),m(o.prototype,"updateUrgentCount",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"updateUrgentCount"),o.prototype),m(o.prototype,"updateIndicatorPreference",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"updateIndicatorPreference"),o.prototype),o);(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-message",["exports","@ember/component","@glimmer/component","@ember/application","@ember/object","@ember/service","discourse/plugins/chat/discourse/lib/chat-messages-manager","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u
function d(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,l.createTemplateFactory)({id:"4ZwlpP03",block:'[[[8,[39,0],null,[["@title"],["<ChatMessage>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@message","@context"],[[30,0,["message"]],"channel"]],null],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["Last Visit"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleLastVisit"]]],null]],[["@state"],[[30,0,["message","newest"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Deleted"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleDeleted"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","deletedAt"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Bookmark"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleBookmarked"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","bookmark"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Thread"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleThread"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","thread"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Reactions"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleReaction"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","reactions"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Upload"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleUpload"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","uploads"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Message"]],[["default"],[[[[1,"\\n      "],[11,"textarea"],[4,[38,6],["input",[30,0,["updateMessage"]]],null],[12],[1,[30,0,["message","message"]]],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat-message","styleguide/controls","styleguide/controls/row","d-toggle-switch","on","not"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-message.hbs",isStrictMode:!1})
let m=e.default=(c=class extends i.default{constructor(){var e,t,i,r
super(...arguments),e=this,t="currentUser",r=this,(i=u)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0}),d(this,"manager",new s.default((0,n.getOwner)(this))),this.message=o.default.message({user:this.currentUser}),this.message.cook()}toggleDeleted(){this.message.deletedAt?this.message.deletedAt=null:this.message.deletedAt=moment()}toggleBookmarked(){this.message.bookmark?this.message.bookmark=null:this.message.bookmark=o.default.bookmark()}toggleHighlighted(){this.message.highlighted=!this.message.highlighted}toggleEdited(){this.message.edited=!this.message.edited}toggleLastVisit(){this.message.newest=!this.message.newest}toggleThread(){this.message.thread?(this.message.channel.threadingEnabled=!1,this.message.thread=null):(this.message.thread=o.default.thread({channel:this.message.channel}),this.message.thread.preview.replyCount=1,this.message.channel.threadingEnabled=!0)}async updateMessage(e){this.message.message=e.target.value,await this.message.cook()}toggleReaction(){this.message.reactions?.length?this.message.reactions=[]:this.message.reactions=[o.default.reaction({emoji:"heart"}),o.default.reaction({emoji:"rocket",reacted:!0})]}toggleUpload(){this.message.uploads?.length?this.message.uploads=[]:this.message.uploads=[o.default.upload(),o.default.upload()]}},u=h(c.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(c.prototype,"toggleDeleted",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleDeleted"),c.prototype),h(c.prototype,"toggleBookmarked",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleBookmarked"),c.prototype),h(c.prototype,"toggleHighlighted",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleHighlighted"),c.prototype),h(c.prototype,"toggleEdited",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleEdited"),c.prototype),h(c.prototype,"toggleLastVisit",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleLastVisit"),c.prototype),h(c.prototype,"toggleThread",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleThread"),c.prototype),h(c.prototype,"updateMessage",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"updateMessage"),c.prototype),h(c.prototype,"toggleReaction",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleReaction"),c.prototype),h(c.prototype,"toggleUpload",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleUpload"),c.prototype),c);(0,t.setComponentTemplate)(p,m)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-archive-channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/archive-channel","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,o.createTemplateFactory)({id:"6txBnytZ",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ArchiveChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-archive-channel.hbs",isStrictMode:!1})
let p=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"channel",s.default.channel())}openModal(){return this.modal.show(a.default,{model:{channel:this.channel}})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(h,p)}))
define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-channel-summary",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/channel-summary","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,o.createTemplateFactory)({id:"9Nkr9oRZ",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ChannelSummary>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-channel-summary.hbs",isStrictMode:!1})
let h=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default,{model:{channelId:s.default.channel().id}})}},c=u(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-create-channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/create-channel","@ember/template-factory"],(function(e,t,i,n,r,a,s){"use strict"
var o,l
function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u=(0,s.createTemplateFactory)({id:"W0WNy+Vl",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::CreateChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-create-channel.hbs",isStrictMode:!1})
let d=e.default=(o=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default)}},l=c(o.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(o.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(o.prototype,"openModal"),o.prototype),o);(0,t.setComponentTemplate)(u,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-delete-channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/delete-channel","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,o.createTemplateFactory)({id:"RePA6/AH",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::DeleteChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-delete-channel.hbs",isStrictMode:!1})
let p=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"channel",s.default.channel())}openModal(){return this.modal.show(a.default,{model:{channel:this.channel}})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-description",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,o.createTemplateFactory)({id:"3ae/A2qR",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::EditChannelDescription>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-description.hbs",isStrictMode:!1})
let p=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"channel",s.default.channel())}openModal(){return this.modal.show(a.default,{model:this.channel})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-name",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,o.createTemplateFactory)({id:"ilAVl2Kg",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::EditChannelName>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-name.hbs",isStrictMode:!1})
let p=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"channel",s.default.channel())}openModal(){return this.modal.show(a.default,{model:this.channel})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-move-message-to-channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,o.createTemplateFactory)({id:"ATPl85dR",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::MoveMessageToChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-move-message-to-channel.hbs",isStrictMode:!1})
let p=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"channel",s.default.channel()),u(this,"selectedMessageIds",[s.default.message({channel:this.channel})].mapBy("id"))}openModal(){return this.modal.show(a.default,{model:{sourceChannel:this.channel,selectedMessageIds:[s.default.message({channel:this.channel})].mapBy("id")}})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-new-message",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/new-message","@ember/template-factory"],(function(e,t,i,n,r,a,s){"use strict"
var o,l
function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u=(0,s.createTemplateFactory)({id:"tf8RWlBH",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::NewMessage>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-new-message.hbs",isStrictMode:!1})
let d=e.default=(o=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default)}},l=c(o.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(o.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(o.prototype,"openModal"),o.prototype),o);(0,t.setComponentTemplate)(u,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-thread-settings",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/thread-settings","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,o.createTemplateFactory)({id:"fzsrgZZ3",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ThreadSettings>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-thread-settings.hbs",isStrictMode:!1})
let h=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default,{model:s.default.thread()})}},c=u(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-toggle-channel-status",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,o.createTemplateFactory)({id:"h5sT+PPJ",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ToggleChannelStatus>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-toggle-channel-status.hbs",isStrictMode:!1})
let h=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default,{model:s.default.channel()})}},c=u(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-thread-list-item",["exports","@ember/component","@glimmer/component","@ember/service","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o
function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,a.createTemplateFactory)({id:"lR91t83a",block:'[[[8,[39,0],null,[["@title"],["<Chat::ThreadList::Item>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@thread"],[[30,0,["thread"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/thread-list/item"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-thread-list-item.hbs",isStrictMode:!1})
let u=e.default=(s=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),l(this,"thread",r.default.thread())}},d=s.prototype,h="currentUser",p=[n.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),o=g,s)
var d,h,p,m,b,g;(0,t.setComponentTemplate)(c,u)})),define("discourse/plugins/chat/discourse/components/styleguide/organisms/chat",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"P8l1UR5w",block:'[[[8,[39,0],null,null,null],[1,"\\n"],[8,[39,1],null,null,null],[1,"\\n"],[8,[39,2],null,null,null],[1,"\\n"],[8,[39,3],null,null,null],[1,"\\n"],[8,[39,4],null,null,null],[1,"\\n\\n"],[10,"h2"],[12],[1,"Modals"],[13],[1,"\\n\\n"],[8,[39,5],null,null,null],[1,"\\n"],[8,[39,6],null,null,null],[1,"\\n"],[8,[39,7],null,null,null],[1,"\\n"],[8,[39,8],null,null,null],[1,"\\n"],[8,[39,9],null,null,null],[1,"\\n"],[8,[39,10],null,null,null],[1,"\\n"],[8,[39,11],null,null,null],[1,"\\n"],[8,[39,12],null,null,null],[1,"\\n"],[8,[39,13],null,null,null],[1,"\\n"],[8,[39,14],null,null,null]],[],false,["styleguide/chat-message","styleguide/chat-composer","styleguide/chat-thread-list-item","styleguide/chat-composer-message-details","styleguide/chat-header-icon","styleguide/chat-modal-archive-channel","styleguide/chat-modal-move-message-to-channel","styleguide/chat-modal-delete-channel","styleguide/chat-modal-edit-channel-description","styleguide/chat-modal-edit-channel-name","styleguide/chat-modal-thread-settings","styleguide/chat-modal-create-channel","styleguide/chat-modal-toggle-channel-status","styleguide/chat-modal-new-message","styleguide/chat-modal-channel-summary"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/organisms/chat.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/toggle-channel-membership-button",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/lib/ajax-error","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,l.createTemplateFactory)({id:"CWfAxj6k",block:'[[[41,[30,1,["currentUserMembership","following"]],[[[1,"  "],[8,[39,1],[[16,0,[28,[37,2],["toggle-channel-membership-button -leave btn-flat",[30,0,["options","leaveClass"]]],null]]],[["@action","@translatedLabel","@translatedTitle","@icon","@disabled"],[[30,0,["onLeaveChannel"]],[30,0,["label"]],[30,0,["options","leaveTitle"]],[30,0,["options","leaveIcon"]],[30,0,["isLoading"]]]],null],[1,"\\n"]],[]],[[[1,"  "],[8,[39,1],[[16,0,[28,[37,2],["toggle-channel-membership-button -join",[30,0,["options","joinClass"]]],null]]],[["@action","@translatedLabel","@translatedTitle","@icon","@disabled"],[[30,0,["onJoinChannel"]],[30,0,["label"]],[30,0,["options","joinTitle"]],[30,0,["options","joinIcon"]],[30,0,["isLoading"]]]],null],[1,"\\n"]],[]]]],["@channel"],false,["if","d-button","concat-class"]]',moduleName:"discourse/plugins/chat/discourse/components/toggle-channel-membership-button.hbs",isStrictMode:!1})
let g=e.default=(c=class extends i.default{constructor(){super(...arguments),h(this,"chat",u,this),h(this,"isLoading",d,this),p(this,"onToggle",null),p(this,"options",{}),this.options={labelType:"normal",joinTitle:o.default.t("chat.channel_settings.join_channel"),joinIcon:"",joinClass:"",leaveTitle:o.default.t("chat.channel_settings.leave_channel"),leaveIcon:"",leaveClass:"",...this.args.options}}get label(){return"none"===this.options.labelType?"":"short"===this.options.labelType?this.args.channel.currentUserMembership.following?o.default.t("chat.channel_settings.leave"):o.default.t("chat.channel_settings.join"):this.args.channel.currentUserMembership.following?o.default.t("chat.channel_settings.leave_channel"):o.default.t("chat.channel_settings.join_channel")}onJoinChannel(){return this.isLoading=!0,this.chat.followChannel(this.args.channel).then((()=>{this.onToggle?.()})).catch(s.popupAjaxError).finally((()=>{this.isDestroying||this.isDestroyed||(this.isLoading=!1)}))}onLeaveChannel(){return this.isLoading=!0,this.chat.unfollowChannel(this.args.channel).then((()=>{this.onToggle?.()})).catch(s.popupAjaxError).finally((()=>{this.isDestroying||this.isDestroyed||(this.isLoading=!1)}))}},u=m(c.prototype,"chat",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(c.prototype,"isLoading",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m(c.prototype,"onJoinChannel",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"onJoinChannel"),c.prototype),m(c.prototype,"onLeaveChannel",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"onLeaveChannel"),c.prototype),c);(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/user-menu/chat-notifications-list-empty-state",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"O6dDc9NT",block:'[[[10,0],[14,0,"empty-state"],[12],[1,"\\n  "],[10,1],[14,0,"empty-state-title"],[12],[1,"\\n    "],[1,[28,[35,0],["user_menu.no_chat_notifications_title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"empty-state-body"],[12],[1,"\\n    "],[10,2],[12],[1,"\\n      "],[1,[28,[35,1],[[28,[37,0],["user_menu.no_chat_notifications_body"],[["preferencesUrl"],[[28,[37,2],["/my/preferences/notifications"],null]]]]],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],[],false,["i18n","html-safe","get-url"]]',moduleName:"discourse/plugins/chat/discourse/components/user-menu/chat-notifications-list-empty-state.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/user-menu/chat-notifications-list",["exports","discourse/components/user-menu/notifications-list"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{get dismissTypes(){return this.filterByTypes}get emptyStateComponent(){return"user-menu/chat-notifications-list-empty-state"}}e.default=i})),define("discourse/plugins/chat/discourse/connectors/user-preferences-nav/chat-preferences",["exports","@glimmer/component"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{static shouldRender(e,t){let{model:i}=e,{siteSettings:n,currentUser:r}=t
return n.chat_enabled&&(i.can_chat||r?.admin)}}e.default=i})),define("discourse/plugins/chat/discourse/controllers/admin-plugins-chat",["exports","@ember/controller","@ember/object","@ember/object/computed","@ember/service","discourse/lib/ajax","discourse/lib/ajax-error","discourse-i18n"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(l=(0,n.and)("newWebhookName","newWebhookChannelId"),c=(0,i.computed)("model.incoming_chat_webhooks.@each.updated_at"),u=(0,i.computed)("selectedWebhookId"),d=(0,i.computed)("selectedWebhook.name","selectedWebhook.chat_channel.id"),h=class extends t.default{constructor(){super(...arguments),b(this,"dialog",p,this),g(this,"queryParams",[{selectedWebhookId:"id"}]),g(this,"loading",!1),g(this,"creatingNew",!1),g(this,"newWebhookName",""),g(this,"newWebhookChannelId",null),g(this,"emojiPickerIsActive",!1),b(this,"nameAndChannelValid",m,this)}get sortedWebhooks(){return this.model.incoming_chat_webhooks?.sortBy("updated_at").reverse()||[]}get selectedWebhook(){if(!this.selectedWebhookId)return
const e=parseInt(this.selectedWebhookId,10)
return this.model.incoming_chat_webhooks.findBy("id",e)}get saveEditDisabled(){return!this.selectedWebhook.name||!this.selectedWebhook.chat_channel.id}createNewWebhook(){if(this.loading)return
this.set("loading",!0)
const e={name:this.newWebhookName,chat_channel_id:this.newWebhookChannelId}
return(0,a.ajax)("/admin/plugins/chat/hooks",{data:e,type:"POST"}).then((e=>{const t=i.default.create(e)
this.set("model.incoming_chat_webhooks",[t].concat(this.model.incoming_chat_webhooks)),this.resetNewWebhook(),this.setProperties({loading:!1,selectedWebhookId:t.id})})).catch(s.popupAjaxError)}resetNewWebhook(){this.setProperties({creatingNew:!1,newWebhookName:"",newWebhookChannelId:null})}destroyWebhook(e){this.dialog.deleteConfirm({message:o.default.t("chat.incoming_webhooks.confirm_destroy"),didConfirm:()=>(this.set("loading",!0),(0,a.ajax)(`/admin/plugins/chat/hooks/${e.id}`,{type:"DELETE"}).then((()=>{this.model.incoming_chat_webhooks.removeObject(e),this.set("loading",!1)})).catch(s.popupAjaxError))})}emojiSelected(e){return this.selectedWebhook.set("emoji",`:${e}:`),this.set("emojiPickerIsActive",!1)}saveEdit(){this.set("loading",!0)
const e={name:this.selectedWebhook.name,chat_channel_id:this.selectedWebhook.chat_channel.id,description:this.selectedWebhook.description,emoji:this.selectedWebhook.emoji,username:this.selectedWebhook.username}
return(0,a.ajax)(`/admin/plugins/chat/hooks/${this.selectedWebhook.id}`,{data:e,type:"PUT"}).then((()=>{this.selectedWebhook.set("updated_at",new Date),this.setProperties({loading:!1,selectedWebhookId:null})})).catch(s.popupAjaxError)}changeChatChannel(e){this.selectedWebhook.set("chat_channel",this.model.chat_channels.findBy("id",e))}},p=f(h.prototype,"dialog",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=f(h.prototype,"nameAndChannelValid",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(h.prototype,"sortedWebhooks",[c],Object.getOwnPropertyDescriptor(h.prototype,"sortedWebhooks"),h.prototype),f(h.prototype,"selectedWebhook",[u],Object.getOwnPropertyDescriptor(h.prototype,"selectedWebhook"),h.prototype),f(h.prototype,"saveEditDisabled",[d],Object.getOwnPropertyDescriptor(h.prototype,"saveEditDisabled"),h.prototype),f(h.prototype,"createNewWebhook",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"createNewWebhook"),h.prototype),f(h.prototype,"resetNewWebhook",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"resetNewWebhook"),h.prototype),f(h.prototype,"destroyWebhook",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"destroyWebhook"),h.prototype),f(h.prototype,"emojiSelected",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"emojiSelected"),h.prototype),f(h.prototype,"saveEdit",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"saveEdit"),h.prototype),f(h.prototype,"changeChatChannel",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"changeChatChannel"),h.prototype),h)})),define("discourse/plugins/chat/discourse/controllers/chat-channel-index",["exports","@ember/controller"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{}e.default=i})),define("discourse/plugins/chat/discourse/controllers/chat-channel-thread",["exports","@glimmer/tracking","@ember/controller","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(){super(...arguments),o(this,"chat",a,this),o(this,"targetMessageId",s,this)}},a=l(r.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=l(r.prototype,"targetMessageId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),r)})),define("discourse/plugins/chat/discourse/controllers/chat-channel",["exports","@glimmer/tracking","@ember/controller","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(){super(...arguments),o(this,"chat",a,this),o(this,"targetMessageId",s,this),l(this,"queryParams",["messageId"])}},a=c(r.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"targetMessageId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),r)})),define("discourse/plugins/chat/discourse/controllers/chat-draft-channel",["exports","@ember/controller","@ember/service"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},a=n.prototype,s="chat",o=[i.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/controllers/chat-index",["exports","@ember/controller","@ember/service"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},a=n.prototype,s="chat",o=[i.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/controllers/chat",["exports","@ember/controller","@ember/service"],(function(e,t,i){"use strict"
var n,r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends t.default{constructor(){super(...arguments),o(this,"chat",r,this),o(this,"chatStateManager",a,this),o(this,"router",s,this)}get shouldUseChatSidebar(){return!this.site.mobileView&&!this.shouldUseCoreSidebar}get shouldUseCoreSidebar(){return"sidebar"===this.siteSettings.navigation_menu}get mainOutletModifierClasses(){let e=[]
return this.chatStateManager.isSidePanelExpanded&&e.push("has-side-panel-expanded"),this.router.currentRouteName.startsWith("chat.channel.info")||this.router.currentRouteName.startsWith("chat.browse")||e.push("chat-view"),e.join(" ")}},r=l(n.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=l(n.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=l(n.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/controllers/preferences-chat",["exports","@ember/controller","@ember/object","@ember/service","discourse/lib/ajax-error","discourse-common/config/environment","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/services/chat-audio-manager"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS=e.HEADER_INDICATOR_PREFERENCE_NEVER=e.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS=e.HEADER_INDICATOR_PREFERENCE_ALL_NEW=void 0
const b=["chat_enabled","only_chat_push_notifications","ignore_channel_wide_mention","chat_sound","chat_email_frequency","chat_header_indicator_preference","chat_separate_sidebar_mode"],g=[{name:o.default.t("chat.email_frequency.never"),value:"never"},{name:o.default.t("chat.email_frequency.when_away"),value:"when_away"}],f=e.HEADER_INDICATOR_PREFERENCE_NEVER="never",v=e.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS="dm_and_mentions",y=e.HEADER_INDICATOR_PREFERENCE_ALL_NEW="all_new",w=e.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS="only_mentions",_=[{name:o.default.t("chat.header_indicator_preference.all_new"),value:y},{name:o.default.t("chat.header_indicator_preference.dm_and_mentions"),value:v},{name:o.default.t("chat.header_indicator_preference.only_mentions"),value:w},{name:o.default.t("chat.header_indicator_preference.never"),value:f}],j=[{name:o.default.t("admin.site_settings.chat_separate_sidebar_mode.always"),value:"always"},{name:o.default.t("admin.site_settings.chat_separate_sidebar_mode.fullscreen"),value:"fullscreen"},{name:o.default.t("admin.site_settings.chat_separate_sidebar_mode.never"),value:"never"}]
e.default=(c=class extends t.default{constructor(){super(...arguments),h(this,"chatAudioManager",u,this),h(this,"siteSettings",d,this),p(this,"subpageTitle",o.default.t("chat.admin.title")),p(this,"emailFrequencyOptions",g),p(this,"headerIndicatorOptions",_),p(this,"chatSeparateSidebarModeOptions",j)}get chatSeparateSidebarMode(){const e=this.model.get("user_option.chat_separate_sidebar_mode")
return"default"===e?this.siteSettings.chat_separate_sidebar_mode:e}chatSounds(){return Object.keys(l.CHAT_SOUNDS).map((e=>({name:o.default.t(`chat.sounds.${e}`),value:e})))}onChangeChatSound(e){e&&this.chatAudioManager.playImmediately(e),this.model.set("user_option.chat_sound",e)}save(){return this.set("saved",!1),this.model.save(b).then((()=>{this.set("saved",!0),(0,a.isTesting)()||location.reload()})).catch(r.popupAjaxError)}},u=m(c.prototype,"chatAudioManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(c.prototype,"siteSettings",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m(c.prototype,"chatSounds",[s.default],Object.getOwnPropertyDescriptor(c.prototype,"chatSounds"),c.prototype),m(c.prototype,"onChangeChatSound",[i.action],Object.getOwnPropertyDescriptor(c.prototype,"onChangeChatSound"),c.prototype),m(c.prototype,"save",[i.action],Object.getOwnPropertyDescriptor(c.prototype,"save"),c.prototype),c)})),define("discourse/plugins/chat/discourse/helpers/chat-guardian",["exports","@ember/component/helper","@ember/service","@ember/string"],(function(e,t,i,n){"use strict"
var r,a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatGuardian",n=this,(i=a)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}compute(e){const[t,...i]=e
if(t)return this.chatGuardian[(0,n.camelize)(t)]?.(...i)}},s=r.prototype,o="chatGuardian",l=[i.inject],c={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),a=d,r)
var s,o,l,c,u,d})),define("discourse/plugins/chat/discourse/helpers/format-chat-date",["exports","@ember/template","discourse/models/user","discourse-common/lib/get-url","discourse-i18n"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,a){const s=i.default.current(),o=s?s.user_option.timezone:moment.tz.guess(),l=moment(new Date(e.createdAt),o),c=l.format(r.default.t("dates.long_with_year")),u="tiny"===a?l.format(r.default.t("chat.dates.time_tiny")):l.format(r.default.t("dates.time"))
if(e.staged)return(0,t.htmlSafe)(`<span title='${c}' tabindex="-1" class='chat-time'>${u}</span>`)
{const i=(0,n.default)(`/chat/c/-/${e.channel.id}/${e.id}`)
return(0,t.htmlSafe)(`<a title='${c}' tabindex="-1" class='chat-time' href='${i}'>${u}</a>`)}}})),define("discourse/plugins/chat/discourse/helpers/tonable-emoji-title",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,t){if(!e.tonable||1===t)return`:${e.name}:`
return`:${e.name}:t${t}:`}})),define("discourse/plugins/chat/discourse/helpers/tonable-emoji-url",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,t){if(!e.tonable||1===t)return e.url
return e.url.split(".png")[0]+`/${t}.png`}})),define("discourse/plugins/chat/discourse/initializers/chat-audio",["exports","discourse/lib/plugin-api"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=[29,30]
e.default={name:"chat-audio",initialize(e){if(!e.lookup("service:chat").userCanChat)return
const n=e.lookup("service:chat-audio-manager")
n.setup(),(0,t.withPluginApi)("0.12.1",(e=>{e.registerDesktopNotificationHandler(((e,t,r)=>{r.isInDoNotDisturb()||r.chat_sound&&i.includes(e.notification_type)&&n.play(r.chat_sound)}))}))}}})),define("discourse/plugins/chat/discourse/initializers/chat-decorators",["exports","discourse/helpers/loading-spinner","discourse/instance-initializers/onebox-decorators","discourse/lib/hashtag-autocomplete","discourse/lib/highlight-syntax","discourse/lib/load-script","discourse/lib/plugin-api","discourse/lib/url","discourse-common/lib/get-url","discourse-i18n"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-decorators",initializeWithPluginApi(e,t){const a=t.lookup("service:site-settings"),s=t.lookup("service:lightbox"),o=t.lookup("service:site")
e.decorateChatMessage((e=>(0,i.decorateGithubOneboxBody)(e)),{id:"onebox-github-body"}),e.decorateChatMessage((e=>{e.querySelectorAll(".onebox.githubblob li.selected").forEach((e=>{const t=this._getScrollParent(e,"onebox")
if(!t)return
const i=t.offsetHeight-t.clientHeight
t.scroll({top:e.offsetTop+i-t.offsetHeight/2+e.offsetHeight/2})}))}),{id:"onebox-github-scrolling"}),e.decorateChatMessage((e=>(0,r.default)(e,a,t.lookup("service:session"))),{id:"highlightSyntax"}),e.decorateChatMessage(this.renderChatTranscriptDates,{id:"transcriptDates"}),e.decorateChatMessage(this.forceLinksToOpenNewTab,{id:"linksNewTab"}),a.enable_experimental_lightbox?e.decorateChatMessage((e=>{s.setupLightboxes({container:e,selector:"img:not(.emoji, .avatar, .site-icon)"})}),{id:"experimental-chat-lightbox"}):e.decorateChatMessage((e=>this.lightbox(e.querySelectorAll("img:not(.emoji, .avatar)"))),{id:"lightbox"}),e.decorateChatMessage((e=>(0,n.decorateHashtags)(e,o)),{id:"hashtagIcons"})},_getScrollParent(e,t){return null===e||e.classList.contains(t)?null:e.scrollHeight>e.clientHeight?e:this._getScrollParent(e.parentNode,t)},renderChatTranscriptDates(e){e.querySelectorAll(".chat-transcript").forEach((e=>{const t=e.dataset.datetime,i=e.querySelector(".chat-transcript-datetime a")
i&&""===i.innerText&&(this.currentUserTimezone?i.innerText=moment.tz(t,this.currentUserTimezone).format(c.default.t("dates.long_no_year")):i.innerText=moment(t).format(c.default.t("dates.long_no_year")))}))},forceLinksToOpenNewTab(e){const t=e.querySelectorAll(".chat-message-text a:not([target='_blank'])")
for(let i=0;i<t.length;i++){const e=t[i]
o.default.isInternal(e.href)&&(0,l.samePrefix)(e.href)||e.setAttribute("target","_blank")}},lightbox(e){(0,a.default)("/javascripts/jquery.magnific-popup.min.js").then((function(){$(e).magnificPopup({type:"image",closeOnContentClick:!1,mainClass:"mfp-zoom-in",tClose:c.default.t("lightbox.close"),tLoading:t.spinnerHTML,image:{verticalFit:!0},callbacks:{elementParse:e=>{e.src=e.el[0].src}}})}))},initialize(e){e.lookup("service:chat").userCanChat&&(0,s.withPluginApi)("0.8.42",(t=>this.initializeWithPluginApi(t,e)))}}})),define("discourse/plugins/chat/discourse/initializers/chat-keyboard-shortcuts",["exports","discourse/lib/keyboard-shortcuts","discourse/lib/plugin-api","discourse/plugins/chat/discourse/components/chat/modal/new-message"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-keyboard-shortcuts",initialize(e){const r=e.lookup("service:chat")
if(!r.userCanChat)return
const a=e.lookup("service:router"),s=e.lookup("service:app-events"),o=e.lookup("service:modal"),l=e.lookup("service:chat-state-manager"),c=e.lookup("service:chat-thread-pane"),u=e.lookup("service:chat-thread-list-pane"),d=e.lookup("service:chat-channels-manager"),h=e=>{e.preventDefault(),e.stopPropagation(),o.show(n.default)},p=e=>{e.preventDefault(),e.stopPropagation(),r.switchChannelUpOrDown("up")},m=e=>{e.preventDefault(),e.stopPropagation(),r.switchChannelUpOrDown("down")},b=e=>e.classList.contains("chat-composer__input"),g=(e,t)=>{b(e.target)&&(e.preventDefault(),e.stopPropagation(),s.trigger("chat:modify-selection",e,{type:t,context:e.target.dataset.chatComposerContext}))};(0,i.withPluginApi)("0.12.1",(e=>{e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+k`,h,{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.open_quick_channel_selector",definition:{keys1:["meta","k"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut("alt+up",p,{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.switch_channel_arrows",definition:{keys1:["alt","&uarr;"],keys2:["alt","&darr;"],keysDelimiter:"plus",shortcutsDelimiter:"slash"}}}),e.addKeyboardShortcut("alt+down",m,{global:!0}),e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+b`,(e=>g(e,"bold")),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.composer_bold",definition:{keys1:["meta","b"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+i`,(e=>g(e,"italic")),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.composer_italic",definition:{keys1:["meta","i"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+e`,(e=>g(e,"code")),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.composer_code",definition:{keys1:["meta","e"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+l`,(e=>(e=>{b(e.target)&&(e.preventDefault(),e.stopPropagation(),s.trigger("chat:open-insert-link-modal",e,{context:e.target.dataset.chatComposerContext}))})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.open_insert_link_modal",definition:{keys1:["meta","l"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut("-",(e=>(e=>{(e=>{const t=e?.tagName.toLowerCase()
return!["input","textarea","select","button"].includes(t)})(e.target)&&(e.preventDefault(),e.stopPropagation(),l.prefersDrawer(),a.transitionTo(l.lastKnownChatURL||"chat"))})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.drawer_open",definition:{keys1:["-"]}}}),e.addKeyboardShortcut("esc",(e=>(e=>{if(!e.srcElement?.classList?.value?.includes("mfp-wrap"))return l.isDrawerActive?(e.preventDefault(),e.stopPropagation(),void s.trigger("chat:toggle-close",e)):c.isOpened?(e.preventDefault(),e.stopPropagation(),void c.close()):u.isOpened?(e.preventDefault(),e.stopPropagation(),void u.close()):void 0})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.drawer_close",definition:{keys1:["esc"]}}}),e.addKeyboardShortcut("shift+esc",(e=>(e=>{e.preventDefault(),e.stopPropagation(),l.isActive&&d.markAllChannelsRead()})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.mark_all_channels_read",definition:{keys1:["shift","esc"],keysDelimiter:"plus"}}})}))}}}))
define("discourse/plugins/chat/discourse/initializers/chat-plugin-decorators",["exports","discourse/lib/local-dates","discourse/lib/plugin-api"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-plugin-decorators",initializeWithPluginApi(e,i){if(e.decorateChatMessage((e=>{(0,t.applyLocalDates)(e.querySelectorAll(".discourse-local-date"),i)}),{id:"local-dates"}),i.spoiler_enabled){const t=requirejs("discourse/plugins/spoiler-alert/lib/apply-spoiler").default
e.decorateChatMessage((e=>{e.querySelectorAll(".spoiler").forEach((e=>{e.classList.remove("spoiler"),e.classList.add("spoiled"),t(e)}))}),{id:"spoiler"})}},initialize(e){if(e.lookup("service:chat").userCanChat){const t=e.lookup("service:site-settings");(0,i.withPluginApi)("0.8.42",(e=>{this.initializeWithPluginApi(e,t)}))}}}})),define("discourse/plugins/chat/discourse/initializers/chat-setup",["exports","discourse/lib/plugin-api","discourse-common/lib/get-owner","discourse-common/lib/icon-library","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/lib/chat-composer-buttons","discourse/plugins/chat/discourse/lib/hashtag-types/channel","discourse/plugins/chat/discourse/components/styleguide/organisms/chat"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u
function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}let h
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;(0,n.replaceIcon)("d-chat","comment")
e.default=(d(u={name:"chat-setup",before:"hashtag-css-generator",initialize(e){this.router=e.lookup("service:router"),this.chatService=e.lookup("service:chat"),this.chatHistory=e.lookup("service:chat-history"),this.site=e.lookup("service:site"),this.siteSettings=e.lookup("service:site-settings"),this.currentUser=e.lookup("service:current-user"),this.appEvents=e.lookup("service:app-events"),this.appEvents.on("discourse:focus-changed",this,"_handleFocusChanged"),this.chatService.userCanChat&&(0,t.withPluginApi)("0.12.1",(t=>{t.onPageChange((e=>{const t=this.router.recognize(e)
t.name.startsWith("chat.")&&this.chatHistory.visit(t)})),t.registerHashtagType("channel",new l.default(e)),t.registerChatComposerButton({id:"chat-upload-btn",icon:"far-image",label:"chat.upload",position:"dropdown",action:"uploadClicked",dependentKeys:["canAttachUploads"],displayed(){return this.canAttachUploads}}),this.siteSettings.discourse_local_dates_enabled&&t.registerChatComposerButton({label:"discourse_local_dates.title",id:"local-dates",class:"chat-local-dates-btn",icon:"calendar-alt",position:"dropdown",action(){this.insertDiscourseLocalDate()}}),t.registerChatComposerButton({label:"chat.emoji",id:"emoji",class:"chat-emoji-btn",icon:"far-smile",position:this.site.desktopView?"inline":"dropdown",context:"channel",action(){e.lookup("service:chat-emoji-picker-manager").open({context:"channel"})}}),t.registerChatComposerButton({label:"chat.emoji",id:"channel-emoji",class:"chat-emoji-btn",icon:"discourse-emojis",position:"dropdown",context:"thread",action(){e.lookup("service:chat-emoji-picker-manager").open({context:"thread"})}})
const n=this.siteSettings.custom_summarization_allowed_groups.split("|").map((e=>parseInt(e,10)))
if(this.siteSettings.summarization_strategy&&this.currentUser&&this.currentUser.groups.some((e=>n.includes(e.id)))&&t.registerChatComposerButton({translatedLabel:"chat.summarization.title",id:"channel-summary",icon:"discourse-sparkles",position:"dropdown",action:"showChannelSummaryModal"}),t.decorateCookedElement((e=>{const t=(0,i.getOwnerWithFallback)(this).lookup("service:current-user"),n=t?.user_option?.timezone
e.querySelectorAll(".chat-transcript").forEach((e=>{const t=e.dataset.datetime,i=e.querySelector(".chat-transcript-datetime a, .chat-transcript-datetime span")
i.innerText=n?moment.tz(t,n).format(a.default.t("dates.long_no_year")):moment(t).format(a.default.t("dates.long_no_year")),i.dataset.dateFormatted=!0}))})),!this.chatService.userCanChat)return
document.body.classList.add("chat-enabled")
const r=t.getCurrentUser()
r?.chat_channels&&this.chatService.setupWithPreloadedChannels(r.chat_channels)
e.lookup("service:chat-notification-manager").start(),this._registeredDocumentTitleCountCallback||(t.addDocumentTitleCounter(this.documentTitleCountCallback),this._registeredDocumentTitleCountCallback=!0),t.addCardClickListenerSelector(".chat-drawer-outlet"),t.addToHeaderIcons("chat-header-icon"),t.addStyleguideSection?.({component:c.default,category:"organisms",id:"chat"}),t.addChatDrawerStateCallback((e=>{let{isDrawerActive:t}=e
t?document.body.classList.add("chat-drawer-active"):document.body.classList.remove("chat-drawer-active")})),t.decorateChatMessage((function(e,t){if(!this.currentUser)return
const i=[`@${this.currentUser.username}`]
t.allowChannelWideMentions&&i.push(...s.MENTION_KEYWORDS.map((e=>`@${e}`))),e.querySelectorAll(".mention").forEach((e=>{const t=e.textContent.trim()
i.includes(t)&&e.classList.add("highlighted","valid-mention")}))}))}))},documentTitleCountCallback(){return this.chatService.getDocumentTitleCount()},teardown(){this.appEvents.off("discourse:focus-changed",this,"_handleFocusChanged"),this.chatService.userCanChat&&(h=null,(0,o.clearChatComposerButtons)())},_handleFocusChanged(e){if(!this.chatService.userCanChat)return
if(!e)return void(h=Date.now())
h=h||Date.now()
Date.now()-h<=18e4||(h=Date.now())}},"documentTitleCountCallback",[r.bind],Object.getOwnPropertyDescriptor(u,"documentTitleCountCallback"),u),d(u,"_handleFocusChanged",[r.bind],Object.getOwnPropertyDescriptor(u,"_handleFocusChanged"),u),u)})),define("discourse/plugins/chat/discourse/initializers/chat-sidebar",["exports","@glimmer/tracking","@ember/service","@ember/string","@ember/template","discourse/helpers/decorate-username-selector","discourse/lib/plugin-api","discourse/lib/text","discourse/lib/utilities","discourse-common/lib/avatar-utils","discourse-common/lib/get-url","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat/modal/new-message","discourse/plugins/chat/discourse/lib/init-sidebar-state"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m){"use strict"
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function f(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-sidebar",initialize(e){this.chatService=e.lookup("service:chat"),this.chatService.userCanChat&&(this.siteSettings=e.lookup("service:site-settings"),(0,s.withPluginApi)("1.8.0",(e=>{e.addSidebarPanel((e=>class extends e{constructor(){super(...arguments),f(this,"key",m.CHAT_PANEL),f(this,"switchButtonLabel",h.default.t("sidebar.panels.chat.label")),f(this,"switchButtonIcon","d-chat"),f(this,"switchButtonDefaultUrl",(0,u.default)("/chat"))}})),(0,m.initSidebarState)(e,e.getCurrentUser())})),(0,s.withPluginApi)("1.3.0",(s=>{this.siteSettings.enable_public_channels&&s.addSidebarSection(((a,s)=>{var l,c,u
const d=class extends s{constructor(e){let{channel:t,chatService:i}=e
super(...arguments),this.channel=t,this.chatService=i}get name(){return(0,n.dasherize)(this.channel.slugifiedTitle)}get classNames(){const e=[]
return this.channel.currentUserMembership.muted&&e.push("sidebar-section-link--muted"),this.channel.id===this.chatService.activeChannel?.id&&e.push("sidebar-section-link--active"),e.push(`channel-${this.channel.id}`),e.join(" ")}get route(){return"chat.channel"}get models(){return this.channel.routeModels}get text(){return(0,r.htmlSafe)((0,o.emojiUnescape)(this.channel.escapedTitle))}get prefixType(){return"icon"}get prefixValue(){return"d-chat"}get prefixColor(){return this.channel.chatable.color}get title(){return this.channel.escapedDescription?(0,r.htmlSafe)(this.channel.escapedDescription):`${this.channel.escapedTitle} ${h.default.t("chat.title")}`}get prefixBadge(){return this.channel.chatable.read_restricted?"lock":""}get suffixType(){return"icon"}get suffixValue(){return this.channel.tracking.unreadCount>0||this.chatService.activeChannel?.id!==this.channel.id&&this.channel.unreadThreadsCountSinceLastViewed>0?"circle":""}get suffixCSSClass(){return this.channel.tracking.mentionCount>0?"urgent":"unread"}},p=(l=class extends a{constructor(){super(...arguments),b(this,"currentUser",c,this),b(this,"currentUserCanJoinPublicChannels",u,this),e.isDestroyed||(this.chatService=e.lookup("service:chat"),this.chatChannelsManager=e.lookup("service:chat-channels-manager"),this.router=e.lookup("service:router"))}get sectionLinks(){return this.chatChannelsManager.publicMessageChannels.map((e=>new d({channel:e,chatService:this.chatService})))}get name(){return"chat-channels"}get title(){return h.default.t("chat.chat_channels")}get text(){return h.default.t("chat.chat_channels")}get actions(){return[{id:"browseChannels",title:h.default.t("chat.channels_list_popup.browse"),action:()=>this.router.transitionTo("chat.browse.open")}]}get actionsIcon(){return"pencil-alt"}get links(){return this.sectionLinks}get displaySection(){return this.sectionLinks.length>0||this.currentUserCanJoinPublicChannels}},c=g(l.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=g(l.prototype,"currentUserCanJoinPublicChannels",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.currentUser&&(this.currentUser.staff||this.currentUser.has_joinable_public_channels)}}),l)
return p}),m.CHAT_PANEL),s.addSidebarSection(((n,s)=>{var o,u,m,f,v,y
const w=(o=class extends s{constructor(e){let{channel:t,chatService:i}=e
if(super(...arguments),this.channel=t,this.chatService=i,this.oneOnOneMessage){const e=this.channel.chatable.users[0]
e.username!==h.default.t("chat.deleted_chat_username")&&e.trackStatus()}}willDestroy(){this.oneOnOneMessage&&this.channel.chatable.users[0].stopTrackingStatus()}get name(){return this.channel.slugifiedTitle}get classNames(){const e=[]
return this.channel.currentUserMembership.muted&&e.push("sidebar-section-link--muted"),this.channel.id===this.chatService.activeChannel?.id&&e.push("sidebar-section-link--active"),e.push(`channel-${this.channel.id}`),e.join(" ")}get route(){return"chat.channel"}get models(){return this.channel.routeModels}get title(){return h.default.t("chat.placeholder_channel",{channelName:this.channel.escapedTitle})}get oneOnOneMessage(){return 1===this.channel.chatable.users.length}get contentComponentArgs(){return this.channel.chatable.users[0].get("status")}get contentComponent(){return"user-status-message"}get text(){const e=this.channel.escapedTitle.replaceAll("@","")
return this.oneOnOneMessage?(0,r.htmlSafe)(`${(0,l.escapeExpression)(e)}${(0,a.decorateUsername)((0,l.escapeExpression)(e))}`):e}get prefixType(){return this.oneOnOneMessage?"image":"text"}get prefixValue(){return 1===this.channel.chatable.users.length?(0,c.avatarUrl)(this.channel.chatable.users[0].avatar_template,"tiny"):this.channel.chatable.users.length}get prefixCSSClass(){const e=this.chatService.presenceChannel.users,t=this.channel.chatable.users[0]
return e?.findBy("id",t?.id)||e?.findBy("username",t?.username)?"active":""}get suffixType(){return"icon"}get suffixValue(){return this.channel.tracking.unreadCount>0?"circle":""}get suffixCSSClass(){return"urgent"}get hoverType(){return"icon"}get hoverValue(){return"times"}get hoverAction(){return e=>{e.stopPropagation(),e.preventDefault(),this.chatService.unfollowChannel(this.channel)}}get hoverTitle(){return h.default.t("chat.direct_messages.leave")}},g(o.prototype,"willDestroy",[d.bind],Object.getOwnPropertyDescriptor(o.prototype,"willDestroy"),o.prototype),o),_=(u=class extends n{constructor(){super(...arguments),b(this,"site",m,this),b(this,"modal",f,this),b(this,"router",v,this),b(this,"userCanDirectMessage",y,this),e.isDestroyed||(this.chatService=e.lookup("service:chat"),this.chatChannelsManager=e.lookup("service:chat-channels-manager"))}get sectionLinks(){return this.chatChannelsManager.truncatedDirectMessageChannels.map((e=>new w({channel:e,chatService:this.chatService})))}get name(){return"chat-dms"}get title(){return h.default.t("chat.direct_messages.title")}get text(){return h.default.t("chat.direct_messages.title")}get actions(){return this.userCanDirectMessage?[{id:"startDm",title:h.default.t("chat.direct_messages.new"),action:()=>{this.modal.show(p.default)}}]:[]}get actionsIcon(){return"plus"}get links(){return this.sectionLinks}get displaySection(){return this.sectionLinks.length>0||this.userCanDirectMessage}},m=g(u.prototype,"site",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=g(u.prototype,"modal",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=g(u.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=g(u.prototype,"userCanDirectMessage",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.chatService.userCanDirectMessage}}),u)
return _}),"chat")})))}}})),define("discourse/plugins/chat/discourse/initializers/chat-user-menu",["exports","discourse/lib/plugin-api","discourse/lib/utilities","discourse-i18n","discourse/plugins/chat/discourse/lib/slugify-channel"],(function(e,t,i,n,r){"use strict"
function a(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-user-menu",initialize(e){(0,t.withPluginApi)("1.3.0",(t=>{e.lookup("service:chat").userCanChat&&(t.registerNotificationTypeRenderer&&(t.registerNotificationTypeRenderer("chat_invitation",(e=>class extends e{constructor(){super(...arguments),a(this,"linkTitle",n.default.t("notifications.titles.chat_invitation")),a(this,"icon","link"),a(this,"description",n.default.t("notifications.chat_invitation"))}get linkHref(){const e=this.notification.data
let t=`/chat/c/${(0,r.default)({title:e.chat_channel_title,slug:e.chat_channel_slug})||"-"}/${e.chat_channel_id}`
return e.chat_message_id&&(t+=`/${e.chat_message_id}`),t}get label(){return(0,i.formatUsername)(this.notification.data.invited_by_username)}})),t.registerNotificationTypeRenderer("chat_mention",(e=>class extends e{get linkHref(){let e=`/chat/c/${(0,r.default)({title:this.notification.data.chat_channel_title,slug:this.notification.data.chat_channel_slug})||"-"}/${this.notification.data.chat_channel_id}`
return this.notification.data.chat_thread_id?e+=`/t/${this.notification.data.chat_thread_id}`:e+=`/${this.notification.data.chat_message_id}`,e}get linkTitle(){return n.default.t("notifications.titles.chat_mention")}get icon(){return"d-chat"}get label(){return(0,i.formatUsername)(this.notification.data.mentioned_by_username)}get description(){const e=this.notification.data.identifier?`@${this.notification.data.identifier}`:null,t=this.notification.data.is_direct_message_channel?"notifications.popup.direct_message_chat_mention":"notifications.popup.chat_mention",i=e?"other_plain":"direct"
return n.default.t(`${t}.${i}`,{identifier:e,channel:this.notification.data.chat_channel_title})}}))),t.registerUserMenuTab&&t.registerUserMenuTab((e=>class extends e{get id(){return"chat-notifications"}get panelComponent(){return"user-menu/chat-notifications-list"}get icon(){return"d-chat"}get count(){return this.getUnreadCountForType("chat_mention")+this.getUnreadCountForType("chat_invitation")}get notificationTypes(){return["chat_invitation","chat_mention","chat_message","chat_quoted"]}})))}))}}})),define("discourse/plugins/chat/discourse/initializers/chat-user-options",["exports","discourse/lib/plugin-api"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-user-options",initialize(e){(0,t.withPluginApi)("0.11.0",(t=>{e.lookup("service:site-settings").chat_enabled&&(t.addSaveableUserOptionField("chat_enabled"),t.addSaveableUserOptionField("only_chat_push_notifications"),t.addSaveableUserOptionField("ignore_channel_wide_mention"),t.addSaveableUserOptionField("chat_sound"),t.addSaveableUserOptionField("chat_email_frequency"),t.addSaveableUserOptionField("chat_header_indicator_preference"),t.addSaveableUserOptionField("chat_separate_sidebar_mode"))}))}}})),define("discourse/plugins/chat/discourse/lib/chat-composer-buttons",["exports","discourse-i18n"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.chatComposerButtons=function(e,a,s){return Object.values(i).filter((t=>{let i=n(e,t,"displayed")&&n(e,t,"position")===a
return t.context&&(i=i&&n(e,t,"context")===s),i})).map((i=>{const a={id:i.id},o=n(e,i,"label")
a.label=o||n(e,i,"translatedLabel")
const l=n(e,i,"ariaLabel")
if(l)a.ariaLabel=t.default.t(l)
else{const t=n(e,i,"translatedAriaLabel")
a.ariaLabel=t||a.label}const c=n(e,i,"title")
if(a.title=c?t.default.t(c):n(e,i,"translatedTitle"),a.classNames=(n(e,i,"classNames")||[]).join(" "),a.icon=n(e,i,"icon"),a.disabled=n(e,i,"disabled"),a.priority=n(e,i,"priority"),r(i.action))a.action=()=>{i.action.apply(e,[s])}
else{const t=i.action
a.action=()=>{e[t](s)}}return a}))},e.chatComposerButtonsDependentKeys=function(){return[].concat(...Object.values(i).mapBy("dependentKeys").filter(Boolean))},e.clearChatComposerButtons=function(){i=[]},e.registerChatComposerButton=function(e){if(!e.id)throw new Error("Attempted to register a chat composer button with no id.")
if(i[e.id])return
const t=Object.assign({id:null,action:null,icon:null,title:null,translatedTitle:null,label:null,translatedLabel:null,ariaLabel:null,translatedAriaLabel:null,position:"inline",classNames:[],dependentKeys:[],displayed:!0,disabled:!1,priority:0},e)
if(!t.icon&&!t.label&&!t.translatedLabel)throw new Error(`Attempted to register a chat composer button: ${e.id} with no icon or label.`)
i[t.id]=t}
let i={}
function n(e,t,i){const n=t[i]
return r(n)?n.apply(e):n}function r(e){return e&&"function"==typeof e}})),define("discourse/plugins/chat/discourse/lib/chat-constants",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.READ_INTERVAL_MS=e.PAST=e.FUTURE=e.DEFAULT_MESSAGE_PAGE_SIZE=void 0
e.PAST="past",e.FUTURE="future",e.READ_INTERVAL_MS=1e3,e.DEFAULT_MESSAGE_PAGE_SIZE=50})),define("discourse/plugins/chat/discourse/lib/chat-ios-hacks",["exports","@ember/runloop","discourse/services/capabilities","discourse-common/lib/later","discourse/plugins/chat/discourse/lib/zoom-check"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.bodyScrollFix=function(){i.capabilities.isIOS&&document.documentElement.classList.contains("keyboard-visible")&&!(0,r.default)()&&document.documentElement.scrollTo(0,0)},e.stackingContextFix=function(e,r){i.capabilities.isIOS&&(e.style.overflow="hidden",e.querySelectorAll(".chat-message-separator__text-container").forEach((e=>e.style.zIndex="1")))
r?.(),i.capabilities.isIOS&&(0,t.next)((()=>{(0,t.schedule)("afterRender",(()=>{e.style.overflow="auto",(0,n.default)((()=>{e&&e.querySelectorAll(".chat-message-separator__text-container").forEach((e=>e.style.zIndex="2"))}),50)}))}))}})),define("discourse/plugins/chat/discourse/lib/chat-message-container",["exports","discourse/plugins/chat/discourse/components/chat-message"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,i){let n
n=i===t.MESSAGE_CONTEXT_THREAD?`.chat-thread .chat-message-container[data-id="${e}"]`:`.chat-channel .chat-message-container[data-id="${e}"]`
return document.querySelector(n)}})),define("discourse/plugins/chat/discourse/lib/chat-message-flag",["exports","discourse/lib/ajax","discourse/lib/ajax-error","discourse-common/lib/get-url","discourse-i18n"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=class{title(){return"flagging.title"}customSubmitLabel(){return"flagging.notify_action"}submitLabel(){return"chat.flagging.action"}targetsTopic(){return!1}editable(){return!1}_rewriteFlagDescriptions(e){return e.map((e=>(e.set("description",r.default.t(`chat.flags.${e.name_key}`,{basePath:(0,n.default)("")})),e)))}flagsAvailable(e){let t=e.site.flagTypes
t=t.filter((t=>e.args.model.flagModel.availableFlags.includes(t.name_key)))
const i=t.indexOf(t.filterBy("name_key","notify_user")[0])
if(-1!==i){const e=t[i]
t.splice(i,1),t.splice(0,0,e)}return this._rewriteFlagDescriptions(t)}create(e,n){return e.args.closeModal(),(0,t.ajax)("/chat/flag",{method:"PUT",data:{chat_message_id:e.args.model.flagModel.id,flag_type_id:e.selected.id,message:n.message,is_warning:n.isWarning,take_action:n.takeAction,queue_for_review:n.queue_for_review}}).catch((e=>(0,i.popupAjaxError)(e)))}}})),define("discourse/plugins/chat/discourse/lib/chat-message-interactor",["exports","@glimmer/tracking","@ember/application","@ember/object","@ember/service","discourse/components/modal/bookmark","discourse/components/modal/flag","discourse/lib/ajax-error","discourse/lib/bookmark","discourse/lib/utilities","discourse/models/bookmark","discourse-common/lib/get-url","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/lib/chat-message-flag","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-message-reaction"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f){"use strict"
var v,y,w,_,j,M,z,k,C,O,S,P,T,E,x,D,A,I,U
function L(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function N(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function R(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.removeChatComposerSecondaryActions=function(e){e.forEach((e=>F.add(e)))},e.resetRemovedChatComposerSecondaryActions=function(){F.clear()}
const F=new Set
e.default=(v=class{constructor(e,t,n){L(this,"appEvents",y,this),L(this,"dialog",w,this),L(this,"chat",_,this),L(this,"chatEmojiReactionStore",j,this),L(this,"chatEmojiPickerManager",M,this),L(this,"chatChannelComposer",z,this),L(this,"chatThreadComposer",k,this),L(this,"chatChannelPane",C,this),L(this,"chatThreadPane",O,this),L(this,"chatApi",S,this),L(this,"currentUser",P,this),L(this,"site",T,this),L(this,"router",E,this),L(this,"modal",x,this),L(this,"capabilities",D,this),L(this,"toasts",A,this),L(this,"message",I,this),L(this,"context",U,this),N(this,"cachedFavoritesReactions",null),(0,i.setOwner)(this,e),this.message=t,this.context=n,this.cachedFavoritesReactions=this.chatEmojiReactionStore.favorites}get pane(){return this.context===m.MESSAGE_CONTEXT_THREAD?this.chatThreadPane:this.chatChannelPane}get emojiReactions(){let e=this.cachedFavoritesReactions
return e&&e.slice?e.slice(0,3).map((e=>this.message.reactions.find((t=>t.emoji===e))||f.default.create({emoji:e}))):[]}get canEdit(){return!this.message.deletedAt&&this.currentUser.id===this.message.user.id&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canInteractWithMessage(){return!this.message?.deletedAt&&this.message?.channel?.canModifyMessages(this.currentUser)}get canRestoreMessage(){return this.message?.deletedAt&&(this.currentUser.staff||this.message?.user?.id===this.currentUser.id&&this.message?.deletedById===this.currentUser.id)&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canBookmark(){return this.message?.channel?.canModifyMessages?.(this.currentUser)}get canReply(){return this.canInteractWithMessage&&this.context!==m.MESSAGE_CONTEXT_THREAD}get canReact(){return this.canInteractWithMessage}get canFlagMessage(){return this.currentUser.id!==this.message?.user?.id&&void 0===this.message?.userFlagStatus&&this.message.channel?.canFlag&&!this.message?.chatWebhookEvent&&!this.message?.deletedAt}get canRebakeMessage(){return this.currentUser.staff&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canDeleteMessage(){return this.canDelete&&!this.message?.deletedAt&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canDelete(){return this.currentUser.id===this.message.user.id?this.message.channel?.canDeleteSelf:this.message.channel?.canDeleteOthers}get composer(){return this.context===m.MESSAGE_CONTEXT_THREAD?this.chatThreadComposer:this.chatChannelComposer}get secondaryActions(){const e=[]
return e.push({id:"copyLink",name:p.default.t("chat.copy_link"),icon:"link"}),this.site.mobileView&&e.push({id:"copyText",name:p.default.t("chat.copy_text"),icon:"clipboard"}),this.canEdit&&e.push({id:"edit",name:p.default.t("chat.edit"),icon:"pencil-alt"}),this.pane.selectingMessages||e.push({id:"select",name:p.default.t("chat.select"),icon:"tasks"}),this.canFlagMessage&&e.push({id:"flag",name:p.default.t("chat.flag"),icon:"flag"}),this.canDeleteMessage&&e.push({id:"delete",name:p.default.t("chat.delete"),icon:"trash-alt"}),this.canRestoreMessage&&e.push({id:"restore",name:p.default.t("chat.restore"),icon:"undo"}),this.canRebakeMessage&&e.push({id:"rebake",name:p.default.t("chat.rebake_message"),icon:"sync-alt"}),e.reject((e=>F.has(e.id)))}select(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0]
this.message.selected=e,this.pane.onSelectMessage(this.message)}bulkSelect(e){const t=this.message.manager,i=[t.findIndexOfMessage(this.pane.lastSelectedMessage.id),t.findIndexOfMessage(this.message.id)].sort(((e,t)=>e-t))
for(let n=i[0];n<=i[1];n++)t.messages[n].selected=e}copyText(){(0,c.clipboardCopy)(this.message.message),this.toasts.success({duration:3e3,data:{message:p.default.t("chat.text_copied")}})}copyLink(){const{protocol:e,host:t}=window.location,i=this.message.channel.id,n=this.message.thread?.id
let r
r=this.context===m.MESSAGE_CONTEXT_THREAD&&n?(0,d.default)(`/chat/c/-/${i}/t/${n}/${this.message.id}`):(0,d.default)(`/chat/c/-/${i}/${this.message.id}`),r=0===r.indexOf("/")?e+"//"+t+r:r,(0,c.clipboardCopy)(r),this.toasts.success({duration:3e3,data:{message:p.default.t("chat.link_copied")}})}react(e,t){if(this.chat.userCanInteractWithChat&&!this.pane.reacting)return this.capabilities.userHasBeenActive&&this.capabilities.canVibrate&&navigator.vibrate(5),this.site.mobileView&&(this.chat.activeMessage=null),t===f.REACTIONS.add&&this.chatEmojiReactionStore.track(`:${e}:`),this.pane.reacting=!0,this.message.react(e,t,this.currentUser,this.currentUser.id),this.chatApi.publishReaction(this.message.channel.id,this.message.id,e,t).catch((t=>{(0,o.popupAjaxError)(t),this.message.react(e,f.REACTIONS.remove,this.currentUser,this.currentUser.id)})).finally((()=>{this.pane.reacting=!1}))}toggleBookmark(){this.modal.show(a.default,{model:{bookmark:new l.BookmarkFormData(this.message.bookmark||u.default.createFor(this.currentUser,"Chat::Message",this.message.id)),afterSave:e=>{const t=u.default.create(e)
this.message.bookmark=t,this.appEvents.trigger("bookmarks:changed",e,t.attachedTo())},afterDelete:()=>{this.message.bookmark=null}}})}flag(){const e=new g.default(this.message.channel,this.message)
e.username=this.message.user?.username,e.user_id=this.message.user?.id,this.modal.show(s.default,{model:{flagTarget:new b.default,flagModel:e,setHidden:()=>e.set("hidden",!0)}})}delete(){return this.chatApi.trashMessage(this.message.channel.id,this.message.id).catch(o.popupAjaxError)}restore(){return this.chatApi.restoreMessage(this.message.channel.id,this.message.id).catch(o.popupAjaxError)}rebake(){return this.chatApi.rebakeMessage(this.message.channel.id,this.message.id).catch(o.popupAjaxError)}reply(){this.composer.replyTo(this.message)}edit(){this.composer.edit(this.message)}openEmojiPicker(e,t){let{target:i}=t
const n={didSelectEmoji:this.selectReaction,trigger:i,context:"chat-channel-message"}
this.chatEmojiPickerManager.open(n)}selectReaction(e){this.chat.userCanInteractWithChat&&this.react(e,f.REACTIONS.add)}handleSecondaryActions(e){this[e](this.message)}},y=R(v.prototype,"appEvents",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=R(v.prototype,"dialog",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=R(v.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=R(v.prototype,"chatEmojiReactionStore",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=R(v.prototype,"chatEmojiPickerManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=R(v.prototype,"chatChannelComposer",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=R(v.prototype,"chatThreadComposer",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=R(v.prototype,"chatChannelPane",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=R(v.prototype,"chatThreadPane",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=R(v.prototype,"chatApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=R(v.prototype,"currentUser",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=R(v.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=R(v.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=R(v.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=R(v.prototype,"capabilities",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=R(v.prototype,"toasts",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=R(v.prototype,"message",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=R(v.prototype,"context",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R(v.prototype,"react",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"react"),v.prototype),R(v.prototype,"toggleBookmark",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"toggleBookmark"),v.prototype),R(v.prototype,"flag",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"flag"),v.prototype),R(v.prototype,"delete",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"delete"),v.prototype),R(v.prototype,"restore",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"restore"),v.prototype),R(v.prototype,"rebake",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"rebake"),v.prototype),R(v.prototype,"reply",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"reply"),v.prototype),R(v.prototype,"edit",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"edit"),v.prototype),R(v.prototype,"openEmojiPicker",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"openEmojiPicker"),v.prototype),R(v.prototype,"selectReaction",[h.bind],Object.getOwnPropertyDescriptor(v.prototype,"selectReaction"),v.prototype),R(v.prototype,"handleSecondaryActions",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"handleSecondaryActions"),v.prototype),v)})),define("discourse/plugins/chat/discourse/lib/chat-messages-loader",["exports","@glimmer/tracking","@ember/application","@ember/service","discourse/lib/ajax-error","discourse/plugins/chat/discourse/lib/chat-constants","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h,p,m,b
function g(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function f(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function v(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=new WeakSet,m=new WeakSet,b=new WeakSet,o=class{constructor(e,t){f(this,b),f(this,m),f(this,p),g(this,"chatApi",l,this),g(this,"loading",c,this),g(this,"canLoadMorePast",u,this),g(this,"canLoadMoreFuture",d,this),g(this,"fetchedOnce",h,this),(0,i.setOwner)(this,e),this.model=t}get loadedPast(){return!1===this.canLoadMorePast&&this.fetchedOnce}async loadMore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(!1===this.canLoadMoreFuture&&e.direction===a.FUTURE)return
if(!1===this.canLoadMorePast&&e.direction===a.PAST)return
const t=v(this,b,j).call(this,e.direction,this.model)
let i
e={direction:e.direction,page_size:a.DEFAULT_MESSAGE_PAGE_SIZE,target_message_id:t?.id},e=v(this,m,_).call(this,e)
try{this.loading=!0,i=await v(this,p,w).call(this,e),this.canLoadMoreFuture=i.meta.can_load_more_future,this.canLoadMorePast=i.meta.can_load_more_past}catch(n){(0,r.popupAjaxError)(n)}finally{this.loading=!1}return i}async load(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.canLoadMorePast=!0,this.canLoadMoreFuture=!0,this.fetchedOnce=!1,this.loading=!0,t.page_size??=a.DEFAULT_MESSAGE_PAGE_SIZE,t=v(this,m,_).call(this,t)
try{e=await v(this,p,w).call(this,t),this.canLoadMoreFuture=e.meta.can_load_more_future,this.canLoadMorePast=e.meta.can_load_more_past,this.fetchedOnce=!0}catch(i){(0,r.popupAjaxError)(i)}finally{this.loading=!1}return e}},l=y(o.prototype,"chatApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=y(o.prototype,"loading",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=y(o.prototype,"canLoadMorePast",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=y(o.prototype,"canLoadMoreFuture",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=y(o.prototype,"fetchedOnce",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o)
function w(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return this.model instanceof s.default?this.chatApi.channelMessages(this.model.id,e):this.chatApi.channelThreadMessages(this.model.channel.id,this.model.id,e)}function _(e){return Object.keys(e).filter((t=>null!=e[t])).reduce(((t,i)=>({...t,[i]:e[i]})),{})}function j(e,t){return e===a.PAST?t.messagesManager.messages.find((e=>!e.staged)):t.messagesManager.messages.findLast((e=>!e.staged))}})),define("discourse/plugins/chat/discourse/lib/chat-messages-manager",["exports","@glimmer/tracking","@ember/application"],(function(e,t,i){"use strict"
var n,r
function a(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class{constructor(e){var t,n,a,s
t=this,n="messages",s=this,(a=r)&&Object.defineProperty(t,n,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(s):void 0}),(0,i.setOwner)(this,e)}get stagedMessages(){return this.messages.filterBy("staged")}get selectedMessages(){return this.messages.filterBy("selected")}clearSelectedMessages(){this.selectedMessages.forEach((e=>e.selected=!1))}clear(){this.messages=[]}addMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]
this.messages=this.messages.concat(e).uniqBy("id").sort(((e,t)=>e.createdAt-t.createdAt))}findMessage(e){return this.messages.find((t=>t.id===parseInt(e,10)))}findFirstMessageOfDay(e){return this.messages.find((t=>e.getFullYear()===t.createdAt.getFullYear()&&e.getMonth()===t.createdAt.getMonth()&&e.getDate()===t.createdAt.getDate()))}removeMessage(e){return this.messages.removeObject(e)}findStagedMessage(e){return this.stagedMessages.find((t=>t.id===e))}findIndexOfMessage(e){return this.messages.findIndex((t=>t.id===e))}findLastMessage(){return this.messages.findLast((e=>!e.deletedAt))}findLastUserMessage(e){return this.messages.findLast((t=>t.user.id===e.id&&!t.deletedAt))}},r=a(n.prototype,"messages",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a(n.prototype,"stagedMessages",[t.cached],Object.getOwnPropertyDescriptor(n.prototype,"stagedMessages"),n.prototype),a(n.prototype,"selectedMessages",[t.cached],Object.getOwnPropertyDescriptor(n.prototype,"selectedMessages"),n.prototype),n)})),define("discourse/plugins/chat/discourse/lib/chat-notification-levels",["exports","discourse/lib/notification-levels"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.threadNotificationButtonLevels=void 0
e.threadNotificationButtonLevels=[t.NotificationLevels.TRACKING,t.NotificationLevels.REGULAR].map(t.buttonDetails)})),define("discourse/plugins/chat/discourse/lib/chat-threads-manager",["exports","@glimmer/tracking","@ember/application","@ember/service","@ember-compat/tracked-built-ins","rsvp","discourse/plugins/chat/discourse/models/chat-thread"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h,p,m,b
function g(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function f(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function v(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=new WeakSet,m=new WeakSet,b=new WeakSet,o=class{constructor(e){f(this,b),f(this,m),f(this,p),g(this,"chatTrackingStateManager",l,this),g(this,"chatChannelsManager",c,this),g(this,"chatApi",u,this),g(this,"_cached",d,this),g(this,"_unreadThreadOverview",h,this),(0,i.setOwner)(this,e)}get unreadThreadCount(){return this.unreadThreadOverview.size}get unreadThreadOverview(){return this._unreadThreadOverview}set unreadThreadOverview(e){this._unreadThreadOverview.clear()
for(const[t,i]of Object.entries(e))this.markThreadUnread(t,i)}markThreadUnread(e,t){this.unreadThreadOverview.set(parseInt(e,10),new Date(t))}get threads(){return Object.values(this._cached)}async find(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{fetchIfNotFound:!0}
const n=v(this,m,_).call(this,t)
return n?a.default.resolve(n):i.fetchIfNotFound?v(this,b,j).call(this,e,t):a.default.resolve()}remove(e){delete this._cached[e.id]}add(e,t){let i
return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).replace||(i=v(this,m,_).call(this,t.id)),i||(i=t instanceof s.default?t:s.default.create(e,t),v(this,p,w).call(this,i)),t?.meta?.message_bus_last_ids?.thread_message_bus_last_id&&(i.threadMessageBusLastId=t.meta.message_bus_last_ids.thread_message_bus_last_id),i}},l=y(o.prototype,"chatTrackingStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=y(o.prototype,"chatChannelsManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=y(o.prototype,"chatApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=y(o.prototype,"_cached",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new r.TrackedObject}}),h=y(o.prototype,"_unreadThreadOverview",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new r.TrackedMap}}),y(o.prototype,"threads",[t.cached],Object.getOwnPropertyDescriptor(o.prototype,"threads"),o.prototype),o)
function w(e){this._cached[e.id]=e}function _(e){return this._cached[e]}async function j(e,t){return this.chatApi.thread(e,t).then((t=>this.chatChannelsManager.find(e).then((e=>e.threadsManager.add(e,t.thread)))))}})),define("discourse/plugins/chat/discourse/lib/chat-user-preferences",["exports","discourse/plugins/chat/discourse/controllers/preferences-chat"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.hasChatIndicator=function(e){const i=e.user_option.chat_header_indicator_preference
return{ALL_NEW:i===t.HEADER_INDICATOR_PREFERENCE_ALL_NEW,DM_AND_MENTIONS:i===t.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS,ONLY_MENTIONS:i===t.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS,NEVER:i===t.HEADER_INDICATOR_PREFERENCE_NEVER}}})),define("discourse/plugins/chat/discourse/lib/check-message-visibility",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.checkMessageBottomVisibility=function(e,t){const i=window.pageYOffset+e.getBoundingClientRect().top
return t.getBoundingClientRect().bottom-i<=e.clientHeight+1},e.checkMessageTopVisibility=function(e,t){const i=window.pageYOffset+e.getBoundingClientRect().top
return t.getBoundingClientRect().top-i>=-1}})),define("discourse/plugins/chat/discourse/lib/collection",["exports","@glimmer/tracking","rsvp","discourse/lib/ajax","discourse-common/utils/decorators"],(function(e,t,i,n,r){"use strict"
let a
var s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=new WeakSet,a=Symbol.iterator,s=class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
p(this,d),h(this,"items",o,this),h(this,"meta",l,this),h(this,"loading",c,this),h(this,"fetchedOnce",u,this),this._resourceURL=e,this._handler=t,this._params=i,this._fetchedAll=!1}get loadMoreURL(){return this.meta?.load_more_url}get totalRows(){return this.meta?.total_rows}get length(){return this.items?.length}[a](){let e=0
return{next:()=>e<this.length?{value:this.items[e++],done:!1}:{done:!0}}}load(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(this.loading||this._fetchedAll||this.totalRows&&this.items.length>=this.totalRows)return i.Promise.resolve()
if(this.loading=!0,this.loadMoreURL)e=this.loadMoreURL
else{const i=Object.entries(t).filter((e=>{let[,t]=e
return void 0!==t})),n=new URLSearchParams(i).toString()
e=this._resourceURL+(n?`?${n}`:"")}return function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,d,b).call(this,e).then((e=>{const i=this._handler(e)
i.length&&(this.items=(this.items??[]).concat(i)),(!i.length||i.length<t.limit)&&(this._fetchedAll=!0),this.meta=e.meta,this.fetchedOnce=!0})).finally((()=>{this.loading=!1}))}},o=m(s.prototype,"items",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=m(s.prototype,"meta",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),c=m(s.prototype,"loading",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=m(s.prototype,"fetchedOnce",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m(s.prototype,"load",[r.bind],Object.getOwnPropertyDescriptor(s.prototype,"load"),s.prototype),s)
function b(e){return(0,n.ajax)(e,{type:"GET",data:this._params})}})),define("discourse/plugins/chat/discourse/lib/fabricators",["exports","discourse/models/bookmark","discourse/models/category","discourse/models/group","discourse/models/user","discourse/plugins/chat/discourse/models/chat-channel","discourse/plugins/chat/discourse/models/chat-direct-message","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-message-reaction","discourse/plugins/chat/discourse/models/chat-thread","discourse/plugins/chat/discourse/models/chat-thread-preview"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let d=0
function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.channel||p(),i=o.default.create(t,Object.assign({id:e.id||d++,user:e.user||g(),message:e.message||"@discobot **abc**defghijklmnopqrstuvwxyz [discourse](discourse.org) :rocket: ",created_at:e.created_at||moment()},e)),n=i.message.toString()
return n.length<=50?i.excerpt=n:i.excerpt=n.slice(0,50)+"...",i}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.id||d++,i=a.default.create({id:t,chatable_type:e.chatable?.type||e.chatable_type||a.CHATABLE_TYPES.categoryChannel,chatable_id:e.chatable?.id||e.chatable_id,title:e.title||"General",description:e.description,chatable:e.chatable||m(),status:e.status||a.CHANNEL_STATUSES.open,slug:e.chatable?.slug||"general",meta:Object.assign({can_delete_self:!0},e.meta||{}),archive_failed:e.archive_failed??!1})
return i.lastMessage=h({channel:i}),i}function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return i.default.create({id:e.id||d++,color:e.color||"D56353",read_restricted:!1,name:e.name||"General",slug:e.slug||"general"})}function b(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return s.default.create({id:e.id||d++,users:e.users||[g(),g()]})}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return r.default.create({id:e.id||d++,username:e.username||"hawk",name:e.name,avatar_template:"/letter_avatar_proxy/v3/letter/t/41988e/{size}.png",suspended_till:e.suspended_till})}function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return u.default.create({last_reply_id:e.last_reply_id||d++,last_reply_created_at:e.last_reply_created_at||Date.now(),last_reply_excerpt:e.last_reply_excerpt||"This is a reply",participant_count:e.participant_count??0,participant_users:e.participant_users??[]})}e.default={bookmark:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return t.default.create({id:e.id||d++})},user:g,channel:p,directMessageChannel:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.chatable||b({id:e.chatable_id||d++})
return p(Object.assign(e,{chatable_type:a.CHATABLE_TYPES.directMessageChannel,chatable_id:t.id,chatable:t}))},message:h,thread:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.channel||p()
return c.default.create(t,{id:e.id||d++,title:e.title,original_message:e.original_message||h({channel:t}),preview:e.preview||f({channel:t})})},threadPreview:f,reaction:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return l.default.create({count:e.count??1,users:e.users||[g()],emoji:e.emoji||"heart",reacted:e.reacted??!1})},upload:function(){return{extension:"jpeg",filesize:126177,height:800,human_filesize:"123 KB",id:202,original_filename:"avatar.PNG.jpg",retain_hours:null,short_path:"/images/avatar.png",short_url:"upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg",thumbnail_height:320,thumbnail_width:690,url:"/images/avatar.png",width:1920}},category:m,directMessage:b,group:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return n.default.create({name:e.name||"Engineers"})}}})),define("discourse/plugins/chat/discourse/lib/get-reaction-text",["exports","discourse-i18n"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_DISPLAYED_USERNAMES=void 0,e.getReactionText=function(e,i){if(0===e.count)return
return e.reacted?function(e,i){if(1===e.count)return t.default.t("chat.reactions.only_you",{emoji:e.emoji})
const a=n(e.users,i)
if(2===e.count)return t.default.t("chat.reactions.you_and_single_user",{emoji:e.emoji,username:a.pop()})
const s=e.count-a.length-1
if(s>0)return t.default.t("chat.reactions.you_multiple_users_and_more",{emoji:e.emoji,commaSeparatedUsernames:r(a),count:s})
return t.default.t("chat.reactions.you_and_multiple_users",{emoji:e.emoji,username:a.pop(),commaSeparatedUsernames:r(a)})}(e,i):function(e,i){const a=n(e.users,i)
if(1===e.count)return t.default.t("chat.reactions.single_user",{emoji:e.emoji,username:a.pop()})
const s=e.count-a.length
if(s>0)return t.default.t("chat.reactions.multiple_users_and_more",{emoji:e.emoji,commaSeparatedUsernames:r(a),count:s})
return t.default.t("chat.reactions.multiple_users",{emoji:e.emoji,username:a.pop(),commaSeparatedUsernames:r(a)})}(e,i)}
const i=e.MAX_DISPLAYED_USERNAMES=15
function n(e,t){return e.filter((e=>e.id!==t?.id)).slice(0,i).mapBy("username")}function r(e){return e.join(t.default.t("word_connector.comma"))}})),define("discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.getUserChatSeparateSidebarMode=function(e){let t=e?.get("user_option.chat_separate_sidebar_mode")
"default"===t&&(t=e.siteSettings.chat_separate_sidebar_mode)
return{never:"never"===t,always:"always"===t,fullscreen:"fullscreen"===t}}})),define("discourse/plugins/chat/discourse/lib/hashtag-types/channel",["exports","@ember/service","discourse/lib/hashtag-types/base","discourse-common/lib/icon-library"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(){super(...arguments),o(this,"chatChannelsManager",a,this),o(this,"currentUser",s,this)}get type(){return"channel"}get preloadedData(){return this.currentUser?this.chatChannelsManager.publicMessageChannels:[]}generateColorCssClasses(e){return[`.d-icon.hashtag-color--${this.type}-${e.id} { color: var(--category-${e.chatable.id}-color); }`]}generateIconHTML(e){const t=parseInt(e.id,10),i=this.preloadedData.mapBy("id").includes(t)?`hashtag-color--${this.type}-${e.id}`:"hashtag-missing"
return(0,n.iconHTML)(e.icon,{class:i})}},a=l(r.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=l(r.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)})),define("discourse/plugins/chat/discourse/lib/init-sidebar-state",["exports","discourse/services/sidebar-state","discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.CHAT_PANEL=void 0,e.initSidebarState=function(e,n){if(e.getSidebarPanel()?.key===t.ADMIN_PANEL)return
e.setSidebarPanel(t.MAIN_PANEL)
const r=(0,i.getUserChatSeparateSidebarMode)(n)
r.fullscreen?(e.setCombinedSidebarMode(),e.showSidebarSwitchPanelButtons()):r.always?e.setSeparatedSidebarMode():(e.setCombinedSidebarMode(),e.hideSidebarSwitchPanelButtons())}
e.CHAT_PANEL="chat"})),define("discourse/plugins/chat/discourse/lib/scroll-helpers",["exports","@ember/runloop","discourse/plugins/chat/discourse/lib/chat-ios-hacks"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.scrollListToBottom=function(e){(0,i.stackingContextFix)(e,(()=>{e.scrollTo({top:0,behavior:"auto"})}))},e.scrollListToMessage=function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{highlight:!1,position:"start",autoExpand:!1}
if(!n)return
n?.deletedAt&&r.autoExpand&&(n.expanded=!0);(0,t.schedule)("afterRender",(()=>{const t=e.querySelector(`.chat-message-container[data-id='${n.id}']`)
t&&(r.highlight&&n.highlight(),(0,i.stackingContextFix)(e,(()=>{t.scrollIntoView({behavior:"auto",block:r.position||"center"})})))}))},e.scrollListToTop=function(e){(0,i.stackingContextFix)(e,(()=>{e.scrollTo({top:-e.scrollHeight,behavior:"auto"})}))}})),define("discourse/plugins/chat/discourse/lib/slugify-channel",["exports","discourse/lib/utilities"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){if(e.slug)return e.slug
if(!e.escapedTitle&&!e.title)return"-"
const i=(0,t.slugify)(e.escapedTitle||e.title),n=(i.length?i:e.title.trim().toLowerCase().replace(/\s|_+/g,"-")).slice(0,100)
if(!n)return"-"
return n}})),define("discourse/plugins/chat/discourse/lib/textarea-interactor",["exports","@ember/application","@ember/destroyable","@ember/object","@ember/runloop","@ember/service","discourse/mixins/textarea-text-manipulation"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o=class extends(n.default.extend(s.default)){constructor(e,n){super(...arguments),d(this,"capabilities",l,this),d(this,"site",c,this),d(this,"siteSettings",u,this),(0,t.setOwner)(this,e),this.textarea=n,this._textarea=n,this.element=this._textarea,this.ready=!0,this.composerFocusSelector=`#${n.id}`,this.init(),this.composerEventPrefix=null,this.textarea.addEventListener("paste",this.paste),(0,i.registerDestructor)(this,(e=>e.teardown()))}teardown(){this.textarea.removeEventListener("paste",this.paste)}set value(e){this._textarea.value=e
const t=new Event("input",{bubbles:!0,cancelable:!0})
this._textarea.dispatchEvent(t)}blur(){(0,r.next)((()=>{(0,r.schedule)("afterRender",(()=>{this._textarea.blur()}))}))}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{ensureAtEnd:!1,refreshHeight:!0,addText:null};(0,r.next)((()=>{(0,r.schedule)("afterRender",(()=>{e.refreshHeight&&this.refreshHeight(),e.ensureAtEnd&&this.ensureCaretAtEnd(),this.capabilities.isIpadOS||this.site.mobileView||(e.addText&&this.addText(this.getSelected(),e.addText),this.focusTextArea())}))}))}ensureCaretAtEnd(){(0,r.schedule)("afterRender",(()=>{this._textarea.setSelectionRange(this._textarea.value.length,this._textarea.value.length)}))}refreshHeight(){(0,r.schedule)("afterRender",(()=>{this._textarea.style.height="auto",this._textarea.style.height=this._textarea.scrollHeight+1+"px"}))}},l=h(o.prototype,"capabilities",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(o.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(o.prototype,"siteSettings",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)})),define("discourse/plugins/chat/discourse/lib/transform-auto-links",["exports","discourse/lib/hashtag-autocomplete","discourse-common/lib/get-url"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){const r=n.parseFromString(e,"text/html")
return function(e){(e.querySelectorAll("span.mention")||[]).forEach((e=>{let t=document.createElement("a"),n=document.createTextNode(e.innerText)
t.classList.add("mention"),t.appendChild(n),t.href=(0,i.default)(`/u/${e.innerText.substring(1)}`),e.replaceWith(t)}))}(r),function(e){(e.querySelectorAll("span.hashtag-raw")||[]).forEach((e=>{(0,t.generatePlaceholderHashtagHTML)("category",e,{id:-1,text:"...",relative_url:"/",slug:"",icon:"square-full"})}))}(r),r.body.innerHTML}
const n=new DOMParser})),define("discourse/plugins/chat/discourse/lib/zoom-check",["exports","discourse-common/config/environment"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return!(0,t.isTesting)()&&1!==visualViewport?.scale&&document.documentElement.clientWidth/window.innerWidth!=1}})),define("discourse/plugins/chat/discourse/models/chat-channel-archive",["exports","@glimmer/tracking"],(function(e,t){"use strict"
var i,n,r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(i=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
l(this,"failed",n,this),l(this,"completed",r,this),l(this,"messages",a,this),l(this,"topicId",s,this),l(this,"totalMessages",o,this),this.failed=e.archive_failed,this.completed=e.archive_completed,this.messages=e.archived_messages,this.topicId=e.archive_topic_id,this.totalMessages=e.total_messages}},n=c(i.prototype,"failed",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=c(i.prototype,"completed",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=c(i.prototype,"messages",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(i.prototype,"topicId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(i.prototype,"totalMessages",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)})),define("discourse/plugins/chat/discourse/models/chat-channel",["exports","@glimmer/tracking","pretty-text/guid","discourse/lib/utilities","discourse/models/category","discourse-common/lib/get-owner","discourse/plugins/chat/discourse/lib/chat-messages-manager","discourse/plugins/chat/discourse/lib/chat-threads-manager","discourse/plugins/chat/discourse/lib/slugify-channel","discourse/plugins/chat/discourse/models/chat-channel-archive","discourse/plugins/chat/discourse/models/chat-direct-message","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-tracking-state","discourse/plugins/chat/discourse/models/user-chat-channel-membership"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g,f,v,y,w,_,j,M,z,k,C,O,S,P,T
function E(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function x(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function D(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.CHATABLE_TYPES=e.CHANNEL_STATUSES=void 0,e.channelStatusIcon=function(e){if(e===I.open)return null
switch(e){case I.closed:return"lock"
case I.readOnly:return"comment-slash"
case I.archived:return"archive"}},e.default=void 0
const A=e.CHATABLE_TYPES={directMessageChannel:"DirectMessage",categoryChannel:"Category"},I=e.CHANNEL_STATUSES={open:"open",readOnly:"read_only",closed:"closed",archived:"archived"}
const U=[I.readOnly,I.archived],L=[I.closed,I.readOnly,I.archived]
e.default=(m=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
E(this,"title",b,this),E(this,"slug",g,this),E(this,"description",f,this),E(this,"status",v,this),E(this,"activeThread",y,this),E(this,"meta",w,this),E(this,"chatableType",_,this),E(this,"chatableUrl",j,this),E(this,"autoJoinUsers",M,this),E(this,"allowChannelWideMentions",z,this),E(this,"membershipsCount",k,this),E(this,"archive",C,this),E(this,"tracking",O,this),E(this,"threadingEnabled",S,this),x(this,"threadsManager",new o.default((0,a.getOwnerWithFallback)(this))),x(this,"messagesManager",new s.default((0,a.getOwnerWithFallback)(this))),E(this,"_currentUserMembership",P,this),E(this,"_lastMessage",T,this),this.id=e.id,this.chatableId=e.chatable_id,this.chatableUrl=e.chatable_url,this.chatableType=e.chatable_type,this.membershipsCount=e.memberships_count,this.slug=e.slug,this.title=e.title,this.status=e.status,this.description=e.description,this.threadingEnabled=e.threading_enabled,this.autoJoinUsers=e.auto_join_users,this.allowChannelWideMentions=e.allow_channel_wide_mentions
this.chatable=this.isDirectMessageChannel?u.default.create({id:e.chatable?.id,users:e.chatable?.users}):r.default.create(e.chatable),this.currentUserMembership=e.current_user_membership,(e.archive_completed||e.archive_failed)&&(this.archive=c.default.create(e)),this.tracking=new h.default((0,a.getOwnerWithFallback)(this)),this.lastMessage=e.last_message,this.meta=e.meta}get unreadThreadsCountSinceLastViewed(){return Array.from(this.threadsManager.unreadThreadOverview.values()).filter((e=>e>=this.currentUserMembership.lastViewedAt)).length}updateLastViewedAt(){this.currentUserMembership.lastViewedAt=new Date}get canDeleteSelf(){return this.meta.can_delete_self}get canDeleteOthers(){return this.meta.can_delete_others}get canFlag(){return this.meta.can_flag}get userSilenced(){return this.meta.user_silenced}get canModerate(){return this.meta.can_moderate}get escapedTitle(){return(0,n.escapeExpression)(this.title)}get escapedDescription(){return(0,n.escapeExpression)(this.description)}get slugifiedTitle(){return this.slug||(0,l.default)(this)}get routeModels(){return[this.slugifiedTitle,this.id]}get isDirectMessageChannel(){return this.chatableType===A.directMessageChannel}get isCategoryChannel(){return this.chatableType===A.categoryChannel}get isOpen(){return!this.status||this.status===I.open}get isReadOnly(){return this.status===I.readOnly}get isClosed(){return this.status===I.closed}get isArchived(){return this.status===I.archived}get isJoinable(){return this.isOpen&&!this.isArchived}get isFollowing(){return this.currentUserMembership.following}get canJoin(){return this.meta.can_join_chat_channel}async stageMessage(e){e.id=(0,i.default)(),e.staged=!0,e.processed=!1,e.draft=!1,e.createdAt=new Date,e.channel=this,e.inReplyTo&&this.threadingEnabled||this.messagesManager.addMessages([e]),e.manager=this.messagesManager}canModifyMessages(e){return e.staff?!U.includes(this.status):!L.includes(this.status)}get currentUserMembership(){return this._currentUserMembership}set currentUserMembership(e){e instanceof p.default?this._currentUserMembership=e:this._currentUserMembership=p.default.create(e)}get lastMessage(){return this._lastMessage}set lastMessage(e){e?e instanceof d.default?this._lastMessage=e:this._lastMessage=d.default.create(this,e):this._lastMessage=null}},b=D(m.prototype,"title",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=D(m.prototype,"slug",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=D(m.prototype,"description",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=D(m.prototype,"status",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=D(m.prototype,"activeThread",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=D(m.prototype,"meta",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=D(m.prototype,"chatableType",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=D(m.prototype,"chatableUrl",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=D(m.prototype,"autoJoinUsers",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),z=D(m.prototype,"allowChannelWideMentions",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),k=D(m.prototype,"membershipsCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),C=D(m.prototype,"archive",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=D(m.prototype,"tracking",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=D(m.prototype,"threadingEnabled",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),P=D(m.prototype,"_currentUserMembership",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=D(m.prototype,"_lastMessage",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m)}))
define("discourse/plugins/chat/discourse/models/chat-chatable",["exports","@glimmer/tracking","@ember/service","discourse/models/user","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n,r){"use strict"
var a,s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(a=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static createUser(t){return new e({type:"user",model:t,identifier:`u-${t.id}`})}static createChannel(t){return new e({type:"channel",model:t,identifier:`c-${t.id}`})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
switch(h(this,"chatChannelsManager",s,this),h(this,"identifier",o,this),h(this,"type",l,this),h(this,"model",c,this),h(this,"enabled",u,this),h(this,"tracking",d,this),this.identifier=e.identifier,this.type=e.type,this.type){case"channel":if(1===e.model.chatable?.users?.length&&(this.enabled=e.model.chatable?.users[0].has_chat_enabled),e.model instanceof r.default){this.model=e.model
break}this.model=r.default.create(e.model)
break
case"user":if(this.enabled=e.model.has_chat_enabled,e.model instanceof n.default){this.model=e.model
break}this.model=n.default.create(e.model)}}get isUser(){return"user"===this.type}get isSingleUserChannel(){return"channel"===this.type&&1===this.model?.chatable?.users?.length}},s=p(a.prototype,"chatChannelsManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=p(a.prototype,"identifier",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=p(a.prototype,"type",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=p(a.prototype,"model",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(a.prototype,"enabled",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),d=p(a.prototype,"tracking",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a)})),define("discourse/plugins/chat/discourse/models/chat-direct-message",["exports","@glimmer/tracking","discourse/models/user","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o=new WeakSet,r=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
c(this,o),l(this,"id",a,this),l(this,"users",s,this),u(this,"type",n.CHATABLE_TYPES.directMessageChannel),this.id=e.id,this.users=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,o,h).call(this,e.users||[])}},a=d(r.prototype,"id",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=d(r.prototype,"users",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),r)
function h(e){return e.map((e=>!e||e instanceof i.default?e:i.default.create(e)))}})),define("discourse/plugins/chat/discourse/models/chat-message-reaction",["exports","@glimmer/tracking","@ember-compat/tracked-built-ins","discourse/models/user"],(function(e,t,i,n){"use strict"
var r,a,s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.REACTIONS=void 0
e.REACTIONS={add:"add",remove:"remove"}
e.default=(c=new WeakSet,r=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
d(this,c),u(this,"count",a,this),u(this,"reacted",s,this),u(this,"users",o,this),u(this,"emoji",l,this),this.count=e.count,this.emoji=e.emoji,this.users=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,c,p).call(this,e.users),this.reacted=e.reacted}},a=h(r.prototype,"count",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),s=h(r.prototype,"reacted",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=h(r.prototype,"users",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=h(r.prototype,"emoji",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)
function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]
return new i.TrackedArray(e.map((e=>e instanceof n.default?e:n.default.create(e))))}})),define("discourse/plugins/chat/discourse/models/chat-message",["exports","@glimmer/tracking","@ember-compat/tracked-built-ins","discourse/lib/text","discourse/models/bookmark","discourse/models/user","discourse-common/lib/get-owner","discourse-common/lib/later","discourse-i18n","discourse/plugins/chat/discourse/lib/transform-auto-links","discourse/plugins/chat/discourse/models/chat-message-reaction"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g,f,v,y,w,_,j,M,z,k,C,O,S,P,T,E,x,D,A,I,U,L,N,R,F,W,B,H,$,V,q,K,G,J,Y,Z,X,Q,ee
function te(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ie(e,t){ne(e,t),t.add(e)}function ne(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function re(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function ae(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function se(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(K=new WeakSet,G=new WeakSet,J=new WeakMap,Y=new WeakSet,Z=new WeakSet,X=new WeakSet,Q=new WeakSet,ee=new WeakSet,q=class e{static create(t){return new e(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}static createDraftMessage(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return i.draft=!0,e.create(t,i)}constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
var a,s,o
ie(this,ee),ie(this,Q),ie(this,X),ie(this,Z),ie(this,Y),o={get:he,set:void 0},ne(a=this,s=J),s.set(a,o),ie(this,G),ie(this,K),te(this,"id",h,this),te(this,"error",p,this),te(this,"selected",m,this),te(this,"channel",b,this),te(this,"staged",g,this),te(this,"processed",f,this),te(this,"draftSaved",v,this),te(this,"draft",y,this),te(this,"createdAt",w,this),te(this,"uploads",_,this),te(this,"excerpt",j,this),te(this,"reactions",M,this),te(this,"reviewableId",z,this),te(this,"user",k,this),te(this,"inReplyTo",C,this),te(this,"expanded",O,this),te(this,"bookmark",S,this),te(this,"userFlagStatus",P,this),te(this,"hidden",T,this),te(this,"version",E,this),te(this,"edited",x,this),te(this,"editing",D,this),te(this,"chatWebhookEvent",A,this),te(this,"mentionWarning",I,this),te(this,"availableFlags",U,this),te(this,"newest",L,this),te(this,"highlighted",N,this),te(this,"firstOfResults",R,this),te(this,"message",F,this),te(this,"manager",W,this),te(this,"deletedById",B,this),te(this,"_deletedAt",H,this),te(this,"_cooked",$,this),te(this,"_thread",V,this),this.id=n.id,this.channel=t,this.manager=n.manager,this.newest=n.newest||!1,this.draftSaved=n.draftSaved||n.draft_saved||!1,this.firstOfResults=n.firstOfResults||n.first_of_results||!1,this.staged=n.staged||!1,this.processed=n.processed||!0,this.edited=n.edited||!1,this.editing=n.editing||!1,this.availableFlags=n.availableFlags||n.available_flags,this.hidden=n.hidden||!1,this.chatWebhookEvent=n.chatWebhookEvent||n.chat_webhook_event,this.createdAt=n.created_at?new Date(n.created_at):new Date(n.createdAt)
this.deletedById=n.deletedById||n.deleted_by_id,this._deletedAt=n.deletedAt||n.deleted_at,this.expanded=!this.hidden&&!this._deletedAt&&(n.expanded||!0),this.excerpt=n.excerpt,this.reviewableId=n.reviewableId||n.reviewable_id,this.userFlagStatus=n.userFlagStatus||n.user_flag_status,this.draft=n.draft,this.message=n.message||"",this._cooked=n.cooked||"",this.inReplyTo=n.inReplyTo||(n.in_reply_to||n.replyToMsg?e.create(t,n.in_reply_to||n.replyToMsg):null),this.reactions=ae(this,Y,pe).call(this,n.reactions),this.uploads=new i.TrackedArray(n.uploads||[]),this.user=ae(this,X,be).call(this,n.user),this.bookmark=n.bookmark?r.default.create(n.bookmark):null,this.mentionedUsers=ae(this,Z,me).call(this,n.mentioned_users),n.thread&&(this.thread=n.thread)}get persisted(){return!!this.id&&!this.staged}get replyable(){return!this.staged&&!this.error}get editable(){return!this.staged&&!this.error}get thread(){return this._thread}set thread(e){this._thread=e?this.channel.threadsManager.add(this.channel,e,{replace:!0}):null}get deletedAt(){return this._deletedAt}set deletedAt(e){return this._deletedAt=e,this.incrementVersion(),this._deletedAt}get cooked(){return this._cooked}set cooked(e){e!==this._cooked&&(this._cooked=e,this.incrementVersion())}async cook(){this.isDestroyed||this.isDestroying||(await ae(this,G,de).call(this),this.cooked=e.cookFunction(this.message))}get read(){return this.channel.currentUserMembership?.lastReadMessageId>=this.id}get firstMessageOfTheDayAt(){return this.previousMessage&&ae(this,Q,ge).call(this,this.previousMessage.createdAt,this.createdAt)?void 0:ae(this,ee,fe).call(this,this.createdAt)}get formattedFirstMessageDate(){if(this.firstMessageOfTheDayAt)return ae(this,K,ue).call(this,this.firstMessageOfTheDayAt)}get index(){return this.manager?.messages?.indexOf(this)}get previousMessage(){return this.manager?.messages?.objectAt?.(this.index-1)}get nextMessage(){return this.manager?.messages?.objectAt?.(this.index+1)}highlight(){this.highlighted=!0,(0,o.default)((()=>{this.isDestroying||this.isDestroyed||(this.highlighted=!1)}),2e3)}incrementVersion(){this.version++}async parseMentions(){return await(0,n.parseMentions)(this.message,re(this,J))}toJSONDraft(){if(0===this.message?.length&&0===this.uploads?.length&&!this.inReplyTo)return null
const e={}
return this.uploads?.length>0&&(e.uploads=this.uploads),this.message?.length>0&&(e.message=this.message),this.inReplyTo&&(e.replyToMsg={id:this.inReplyTo.id,excerpt:this.inReplyTo.excerpt,user:{id:this.inReplyTo.user.id,name:this.inReplyTo.user.name,avatar_template:this.inReplyTo.user.avatar_template,username:this.inReplyTo.user.username}}),this.editing&&(e.editing=!0,e.id=this.id,e.excerpt=this.excerpt),JSON.stringify(e)}react(e,t,i,n){const r=i.id===n,a=this.reactions.find((t=>t.emoji===e))
if(a)if("add"===t){if(r&&a.reacted)return
if(a.users.find((e=>e.id===i.id)))return
a.count=a.count+1,r&&(a.reacted=!0),a.users.pushObject(i)}else{const e=a.users.find((e=>e.id===i.id))
if(!e)return
r&&(a.reacted=!1),1===a.count?this.reactions.removeObject(a):(a.count=a.count-1,a.users.removeObject(e))}else"add"===t&&this.reactions.pushObject(u.default.create({count:1,emoji:e,reacted:r,users:[i]}))}},oe=q,ce=null,(le=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(le="cookFunction"))in oe?Object.defineProperty(oe,le,{value:ce,enumerable:!0,configurable:!0,writable:!0}):oe[le]=ce,h=se((d=q).prototype,"id",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=se(d.prototype,"error",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=se(d.prototype,"selected",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=se(d.prototype,"channel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=se(d.prototype,"staged",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=se(d.prototype,"processed",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=se(d.prototype,"draftSaved",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=se(d.prototype,"draft",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=se(d.prototype,"createdAt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=se(d.prototype,"uploads",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=se(d.prototype,"excerpt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=se(d.prototype,"reactions",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=se(d.prototype,"reviewableId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=se(d.prototype,"user",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=se(d.prototype,"inReplyTo",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=se(d.prototype,"expanded",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),S=se(d.prototype,"bookmark",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=se(d.prototype,"userFlagStatus",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=se(d.prototype,"hidden",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=se(d.prototype,"version",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),x=se(d.prototype,"edited",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=se(d.prototype,"editing",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=se(d.prototype,"chatWebhookEvent",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new i.TrackedObject}}),I=se(d.prototype,"mentionWarning",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=se(d.prototype,"availableFlags",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=se(d.prototype,"newest",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=se(d.prototype,"highlighted",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=se(d.prototype,"firstOfResults",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=se(d.prototype,"message",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=se(d.prototype,"manager",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=se(d.prototype,"deletedById",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=se(d.prototype,"_deletedAt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=se(d.prototype,"_cooked",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=se(d.prototype,"_thread",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),se(d.prototype,"firstMessageOfTheDayAt",[t.cached],Object.getOwnPropertyDescriptor(d.prototype,"firstMessageOfTheDayAt"),d.prototype),se(d.prototype,"formattedFirstMessageDate",[t.cached],Object.getOwnPropertyDescriptor(d.prototype,"formattedFirstMessageDate"),d.prototype),se(d.prototype,"index",[t.cached],Object.getOwnPropertyDescriptor(d.prototype,"index"),d.prototype),se(d.prototype,"previousMessage",[t.cached],Object.getOwnPropertyDescriptor(d.prototype,"previousMessage"),d.prototype),se(d.prototype,"nextMessage",[t.cached],Object.getOwnPropertyDescriptor(d.prototype,"nextMessage"),d.prototype),d)
var oe,le,ce
function ue(e){return moment(e).calendar(moment(),{sameDay:`[${l.default.t("chat.chat_message_separator.today")}]`,lastDay:`[${l.default.t("chat.chat_message_separator.yesterday")}]`,lastWeek:"LL",sameElse:"LL"})}async function de(){if(q.cookFunction)return
const e=await(0,n.generateCookFunction)(re(this,J))
q.cookFunction=t=>(0,c.default)(e(t))}function he(){const e=(0,s.getOwnerWithFallback)(this).lookup("service:site")
return{featuresOverride:e.markdown_additional_options?.chat?.limited_pretty_text_features,markdownItRules:e.markdown_additional_options?.chat?.limited_pretty_text_markdown_rules,hashtagTypesInPriorityOrder:e.hashtag_configurations?.["chat-composer"],hashtagIcons:e.hashtag_icons}}function pe(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((e=>u.default.create(e)))}function me(e){const t=new Map
return e&&e.forEach((e=>{const i=a.default.create(e)
t.set(i.id,i)})),t}function be(e){return!e||e instanceof a.default?e:a.default.create(e)}function ge(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function fe(e){return moment(e).startOf("day").format()}})),define("discourse/plugins/chat/discourse/models/chat-notice",["exports","@glimmer/tracking"],(function(e,t){"use strict"
var i,n,r
function a(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function s(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(i=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
a(this,"channelId",n,this),a(this,"textContent",r,this),this.channelId=e.channel_id,this.textContent=e.text_content,this.type=e.notice_type,this.data=e.data}},n=s(i.prototype,"channelId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=s(i.prototype,"textContent",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)})),define("discourse/plugins/chat/discourse/models/chat-thread-preview",["exports","@glimmer/tracking","@ember-compat/tracked-built-ins"],(function(e,t,i){"use strict"
var n,r,a,s,o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
d(this,"replyCount",r,this),d(this,"lastReplyId",a,this),d(this,"lastReplyCreatedAt",s,this),d(this,"lastReplyExcerpt",o,this),d(this,"lastReplyUser",l,this),d(this,"participantCount",c,this),d(this,"participantUsers",u,this),e||(e={}),this.replyCount=e.reply_count||e.replyCount||0,this.lastReplyId=e.last_reply_id||e.lastReplyId,this.lastReplyCreatedAt=new Date(e.last_reply_created_at||e.lastReplyCreatedAt),this.lastReplyExcerpt=e.last_reply_excerpt||e.lastReplyExcerpt,this.lastReplyUser=e.last_reply_user||e.lastReplyUser,this.participantCount=e.participant_count||e.participantCount||0,this.participantUsers=new i.TrackedArray(e.participant_users||e.participantUsers||[])}get otherParticipantCount(){return this.participantCount-this.participantUsers.length}},r=h(n.prototype,"replyCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=h(n.prototype,"lastReplyId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=h(n.prototype,"lastReplyCreatedAt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=h(n.prototype,"lastReplyExcerpt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=h(n.prototype,"lastReplyUser",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(n.prototype,"participantCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(n.prototype,"participantUsers",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/models/chat-thread",["exports","@glimmer/tracking","pretty-text/guid","discourse-common/lib/get-owner","discourse/plugins/chat/discourse/lib/chat-messages-manager","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-thread-preview","discourse/plugins/chat/discourse/models/chat-tracking-state","discourse/plugins/chat/discourse/models/user-chat-thread-membership"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d,h,p,m,b,g,f,v,y,w,_
function j(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function M(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function z(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.THREAD_STATUSES=void 0
e.THREAD_STATUSES={open:"open",readOnly:"read_only",closed:"closed",archived:"archived"}
e.default=(c=class e{static create(t){return new e(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
j(this,"id",u,this),j(this,"title",d,this),j(this,"status",h,this),j(this,"draft",p,this),j(this,"staged",m,this),j(this,"channel",b,this),j(this,"originalMessage",g,this),j(this,"threadMessageBusLastId",f,this),j(this,"replyCount",v,this),j(this,"tracking",y,this),j(this,"currentUserMembership",w,this),j(this,"preview",_,this),M(this,"messagesManager",new r.default((0,n.getOwnerWithFallback)(this))),this.id=t.id,this.channel=e,this.status=t.status,this.draft=t.draft,this.staged=t.staged,this.replyCount=t.reply_count,this.originalMessage=t.original_message?a.default.create(e,t.original_message):null,this.title=t.title,t.current_user_membership&&(this.currentUserMembership=l.default.create(t.current_user_membership)),this.tracking=new o.default((0,n.getOwnerWithFallback)(this)),this.preview=s.default.create(t.preview)}async stageMessage(e){e.id=(0,i.default)(),e.staged=!0,e.processed=!1,e.draft=!1,e.createdAt??=moment.utc().format(),e.thread=this,this.messagesManager.addMessages([e]),e.manager=this.messagesManager}get routeModels(){return[...this.channel.routeModels,this.id]}},u=z(c.prototype,"id",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=z(c.prototype,"title",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=z(c.prototype,"status",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=z(c.prototype,"draft",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=z(c.prototype,"staged",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=z(c.prototype,"channel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=z(c.prototype,"originalMessage",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=z(c.prototype,"threadMessageBusLastId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=z(c.prototype,"replyCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=z(c.prototype,"tracking",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=z(c.prototype,"currentUserMembership",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=z(c.prototype,"preview",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c)})),define("discourse/plugins/chat/discourse/models/chat-tracking-state",["exports","@glimmer/tracking","@ember/application","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
l(this,"chatTrackingStateManager",a,this),l(this,"_unreadCount",s,this),l(this,"_mentionCount",o,this),(0,i.setOwner)(this,e),this._unreadCount=t.unreadCount||0,this._mentionCount=t.mentionCount||0}reset(){this._unreadCount=0,this._mentionCount=0}get unreadCount(){return this._unreadCount}set unreadCount(e){this._unreadCount!==e&&(this._unreadCount=e,this.chatTrackingStateManager.triggerNotificationsChanged())}get mentionCount(){return this._mentionCount}set mentionCount(e){this._mentionCount!==e&&(this._mentionCount=e,this.chatTrackingStateManager.triggerNotificationsChanged())}},a=c(r.prototype,"chatTrackingStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"_unreadCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o=c(r.prototype,"_mentionCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r)})),define("discourse/plugins/chat/discourse/models/user-chat-channel-membership",["exports","@glimmer/tracking","discourse/models/user"],(function(e,t,i){"use strict"
var n,r,a,s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=new WeakSet,n=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
p(this,d),h(this,"following",r,this),h(this,"muted",a,this),h(this,"desktopNotificationLevel",s,this),h(this,"mobileNotificationLevel",o,this),h(this,"lastReadMessageId",l,this),h(this,"lastViewedAt",c,this),h(this,"user",u,this),this.following=e.following,this.muted=e.muted,this.desktopNotificationLevel=e.desktop_notification_level,this.mobileNotificationLevel=e.mobile_notification_level,this.lastReadMessageId=e.last_read_message_id,this.lastViewedAt=new Date(e.last_viewed_at),this.user=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,d,b).call(this,e.user)}},r=m(n.prototype,"following",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),a=m(n.prototype,"muted",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=m(n.prototype,"desktopNotificationLevel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o=m(n.prototype,"mobileNotificationLevel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=m(n.prototype,"lastReadMessageId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=m(n.prototype,"lastViewedAt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u=m(n.prototype,"user",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),n)
function b(e){return!e||e instanceof i.default?e:i.default.create(e)}})),define("discourse/plugins/chat/discourse/models/user-chat-thread-membership",["exports","@glimmer/tracking","discourse/lib/notification-levels"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
s(this,"lastReadMessageId",r,this),s(this,"notificationLevel",a,this),this.lastReadMessageId=e.last_read_message_id,this.notificationLevel=e.notification_level}get isQuiet(){return this.notificationLevel===i.NotificationLevels.REGULAR||this.notificationLevel===i.NotificationLevels.MUTED}},r=o(n.prototype,"lastReadMessageId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),a=o(n.prototype,"notificationLevel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),n)})),define("discourse/plugins/chat/discourse/modifiers/chat/emoji-picker-scroll-listener",["exports","@ember/destroyable","@ember/service","ember-modifier"],(function(e,t,i,n){"use strict"
var r,a
function s(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(e,i){var n,r,o,l
super(e,i),n=this,r="emojiPickerScrollObserver",l=this,(o=a)&&Object.defineProperty(n,r,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(l):void 0}),s(this,"element",null),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e){this.element=e,this.emojiPickerScrollObserver.observe(e)}cleanup(){this.emojiPickerScrollObserver.unobserve(this.element)}},o=r.prototype,l="emojiPickerScrollObserver",c=[i.inject],u={configurable:!0,enumerable:!0,writable:!0,initializer:null},h={},Object.keys(u).forEach((function(e){h[e]=u[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=c.slice().reverse().reduce((function(e,t){return t(o,l,e)||e}),h),d&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(d):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(o,l,h),h=null),a=h,r)
var o,l,c,u,d,h})),define("discourse/plugins/chat/discourse/modifiers/chat/later-fn",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/lib/later"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends n.default{constructor(e,i){super(e,i),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,n]=t
this.handler=(0,r.default)((()=>{i?.(e)}),n)}cleanup(){(0,i.cancel)(this.handler)}}e.default=a})),define("discourse/plugins/chat/discourse/modifiers/chat/on-animation-end",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/utils/decorators"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(a=class extends n.default{constructor(e,i){super(e,i),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[n]=t
this.element=e,this.fn=n,this.handler=(0,i.schedule)("afterRender",(()=>{this.element.addEventListener("animationend",this.handleAnimationEnd)}))}handleAnimationEnd(){this.isDestroying||this.isDestroyed||this.fn?.(this.element)}cleanup(){(0,i.cancel)(this.handler),this.element?.removeEventListener("animationend",this.handleAnimationEnd)}},s=a.prototype,o="handleAnimationEnd",l=[r.bind],c=Object.getOwnPropertyDescriptor(a.prototype,"handleAnimationEnd"),u=a.prototype,d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),a)
var s,o,l,c,u,d})),define("discourse/plugins/chat/discourse/modifiers/chat/on-long-press",["exports","@ember/destroyable","@ember/runloop","@ember/service","ember-modifier","discourse-common/lib/later","discourse-common/utils/decorators"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function h(e){e.stopPropagation()}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o=class extends r.default{constructor(e,i){super(e,i),u(this,"capabilities",l,this),u(this,"site",c,this),(0,t.registerDestructor)(this,(e=>e.cleanup()))}get enabled(){return this.capabilities.touch&&this.site.mobileView}modify(e,t){let[i,n,r]=t
this.enabled&&(this.element=e,this.onLongPressStart=i||(()=>{}),this.onLongPressEnd=n||(()=>{}),this.onLongPressCancel=r||(()=>{}),this.element.addEventListener("touchstart",this.handleTouchStart,{passive:!0}))}onCancel(){(0,i.cancel)(this.timeout),this.capabilities.touch&&(this.element.removeEventListener("touchmove",this.onCancel,{passive:!0}),this.element.removeEventListener("touchend",this.onCancel),this.element.removeEventListener("touchcancel",this.onCancel)),this.onLongPressCancel(this.element)}handleTouchStart(e){e.touches.length>1?this.onCancel():(this.onLongPressStart(this.element,e),this.element.addEventListener("touchmove",this.onCancel,{passive:!0}),this.element.addEventListener("touchend",this.onCancel),this.element.addEventListener("touchcancel",this.onCancel),this.timeout=(0,a.default)((()=>{this.isDestroying||this.isDestroyed||(this.element.addEventListener("touchend",h,{once:!0,passive:!0}),this.onLongPressEnd(this.element,e))}),400))}cleanup(){this.enabled&&(this.element.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),this.onCancel())}},l=d(o.prototype,"capabilities",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=d(o.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(o.prototype,"onCancel",[s.bind],Object.getOwnPropertyDescriptor(o.prototype,"onCancel"),o.prototype),d(o.prototype,"handleTouchStart",[s.bind],Object.getOwnPropertyDescriptor(o.prototype,"handleTouchStart"),o.prototype),o)})),define("discourse/plugins/chat/discourse/modifiers/chat/on-resize",["exports","@ember/destroyable","@ember/runloop","ember-modifier"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends n.default{constructor(e,i){super(e,i),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[n,r={}]=t
this.resizeObserver=new ResizeObserver((e=>{this.throttleHandler=(0,i.throttle)(this,n,e,r.delay??0,r.immediate??!1)})),this.resizeObserver.observe(e)}cleanup(){(0,i.cancel)(this.throttleHandler),this.resizeObserver?.disconnect()}}e.default=r})),define("discourse/plugins/chat/discourse/modifiers/chat/on-scroll",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/utils/decorators"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(a=class extends n.default{constructor(e,i){super(e,i),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,n]=t
this.element=e,this.callback=i,this.options=n,this.element.addEventListener("scroll",this.throttledCallback,{passive:!0})}throttledCallback(e){this.throttledHandler=(0,i.throttle)(this,this.callback,e,this.options.delay??100,this.options.immediate??!1)}cleanup(){(0,i.cancel)(this.throttledHandler),this.element.removeEventListener("scroll",this.throttledCallback)}},s=a.prototype,o="throttledCallback",l=[r.bind],c=Object.getOwnPropertyDescriptor(a.prototype,"throttledCallback"),u=a.prototype,d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),a)
var s,o,l,c,u,d})),define("discourse/plugins/chat/discourse/modifiers/chat/resizable-node",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/utils/decorators"],(function(e,t,i,n,r){"use strict"
var a
function s(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o((a=class extends n.default{constructor(e,i){super(e,i),s(this,"element",null),s(this,"resizerSelector",null),s(this,"didResizeContainer",null),s(this,"options",null),s(this,"_originalWidth",0),s(this,"_originalHeight",0),s(this,"_originalX",0),s(this,"_originalY",0),s(this,"_originalPageX",0),s(this,"_originalPageY",0),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,n,r={}]=t
this.resizerSelector=i,this.element=e,this.didResizeContainer=n,this.options=Object.assign({vertical:!0,horizontal:!0,position:!0,mutate:!0,resetOnWindowResize:!1},r),this.element.querySelector(this.resizerSelector)?.addEventListener("touchstart",this._startResize),this.element.querySelector(this.resizerSelector)?.addEventListener("mousedown",this._startResize),window.addEventListener("resize",this._resizeWindow)}cleanup(){this.element.querySelector(this.resizerSelector)?.removeEventListener("touchstart",this._startResize),this.element.querySelector(this.resizerSelector)?.removeEventListener("mousedown",this._startResize),window.removeEventListener("resize",this._resizeWindow),(0,i.cancel)(this._throttledResizeHandler)}_startResize(e){e.preventDefault(),this._minimumWidth=parseFloat(getComputedStyle(this.element,null).getPropertyValue("min-width").replace("px","")||20),this._minimumHeight=parseFloat(getComputedStyle(this.element,null).getPropertyValue("min-height").replace("px","")||20),this._originalWidth=parseFloat(getComputedStyle(this.element,null).getPropertyValue("width").replace("px","")),this._originalHeight=parseFloat(getComputedStyle(this.element,null).getPropertyValue("height").replace("px","")),this._originalX=this.element.getBoundingClientRect().left,this._originalY=this.element.getBoundingClientRect().top,this._originalPageX=this._eventValueForProperty(e,"pageX"),this._originalPageY=this._eventValueForProperty(e,"pageY"),window.addEventListener("touchmove",this._resize),window.addEventListener("touchend",this._stopResize),window.addEventListener("mousemove",this._resize),window.addEventListener("mouseup",this._stopResize)}_resize(e){let t=this._originalWidth,i=this._eventValueForProperty(e,"pageX")-this._originalPageX
t=document.documentElement.classList.contains("rtl")?Math.ceil(t+i):Math.ceil(t-i)
const n=Math.ceil(this._originalHeight-(this._eventValueForProperty(e,"pageY")-this._originalPageY)),r={}
this.options.horizontal&&t>=this._minimumWidth&&(r.width=t+"px",this.options.position&&(r.left=Math.ceil(this._originalX+(this._eventValueForProperty(e,"pageX")-this._originalPageX))+"px")),this.options.vertical&&n>=this._minimumHeight&&(r.height=n+"px",this.options.position&&(r.top=Math.ceil(this._originalY+(this._eventValueForProperty(e,"pageY")-this._originalPageY))+"px")),this.options.mutate&&Object.assign(this.element.style,r),this.didResizeContainer?.(this.element,{width:t>=this._minimumWidth?t:this._minimumWidth,height:n>=this._minimumHeight?n:this._minimumHeight})}_resizeWindow(){this.options.resetOnWindowResize&&(this._throttledResizeHandler=(0,i.throttle)(this,this._throttledResize,100))}_throttledResize(){const e={}
this.options.vertical&&(e.height="auto"),this.options.horizontal&&(e.width="auto"),Object.assign(this.element.style,e)}_stopResize(){window.removeEventListener("touchmove",this._resize),window.removeEventListener("touchend",this._stopResize),window.removeEventListener("mousemove",this._resize),window.removeEventListener("mouseup",this._stopResize)}_eventValueForProperty(e,t){return e.changedTouches?e.changedTouches[0][t]:e[t]}}).prototype,"_startResize",[r.bind],Object.getOwnPropertyDescriptor(a.prototype,"_startResize"),a.prototype),o(a.prototype,"_resize",[r.bind],Object.getOwnPropertyDescriptor(a.prototype,"_resize"),a.prototype),o(a.prototype,"_resizeWindow",[r.bind],Object.getOwnPropertyDescriptor(a.prototype,"_resizeWindow"),a.prototype),o(a.prototype,"_throttledResize",[r.bind],Object.getOwnPropertyDescriptor(a.prototype,"_throttledResize"),a.prototype),o(a.prototype,"_stopResize",[r.bind],Object.getOwnPropertyDescriptor(a.prototype,"_stopResize"),a.prototype),a)})),define("discourse/plugins/chat/discourse/modifiers/chat/scrollable-list",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/lib/later","discourse-common/utils/decorators"],(function(e,t,i,n,r,a){"use strict"
var s
function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l="down"
e.default=(o((s=class extends n.default{constructor(e,i){super(e,i),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i]=t
this.element=e,this.options=i,this.lastScrollTop=this.computeInitialScrollTop(),this.element.addEventListener("scroll",this.handleScroll,{passive:!0}),this.element.addEventListener("wheel",this.handleWheel,{passive:!0})}handleScroll(){this.throttleComputeScroll()}handleWheel(){this.throttleComputeScroll()}computeScroll(){const e=this.element.scrollTop
this.options.onScroll?.(this.computeState()),this.lastScrollTop=e}throttleComputeScroll(){(0,i.cancel)(this.scrollTimer),this.throttleTimer=(0,i.throttle)(this,this.computeScroll,50,!0),this.scrollTimer=(0,r.default)((()=>{this.options.onScrollEnd?.(this.computeState())}),this.options.delay||250)}cleanup(){(0,i.cancel)(this.scrollTimer),(0,i.cancel)(this.throttleTimer),this.element.removeEventListener("scroll",this.handleScroll),this.element.removeEventListener("wheel",this.handleWheel)}computeState(){const e=this.computeScrollDirection(),t=this.computeDistanceToBottom(),i=this.computeDistanceToTop()
return{up:"up"===e,down:e===l,distanceToBottom:t,distanceToTop:i,atBottom:t.pixels<=1,atTop:i.pixels<=1}}computeInitialScrollTop(){return this.options.reverse?this.element.scrollHeight-this.element.clientHeight:this.element.scrollTop}computeScrollTop(){return this.options.reverse?this.element.scrollHeight-this.element.clientHeight-this.element.scrollTop:this.element.scrollTop}computeDistanceToTop(){let e
const t=this.element.scrollHeight-this.element.clientHeight
return e=this.options.reverse?t-Math.abs(this.element.scrollTop):Math.abs(this.element.scrollTop),{pixels:e,percentage:Math.round(e/t*100)}}computeDistanceToBottom(){let e
const t=this.element.scrollHeight-this.element.clientHeight
return e=this.options.reverse?-this.element.scrollTop:t-Math.abs(this.element.scrollTop),{pixels:e,percentage:Math.round(e/t*100)}}computeScrollDirection(){return this.element.scrollTop===this.lastScrollTop?null:this.element.scrollTop<this.lastScrollTop?"up":l}}).prototype,"handleScroll",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"handleScroll"),s.prototype),o(s.prototype,"handleWheel",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"handleWheel"),s.prototype),o(s.prototype,"computeScroll",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"computeScroll"),s.prototype),s)})),define("discourse/plugins/chat/discourse/modifiers/chat/track-message-separator-date",["exports","@ember/destroyable","ember-modifier"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n="is-pinned"
class r extends i.default{constructor(e,i){super(e,i),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e){this.intersectionObserver=new IntersectionObserver((e=>{let[t]=e
t.isIntersecting&&t.intersectionRatio<1&&t.boundingClientRect.y<t.intersectionRect.y?t.target.classList.add(n):t.target.classList.remove(n)}),{threshold:[0,1]}),this.intersectionObserver.observe(e)}cleanup(){this.intersectionObserver?.disconnect()}}e.default=r})),define("discourse/plugins/chat/discourse/modifiers/chat/track-message",["exports","@ember/destroyable","ember-modifier","discourse-common/utils/decorators"],(function(e,t,i,n){"use strict"
var r
function a(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(e,i){super(e,i),a(this,"didEnterViewport",null),a(this,"didLeaveViewport",null),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,n]=t
this.didEnterViewport=i,this.didLeaveViewport=n,this.intersectionObserver=new IntersectionObserver(this._intersectionObserverCallback,{root:document,threshold:0}),this.intersectionObserver.observe(e)}cleanup(){this.intersectionObserver?.disconnect()}_intersectionObserverCallback(e){e.forEach((e=>{e.isIntersecting?this.didEnterViewport?.():this.didLeaveViewport?.()}))}},s=r.prototype,o="_intersectionObserverCallback",l=[n.bind],c=Object.getOwnPropertyDescriptor(r.prototype,"_intersectionObserverCallback"),u=r.prototype,d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),r)
var s,o,l,c,u,d})),define("discourse/plugins/chat/discourse/pre-initializers/chat-plugin-api",["exports","discourse/lib/plugin-api","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/lib/chat-composer-buttons","discourse/plugins/chat/discourse/lib/chat-message-interactor","discourse/plugins/chat/discourse/services/chat-state-manager"],(function(e,t,i,n,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-plugin-api",after:"inject-discourse-objects",initialize(){(0,t.withPluginApi)("1.2.0",(e=>{const t=Object.getPrototypeOf(e)
t.hasOwnProperty("decorateChatMessage")||Object.defineProperty(t,"decorateChatMessage",{value(e){(0,i.addChatMessageDecorator)(e)}}),t.hasOwnProperty("registerChatComposerButton")||Object.defineProperty(t,"registerChatComposerButton",{value(e){(0,n.registerChatComposerButton)(e)}}),t.hasOwnProperty("addChatDrawerStateCallback")||Object.defineProperty(t,"addChatDrawerStateCallback",{value(e){(0,a.addChatDrawerStateCallback)(e)}}),t.hasOwnProperty("sendChatMessage")||Object.defineProperty(t,"sendChatMessage",{async value(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return this.container.lookup("service:chat-api").sendMessage(e,{thread_id:t.threadId,message:t.message,uploads:t.uploads})}}),t.hasOwnProperty("removeChatComposerSecondaryActions")||Object.defineProperty(t,"removeChatComposerSecondaryActions",{value(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];(0,r.removeChatComposerSecondaryActions)(t)}})}))},teardown(){(0,i.resetChatMessageDecorators)()}}})),define("discourse/plugins/chat/discourse/preferences-chat-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"user.preferences",map(){this.route("chat")}}})),define("discourse/plugins/chat/discourse/routes/admin-plugins-chat",["exports","@ember/object","discourse/lib/ajax","discourse/routes/discourse","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends n.default{model(){return this.currentUser?.admin?(0,i.ajax)("/admin/plugins/chat.json").then((e=>(e.incoming_chat_webhooks=e.incoming_chat_webhooks.map((e=>t.default.create(e))),e.chat_channels=e.chat_channels.map((e=>r.default.create(e))),e))):{model:null}}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-browse-archived",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){super(...arguments),s(this,"router",r,this),s(this,"siteSettings",a,this)}afterModel(){this.siteSettings.chat_allow_archiving_channels||this.router.replaceWith("chat.browse")}},r=o(n.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=o(n.prototype,"siteSettings",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/routes/chat-browse-index",["exports","@ember/service","discourse/lib/utilities","discourse/routes/discourse"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(){super(...arguments),l(this,"chat",a,this),l(this,"siteSettings",s,this),l(this,"router",o,this)}beforeModel(){if(!this.siteSettings.enable_public_channels)return this.router.transitionTo(`discovery.${(0,i.defaultHomepage)()}`)}activate(){this.chat.activeChannel=null}afterModel(){this.router.replaceWith("chat.browse.open")}},a=c(r.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"siteSettings",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(r.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)})),define("discourse/plugins/chat/discourse/routes/chat-channel-decorator",["exports","@ember/service"],(function(e,t){"use strict"
function i(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function n(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){var r,a,s,o
return r=class extends e{constructor(){super(...arguments),i(this,"chatChannelsManager",a,this),i(this,"chat",s,this),i(this,"router",o,this)}async model(e){return this.chatChannelsManager.find(e.channelId)}titleToken(){if(this.currentModel)return this.currentModel.isDirectMessageChannel?`${this.currentModel.title}`:`#${this.currentModel.title}`}afterModel(e){if(super.afterModel?.(...arguments),this.chat.activeChannel=e,!e)return this.router.replaceWith("chat")
let{channelTitle:t}=this.paramsFor(this.routeName)
if(t&&t!==e.slugifiedTitle){const t=this.paramsFor("chat.channel.near-message").messageId,i=this.paramsFor("chat.channel.thread").threadId
if(i){const t=this.paramsFor("chat.channel.thread.near-message").messageId
t?this.router.replaceWith("chat.channel.thread.near-message",...e.routeModels,i,t):this.router.replaceWith("chat.channel.thread",...e.routeModels,i)}else t?this.router.replaceWith("chat.channel.near-message",...e.routeModels,t):this.router.replaceWith("chat.channel",...e.routeModels)}else this.controllerFor("chat-channel").set("targetMessageId",null)}},a=n(r.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=n(r.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=n(r.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r}})),define("discourse/plugins/chat/discourse/routes/chat-channel-info-index",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}afterModel(){this.router.replaceWith("chat.channel.info.settings")}},a=n.prototype,s="router",o=[t.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/routes/chat-channel-info-members",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}afterModel(e){if(!e.isOpen||e.membershipsCount<1)return this.router.replaceWith("chat.channel.info.settings")}},a=n.prototype,s="router",o=[t.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/routes/chat-channel-info",["exports","@ember/service","discourse/routes/discourse","discourse/plugins/chat/discourse/services/chat-channel-info-route-origin-manager","discourse/plugins/chat/discourse/routes/chat-channel-decorator"],(function(e,t,i,n,r){"use strict"
var a,s,o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,r.default)((s=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatChannelInfoRouteOriginManager",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}activate(e){const t=e?.from?.name
t&&(this.chatChannelInfoRouteOriginManager.origin=t.startsWith("chat.browse")?n.ORIGINS.browse:n.ORIGINS.channel)}deactivate(){this.chatChannelInfoRouteOriginManager.origin=null}},l=s.prototype,c="chatChannelInfoRouteOriginManager",u=[t.inject],d={configurable:!0,enumerable:!0,writable:!0,initializer:null},p={},Object.keys(d).forEach((function(e){p[e]=d[e]})),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=u.slice().reverse().reduce((function(e,t){return t(l,c,e)||e}),p),h&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(h):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(l,c,p),p=null),o=p,a=s))||a
var l,c,u,d,h,p})),define("discourse/plugins/chat/discourse/routes/chat-channel-legacy",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}redirect(){const{channelTitle:e,channelId:t,messageId:i}=this.paramsFor(this.routeName)
this.router.replaceWith("chat.channel",e,t,{queryParams:{messageId:i}})}},a=n.prototype,s="router",o=[t.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u}))
define("discourse/plugins/chat/discourse/routes/chat-channel-near-message",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}beforeModel(){const e=this.modelFor("chat-channel"),{messageId:t}=this.paramsFor(this.routeName)
this.controllerFor("chat-channel").set("messageId",null),(t||this.controllerFor("chat-channel").get("targetMessageId"))&&this.controllerFor("chat-channel").set("targetMessageId",t),this.router.replaceWith("chat.channel",...e.routeModels)}},a=n.prototype,s="router",o=[t.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/routes/chat-channel-thread-near-message",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}beforeModel(){const e=this.modelFor("chat-channel-thread"),{messageId:t}=this.paramsFor(this.routeName);(t||this.controllerFor("chat-channel-thread").get("targetMessageId"))&&this.controllerFor("chat-channel-thread").set("targetMessageId",t),this.router.replaceWith("chat.channel.thread",...e.routeModels)}},a=n.prototype,s="router",o=[t.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/routes/chat-channel-thread",["exports","@ember/object","@ember/service","discourse/routes/discourse"],(function(e,t,i,n){"use strict"
var r,a,s,o,l
function c(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(){super(...arguments),c(this,"router",a,this),c(this,"chatStateManager",s,this),c(this,"chat",o,this),c(this,"chatThreadPane",l,this)}model(e,t){const i=this.modelFor("chat.channel")
return i.threadsManager.find(i.id,e.threadId).catch((()=>{t.abort(),this.chatStateManager.closeSidePanel(),this.router.transitionTo("chat.channel",...i.routeModels)}))}afterModel(e){this.chat.activeChannel.activeThread=e}willTransition(e){"chat.channel.index"!==e.targetName&&"chat.channel.near-message"!==e.targetName&&"chat.index"!==e.targetName&&e.targetName.startsWith("chat")||this.chatStateManager.closeSidePanel()}beforeModel(e){const t=this.modelFor("chat.channel")
if(!t.threadingEnabled)return e.abort(),void this.router.transitionTo("chat.channel",...t.routeModels)
const{messageId:i}=this.paramsFor(this.routeName+".near-message")
!i&&this.controllerFor("chat-channel-thread").get("targetMessageId")&&this.controllerFor("chat-channel-thread").set("targetMessageId",null),this.chatStateManager.openSidePanel()}},a=u(r.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=u(r.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=u(r.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=u(r.prototype,"chatThreadPane",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(r.prototype,"willTransition",[t.action],Object.getOwnPropertyDescriptor(r.prototype,"willTransition"),r.prototype),r)})),define("discourse/plugins/chat/discourse/routes/chat-channel-threads",["exports","@ember/object","@ember/service","discourse/routes/discourse"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(){super(...arguments),l(this,"router",a,this),l(this,"chatThreadListPane",s,this),l(this,"chatStateManager",o,this)}beforeModel(e){const t=this.modelFor("chat.channel")
if(!t.threadingEnabled)return e.abort(),void this.router.transitionTo("chat.channel",...t.routeModels)
this.chatStateManager.openSidePanel()}willTransition(e){"chat.channel.index"!==e.targetName&&"chat.channel.near-message"!==e.targetName&&"chat.index"!==e.targetName&&e.targetName.startsWith("chat")||this.chatStateManager.closeSidePanel()}},a=c(r.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"chatThreadListPane",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(r.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(r.prototype,"willTransition",[t.action],Object.getOwnPropertyDescriptor(r.prototype,"willTransition"),r.prototype),r)})),define("discourse/plugins/chat/discourse/routes/chat-channel",["exports","@ember/service","discourse/routes/discourse","discourse/plugins/chat/discourse/routes/chat-channel-decorator"],(function(e,t,i,n){"use strict"
var r,a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,n.default)((a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="site",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}redirect(e){if(this.site.mobileView)return
const t=this.paramsFor("chat.channel.near-message").messageId,i=this.paramsFor("chat.channel.thread").threadId
!t&&!i&&e.threadsManager.unreadThreadCount>0&&this.transitionTo("chat.channel.threads",...e.routeModels)}},o=a.prototype,l="site",c=[t.inject],u={configurable:!0,enumerable:!0,writable:!0,initializer:null},h={},Object.keys(u).forEach((function(e){h[e]=u[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=c.slice().reverse().reduce((function(e,t){return t(o,l,e)||e}),h),d&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(d):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(o,l,h),h=null),s=h,r=a))||r
var o,l,c,u,d,h})),define("discourse/plugins/chat/discourse/routes/chat-draft-channel",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){super(...arguments),s(this,"chat",r,this),s(this,"router",a,this)}beforeModel(){this.chat.userCanDirectMessage||this.router.transitionTo("chat")}activate(){this.chat.activeChannel=null}},r=o(n.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=o(n.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/routes/chat-index",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){super(...arguments),o(this,"chat",r,this),o(this,"chatChannelsManager",a,this),o(this,"router",s,this)}activate(){this.chat.activeChannel=null}redirect(){if(this.site.mobileView)return
const e=this.chat.getIdealFirstChannelId()
return e?this.chatChannelsManager.find(e).then((e=>this.router.replaceWith("chat.channel",...e.routeModels))):this.router.replaceWith("chat.browse")}model(){if(this.site.mobileView)return this.chatChannelsManager.channels}},r=l(n.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=l(n.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=l(n.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/routes/chat-message",["exports","@ember/service","discourse/lib/ajax","discourse/lib/utilities","discourse/routes/discourse"],(function(e,t,i,n,r){"use strict"
var a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(a=class extends r.default{constructor(){super(...arguments),l(this,"chat",s,this),l(this,"router",o,this)}async model(e){return(0,i.ajax)(`/chat/message/${e.messageId}.json`).then((t=>{this.router.transitionTo("chat.channel.near-message",t.chat_channel_title,t.chat_channel_id,e.messageId)})).catch((()=>this.router.replaceWith("/404")))}beforeModel(){if(!this.chat.userCanChat)return this.router.transitionTo(`discovery.${(0,n.defaultHomepage)()}`)}},s=c(a.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(a.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a)})),define("discourse/plugins/chat/discourse/routes/chat",["exports","@ember/runloop","@ember/service","discourse/lib/plugin-api","discourse/lib/utilities","discourse/mixins/scroll-top","discourse/routes/discourse","discourse-i18n","discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode","discourse/plugins/chat/discourse/lib/init-sidebar-state"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends s.default{constructor(){super(...arguments),b(this,"chat",d,this),b(this,"router",h,this),b(this,"chatStateManager",p,this),b(this,"currentUser",m,this)}titleToken(){return o.default.t("chat.title_capitalized")}beforeModel(e){if(!this.chat.userCanChat)return this.router.transitionTo(`discovery.${(0,r.defaultHomepage)()}`)
if(e.from&&this.chatStateManager.isDrawerPreferred&&["chat.channel","chat.channel.thread","chat.channel.thread.index","chat.channel.thread.near-message","chat.channel.threads","chat.channel.index","chat.channel.near-message","chat.channel-legacy","chat","chat.index"].includes(e.targetName)){e.abort()
let t=e.intent.url
return e.targetName.startsWith("chat.channel")?t??=this.router.urlFor(e.targetName,...e.intent.contexts):t??=this.router.urlFor(e.targetName),void this.appEvents.trigger("chat:open-url",t)}this.appEvents.trigger("chat:toggle-close")}activate(){(0,n.withPluginApi)("1.8.0",(e=>{e.setSidebarPanel(c.CHAT_PANEL);(0,l.getUserChatSeparateSidebarMode)(this.currentUser).never?(e.setCombinedSidebarMode(),e.hideSidebarSwitchPanelButtons()):e.setSeparatedSidebarMode()})),this.chatStateManager.storeAppURL(),this.chat.updatePresence(),(0,t.schedule)("afterRender",(()=>{document.body.classList.add("has-full-page-chat"),document.documentElement.classList.add("has-full-page-chat"),(0,a.scrollTop)()}))}deactivate(e){if((0,n.withPluginApi)("1.8.0",(e=>{(0,c.initSidebarState)(e,this.currentUser)})),e){const t=this.router.urlFor(e.from.name)
this.chatStateManager.storeChatURL(t)}this.chat.activeChannel=null,this.chat.updatePresence(),(0,t.schedule)("afterRender",(()=>{document.body.classList.remove("has-full-page-chat"),document.documentElement.classList.remove("has-full-page-chat")}))}},d=g(u.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(u.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=g(u.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=g(u.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u)})),define("discourse/plugins/chat/discourse/routes/preferences-chat",["exports","@ember/service","discourse/lib/utilities","discourse/routes/restricted-user"],(function(e,t,i,n){"use strict"
var r,a,s,o,l
function c(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(){super(...arguments),c(this,"chat",a,this),c(this,"router",s,this),c(this,"siteSettings",o,this),c(this,"currentUser",l,this),u(this,"showFooter",!0)}setupController(e,t){if(!this.siteSettings.chat_enabled||!t.can_chat&&!this.currentUser?.admin)return this.router.transitionTo(`discovery.${(0,i.defaultHomepage)()}`)
e.set("model",t)}},a=d(r.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=d(r.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=d(r.prototype,"siteSettings",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=d(r.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)})),define("discourse/plugins/chat/discourse/services/chat-admin-api",["exports","@ember/service","discourse/lib/ajax"],(function(e,t,i){"use strict"
function n(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var a=new WeakMap,s=new WeakSet
class o extends t.default{constructor(){var e,t
super(...arguments),n(e=this,t=s),t.add(e),function(e,t,i){n(e,t),t.set(e,i)}(this,a,{get:l,set:void 0})}async exportMessages(){await function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,s,c).call(this,"/export/messages")}}function l(){return"/chat/admin"}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${r(this,a)}${e}`,{type:"POST",data:t})}e.default=o})),define("discourse/plugins/chat/discourse/services/chat-api",["exports","@ember/service","discourse/lib/ajax","discourse/plugins/chat/discourse/models/user-chat-channel-membership","discourse/plugins/chat/discourse/lib/collection"],(function(e,t,i,n,r){"use strict"
var a,s,o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t){b(e,t),t.add(e)}function b(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function g(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function f(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function v(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(l=new WeakMap,c=new WeakSet,u=new WeakSet,d=new WeakSet,h=new WeakSet,a=class extends t.default{constructor(){var e,t,i
super(...arguments),m(this,h),m(this,d),m(this,u),m(this,c),i={get:y,set:void 0},b(e=this,t=l),t.set(e,i),p(this,"chat",s,this),p(this,"chatChannelsManager",o,this)}channel(e){return f(this,c,w).call(this,`/channels/${e}`)}channelThreadMessages(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return f(this,c,w).call(this,`/channels/${e}/threads/${t}/messages?${new URLSearchParams(i).toString()}`)}channelMessages(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,c,w).call(this,`/channels/${e}/messages?${new URLSearchParams(t).toString()}`)}thread(e,t){return f(this,c,w).call(this,`/channels/${e}/threads/${t}`)}threads(e,t){return new r.default(`${g(this,l)}/channels/${e}/threads`,t)}channels(){return new r.default(`${g(this,l)}/channels`,(e=>e.channels.map((e=>this.chatChannelsManager.store(e)))))}moveChannelMessages(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,d,j).call(this,`/channels/${e}/messages/moves`,{move:t})}destroyChannel(e){return f(this,h,M).call(this,`/channels/${e}`)}createChannel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return f(this,d,j).call(this,"/channels",{channel:e}).then((e=>this.chatChannelsManager.store(e.channel)))}categoryPermissions(e){return f(this,c,w).call(this,`/category-chatables/${e}/permissions`)}sendMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`/chat/${e}`,{ignoreUnsent:!1,type:"POST",data:t})}trashMessage(e,t){return f(this,h,M).call(this,`/channels/${e}/messages/${t}`)}createChannelArchive(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,d,j).call(this,`/channels/${e}/archives`,{archive:t})}updateChannel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,u,_).call(this,`/channels/${e}`,{channel:t})}createThread(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return f(this,d,j).call(this,`/channels/${e}/threads`,{title:i.title,original_message_id:t})}updateChannelStatus(e,t){return f(this,u,_).call(this,`/channels/${e}/status`,{status:t})}listChannelMemberships(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return new r.default(`${g(this,l)}/channels/${e}/memberships`,(e=>e.memberships.map((e=>n.default.create(e)))),t)}listCurrentUserChannels(){return f(this,c,w).call(this,"/channels/me")}followChannel(e){return f(this,d,j).call(this,`/channels/${e}/memberships/me`).then((e=>n.default.create(e.membership)))}unfollowChannel(e){return f(this,h,M).call(this,`/channels/${e}/memberships/me`).then((e=>n.default.create(e.membership)))}updateCurrentUserChannelNotificationsSettings(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,u,_).call(this,`/channels/${e}/notifications-settings/me`,{notifications_settings:t})}updateCurrentUserThreadNotificationsSettings(e,t,i){return f(this,u,_).call(this,`/channels/${e}/threads/${t}/notifications-settings/me`,{notification_level:i.notificationLevel})}saveDraft(e,t){return(0,i.ajax)("/chat/drafts",{type:"POST",data:{chat_channel_id:e,data:t},ignoreUnsent:!1}).then((()=>{this.chat.markNetworkAsReliable()})).catch((e=>{e.jqXHR?.responseJSON?.errors?.length||this.chat.markNetworkAsUnreliable()}))}publishReaction(e,t,n,r){return(0,i.ajax)(`/chat/${e}/react/${t}`,{type:"PUT",data:{react_action:r,emoji:n}})}restoreMessage(e,t){return f(this,u,_).call(this,`/channels/${e}/messages/${t}/restore`)}rebakeMessage(e,t){return(0,i.ajax)(`/chat/${e}/${t}/rebake`,{type:"PUT"})}editMessage(e,t,i){return f(this,u,_).call(this,`/channels/${e}/messages/${t}`,i)}markAllChannelsAsRead(){return f(this,u,_).call(this,"/channels/read")}chatables(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return f(this,c,w).call(this,"/chatables",e)}markChannelAsRead(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
return f(this,u,_).call(this,`/channels/${e}/read/${t}`)}markThreadAsRead(e,t){return f(this,u,_).call(this,`/channels/${e}/threads/${t}/read`)}editThread(e,t,i){return f(this,u,_).call(this,`/channels/${e}/threads/${t}`,i)}generateQuote(e,t){return(0,i.ajax)(`/chat/${e}/quote`,{type:"POST",data:{message_ids:t}})}invite(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return f(this,d,j).call(this,`/channels/${e}/invites`,{user_ids:t,message_id:i.messageId})}summarize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,c,w).call(this,`/channels/${e}/summarize`,t)}},s=v(a.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=v(a.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a)
function y(){return"/chat/api"}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${g(this,l)}${e}`,{type:"GET",data:t})}function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${g(this,l)}${e}`,{type:"PUT",data:t})}function j(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${g(this,l)}${e}`,{type:"POST",data:t})}function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${g(this,l)}${e}`,{type:"DELETE",data:t})}})),define("discourse/plugins/chat/discourse/services/chat-audio-manager",["exports","@ember/service","discourse-common/config/environment","discourse-common/lib/get-url","discourse-common/utils/decorators"],(function(e,t,i,n,r){"use strict"
var a,s
function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.CHAT_SOUNDS=void 0
const l=e.CHAT_SOUNDS={bell:[{src:"/plugins/chat/audio/bell.mp3",type:"audio/mpeg"}],ding:[{src:"/plugins/chat/audio/ding.mp3",type:"audio/mpeg"}]}
e.default=(a=(0,r.debounce)(3e3,!0),s=class extends t.default{constructor(){super(...arguments),o(this,"_audioCache",{})}setup(){Object.keys(l).forEach((e=>{this._audioCache[e]=(e=>{const t=new Audio
return t.pause(),e.forEach((e=>{let{type:i,src:r}=e
const a=document.createElement("source")
a.type=i,a.src=(0,n.getURLWithCDN)(r),t.appendChild(a)})),t})(l[e])}))}willDestroy(){this._super(...arguments),this._audioCache={}}playImmediately(e){return this._play(e)}play(e){return this._play(e)}_play(e){const t=this._audioCache[e]||this._audioCache.bell
return t.muted=(0,i.isTesting)(),t.paused||(t.pause(),"function"==typeof t.fastSeek?t.fastSeek(0):t.currentTime=0),t.play().catch((()=>{(0,i.isTesting)()||console.info("[chat] User needs to interact with DOM before we can play notification sounds.")}))}},c=s.prototype,u="play",d=[a],h=Object.getOwnPropertyDescriptor(s.prototype,"play"),p=s.prototype,m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s)
var c,u,d,h,p,m})),define("discourse/plugins/chat/discourse/services/chat-channel-composer",["exports","@glimmer/tracking","@ember/object","@ember/service","discourse/plugins/chat/discourse/models/chat-message"],(function(e,t,i,n,r){"use strict"
var a,s,o,l,c,u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(a=(0,n.inject)("chat-thread-composer"),s=class extends n.default{constructor(){super(...arguments),b(this,"chat",o,this),b(this,"chatApi",l,this),b(this,"currentUser",c,this),b(this,"router",u,this),b(this,"threadComposer",d,this),b(this,"loadingSlider",h,this),b(this,"message",p,this),b(this,"textarea",m,this)}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.textarea?.focus(e)}blur(){this.textarea.blur()}reset(e){this.message=r.default.createDraftMessage(e,{user:this.currentUser})}cancel(){this.message.editing?this.reset(this.message.channel):this.message.inReplyTo&&(this.message.inReplyTo=null),this.focus({ensureAtEnd:!0,refreshHeight:!0})}edit(e){this.chat.activeMessage=null,e.editing=!0,this.message=e,this.focus({refreshHeight:!0,ensureAtEnd:!0})}async replyTo(e){if(this.chat.activeMessage=null,e.channel.threadingEnabled){if(!e.thread?.id){this.loadingSlider.transitionStarted()
const t=await this.chatApi.createThread(e.channel.id,e.id)
this.loadingSlider.transitionEnded(),e.thread=e.channel.threadsManager.add(e.channel,t)}this.reset(e.channel),await this.router.transitionTo("chat.channel.thread",...e.thread.routeModels),this.threadComposer.focus({ensureAtEnd:!0,refreshHeight:!0})}else this.message.inReplyTo=e,this.focus({ensureAtEnd:!0,refreshHeight:!0})}},o=g(s.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=g(s.prototype,"chatApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=g(s.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=g(s.prototype,"router",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=g(s.prototype,"threadComposer",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(s.prototype,"loadingSlider",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=g(s.prototype,"message",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=g(s.prototype,"textarea",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g(s.prototype,"focus",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"focus"),s.prototype),g(s.prototype,"blur",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"blur"),s.prototype),g(s.prototype,"reset",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"reset"),s.prototype),g(s.prototype,"cancel",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"cancel"),s.prototype),g(s.prototype,"edit",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"edit"),s.prototype),g(s.prototype,"replyTo",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"replyTo"),s.prototype),s)})),define("discourse/plugins/chat/discourse/services/chat-channel-emoji-picker-manager",["exports","discourse/plugins/chat/discourse/services/chat-emoji-picker-manager"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{}e.default=i})),define("discourse/plugins/chat/discourse/services/chat-channel-info-route-origin-manager",["exports","@ember/service","@ember/utils","discourse/lib/key-value-store"],(function(e,t,i,n){"use strict"
function r(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.ORIGINS=e.INFO_ROUTE_NAMESPACE=e.BACK_KEY=void 0
const a=e.BACK_KEY="back",s=e.INFO_ROUTE_NAMESPACE="discourse_chat_info_route",o=e.ORIGINS={channel:"channel",browse:"browse"}
class l extends t.default{constructor(){super(...arguments),r(this,"store",new n.default(s))}get origin(){const e=this.store.getObject(a)
if(e)return o[e]}set origin(e){this.store.setObject({key:a,value:e})}get isBrowse(){return this.origin===o.browse}get isChannel(){return this.origin===o.channel||(0,i.isEmpty)(this.origin)}}e.default=l})),define("discourse/plugins/chat/discourse/services/chat-channel-pane-subscriptions-manager",["exports","@glimmer/tracking","@ember/service","@ember-compat/tracked-built-ins","discourse/plugins/chat/discourse/models/chat-notice","discourse/plugins/chat/discourse/models/chat-thread-preview","discourse/plugins/chat/discourse/services/chat-pane-base-subscriptions-manager"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o=class extends s.default{constructor(){super(...arguments),d(this,"chat",l,this),d(this,"currentUser",c,this),d(this,"notices",u,this)}beforeSubscribe(e){this.messageBusChannel=`/chat/${e.id}`,this.messageBusLastId=e.channelMessageBusLastId}afterMessage(e,t,i,n){e.channelMessageBusLastId=n}handleSentMessage(){}handleNotice(e){this.notices.pushObject(r.default.create(e))}clearNotice(e){this.notices.removeObject(e)}handleThreadOriginalMessageUpdate(e){const t=this.messagesManager.findMessage(e.original_message_id)
t?.thread&&(t.thread.preview=a.default.create(e.preview))}_afterDeleteMessage(e,t){this.model.currentUserMembership.lastReadMessageId===e.id&&(this.model.currentUserMembership.lastReadMessageId=t.latest_not_deleted_message_id)}},l=h(o.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(o.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(o.prototype,"notices",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new n.TrackedArray}}),o)})),define("discourse/plugins/chat/discourse/services/chat-channel-pane",["exports","@glimmer/tracking","@ember/object","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(){super(...arguments),u(this,"chat",a,this),u(this,"reacting",s,this),u(this,"selectingMessages",o,this),u(this,"lastSelectedMessage",l,this),u(this,"sending",c,this)}get channel(){return this.chat.activeChannel}get selectedMessageIds(){return this.channel.messagesManager.selectedMessages.mapBy("id")}cancelSelecting(){this.selectingMessages=!1,this.channel.messagesManager.clearSelectedMessages()}onSelectMessage(e){this.lastSelectedMessage=e,this.selectingMessages=!0}},a=d(r.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=d(r.prototype,"reacting",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=d(r.prototype,"selectingMessages",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=d(r.prototype,"lastSelectedMessage",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=d(r.prototype,"sending",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d(r.prototype,"cancelSelecting",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"cancelSelecting"),r.prototype),d(r.prototype,"onSelectMessage",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"onSelectMessage"),r.prototype),r)})),define("discourse/plugins/chat/discourse/services/chat-channels-manager",["exports","@glimmer/tracking","@ember/service","@ember-compat/tracked-built-ins","rsvp","discourse/lib/ajax-error","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p,m,b,g,f,v
function y(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function w(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function _(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function j(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(l=(0,s.debounce)(300),b=new WeakSet,g=new WeakSet,f=new WeakSet,v=new WeakSet,c=class extends i.default{constructor(){super(...arguments),w(this,v),w(this,f),w(this,g),w(this,b),y(this,"chatSubscriptionsManager",u,this),y(this,"chatApi",d,this),y(this,"currentUser",h,this),y(this,"router",p,this),y(this,"_cached",m,this)}async find(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fetchIfNotFound:!0}
const i=_(this,f,k).call(this,e)
return i?r.default.resolve(i):t.fetchIfNotFound?_(this,b,M).call(this,e):r.default.resolve()}get channels(){return Object.values(this._cached)}store(e){let t
return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).replace||(t=_(this,f,k).call(this,e.id)),t||(t=e instanceof o.default?e:o.default.create(e),_(this,g,z).call(this,t)),void 0!==e.meta?.message_bus_last_ids?.channel_message_bus_last_id&&(t.channelMessageBusLastId=e.meta.message_bus_last_ids.channel_message_bus_last_id),t}async follow(e){return this.chatSubscriptionsManager.startChannelSubscription(e),e.currentUserMembership.following?e:this.chatApi.followChannel(e.id).then((t=>(e.currentUserMembership=t,e)))}async unfollow(e){return this.chatSubscriptionsManager.stopChannelSubscription(e),this.chatApi.unfollowChannel(e.id).then((t=>(e.currentUserMembership=t,e)))}async markAllChannelsRead(){return this.chatApi.markAllChannelsAsRead()}remove(e){this.chatSubscriptionsManager.stopChannelSubscription(e),delete this._cached[e.id]}get allChannels(){return[...this.publicMessageChannels,...this.directMessageChannels].sort(((e,t)=>t?.currentUserMembership?.lastViewedAt?.localeCompare?.(e?.currentUserMembership?.lastViewedAt)))}get publicMessageChannels(){return this.channels.filter((e=>e.isCategoryChannel&&e.currentUserMembership.following)).sort(((e,t)=>e?.slug?.localeCompare?.(t?.slug)))}get directMessageChannels(){return _(this,v,C).call(this,this.channels.filter((e=>{const t=e.currentUserMembership
return e.isDirectMessageChannel&&t.following})))}get truncatedDirectMessageChannels(){return this.directMessageChannels.slice(0,20)}},u=j(c.prototype,"chatSubscriptionsManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=j(c.prototype,"chatApi",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=j(c.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=j(c.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=j(c.prototype,"_cached",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new n.TrackedObject}}),j(c.prototype,"markAllChannelsRead",[l],Object.getOwnPropertyDescriptor(c.prototype,"markAllChannelsRead"),c.prototype),j(c.prototype,"publicMessageChannels",[t.cached],Object.getOwnPropertyDescriptor(c.prototype,"publicMessageChannels"),c.prototype),j(c.prototype,"directMessageChannels",[t.cached],Object.getOwnPropertyDescriptor(c.prototype,"directMessageChannels"),c.prototype),c)
async function M(e){try{const t=await this.chatApi.channel(e)
return this.store(t.channel)}catch(t){(0,a.popupAjaxError)(t)}}function z(e){e&&(this._cached[e.id]=e)}function k(e){return this._cached[e]}function C(e){return e.sort(((e,t)=>e.lastMessage.id?t.lastMessage.id?e.tracking.unreadCount===t.tracking.unreadCount?new Date(e.lastMessage.createdAt)>new Date(t.lastMessage.createdAt)?-1:1:e.tracking.unreadCount>t.tracking.unreadCount?-1:1:-1:1))}})),define("discourse/plugins/chat/discourse/services/chat-composer-presence-manager",["exports","@ember/runloop","@ember/service","discourse-common/config/environment"],(function(e,t,i,n){"use strict"
var r,a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="presence",n=this,(i=a)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}willDestroy(){this.leave()}notifyState(e,i){i?(this._channelName!==e&&(this._enter(e),this._channelName=e),(0,n.isTesting)()||(this._autoLeaveTimer=(0,t.debounce)(this,this.leave,1e4))):this.leave()}leave(){this._presentChannel?.leave(),this._presentChannel=null,this._channelName=null,this._autoLeaveTimer&&((0,t.cancel)(this._autoLeaveTimer),this._autoLeaveTimer=null)}_enter(e){this.leave(),this._presentChannel=this.presence.getChannel(e),this._presentChannel.enter()}},s=r.prototype,o="presence",l=[i.inject],c={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),a=d,r)
var s,o,l,c,u,d})),define("discourse/plugins/chat/discourse/services/chat-composer-warnings-tracker",["exports","@glimmer/tracking","@ember/runloop","@ember/service","discourse/lib/ajax","discourse-common/lib/debounce","discourse-common/utils/decorators"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h,p,m,b,g,f
function v(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function y(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function w(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function j(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const M={invalid:-1,unreachable:0,over_members_limit:1}
e.default=(b=new WeakSet,g=new WeakSet,f=new WeakSet,o=class extends n.default{constructor(){super(...arguments),y(this,f),y(this,g),y(this,b),v(this,"siteSettings",l,this),v(this,"unreachableGroupMentions",c,this),v(this,"overMembersLimitGroupMentions",u,this),v(this,"tooManyMentions",d,this),v(this,"channelWideMentionDisallowed",h,this),v(this,"mentionsCount",p,this),v(this,"mentionsTimer",m,this),w(this,"_mentionWarningsSeen",{})}willDestroy(){(0,i.cancel)(this.mentionsTimer)}reset(){_(this,b,z).call(this),this.mentionsCount=0,(0,i.cancel)(this.mentionsTimer)}trackMentions(e,t){if(t)return this._trackMentions(e)
this.mentionsTimer=(0,a.default)(this,this._trackMentions,e,1e3)}_trackMentions(e){this.siteSettings.enable_mentions&&e.parseMentions().then((t=>{if(this.mentionsCount=t?.length,this.mentionsCount>0){if(this.tooManyMentions=this.mentionsCount>this.siteSettings.max_mentions_per_chat_message,!this.tooManyMentions){const i=t.filter((e=>!(e in this._mentionWarningsSeen)))
this.channelWideMentionDisallowed=!e.channel.allowChannelWideMentions&&(t.includes("here")||t.includes("all")),i?.length>0?_(this,g,k).call(this,i,t):_(this,f,C).call(this,t)}}else _(this,b,z).call(this)}))}},l=j(o.prototype,"siteSettings",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=j(o.prototype,"unreachableGroupMentions",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),u=j(o.prototype,"overMembersLimitGroupMentions",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=j(o.prototype,"tooManyMentions",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=j(o.prototype,"channelWideMentionDisallowed",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=j(o.prototype,"mentionsCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),m=j(o.prototype,"mentionsTimer",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j(o.prototype,"reset",[s.bind],Object.getOwnPropertyDescriptor(o.prototype,"reset"),o.prototype),j(o.prototype,"trackMentions",[s.bind],Object.getOwnPropertyDescriptor(o.prototype,"trackMentions"),o.prototype),j(o.prototype,"_trackMentions",[s.bind],Object.getOwnPropertyDescriptor(o.prototype,"_trackMentions"),o.prototype),o)
function z(){this.tooManyMentions=!1,this.channelWideMentionDisallowed=!1,this.unreachableGroupMentions=[],this.overMembersLimitGroupMentions=[]}function k(e,t){(0,r.ajax)("/chat/api/mentions/groups.json",{data:{mentions:e}}).then((e=>{e.unreachable.forEach((e=>{this._mentionWarningsSeen[e]=M.unreachable})),e.over_members_limit.forEach((e=>{this._mentionWarningsSeen[e]=M.over_members_limit})),e.invalid.forEach((e=>{this._mentionWarningsSeen[e]=M.invalid})),_(this,f,C).call(this,t)})).catch(_(this,f,C).call(this,t))}function C(e){const t=e.reduce(((e,t)=>(t in this._mentionWarningsSeen&&this._mentionWarningsSeen[t]!==M.invalid&&(this._mentionWarningsSeen[t]===M.unreachable?e[0].push(t):e[1].push(t)),e)),[[],[]])
this.unreachableGroupMentions=t[0],this.overMembersLimitGroupMentions=t[1]}})),define("discourse/plugins/chat/discourse/services/chat-drafts-manager",["exports","@ember/service","discourse/plugins/chat/discourse/models/chat-message"],(function(e,t,i){"use strict"
function n(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{constructor(){super(...arguments),n(this,"drafts",{})}add(e){if(!(e instanceof i.default))throw new Error("message must be an instance of ChatMessage")
this.drafts[e.channel.id]=e}get(e){let{channelId:t}=e
return this.drafts[t]}remove(e){let{channelId:t}=e
delete this.drafts[t]}reset(){this.drafts={}}}e.default=r})),define("discourse/plugins/chat/discourse/services/chat-drawer-router",["exports","@glimmer/tracking","@ember/service","discourse/plugins/chat/discourse/components/chat-drawer/channel","discourse/plugins/chat/discourse/components/chat-drawer/index","discourse/plugins/chat/discourse/components/chat-drawer/thread","discourse/plugins/chat/discourse/components/chat-drawer/threads"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b={"chat.channel":{name:n.default},"chat.channel.thread":{name:a.default,extractParams:e=>({channelId:e.parent.params.channelId,threadId:e.params.threadId})},"chat.channel.thread.index":{name:a.default,extractParams:e=>({channelId:e.parent.params.channelId,threadId:e.params.threadId})},"chat.channel.thread.near-message":{name:a.default,extractParams:e=>({channelId:e.parent.parent.params.channelId,threadId:e.parent.params.threadId,messageId:e.params.messageId})},"chat.channel.threads":{name:s.default,extractParams:e=>({channelId:e.parent.params.channelId})},chat:{name:r.default},"chat.channel.near-message":{name:n.default,extractParams:e=>({channelId:e.parent.params.channelId,messageId:e.params.messageId})},"chat.channel-legacy":{name:n.default,extractParams:e=>({channelId:e.params.channelId,messageId:e.queryParams.messageId})}}
e.default=(o=class extends i.default{constructor(){super(...arguments),p(this,"router",l,this),p(this,"chatHistory",c,this),p(this,"component",u,this),p(this,"drawerRoute",d,this),p(this,"params",h,this)}stateFor(e){this.drawerRoute?.deactivate?.(this.chatHistory.currentRoute),this.chatHistory.visit(e),this.drawerRoute=b[e.name],this.params=this.drawerRoute?.extractParams?.(e)||e.params,this.component=this.drawerRoute?.name||r.default,this.drawerRoute.activate?.(e)}},l=m(o.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=m(o.prototype,"chatHistory",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=m(o.prototype,"component",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=m(o.prototype,"drawerRoute",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=m(o.prototype,"params",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o)})),define("discourse/plugins/chat/discourse/services/chat-drawer-size",["exports","@ember/service","discourse/lib/key-value-store"],(function(e,t,i){"use strict"
function n(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function r(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=new WeakSet
class o extends t.default{constructor(){super(...arguments),n(this,s),r(this,"STORE_NAMESPACE","discourse_chat_drawer_size_"),r(this,"MIN_HEIGHT",300),r(this,"MIN_WIDTH",250),r(this,"store",new i.default(this.STORE_NAMESPACE))}get size(){return{width:this.store.getObject("width")||400,height:this.store.getObject("height")||530}}set size(e){let{width:t,height:i}=e
this.store.setObject({key:"width",value:a(this,s,l).call(this,t,this.MIN_WIDTH)}),this.store.setObject({key:"height",value:a(this,s,l).call(this,i,this.MIN_HEIGHT)})}}function l(e,t){return Math.max(e,t)}e.default=o})),define("discourse/plugins/chat/discourse/services/chat-emoji-picker-manager",["exports","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","rsvp","discourse/lib/ajax","discourse/lib/ajax-error","discourse-common/config/environment","discourse-common/lib/helpers","discourse-common/utils/decorators"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g,f,v,y
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const j=(0,l.isTesting)()?0:125,M=["favorites","smileys_&_emotion"],z="favorites"
e.default=(d=class extends r.default{constructor(){super(...arguments),w(this,"appEvents",h,this),w(this,"closing",p,this),w(this,"loading",m,this),w(this,"picker",b,this),w(this,"emojis",g,this),w(this,"visibleSections",f,this),w(this,"lastVisibleSection",v,this),w(this,"element",y,this)}get sections(){return!this.loading&&this.emojis?Object.keys(this.emojis):[]}closeExisting(){this.visibleSections=M,this.lastVisibleSection=z,this.picker=null}close(){this.closing=!0,(0,n.later)((()=>{this.isDestroyed||this.isDestroying||(this.visibleSections=M,this.lastVisibleSection=z,this.closing=!1,this.picker=null)}),j)}addVisibleSections(e){this.visibleSections=(0,c.makeArray)(this.visibleSections).concat((0,c.makeArray)(e)).uniq()}open(e){this.loadEmojis(),this.picker?this.picker.trigger===e.trigger?this.closeExisting():(this.closeExisting(),this.picker=e):this.picker=e}loadEmojis(){return this.emojis?a.Promise.resolve():(this.loading=!0,(0,s.ajax)("/chat/emojis.json").then((e=>{this.emojis=e})).catch(o.popupAjaxError).finally((()=>{this.loading=!1})))}},h=_(d.prototype,"appEvents",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=_(d.prototype,"closing",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=_(d.prototype,"loading",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=_(d.prototype,"picker",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=_(d.prototype,"emojis",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=_(d.prototype,"visibleSections",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M}}),v=_(d.prototype,"lastVisibleSection",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return z}}),y=_(d.prototype,"element",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_(d.prototype,"closeExisting",[u.bind],Object.getOwnPropertyDescriptor(d.prototype,"closeExisting"),d.prototype),_(d.prototype,"close",[u.bind],Object.getOwnPropertyDescriptor(d.prototype,"close"),d.prototype),_(d.prototype,"loadEmojis",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"loadEmojis"),d.prototype),d)})),define("discourse/plugins/chat/discourse/services/chat-emoji-reaction-store",["exports","@ember/service","discourse/lib/key-value-store"],(function(e,t,i){"use strict"
function n(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{constructor(){super(...arguments),n(this,"STORE_NAMESPACE","discourse_chat_emoji_reaction_"),n(this,"MAX_DISPLAYED_EMOJIS",20),n(this,"MAX_TRACKED_EMOJIS",2*this.MAX_DISPLAYED_EMOJIS),n(this,"SKIN_TONE_STORE_KEY","emojiSelectedDiversity"),n(this,"USER_EMOJIS_STORE_KEY","emojiUsage"),n(this,"store",new i.default(this.STORE_NAMESPACE)),this.store.getObject(this.USER_EMOJIS_STORE_KEY)||(this.storedFavorites=[])}get diversity(){return this.store.getObject(this.SKIN_TONE_STORE_KEY)||1}set diversity(e){void 0===e&&(e=1),this.store.setObject({key:this.SKIN_TONE_STORE_KEY,value:e}),this.notifyPropertyChange("diversity")}get storedFavorites(){let e=this.store.getObject(this.USER_EMOJIS_STORE_KEY)||[]
return e.length<1&&(e=this.siteSettings.default_emoji_reactions?this.siteSettings.default_emoji_reactions.split("|").filter(Boolean):[],this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:e})),e}set storedFavorites(e){this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:e}),this.notifyPropertyChange("favorites")}get favorites(){return[...new Set(this._frequencySort(this.storedFavorites))].slice(0,this.MAX_DISPLAYED_EMOJIS)}set favorites(e){void 0===e&&(e=[]),this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:e})}track(e){const t=e.replace(/(^:)|(:$)/g,"")
let i=this.storedFavorites
i.unshift(t),i.length=Math.min(i.length,this.MAX_TRACKED_EMOJIS),this.storedFavorites=i}reset(){this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:[]}),this.store.setObject({key:this.SKIN_TONE_STORE_KEY,value:1})}_frequencySort(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{})
return Object.keys(e).sort(((t,i)=>e[i]-e[t]))}}e.default=r})),define("discourse/plugins/chat/discourse/services/chat-guardian",["exports","@ember/service"],(function(e,t){"use strict"
var i,n,r
function a(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function s(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(i=class extends t.default{constructor(){super(...arguments),a(this,"currentUser",n,this),a(this,"siteSettings",r,this)}canEditChatChannel(){return this.canUseChat()&&this.currentUser.staff}canArchiveChannel(e){return this.canEditChatChannel()&&this.siteSettings.chat_allow_archiving_channels&&!e.isArchived&&!e.isReadOnly}canUseChat(){return this.currentUser?.has_chat_enabled&&this.siteSettings?.chat_enabled}},n=s(i.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=s(i.prototype,"siteSettings",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)})),define("discourse/plugins/chat/discourse/services/chat-history",["exports","@glimmer/tracking","@ember/service"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="history",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get previousRoute(){if(this.history?.length>1)return this.history[this.history.length-2]}get currentRoute(){if(this.history?.length>0)return this.history[this.history.length-1]}visit(e){this.history=(this.history||[]).slice(-9).concat([e])}},a=n.prototype,s="history",o=[t.tracked],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/services/chat-notification-manager",["exports","@ember/service","discourse/lib/desktop-notifications","discourse/lib/plugin-api","discourse-common/config/environment","discourse-common/utils/decorators"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(s=class extends t.default{constructor(){super(...arguments),u(this,"presence",o,this),u(this,"chat",l,this),u(this,"chatStateManager",c,this),d(this,"_subscribedToCore",!0),d(this,"_subscribedToChat",!1),d(this,"_countChatInDocTitle",!0)}start(){this._shouldRun()&&(this.set("_chatPresenceChannel",this.presence.getChannel(`/chat-user/chat/${this.currentUser.id}`)),this.set("_corePresenceChannel",this.presence.getChannel(`/chat-user/core/${this.currentUser.id}`)),this._chatPresenceChannel.subscribe(),this._corePresenceChannel.subscribe(),(0,n.withPluginApi)("0.12.1",(e=>{e.onPageChange(this._pageChanged)})),this._pageChanged(),this._chatPresenceChannel.on("change",this._subscribeToCorrectNotifications),this._corePresenceChannel.on("change",this._subscribeToCorrectNotifications))}willDestroy(){super.willDestroy(...arguments),this._shouldRun()&&(this._chatPresenceChannel.off("change",this._subscribeToCorrectNotifications),this._chatPresenceChannel.unsubscribe(),this._chatPresenceChannel.leave(),this._corePresenceChannel.off("change",this._subscribeToCorrectNotifications),this._corePresenceChannel.unsubscribe(),this._corePresenceChannel.leave())}shouldCountChatInDocTitle(){return this._countChatInDocTitle}_pageChanged(){this.chatStateManager.isActive?(this._chatPresenceChannel.enter({onlyWhileActive:!1}),this._corePresenceChannel.leave()):(this._chatPresenceChannel.leave(),this._corePresenceChannel.enter({onlyWhileActive:!1}))}_coreAlertChannel(){return(0,i.alertChannel)(this.currentUser)}_chatAlertChannel(){return`/chat${(0,i.alertChannel)(this.currentUser)}`}_subscribeToCorrectNotifications(){this._chatPresenceChannel.count>0&&this._corePresenceChannel.count>0?this.chatStateManager.isActive?this._subscribeToChat({only:!0}):this._subscribeToCore({only:!0}):this._subscribeToBoth()}_subscribeToBoth(){this._subscribeToChat(),this._subscribeToCore()}_subscribeToChat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{only:!1}
this.set("_countChatInDocTitle",!0),this._subscribedToChat||(this.messageBus.subscribe(this._chatAlertChannel(),this.onMessage),this.set("_subscribedToChat",!0)),e.only&&this._subscribedToCore&&(this.messageBus.unsubscribe(this._coreAlertChannel(),this.onMessage),this.set("_subscribedToCore",!1))}_subscribeToCore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{only:!1}
e.only&&this.set("_countChatInDocTitle",!1),this._subscribedToCore||(this.messageBus.subscribe(this._coreAlertChannel(),this.onMessage),this.set("_subscribedToCore",!0)),e.only&&this._subscribedToChat&&(this.messageBus.unsubscribe(this._chatAlertChannel(),this.onMessage),this.set("_subscribedToChat",!1))}onMessage(e){return(0,i.onNotification)(e,this.siteSettings,this.currentUser)}_shouldRun(){return this.chat.userCanChat&&!(0,r.isTesting)()}},o=h(s.prototype,"presence",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=h(s.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(s.prototype,"chatStateManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(s.prototype,"_pageChanged",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"_pageChanged"),s.prototype),h(s.prototype,"_subscribeToCorrectNotifications",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"_subscribeToCorrectNotifications"),s.prototype),h(s.prototype,"onMessage",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"onMessage"),s.prototype),s)})),define("discourse/plugins/chat/discourse/services/chat-pane-base-subscriptions-manager",["exports","@ember/service","discourse-common/lib/object","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-message"],(function(e,t,i,n,r){"use strict"
var a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function d(e,t,i){const n=t.findStagedMessage(i.staged_id)
if(n)return n.error=null,n.id=i.chat_message.id,n.staged=!1,n.excerpt=i.chat_message.excerpt,n.channel=e,n.createdAt=new Date(i.chat_message.created_at),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.handleStagedMessage=d
e.default=(a=class extends t.default{constructor(){super(...arguments),l(this,"chat",s,this),l(this,"currentUser",o,this),c(this,"messageBusChannel",null),c(this,"messageBusLastId",null)}get messagesManager(){return this.model.messagesManager}beforeSubscribe(){}afterMessage(){}subscribe(e){this.unsubscribe(),this.beforeSubscribe(e),this.model=e,this.messageBusChannel&&this.messageBus.subscribe(this.messageBusChannel,this.onMessage,this.messageBusLastId)}unsubscribe(){this.model&&(this.messageBus.unsubscribe(this.messageBusChannel,this.onMessage),this.model=null)}handleStagedMessageInternal(e,t){return d(e,this.messagesManager,t)}onMessage(e){switch(e.type){case"sent":this.handleSentMessage(e)
break
case"reaction":this.handleReactionMessage(e)
break
case"processed":this.handleProcessedMessage(e)
break
case"edit":this.handleEditMessage(e)
break
case"refresh":this.handleRefreshMessage(e)
break
case"delete":this.handleDeleteMessage(e)
break
case"bulk_delete":this.handleBulkDeleteMessage(e)
break
case"restore":this.handleRestoreMessage(e)
break
case"self_flagged":this.handleSelfFlaggedMessage(e)
break
case"flag":this.handleFlaggedMessage(e)
break
case"thread_created":this.handleNewThreadCreated(e)
break
case"update_thread_original_message":this.handleThreadOriginalMessageUpdate(e)
break
case"notice":this.handleNotice(e)}this.afterMessage(this.model,...arguments)}handleSentMessage(){throw"not implemented"}handleProcessedMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&(t.cooked=e.chat_message.cooked,t.processed=!0)}handleReactionMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&t.react(e.emoji,e.action,e.user,this.currentUser.id)}handleEditMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&(t.excerpt=e.chat_message.excerpt,t.uploads=(0,i.cloneJSON)(e.chat_message.uploads||[]),t.edited=e.chat_message.edited)}handleRefreshMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&t.incrementVersion()}handleBulkDeleteMessage(e){e.deleted_ids.forEach((t=>{this.handleDeleteMessage({deleted_id:t,deleted_at:e.deleted_at})}))}handleDeleteMessage(e){const t=e.deleted_id,i=this.messagesManager.findMessage(t)
i&&(this.currentUser.staff||this.currentUser.id===i.user.id?(i.deletedAt=e.deleted_at,i.deletedById=e.deleted_by_id,i.expanded=!1):this.messagesManager.removeMessage(i),this._afterDeleteMessage(i,e))}handleRestoreMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
if(t)t.deletedAt=null
else{const t=r.default.create(this.model,e.chat_message)
t.manager=this.messagesManager,this.messagesManager.addMessages([t])}}handleSelfFlaggedMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.userFlagStatus=e.user_flag_status)}handleFlaggedMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.reviewableId=e.reviewable_id)}handleNewThreadCreated(e){this.model.threadsManager.find(this.model.id,e.thread_id,{fetchIfNotFound:!0}).then((e=>{const t=this.model.messagesManager.findMessage(e.originalMessage.id)
t&&(t.thread=e)}))}handleThreadOriginalMessageUpdate(){throw"not implemented"}handleNotice(){throw"not implemented"}_afterDeleteMessage(){throw"not implemented"}},s=u(a.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=u(a.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(a.prototype,"onMessage",[n.bind],Object.getOwnPropertyDescriptor(a.prototype,"onMessage"),a.prototype),a)}))
define("discourse/plugins/chat/discourse/services/chat-side-panel-size",["exports","@ember/service","discourse/lib/key-value-store"],(function(e,t,i){"use strict"
function n(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function r(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=new WeakSet
class o extends t.default{constructor(){super(...arguments),n(this,s),r(this,"STORE_NAMESPACE","discourse_chat_side_panel_size_"),r(this,"MIN_WIDTH",250),r(this,"store",new i.default(this.STORE_NAMESPACE))}get width(){return this.store.getObject("width")||this.MIN_WIDTH}set width(e){this.store.setObject({key:"width",value:a(this,s,l).call(this,e,this.MIN_WIDTH)})}}function l(e,t){return Math.max(e,t)}e.default=o})),define("discourse/plugins/chat/discourse/services/chat-state-manager",["exports","@glimmer/tracking","@ember/service","discourse/lib/key-value-store","discourse/lib/plugin-api","discourse/lib/utilities","discourse/models/site","discourse/services/sidebar-state","discourse-common/lib/get-url","discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p,m,b,g,f,v,y
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function j(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function M(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function z(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.addChatDrawerStateCallback=function(e){S.push(e)},e.default=void 0,e.resetChatDrawerStateCallbacks=function(){S=[]}
const k="preferred_mode",C="FULL_PAGE_CHAT",O="DRAWER_CHAT"
let S=[]
e.default=(y=new WeakSet,u=class extends i.default{constructor(){super(...arguments),_(this,y),w(this,"chat",d,this),w(this,"chatHistory",h,this),w(this,"router",p,this),w(this,"isSidePanelExpanded",m,this),w(this,"isDrawerExpanded",b,this),w(this,"isDrawerActive",g,this),w(this,"_chatURL",f,this),w(this,"_appURL",v,this),j(this,"_store",new n.default("discourse_chat_"))}reset(){this._store.remove(k),this._chatURL=null,this._appURL=null}prefersFullPage(){this._store.setObject({key:k,value:C})}prefersDrawer(){this._store.setObject({key:k,value:O})}openSidePanel(){this.isSidePanelExpanded=!0}closeSidePanel(){this.isSidePanelExpanded=!1}didOpenDrawer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,r.withPluginApi)("1.8.0",(e=>{(0,c.getUserChatSeparateSidebarMode)(this.currentUser).always?(e.setSidebarPanel(o.MAIN_PANEL),e.setSeparatedSidebarMode(),e.hideSidebarSwitchPanelButtons()):e.setCombinedSidebarMode()})),this.isDrawerActive=!0,this.isDrawerExpanded=!0,e&&this.storeChatURL(e),this.chat.updatePresence(),M(this,y,P).call(this)}didCloseDrawer(){(0,r.withPluginApi)("1.8.0",(e=>{e.setSidebarPanel(o.MAIN_PANEL)
const t=(0,c.getUserChatSeparateSidebarMode)(this.currentUser)
t.fullscreen?(e.setCombinedSidebarMode(),e.showSidebarSwitchPanelButtons()):t.always?(e.setSeparatedSidebarMode(),e.showSidebarSwitchPanelButtons()):(e.setCombinedSidebarMode(),e.hideSidebarSwitchPanelButtons())})),this.isDrawerActive=!1,this.isDrawerExpanded=!1,this.chat.updatePresence(),M(this,y,P).call(this)}didExpandDrawer(){this.isDrawerActive=!0,this.isDrawerExpanded=!0,this.chat.updatePresence()}didCollapseDrawer(){this.isDrawerActive=!0,this.isDrawerExpanded=!1,M(this,y,P).call(this)}didToggleDrawer(){this.isDrawerExpanded=!this.isDrawerExpanded,this.isDrawerActive=!0,M(this,y,P).call(this)}get isFullPagePreferred(){return!(!s.default.currentProp("mobileView")&&this._store.getObject(k)!==C)}get isDrawerPreferred(){return!(this.isFullPagePreferred&&(s.default.currentProp("mobileView")||this._store.getObject(k)&&this._store.getObject(k)!==O))}get isFullPageActive(){return this.router.currentRouteName?.startsWith("chat")}get isActive(){return this.isFullPageActive||this.isDrawerActive}storeAppURL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null
e?this._appURL=e:this.router.currentURL?.startsWith("/chat")?this._appURL="/":this._appURL=this.router.currentURL}storeChatURL(e){this._chatURL=e}get lastKnownAppURL(){let e=this._appURL
return e&&"/"!==e||(e=this.router.urlFor(`discovery.${(0,a.defaultHomepage)()}`)),(0,l.default)(e)}get lastKnownChatURL(){return(0,l.default)(this._chatURL||"/chat")}},d=z(u.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=z(u.prototype,"chatHistory",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=z(u.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=z(u.prototype,"isSidePanelExpanded",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=z(u.prototype,"isDrawerExpanded",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=z(u.prototype,"isDrawerActive",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=z(u.prototype,"_chatURL",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=z(u.prototype,"_appURL",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u)
function P(){const e={isDrawerActive:this.isDrawerActive,isDrawerExpanded:this.isDrawerExpanded}
S.forEach((t=>t(e)))}})),define("discourse/plugins/chat/discourse/services/chat-subscriptions-manager",["exports","@ember/service","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/models/chat-channel","discourse/plugins/chat/discourse/models/chat-channel-archive"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(s=class extends t.default{constructor(){super(...arguments),b(this,"store",o,this),b(this,"chatChannelsManager",l,this),b(this,"chatTrackingStateManager",c,this),b(this,"currentUser",u,this),b(this,"appEvents",d,this),b(this,"chat",h,this),b(this,"dialog",p,this),b(this,"router",m,this),g(this,"_channelSubscriptions",new Set)}startChannelSubscription(e){e.currentUserMembership.muted||this._channelSubscriptions.has(e.id)||(this._channelSubscriptions.add(e.id),this._startChannelMentionsSubscription(e),e.isDirectMessageChannel||this._startKickFromChannelSubscription(e),this._startChannelNewMessagesSubscription(e))}stopChannelSubscription(e){this.messageBus.unsubscribe(`/chat/${e.id}/new-messages`,this._onNewMessages),e.isDirectMessageChannel||(this.messageBus.unsubscribe(`/chat/${e.id}/new-mentions`,this._onNewMentions),this.messageBus.unsubscribe(`/chat/${e.id}/kick`,this._onKickFromChannel)),this._channelSubscriptions.delete(e.id)}startChannelsSubscriptions(e){this._startNewChannelSubscription(e.new_channel),this._startChannelArchiveStatusSubscription(e.archive_status),this._startUserTrackingStateSubscription(e.user_tracking_state),this._startChannelsEditsSubscription(e.channel_edits),this._startChannelsStatusChangesSubscription(e.channel_status),this._startChannelsMetadataChangesSubscription(e.channel_metadata)}stopChannelsSubscriptions(){this._stopNewChannelSubscription(),this._stopChannelArchiveStatusSubscription(),this._stopUserTrackingStateSubscription(),this._stopChannelsEditsSubscription(),this._stopChannelsStatusChangesSubscription(),this._stopChannelsMetadataChangesSubscription(),(this.chatChannelsManager.channels||[]).forEach((e=>{this.stopChannelSubscription(e)}))}_startChannelArchiveStatusSubscription(e){this.currentUser.admin&&this.messageBus.subscribe("/chat/channel-archive-status",this._onChannelArchiveStatusUpdate,e)}_stopChannelArchiveStatusSubscription(){this.currentUser.admin&&this.messageBus.unsubscribe("/chat/channel-archive-status",this._onChannelArchiveStatusUpdate)}_startChannelMentionsSubscription(e){this.messageBus.subscribe(`/chat/${e.id}/new-mentions`,this._onNewMentions,e.meta.message_bus_last_ids.new_mentions)}_startKickFromChannelSubscription(e){this.messageBus.subscribe(`/chat/${e.id}/kick`,this._onKickFromChannel,e.meta.message_bus_last_ids.kick)}_onChannelArchiveStatusUpdate(e){this.chatChannelsManager.find(e.chat_channel_id,{fetchIfNotFound:!1}).then((t=>{t&&(t.archive=a.default.create(e))}))}_onNewMentions(e){this.chatChannelsManager.find(e.channel_id).then((t=>{const i=t.currentUserMembership
e.message_id>i?.lastReadMessageId&&t.tracking.mentionCount++}))}_onKickFromChannel(e){this.chatChannelsManager.find(e.channel_id).then((e=>{this.chat.activeChannel.id===e.id?this.dialog.alert({message:n.default.t("chat.kicked_from_channel"),didConfirm:()=>{this.chatChannelsManager.remove(e)
const t=this.chatChannelsManager.publicMessageChannels[0]
t?this.router.transitionTo("chat.channel",...t.routeModels):this.router.transitionTo("chat.browse")}}):this.chatChannelsManager.remove(e)}))}_startChannelNewMessagesSubscription(e){this.messageBus.subscribe(`/chat/${e.id}/new-messages`,this._onNewMessages,e.meta.message_bus_last_ids.new_messages)}_onNewMessages(e){switch(e.type){case"channel":this._onNewChannelMessage(e)
break
case"thread":this._onNewThreadMessage(e)}}_onNewChannelMessage(e){this.chatChannelsManager.find(e.channel_id).then((t=>{t.lastMessage=e.message
const i=e.message.user
i.id===this.currentUser.id||this.currentUser.ignored_users.includes(i.username)?t.currentUserMembership.lastReadMessageId=t.lastMessage.id:(t.lastMessage.id>(t.currentUserMembership.lastReadMessageId||0)&&t.tracking.unreadCount++,e.thread_id&&t.threadingEnabled&&t.threadsManager.find(t.id,e.thread_id).then((i=>{i.currentUserMembership&&(t.threadsManager.markThreadUnread(e.thread_id,e.message.created_at),this._updateActiveLastViewedAt(t))})))}))}_onNewThreadMessage(e){this.chatChannelsManager.find(e.channel_id).then((t=>{t.threadingEnabled&&t.threadsManager.find(e.channel_id,e.thread_id).then((i=>{e.message.user.id===this.currentUser.id?i.currentUserMembership&&(t.threadsManager.unreadThreadOverview.delete(parseInt(e.thread_id,10)),i.currentUserMembership.lastReadMessageId=e.message.id):this.currentUser.ignored_users.includes(e.message.user.username)?i.currentUserMembership&&(i.currentUserMembership.lastReadMessageId=e.message.id):i.currentUserMembership&&e.message.id>(i.currentUserMembership.lastReadMessageId||0)&&!i.currentUserMembership.isQuiet&&(t.threadsManager.markThreadUnread(e.thread_id,e.message.created_at),i.tracking.unreadCount++,this._updateActiveLastViewedAt(t))}))}))}_updateActiveLastViewedAt(e){this.chat.activeChannel?.id===e.id&&e.updateLastViewedAt()}_startUserTrackingStateSubscription(e){this.currentUser&&(this.messageBus.subscribe(`/chat/user-tracking-state/${this.currentUser.id}`,this._onUserTrackingStateUpdate,e),this.messageBus.subscribe(`/chat/bulk-user-tracking-state/${this.currentUser.id}`,this._onBulkUserTrackingStateUpdate,e))}_stopUserTrackingStateSubscription(){this.currentUser&&(this.messageBus.unsubscribe(`/chat/user-tracking-state/${this.currentUser.id}`,this._onUserTrackingStateUpdate),this.messageBus.unsubscribe(`/chat/bulk-user-tracking-state/${this.currentUser.id}`,this._onBulkUserTrackingStateUpdate))}_onBulkUserTrackingStateUpdate(e){Object.keys(e).forEach((t=>{this._updateChannelTrackingData(t,e[t])}))}_onUserTrackingStateUpdate(e){this._updateChannelTrackingData(e.channel_id,e)}_updateChannelTrackingData(e,t){this.chatChannelsManager.find(e).then((i=>{t.thread_id||(i.currentUserMembership.lastReadMessageId=t.last_read_message_id),i.tracking.unreadCount=t.unread_count,i.tracking.mentionCount=t.mention_count,t.hasOwnProperty("unread_thread_overview")&&i.threadingEnabled&&(i.threadsManager.unreadThreadOverview=t.unread_thread_overview),t.thread_id&&t.hasOwnProperty("thread_tracking")&&i.threadingEnabled&&i.threadsManager.find(e,t.thread_id).then((e=>{e.currentUserMembership&&!e.currentUserMembership.isQuiet&&(e.currentUserMembership.lastReadMessageId=t.last_read_message_id,e.tracking.unreadCount=t.thread_tracking.unread_count,e.tracking.mentionCount=t.thread_tracking.mention_count)}))}))}_startNewChannelSubscription(e){this.messageBus.subscribe("/chat/new-channel",this._onNewChannelSubscription,e)}_stopNewChannelSubscription(){this.messageBus.unsubscribe("/chat/new-channel",this._onNewChannelSubscription)}_onNewChannelSubscription(e){this.chatChannelsManager.find(e.channel.id).then((t=>{t.meta=e.channel.meta,t.currentUserMembership=e.channel.current_user_membership,t.isDirectMessageChannel&&!t.currentUserMembership.following&&(t.tracking.unreadCount=1),this.chatChannelsManager.follow(t)}))}_startChannelsMetadataChangesSubscription(e){this.messageBus.subscribe("/chat/channel-metadata",this._onChannelMetadata,e)}_startChannelsEditsSubscription(e){this.messageBus.subscribe("/chat/channel-edits",this._onChannelEdits,e)}_startChannelsStatusChangesSubscription(e){this.messageBus.subscribe("/chat/channel-status",this._onChannelStatus,e)}_stopChannelsStatusChangesSubscription(){this.messageBus.unsubscribe("/chat/channel-status",this._onChannelStatus)}_stopChannelsEditsSubscription(){this.messageBus.unsubscribe("/chat/channel-edits",this._onChannelEdits)}_stopChannelsMetadataChangesSubscription(){this.messageBus.unsubscribe("/chat/channel-metadata",this._onChannelMetadata)}_onChannelMetadata(e){this.chatChannelsManager.find(e.chat_channel_id,{fetchIfNotFound:!1}).then((t=>{t&&(t.membershipsCount=e.memberships_count,this.appEvents.trigger("chat:refresh-channel-members"))}))}_onChannelEdits(e){this.chatChannelsManager.find(e.chat_channel_id).then((t=>{t&&(t.title=e.name,t.description=e.description,t.slug=e.slug)}))}_onChannelStatus(e){this.chatChannelsManager.find(e.chat_channel_id).then((t=>{t.status=e.status,e.status===r.CHANNEL_STATUSES.archived&&t.tracking.reset()}))}},o=f(s.prototype,"store",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=f(s.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=f(s.prototype,"chatTrackingStateManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=f(s.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=f(s.prototype,"appEvents",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=f(s.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=f(s.prototype,"dialog",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=f(s.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(s.prototype,"_onChannelArchiveStatusUpdate",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onChannelArchiveStatusUpdate"),s.prototype),f(s.prototype,"_onNewMentions",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onNewMentions"),s.prototype),f(s.prototype,"_onKickFromChannel",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onKickFromChannel"),s.prototype),f(s.prototype,"_onNewMessages",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onNewMessages"),s.prototype),f(s.prototype,"_onBulkUserTrackingStateUpdate",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onBulkUserTrackingStateUpdate"),s.prototype),f(s.prototype,"_onUserTrackingStateUpdate",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onUserTrackingStateUpdate"),s.prototype),f(s.prototype,"_updateChannelTrackingData",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_updateChannelTrackingData"),s.prototype),f(s.prototype,"_onNewChannelSubscription",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onNewChannelSubscription"),s.prototype),f(s.prototype,"_onChannelMetadata",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onChannelMetadata"),s.prototype),f(s.prototype,"_onChannelEdits",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onChannelEdits"),s.prototype),f(s.prototype,"_onChannelStatus",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onChannelStatus"),s.prototype),s)})),define("discourse/plugins/chat/discourse/services/chat-thread-composer",["exports","@glimmer/tracking","@ember/object","@ember/service","discourse/plugins/chat/discourse/models/chat-message"],(function(e,t,i,n,r){"use strict"
var a,s,o,l
function c(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(a=class extends n.default{constructor(){super(...arguments),c(this,"chat",s,this),c(this,"message",o,this),c(this,"textarea",l,this)}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.textarea?.focus(e)}blur(){this.textarea?.blur()}reset(e){this.message=r.default.createDraftMessage(e.channel,{user:this.currentUser,thread:e})}cancel(){this.message.editing?this.reset(this.message.thread):this.message.inReplyTo&&(this.message.inReplyTo=null)}edit(e){this.chat.activeMessage=null,e.editing=!0,this.message=e,this.focus({refreshHeight:!0,ensureAtEnd:!0})}replyTo(){this.chat.activeMessage=null}},s=u(a.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=u(a.prototype,"message",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=u(a.prototype,"textarea",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(a.prototype,"focus",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"focus"),a.prototype),u(a.prototype,"blur",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"blur"),a.prototype),u(a.prototype,"reset",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"reset"),a.prototype),u(a.prototype,"cancel",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"cancel"),a.prototype),u(a.prototype,"edit",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"edit"),a.prototype),u(a.prototype,"replyTo",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"replyTo"),a.prototype),a)})),define("discourse/plugins/chat/discourse/services/chat-thread-list-pane",["exports","@ember/service"],(function(e,t){"use strict"
var i,n,r
function a(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function s(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(i=class extends t.default{constructor(){super(...arguments),a(this,"chat",n,this),a(this,"router",r,this)}get isOpened(){return"chat.channel.threads"===this.router.currentRoute.name}async close(){await this.router.transitionTo("chat.channel",...this.chat.activeChannel.routeModels)}async open(){await this.router.transitionTo("chat.channel.threads",...this.chat.activeChannel.routeModels)}},n=s(i.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=s(i.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)})),define("discourse/plugins/chat/discourse/services/chat-thread-pane-subscriptions-manager",["exports","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/services/chat-pane-base-subscriptions-manager"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends i.default{beforeSubscribe(e){this.messageBusChannel=`/chat/${e.channel.id}/thread/${e.id}`,this.messageBusLastId=e.threadMessageBusLastId}afterMessage(e,t,i,n){e.threadMessageBusLastId=n}handleSentMessage(e){if(e.chat_message.user.id===this.currentUser.id&&e.staged_id){if(this.handleStagedMessageInternal(this.model.channel,e))return}const i=t.default.create(this.model.channel,e.chat_message)
i.thread=this.model,i.manager=this.messagesManager,this.messagesManager.addMessages([i])}handleThreadOriginalMessageUpdate(){}handleNotice(){}_afterDeleteMessage(e,t){this.model.currentUserMembership?.lastReadMessageId===e.id&&(this.model.currentUserMembership.lastReadMessageId=t.latest_not_deleted_message_id)}}e.default=n})),define("discourse/plugins/chat/discourse/services/chat-thread-pane",["exports","@ember/service","discourse/plugins/chat/discourse/services/chat-channel-pane"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){super(...arguments),s(this,"chat",r,this),s(this,"router",a,this)}get thread(){return this.channel?.activeThread}get isOpened(){return"chat.channel.thread"===this.router.currentRoute.name}get selectedMessageIds(){return this.thread.messagesManager.selectedMessages.mapBy("id")}async close(){await this.router.transitionTo("chat.channel",...this.channel.routeModels)}async open(e){await this.router.transitionTo("chat.channel.thread",...e.routeModels)}},r=o(n.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=o(n.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/services/chat-tracking-state-manager",["exports","@ember/application","@ember/runloop","@ember/service","discourse-common/lib/debounce","discourse/plugins/chat/discourse/models/chat-tracking-state"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i){g(e,t),t.set(e,i)}function b(e,t){g(e,t),t.add(e)}function g(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function v(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(c=new WeakSet,u=new WeakSet,d=new WeakMap,h=new WeakMap,s=class extends n.default{constructor(){super(...arguments),m(this,h,{get:M,set:void 0}),m(this,d,{get:j,set:void 0}),b(this,u),b(this,c),p(this,"chatChannelsManager",o,this),p(this,"appEvents",l,this)}setupWithPreloadedState(e){let{channel_tracking:t={}}=e
this.chatChannelsManager.channels.forEach((e=>{t[e.id.toString()]&&v(this,u,_).call(this,e,t[e.id.toString()])}))}setupChannelThreadState(e,t){e.threadsManager.threads.forEach((e=>{const i=t[e.id.toString()]
i&&v(this,u,_).call(this,e,i)}))}get publicChannelUnreadCount(){return f(this,d).reduce(((e,t)=>e+t.tracking.unreadCount),0)}get allChannelMentionCount(){return f(this,d).reduce(((e,t)=>e+t.tracking.mentionCount),0)+f(this,h).reduce(((e,t)=>e+t.tracking.mentionCount),0)}get allChannelUrgentCount(){return f(this,d).reduce(((e,t)=>e+t.tracking.mentionCount),0)+f(this,h).reduce(((e,t)=>e+t.tracking.unreadCount),0)}willDestroy(){super.willDestroy(...arguments),(0,i.cancel)(this._onTriggerNotificationDebounceHandler)}triggerNotificationsChanged(){this._onTriggerNotificationDebounceHandler=(0,r.default)(this,v(this,c,w),100)}},o=y(s.prototype,"chatChannelsManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=y(s.prototype,"appEvents",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s)
function w(){this.appEvents.trigger("notifications:changed")}function _(e,i){e.tracking||(e.tracking=new a.default((0,t.getOwner)(this))),e.tracking.unreadCount=i.unread_count,e.tracking.mentionCount=i.mention_count}function j(){return this.chatChannelsManager.publicMessageChannels}function M(){return this.chatChannelsManager.directMessageChannels}})),define("discourse/plugins/chat/discourse/services/chat",["exports","@glimmer/tracking","@ember/object","@ember/object/computed","@ember/runloop","@ember/service","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/user-presence","discourse-common/lib/deprecated","discourse-common/lib/later","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-message"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g,f,v,y,w,_,j,M,z,k,C,O,S,P,T,E
function x(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function D(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function A(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const I={userUnseenTime:3e5,browserHiddenTime:3e5}
e.default=(p=(0,n.and)("currentUser.has_chat_enabled","siteSettings.chat_enabled"),m=(0,i.computed)("currentUser.staff","currentUser.groups.[]"),b=(0,i.computed)("activeChannel.userSilenced"),g=class extends a.default{constructor(){super(...arguments),x(this,"chatApi",f,this),x(this,"appEvents",v,this),x(this,"currentUser",y,this),x(this,"chatNotificationManager",w,this),x(this,"chatSubscriptionsManager",_,this),x(this,"chatStateManager",j,this),x(this,"chatDraftsManager",M,this),x(this,"presence",z,this),x(this,"router",k,this),x(this,"site",C,this),x(this,"chatChannelsManager",O,this),x(this,"chatTrackingStateManager",S,this),D(this,"cook",null),D(this,"presenceChannel",null),D(this,"sidebarActive",!1),D(this,"isNetworkUnreliable",!1),x(this,"userCanChat",P,this),x(this,"_activeMessage",T,this),x(this,"_activeChannel",E,this)}get activeChannel(){return this._activeChannel}set activeChannel(e){e||(this._activeMessage=null),this._activeChannel&&(this._activeChannel.activeThread=null),this._activeChannel=e}get userCanDirectMessage(){return!!this.currentUser&&(this.currentUser.staff||this.siteSettings.userInAnyGroups("direct_message_enabled_groups",this.currentUser))}get userCanInteractWithChat(){return!this.activeChannel?.userSilenced}get activeMessage(){return this._activeMessage}set activeMessage(e){this._activeMessage=e||null}init(){super.init(...arguments),this.userCanChat&&(this.presenceChannel=this.presence.getChannel("/chat/online"),(0,l.onPresenceChange)({callback:this.onPresenceChangeCallback,browserHiddenTime:15e4,userUnseenTime:15e4}))}onPresenceChangeCallback(e){e&&this.chatApi.listCurrentUserChannels().then((e=>{this.chatSubscriptionsManager.stopChannelsSubscriptions(),this.chatSubscriptionsManager.startChannelsSubscriptions(e.meta.message_bus_last_ids),[...e.public_channels,...e.direct_message_channels].forEach((t=>{this.chatChannelsManager.find(t.id,{fetchIfNotFound:!1}).then((i=>{if(!i)return
i.meta.message_bus_last_ids=t.meta.message_bus_last_ids
const n=e.tracking.channel_tracking[i.id]
i.tracking.unreadCount=n.unread_count,i.tracking.mentionCount=n.mention_count,i.currentUserMembership=t.current_user_membership,this.chatSubscriptionsManager.startChannelSubscription(i)}))}))}))}markNetworkAsUnreliable(){(0,r.cancel)(this._networkCheckHandler),this.set("isNetworkUnreliable",!0),this._networkCheckHandler=(0,u.default)((()=>{this.isDestroyed||this.isDestroying||this.markNetworkAsReliable()}),3e4)}markNetworkAsReliable(){(0,r.cancel)(this._networkCheckHandler),this.set("isNetworkUnreliable",!1)}setupWithPreloadedChannels(e){this.chatSubscriptionsManager.startChannelsSubscriptions(e.meta.message_bus_last_ids),this.presenceChannel.subscribe(e.global_presence_channel_state),[...e.public_channels,...e.direct_message_channels].forEach((t=>{const i=this.chatChannelsManager.store(t),n=(this.currentUser?.chat_drafts||[]).find((e=>e.channel_id===i.id))
return n&&this.chatDraftsManager.add(h.default.createDraftMessage(i,Object.assign({user:this.currentUser},JSON.parse(n.data)))),e.unread_thread_overview?.[i.id]&&(i.threadsManager.unreadThreadOverview=e.unread_thread_overview[i.id]),this.chatChannelsManager.follow(i)})),this.chatTrackingStateManager.setupWithPreloadedState(e.tracking)}willDestroy(){super.willDestroy(...arguments),this.userCanChat&&(this.chatSubscriptionsManager.stopChannelsSubscriptions(),(0,l.removeOnPresenceChange)(this.onPresenceChangeCallback))}updatePresence(){(0,r.next)((()=>{this.isDestroyed||this.isDestroying||this.currentUser.user_option?.hide_profile_and_presence||(this.chatStateManager.isActive?this.presenceChannel.enter({activeOptions:I}):this.presenceChannel.leave())}))}getDocumentTitleCount(){return this.chatNotificationManager.shouldCountChatInDocTitle()?this.chatTrackingStateManager.allChannelUrgentCount:0}switchChannelUpOrDown(e){const{activeChannel:t}=this
if(!t)return
let i,n
t.isDirectMessageChannel?(i=this.chatChannelsManager.truncatedDirectMessageChannels,n=this.chatChannelsManager.publicMessageChannels):(i=this.chatChannelsManager.publicMessageChannels,n=this.chatChannelsManager.truncatedDirectMessageChannels)
const r="up"===e,a=i.findIndex((e=>e.id===t.id))
let s=i[a+(r?-1:1)]
if(s)return this.router.transitionTo("chat.channel",...s.routeModels)
const o=n.length?n:i,l=r?o[o.length-1]:o[0]
return l.id!==t.id?this.router.transitionTo("chat.channel",...l.routeModels):void 0}getIdealFirstChannelId(){let e,t,i,n,r,a
return this.chatChannelsManager.channels.forEach((s=>{const o=s.currentUserMembership
if(o.following)if(s.isDirectMessageChannel)!t&&s.tracking.unreadCount>0?t=s.id:r||(r=s.id)
else{if(o.unread_mentions>0)return void(e=s.id)
!i&&s.tracking.unreadCount>0?i=s.id:a||parseInt(this.siteSettings.chat_default_channel_id||0,10)!==s.id?n||(n=s.id):a=s.id}})),e||t||i||a||n||r}_fireOpenFloatAppEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
t?this.router.transitionTo("chat.channel.near-message",...e.routeModels,t):this.router.transitionTo("chat.channel",...e.routeModels)}async followChannel(e){return this.chatChannelsManager.follow(e)}async unfollowChannel(e){return this.chatChannelsManager.unfollow(e).then((()=>{e===this.activeChannel&&e.isDirectMessageChannel&&this.router.transitionTo("chat")}))}upsertDmChannelForUser(e,t){const i=(e.chatable.users||[]).mapBy("username").concat(t.username).uniq()
return this.upsertDmChannelForUsernames(i)}upsertDmChannelForUsernames(e){return(0,s.ajax)("/chat/api/direct-message-channels.json",{method:"POST",data:{target_usernames:e.uniq()}}).then((e=>{const t=this.chatChannelsManager.store(e.channel)
return this.chatChannelsManager.follow(t),t})).catch(o.popupAjaxError)}getDmChannelForUsernames(e){return(0,s.ajax)("/chat/direct_messages.json",{data:{usernames:e.uniq().join(",")}})}addToolbarButton(){(0,c.default)("Use the new chat API `api.registerChatComposerButton` instead of `chat.addToolbarButton`")}},f=A(g.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=A(g.prototype,"appEvents",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=A(g.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=A(g.prototype,"chatNotificationManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=A(g.prototype,"chatSubscriptionsManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=A(g.prototype,"chatStateManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=A(g.prototype,"chatDraftsManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=A(g.prototype,"presence",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=A(g.prototype,"router",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=A(g.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=A(g.prototype,"chatChannelsManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=A(g.prototype,"chatTrackingStateManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=A(g.prototype,"userCanChat",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=A(g.prototype,"_activeMessage",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=A(g.prototype,"_activeChannel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A(g.prototype,"userCanDirectMessage",[m],Object.getOwnPropertyDescriptor(g.prototype,"userCanDirectMessage"),g.prototype),A(g.prototype,"userCanInteractWithChat",[b],Object.getOwnPropertyDescriptor(g.prototype,"userCanInteractWithChat"),g.prototype),A(g.prototype,"onPresenceChangeCallback",[d.bind],Object.getOwnPropertyDescriptor(g.prototype,"onPresenceChangeCallback"),g.prototype),g)})),define("discourse/plugins/chat/discourse/services/emoji-picker-scroll-observer",["exports","@glimmer/tracking","@ember/service","discourse-common/utils/decorators"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(){super(...arguments),o(this,"chatEmojiPickerManager",a,this),o(this,"enabled",s,this),l(this,"direction","up"),l(this,"prevYPosition",0)}_observerCallback(e){if(!this.enabled)return
this._setScrollDirection(e.target)
const t=[...document.querySelectorAll(".chat-emoji-picker__section")].filter((t=>this._isSectionVisibleInPicker(t,e.target)))
if(t?.length){let e
e="up"===this.direction||this.prevYPosition<50?t.firstObject:t.lastObject,this.chatEmojiPickerManager.lastVisibleSection=e.dataset.section,this.chatEmojiPickerManager.addVisibleSections(t.map((e=>e.dataset.section)))}}observe(e){e.addEventListener("scroll",this._observerCallback)}unobserve(e){e.removeEventListener("scroll",this._observerCallback)}_setScrollDirection(e){e.scrollTop>this.prevYPosition?this.direction="down":this.direction="up",this.prevYPosition=e.scrollTop}_isSectionVisibleInPicker(e,t){const{bottom:i,height:n,top:r}=e.getBoundingClientRect(),a=t.getBoundingClientRect()
return r<=a.top?a.top-r<=n:i-a.bottom<=n}},a=c(r.prototype,"chatEmojiPickerManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"enabled",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),c(r.prototype,"_observerCallback",[n.bind],Object.getOwnPropertyDescriptor(r.prototype,"_observerCallback"),r.prototype),r)})),define("discourse/plugins/chat/discourse/templates/admin-plugins-chat",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"43El/bcP",block:'[[[8,[39,0],null,null,null],[1,"\\n\\n"],[41,[30,0,["selectedWebhook"]],[[[1,"  "],[8,[39,2],[[24,0,"incoming-chat-webhooks-back"]],[["@icon","@label","@title","@action"],["chevron-left","chat.incoming_webhooks.back","chat.incoming_webhooks.back",[28,[37,3],[[28,[37,4],[[30,0,["selectedWebhookId"]]],null],null],null]]],null],[1,"\\n\\n  "],[10,"form"],[14,0,"form-vertical"],[12],[1,"\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.name"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,6],[[16,"placeholder",[28,[37,5],["chat.incoming_webhooks.name"],null]]],[["@type","@value"],["text",[30,0,["selectedWebhook","name"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.description"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,7],null,[["@value"],[[30,0,["selectedWebhook","description"]]]],null],[1,"    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.username"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,6],[[16,"placeholder",[28,[37,5],["chat.incoming_webhooks.system"],null]]],[["@type","@value"],["text",[30,0,["selectedWebhook","username"]]]],null],[1,"\\n      "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.username_instructions"],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.post_to"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,8],null,[["@content","@value","@onChange"],[[30,0,["model","chat_channels"]],[30,0,["selectedWebhook","chat_channel","id"]],[28,[37,9],[[30,0],"changeChatChannel"],null]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n"],[41,[30,0,["selectedWebhook","emoji"]],[[[1,"          "],[1,[28,[35,5],["chat.incoming_webhooks.current_emoji"],null]],[1,"\\n\\n          "],[10,1],[14,0,"incoming-chat-webhooks-current-emoji"],[12],[1,"\\n            "],[1,[28,[35,10],[[30,0,["selectedWebhook","emoji"]]],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[35,5],["chat.incoming_webhooks.no_emoji"],null]],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n\\n      "],[8,[39,11],null,[["@isActive","@isEditorFocused","@emojiSelected","@onEmojiPickerClose"],[[30,0,["emojiPickerIsActive"]],true,[28,[37,9],[[30,0],"emojiSelected"],null],[28,[37,9],[[30,0],[28,[37,4],[[30,0,["emojiPickerIsActive"]]],null],false],null]]],null],[1,"\\n\\n"],[41,[51,[30,0,["emojiPickerIsActive"]]],[[[1,"        "],[8,[39,2],[[24,0,"btn-primary"]],[["@label","@action"],["chat.incoming_webhooks.select_emoji",[28,[37,3],[[28,[37,4],[[30,0,["emojiPickerIsActive"]]],null],true],null]]],null],[1,"\\n        "],[8,[39,2],null,[["@label","@action","@disabled"],["chat.incoming_webhooks.reset_emoji",[28,[37,3],[[28,[37,4],[[30,0,["selectedWebhook","emoji"]]],null],null],null],[28,[37,13],[[30,0,["selectedWebhook","emoji"]]],null]]],null],[1,"\\n"]],[]],null],[1,"\\n      "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.emoji_instructions"],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,[28,[35,5],["chat.incoming_webhooks.url"],null]],[13],[1,"\\n      "],[10,"label"],[12],[1,[30,0,["selectedWebhook","url"]]],[13],[1,"\\n      "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.url_instructions"],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[39,2],[[24,0,"btn-primary"]],[["@label","@title","@action","@disabled"],["chat.incoming_webhooks.save","chat.incoming_webhooks.save",[30,0,["saveEdit"]],[30,0,["saveEditDisabled"]]]],null],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[1,"  "],[10,"h3"],[12],[1,[28,[35,5],["chat.incoming_webhooks.title"],null]],[13],[1,"\\n\\n"],[41,[30,0,["creatingNew"]],[[[1,"    "],[10,0],[14,0,"new-incoming-webhook-container"],[12],[1,"\\n      "],[8,[39,6],[[16,"placeholder",[28,[37,5],["chat.incoming_webhooks.name_placeholder"],null]]],[["@type","@value"],["text",[30,0,["newWebhookName"]]]],null],[1,"\\n      "],[8,[39,8],null,[["@content","@value","@onChange"],[[30,0,["model","chat_channels"]],[30,0,["newWebhookChannelId"]],[28,[37,9],[[30,0],[28,[37,4],[[30,0,["newWebhookChannelId"]]],null]],null]]],null],[1,"\\n      "],[8,[39,2],[[24,0,"btn-primary create-new-incoming-webhook-btn"]],[["@label","@title","@disabled","@action"],["chat.create","chat.create",[28,[37,13],[[30,0,["nameAndChannelValid"]]],null],[30,0,["createNewWebhook"]]]],null],[1,"\\n      "],[8,[39,2],null,[["@label","@title","@action"],["chat.cancel","chat.cancel",[30,0,["resetNewWebhook"]]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[1,"    "],[8,[39,2],[[24,0,"btn-primary"]],[["@label","@title","@action"],["chat.incoming_webhooks.new","chat.incoming_webhooks.new",[28,[37,3],[[28,[37,4],[[30,0,["creatingNew"]]],null],true],null]]],null],[1,"\\n"]],[]]],[1,"\\n  "],[10,2],[12],[1,[28,[35,14],[[28,[37,5],["chat.incoming_webhooks.instructions"],null]],null]],[13],[1,"\\n\\n  "],[10,0],[14,0,"incoming-chat-webhooks"],[12],[1,"\\n"],[41,[30,0,["model","incoming_chat_webhooks"]],[[[42,[28,[37,16],[[28,[37,16],[[30,0,["sortedWebhooks"]]],null]],null],null,[[[1,"        "],[10,0],[14,0,"incoming-chat-webhooks--row"],[12],[1,"\\n          "],[10,0],[14,0,"incoming-chat-webhooks--row--details"],[12],[1,"\\n            "],[10,0],[14,0,"incoming-chat-webhooks--row--details--name"],[12],[1,"\\n              "],[1,[30,1,["name"]]],[1,"\\n            "],[13],[1,"\\n\\n            "],[10,0],[12],[1,"\\n"],[41,[30,1,["emoji"]],[[[1,"                "],[1,[28,[35,10],[[30,1,["emoji"]]],null]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,1,["username"]],[[[1,"                "],[1,[30,1,["username"]]],[1,"\\n"]],[]],[[[1,"                "],[1,[28,[35,5],["chat.incoming_webhooks.system"],null]],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n\\n            "],[10,0],[12],[8,[39,17],null,[["@channel"],[[30,1,["chat_channel"]]]],null],[13],[1,"\\n            "],[10,0],[12],[1,[30,1,["description"]]],[13],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,0],[14,0,"incoming-chat-webhooks--row--controls"],[12],[1,"\\n            "],[10,0],[12],[1,"\\n              "],[8,[39,2],null,[["@icon","@label","@action"],["pencil-alt","chat.incoming_webhooks.edit",[28,[37,3],[[28,[37,4],[[30,0,["selectedWebhookId"]]],null],[30,1,["id"]]],null]]],null],[1,"\\n              "],[8,[39,2],[[24,0,"btn-danger"]],[["@icon","@title","@action"],["trash-alt","chat.incoming_webhooks.delete",[28,[37,3],[[30,0,["destroyWebhook"]],[30,1]],null]]],null],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[1]],null]],[]],[[[1,"      "],[1,[28,[35,5],["chat.incoming_webhooks.none"],null]],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"]],[]]]],["webhook"],false,["chat/admin/export-messages","if","d-button","fn","mut","i18n","input","textarea","chat-channel-chooser","action","replace-emoji","emoji-picker","unless","not","html-safe","each","-track-array","chat-channel-title"]]',moduleName:"discourse/plugins/chat/discourse/templates/admin-plugins-chat.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse-all",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"n+hNl9uO",block:'[[[8,[39,0],null,[["@status"],["all"]],null]],[],false,["chat-browse-view"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-all.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse-archived",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"EUaP2Z63",block:'[[[8,[39,0],null,[["@status"],["archived"]],null]],[],false,["chat-browse-view"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-archived.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse-closed",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"ZWfH9pQM",block:'[[[8,[39,0],null,[["@status"],["closed"]],null]],[],false,["chat-browse-view"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-closed.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse-open",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"Oa2syDPa",block:'[[[8,[39,0],null,[["@status"],["open"]],null]],[],false,["chat-browse-view"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-open.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"bDDVU8Cl",block:'[[[46,[28,[37,1],null,null],null,null,null]],[],false,["component","-outlet"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-info-members",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"UwB0ekip",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat-channel-members"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info-members.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-info-settings",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"KgGiD2yf",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat-channel-settings"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info-settings.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-info",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"+sU3YTT9",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat-channel-info"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-thread",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"l5w9/9z5",block:'[[[8,[39,0],null,[["@thread","@targetMessageId","@includeHeader"],[[30,0,["model"]],[30,0,["targetMessageId"]],true]],null]],[],false,["chat-thread"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-thread.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-threads",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"Falkwh8k",block:'[[[8,[39,0],null,[["@channel","@includeHeader"],[[30,0,["model"]],true]],null]],[],false,["chat-thread-list"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-threads.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"ohzsMQzC",block:'[[[8,[39,0],null,[["@channel","@targetMessageId"],[[30,0,["model"]],[30,0,["targetMessageId"]]]],null],[1,"\\n\\n"],[8,[39,1],null,null,[["default"],[[[[1,"\\n  "],[46,[28,[37,3],null,null],null,null,null],[1,"\\n"]],[]]]]]],[],false,["full-page-chat","chat-side-panel","component","-outlet"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-draft-channel",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"sufv3uW6",block:'[[[8,[39,0],null,null,null]],[],false,["chat-draft-channel-screen"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-draft-channel.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-index",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"Okro16df",block:'[[[8,[39,0],null,null,null]],[],false,["channels-list"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-index.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"Ypgs0gJG",block:'[[[10,0],[14,1,"chat-progress-bar-container"],[12],[13],[1,"\\n\\n"],[8,[39,0],null,null,null],[1,"\\n\\n"],[41,[30,0,["chat","sidebarActive"]],[[[1,"  "],[10,0],[14,0,"full-page-chat teams-sidebar-on"],[12],[1,"\\n    "],[46,[28,[37,3],null,null],null,null,null],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[1,"  "],[10,0],[15,0,[28,[37,4],["full-page-chat",[52,[30,0,["shouldUseCoreSidebar"]],"full-page-chat-sidebar-enabled"]],null]],[12],[1,"\\n"],[41,[30,0,["shouldUseChatSidebar"]],[[[1,"      "],[8,[39,5],null,null,null],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,1,"main-chat-outlet"],[15,0,[28,[37,4],["main-chat-outlet",[30,0,["mainOutletModifierClasses"]]],null]],[12],[1,"\\n      "],[46,[28,[37,3],null,null],null,null,null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]]]],[],false,["chat-vh","if","component","-outlet","concat-class","channels-list"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-channel-message-emoji-picker-connector",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"yzyIVLUg",block:'[[[8,[39,0],null,null,null]],[],false,["chat-channel-message-emoji-picker"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-channel-message-emoji-picker-connector.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-drawer-outlet",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"dBkEnbeG",block:'[[[10,0],[14,0,"chat-drawer-outlet-container"],[12],[1,"\\n  "],[8,[39,0],null,null,null],[1,"\\n"],[13]],[],false,["chat-drawer"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-drawer-outlet.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-desktop-outlet",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"6ho8SpDw",block:'[[[8,[39,0],null,null,null]],[],false,["chat-message-actions-desktop"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-desktop-outlet.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-mobile-outlet",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"dy8JR7Ux",block:'[[[8,[39,0],null,null,null]],[],false,["chat-message-actions-mobile"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-mobile-outlet.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/user-card-below-message-button/chat-button",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"6Q54Siix",block:'[[[41,[30,0,["user","can_chat_user"]],[[[1,"  "],[8,[39,1],null,[["@user"],[[30,0,["user"]]]],null],[1,"\\n"]],[]],null]],[],false,["if","chat/user-card-button"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/user-card-below-message-button/chat-button.hbs",isStrictMode:!1})}))
define("discourse/plugins/chat/discourse/templates/connectors/user-preferences-nav/chat-preferences",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"9kbPxOKI",block:'[[[10,"li"],[14,0,"user-nav__preferences-chat"],[12],[1,"\\n  "],[8,[39,0],null,[["@route"],["preferences.chat"]],[["default"],[[[[1,"\\n    "],[1,[28,[35,1],["d-chat"],null]],[1,"\\n    "],[10,1],[12],[1,[28,[35,2],["chat.title_capitalized"],null]],[13],[1,"\\n  "]],[]]]]],[1,"\\n"],[13]],[],false,["link-to","d-icon","i18n"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/user-preferences-nav/chat-preferences.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/preferences/chat",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"Z9h+n7xC",block:'[[[10,"label"],[14,0,"control-label"],[12],[1,[28,[35,0],["chat.title_capitalized"],null]],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting"],[14,"data-setting-name","user_chat_enabled"],[12],[1,"\\n  "],[10,"label"],[14,0,"controls"],[12],[1,"\\n    "],[8,[39,1],[[24,1,"user_chat_enabled"]],[["@type","@checked"],["checkbox",[30,0,["model","user_option","chat_enabled"]]]],null],[1,"\\n    "],[1,[28,[35,0],["chat.enable"],null]],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting"],[14,"data-setting-name","user_chat_only_push_notifications"],[12],[1,"\\n  "],[10,"label"],[14,0,"controls"],[12],[1,"\\n    "],[8,[39,1],[[24,1,"user_chat_only_push_notifications"]],[["@type","@checked"],["checkbox",[30,0,["model","user_option","only_chat_push_notifications"]]]],null],[1,"\\n    "],[1,[28,[35,0],["chat.only_chat_push_notifications.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,1],[14,0,"control-instructions"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.only_chat_push_notifications.description"],null]],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting"],[14,"data-setting-name","user_chat_ignore_channel_wide_mention"],[12],[1,"\\n  "],[10,"label"],[14,0,"controls"],[12],[1,"\\n    "],[8,[39,1],[[24,1,"user_chat_ignore_channel_wide_mention"]],[["@type","@checked"],["checkbox",[30,0,["model","user_option","ignore_channel_wide_mention"]]]],null],[1,"\\n    "],[1,[28,[35,0],["chat.ignore_channel_wide_mention.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,1],[14,0,"control-instructions"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.ignore_channel_wide_mention.description"],null]],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_sounds"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_sounds"],[12],[1,[28,[35,0],["chat.sound.title"],null]],[13],[1,"\\n  "],[8,[39,2],null,[["@options","@valueProperty","@content","@value","@id","@onChange"],[[28,[37,3],null,[["none"],["chat.sounds.none"]]],"value",[30,0,["chatSounds"]],[30,0,["model","user_option","chat_sound"]],"user_chat_sounds",[28,[37,4],[[30,0],"onChangeChatSound"],null]]],null],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_email_frequency"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_email_frequency"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.email_frequency.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[8,[39,2],null,[["@valueProperty","@content","@value","@id","@onChange"],["value",[30,0,["emailFrequencyOptions"]],[30,0,["model","user_option","chat_email_frequency"]],"user_chat_email_frequency",[28,[37,4],[[30,0],[28,[37,5],[[30,0,["model","user_option","chat_email_frequency"]]],null]],null]]],null],[1,"\\n"],[41,[28,[37,7],[[30,0,["model","user_option","chat_email_frequency"]],"when_away"],null],[[[1,"    "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n      "],[1,[28,[35,0],["chat.email_frequency.description"],null]],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_header_indicator_preference"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_header_indicator_preference"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.header_indicator_preference.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[8,[39,2],null,[["@valueProperty","@content","@value","@id","@onChange"],["value",[30,0,["headerIndicatorOptions"]],[30,0,["model","user_option","chat_header_indicator_preference"]],"user_chat_header_indicator_preference",[28,[37,4],[[30,0],[28,[37,5],[[30,0,["model","user_option","chat_header_indicator_preference"]]],null]],null]]],null],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_separate_sidebar_mode"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_separate_sidebar_mode"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.separate_sidebar_mode.title"],null]],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,2],null,[["@valueProperty","@content","@value","@id","@onChange"],["value",[30,0,["chatSeparateSidebarModeOptions"]],[30,0,["chatSeparateSidebarMode"]],"user_chat_separate_sidebar_mode",[28,[37,4],[[30,0],[28,[37,5],[[30,0,["model","user_option","chat_separate_sidebar_mode"]]],null]],null]]],null],[1,"\\n"],[13],[1,"\\n\\n"],[8,[39,8],null,[["@id","@model","@action","@saved"],["user_chat_preference_save",[30,0,["model"]],[28,[37,4],[[30,0],"save"],null],[30,0,["saved"]]]],null]],[],false,["i18n","input","combo-box","hash","action","mut","if","eq","save-controls"]]',moduleName:"discourse/plugins/chat/discourse/templates/preferences/chat.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/widgets/chat-header-icon",["exports","discourse/widgets/render-glimmer","discourse/widgets/widget","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,i.createWidget)("chat-header-icon",{tagName:"li.header-dropdown-toggle.chat-header-icon",services:["chat"],html(){if(this.chat.userCanChat)return[new t.default(this,"div.widget-component-connector",(0,n.createTemplateFactory)({id:"/OOwVHdi",block:'[[[8,[39,0],null,null,null]],[],false,["chat/header/icon"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/widgets/chat-header-icon.js",isStrictMode:!1}))]}})})),define("discourse/plugins/chat/discourse/widgets/chat-invitation-notification-item",["virtual-dom","discourse/lib/utilities","discourse/widgets/default-notification-item","discourse/widgets/raw-html","discourse/widgets/widget","discourse-common/lib/icon-library","discourse-i18n","discourse/plugins/chat/discourse/lib/slugify-channel"],(function(e,t,i,n,r,a,s,o){"use strict";(0,r.createWidgetFrom)(i.DefaultNotificationItem,"chat-invitation-notification-item",{services:["chat","router"],text(e){const i=(0,t.formatUsername)(e.invited_by_username)
return s.default.t("notifications.chat_invitation_html",{username:i})},html(t){const i=t.notification_type,r=this.site.get("notificationLookup")[i],{data:s}=t,o=this.text(s),l=this.notificationTitle(r,s),c=new n.default({html:`<div>${o}</div>`}),u=[(0,a.iconNode)("link"),c],d=this.url(s)
return(0,e.h)("a",{attributes:{title:l,href:d,"data-auto-route":!0}},u)},url(e){let t=`/chat/c/${(0,o.default)({title:e.chat_channel_title,slug:e.chat_channel_slug})||"-"}/${e.chat_channel_id}`
return e.chat_message_id&&(t+=`/${e.chat_message_id}`),t}})})),define("discourse/plugins/chat/discourse/widgets/chat-mention-notification-item",["virtual-dom","discourse/lib/utilities","discourse/widgets/default-notification-item","discourse/widgets/raw-html","discourse/widgets/widget","discourse-common/lib/icon-library","discourse-i18n","discourse/plugins/chat/discourse/lib/slugify-channel"],(function(e,t,i,n,r,a,s,o){"use strict"
const l={services:["chat","router"],text(e,i){const n=(0,t.formatUsername)(i.mentioned_by_username),r=i.identifier?`@${i.identifier}`:null,a=i.is_direct_message_channel?"notifications.popup.direct_message_chat_mention":"notifications.popup.chat_mention",o=r?"other_html":"direct_html"
return s.default.t(`${a}.${o}`,{username:n,identifier:r,channel:i.chat_channel_title})},html(t){const i=t.notification_type,r=this.site.get("notificationLookup")[i],{data:s}=t,o=this.notificationTitle(r,s),l=this.text(r,s),c=new n.default({html:`<div>${l}</div>`}),u=[(0,a.iconNode)("d-chat"),c],d=this.url(s)
return(0,e.h)("a",{attributes:{title:o,href:d,"data-auto-route":!0}},u)},url(e){let t=`/chat/c/${(0,o.default)({title:e.chat_channel_title,slug:e.chat_channel_slug})||"-"}/${e.chat_channel_id}`
return e.chat_thread_id?t+=`/t/${e.chat_thread_id}`:t+=`/${e.chat_message_id}`,t}};(0,r.createWidgetFrom)(i.DefaultNotificationItem,"chat-mention-notification-item",l),(0,r.createWidgetFrom)(i.DefaultNotificationItem,"chat-group-mention-notification-item",l)})),define("discourse/plugins/chat/lib/discourse-markdown/chat-transcript",["exports","pretty-text/emoji","discourse-i18n"],(function(e,t,i){"use strict"
let n
Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){e.allowList(["div[class=chat-transcript]","div[class=chat-transcript chat-transcript-chained]","div.chat-transcript-meta","div.chat-transcript-user","div.chat-transcript-username","div.chat-transcript-user-avatar","div.chat-transcript-messages","div.chat-transcript-datetime","div.chat-transcript-reactions","div.chat-transcript-reaction","span[title]","div[data-message-id]","div[data-channel-name]","div[data-channel-id]","div[data-username]","div[data-datetime]","a.chat-transcript-channel"]),e.registerOptions(((e,t)=>{e.features["chat-transcript"]=!!t.chat_enabled})),e.registerPlugin((e=>{e.options.discourse.features["chat-transcript"]&&e.block.bbcode.ruler.push("chat-transcript",r)})),e.buildCookFunction(((e,t)=>{if(!e.discourse.additionalOptions?.chat)return
const i=e.discourse.additionalOptions.chat,r=i.limited_pretty_text_markdown_rules.concat("image")
t({featuresOverride:i.limited_pretty_text_features,markdownItRules:r,hashtagLookup:e.discourse.hashtagLookup,hashtagTypesInPriorityOrder:i.hashtag_configurations["chat-composer"],hashtagIcons:e.discourse.hashtagIcons},(e=>{n=e}))}))}
const r={tag:"chat",replace:function(e,r,a){if(!n)return
const s=e.md.options.discourse,[o,l,c]=r.attrs.quote&&r.attrs.quote.split(";")||[],u=r.attrs.reactions,d=!!r.attrs.multiQuote,h=!!r.attrs.noLink,p=r.attrs.channel,m=r.attrs.channelId,b=m?s.getURL(`/chat/c/-/${m}`):null
if(!o||!l||!c)return
let g,f,v=e.push("div_chat_transcript_wrap","div",1),y=["chat-transcript"]
if(r.attrs.chained&&y.push("chat-transcript-chained"),v.attrs=[["class",y.join(" ")]],v.attrs.push(["data-message-id",l]),v.attrs.push(["data-username",o]),v.attrs.push(["data-datetime",c]),u&&v.attrs.push(["data-reactions",u]),p&&(v.attrs.push(["data-channel-name",p]),d)){e.push("div_chat_transcript_meta","div",1).attrs=[["class","chat-transcript-meta"]]
e.push("html_inline","",0).content=i.default.t("chat.quote.original_channel",{channel:p,channelLink:b}),e.push("div_chat_transcript_meta","div",-1)}if(m&&v.attrs.push(["data-channel-id",m]),e.push("div_chat_transcript_user","div",1).attrs=[["class","chat-transcript-user"]],e.push("div_chat_transcript_user_avatar","div",1).attrs=[["class","chat-transcript-user-avatar"]],s.lookupAvatar&&(g=s.lookupAvatar(o)),g){e.push("html_inline","",0).content=g}e.push("div_chat_transcript_user_avatar","div",-1),e.push("div_chat_transcript_username","div",1).attrs=[["class","chat-transcript-username"]],f=s.formatUsername?s.formatUsername(o):o
if(e.push("html_inline","",0).content=f,e.push("div_chat_transcript_username","div",-1),e.push("div_chat_transcript_datetime","div",1).attrs=[["class","chat-transcript-datetime"]],h||!b){let t=e.push("span_open","span",1)
t.attrs=[["title",c]],t.block=!1,t=e.push("span_close","span",-1),t.block=!1}else{let t=e.push("link_open","a",1)
t.attrs=[["href",`${b}/${l}`],["title",c]],t.block=!1,t=e.push("link_close","a",-1),t.block=!1}if(e.push("div_chat_transcript_datetime","div",-1),p&&!d){let t=e.push("link_open","a",1)
t.attrs=[["class","chat-transcript-channel"],["href",b]],e.push("html_inline","",0).content=`#${p}`,t=e.push("link_close","a",-1),t.block=!1}e.push("div_chat_transcript_user","div",-1),e.push("div_chat_transcript_messages","div",1).attrs=[["class","chat-transcript-messages"]]
if(e.push("html_raw","",1).content=n(a),e.push("html_raw","",-1),u){let i={}
e.push("div_chat_transcript_reactions","div",1).attrs=[["class","chat-transcript-reactions"]],u.split(";").forEach((n=>{const r=n.split(":"),a=r[0],o=r[1].split(",")
e.push("div_chat_transcript_reaction","div",1).attrs=[["class","chat-transcript-reaction"]]
const l=e.push("html_inline","",0)
i[a]||(i[a]=(0,t.performEmojiUnescape)(`:${a}:`,{getURL:s.getURL,emojiSet:s.emojiSet,emojiCDNUrl:s.emojiCDNUrl,enableEmojiShortcuts:s.enableEmojiShortcuts,inlineEmoji:s.inlineEmoji,lazy:!0})),l.content=`${i[a]} ${o.length.toString()}`,e.push("div_chat_transcript_reaction","div",-1)})),e.push("div_chat_transcript_reactions","div",-1)}return e.push("div_chat_transcript_messages","div",-1),e.push("div_chat_transcript_wrap","div",-1),!0}}})),define("discourse/plugins/chat/select-kit/addons/components/thread-notifications-button",["exports","select-kit/components/notifications-button","discourse/plugins/chat/discourse/lib/chat-notification-levels"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=t.default.extend({pluginApiIdentifiers:["thread-notifications-button"],classNames:["thread-notifications-button"],content:i.threadNotificationButtonLevels,selectKitOptions:{i18nPrefix:"chat.thread.notifications",showFullTitle:!1,btnCustomClasses:"btn-flat"}})}))

//# sourceMappingURL=chat-7a9ff0df4148aa72c09c6197ccc80954b77b9180ed6a927e5644be68bc7ee144.map
//!

;
