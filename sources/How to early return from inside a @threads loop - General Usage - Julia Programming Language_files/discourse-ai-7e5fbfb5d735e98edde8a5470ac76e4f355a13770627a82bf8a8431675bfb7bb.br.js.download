define("discourse/plugins/discourse-ai/discourse/components/ai-bot-header-panel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","I18n","discourse/plugins/discourse-ai/discourse/lib/ai-bot-helper","@ember/template-factory"],(function(e,t,i,r,o,n,s,a){"use strict"
var l,c,u,d
function p(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function m(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function g(e,t,i,r,o){var n={}
return Object.keys(r).forEach((function(e){n[e]=r[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,a.createTemplateFactory)({id:"69SBJZPC",block:'[[[10,0],[14,0,"bot-panel ai-bot-available-bot-options"],[12],[1,"\\n  "],[10,0],[14,0,"menu-panel drop-down"],[12],[1,"\\n    "],[10,0],[14,0,"panel-body"],[12],[1,"\\n      "],[10,0],[14,0,"panel-body-contents"],[12],[1,"\\n        "],[10,0],[14,0,"sidebar-hamburger-dropdown"],[12],[1,"\\n"],[42,[28,[37,1],[[28,[37,1],[[30,0,["botNames"]]],null]],null],null,[[[1,"            "],[8,[39,2],null,[["@class","@translatedTitle","@translatedLabel","@action"],["btn-flat ai-bot-available-bot-content",[30,1,["humanized"]],[30,1,["humanized"]],[28,[37,3],[[30,0],"composeMessageWithTargetBot",[30,1,["modelName"]]],null]]],null],[1,"\\n"]],[1]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],["bot"],false,["each","-track-array","d-button","action"]]',moduleName:"discourse/plugins/discourse-ai/discourse/components/ai-bot-header-panel.hbs",isStrictMode:!1})
let b=e.default=(d=new WeakSet,l=class extends i.default{constructor(){super(...arguments),m(this,d),p(this,"siteSettings",c,this),p(this,"composer",u,this)}composeMessageWithTargetBot(e){(function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i})(this,d,f).call(this,e)}get botNames(){return this.enabledBotOptions.map((e=>({humanized:n.default.t(`discourse_ai.ai_bot.bot_names.${e}`),modelName:e})))}get enabledBotOptions(){return this.siteSettings.ai_bot_enabled_chat_bots.split("|")}},c=g(l.prototype,"siteSettings",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=g(l.prototype,"composer",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g(l.prototype,"composeMessageWithTargetBot",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"composeMessageWithTargetBot"),l.prototype),l)
function f(e){this.args.closePanel(),(0,s.composeAiBotMessage)(e,this.composer)}(0,t.setComponentTemplate)(h,b)})),define("discourse/plugins/discourse-ai/discourse/components/ai-suggestion-dropdown",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/service","discourse/components/d-button","discourse/lib/ajax","discourse/lib/ajax-error","discourse-common/utils/decorators","I18n","@ember/template-factory","@ember/component"],(function(e,t,i,r,o,n,s,a,l,c,u,d,p){"use strict"
var m,g,h,b,f,y,_,v,w,S,O,T,P,j,E
function z(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function A(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function x(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var r=i.call(e,t||"default")
if("object"!=typeof r)return r
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function M(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function C(e,t,i,r,o){var n={}
return Object.keys(r).forEach((function(e){n[e]=r[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(T=new WeakSet,P=new WeakSet,j=new WeakSet,E=new WeakSet,O=class extends t.default{constructor(){super(...arguments),A(this,E),A(this,j),A(this,P),A(this,T),z(this,"dialog",g,this),z(this,"siteSettings",h,this),z(this,"composer",b,this),z(this,"loading",f,this),z(this,"showMenu",y,this),z(this,"generatedSuggestions",_,this),z(this,"suggestIcon",v,this),z(this,"showErrors",w,this),z(this,"error",S,this),x(this,"SUGGESTION_TYPES",{title:"suggest_title",category:"suggest_category",tag:"suggest_tags"})}willDestroy(){super.willDestroy(...arguments),document.removeEventListener("click",this.onClickOutside)}get showAIButton(){const e=this.composer.model.replyLength>40,t=document.querySelector(".composer-fields")
return t&&(e?t.classList.add("showing-ai-suggestions"):t.classList.remove("showing-ai-suggestions")),e}get disableSuggestionButton(){return this.loading}applyClasses(){this.showAIButton?document.querySelector(".composer-fields")?.classList.add("showing-ai-suggestions"):document.querySelector(".composer-fields")?.classList.remove("showing-ai-suggestions")}onClickOutside(e){const t=document.querySelector(".ai-title-suggestions-menu")
if(e.target!==t)return M(this,T,k).call(this)}handleClickOutside(){document.addEventListener("click",this.onClickOutside)}applySuggestion(e){if(!this.args.mode)return
const t=this.args?.composer
if(t){if(this.args.mode===this.SUGGESTION_TYPES.title)return t.set("title",e),M(this,T,k).call(this)
if(this.args.mode===this.SUGGESTION_TYPES.category){const i=this.composer.categories.find((t=>t.slug===e)).id
return t.set("categoryId",i),M(this,T,k).call(this)}this.args.mode===this.SUGGESTION_TYPES.tag&&M(this,P,I).call(this,e,t)}}async performSuggestion(){if(this.args.mode)return 0===this.composer.model.replyLength?this.dialog.alert(u.default.t("discourse_ai.ai_helper.missing_content")):(this.loading=!0,this.suggestIcon="spinner",(0,a.ajax)(`/discourse-ai/ai-helper/${this.args.mode}`,{method:"POST",data:{text:this.composer.model.reply}}).then((e=>{M(this,E,R).call(this,e,this.args.mode)})).catch(l.popupAjaxError).finally((()=>{this.loading=!1,this.suggestIcon="sync-alt",this.showMenu=!0,"suggest_category"===this.args.mode&&document.querySelector(".category-input")?.classList.add("showing-ai-suggestion-menu")})))}},(0,p.setComponentTemplate)((0,d.createTemplateFactory)({id:"jrGAyDMD",block:'[[[1,"\\n"],[41,[30,0,["showAIButton"]],[[[1,"      "],[8,[32,0],[[17,1]],[["@class","@icon","@title","@action","@disabled"],[[29,["suggestion-button ",[52,[30,0,["loading"]],"is-loading"]]],[30,0,["suggestIcon"]],"discourse_ai.ai_helper.suggest",[30,0,["performSuggestion"]],[30,0,["disableSuggestionButton"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["showMenu"]],[[[1,"      "],[11,"ul"],[24,0,"popup-menu ai-suggestions-menu"],[4,[32,1],[[30,0,["handleClickOutside"]]],null],[12],[1,"\\n"],[41,[30,0,["showErrors"]],[[[1,"          "],[10,"li"],[14,0,"ai-suggestions-menu__errors"],[12],[1,[30,0,["error"]]],[13],[1,"\\n"]],[]],null],[42,[28,[31,2],[[28,[31,2],[[30,0,["generatedSuggestions"]]],null]],null],null,[[[1,"          "],[10,"li"],[15,"data-name",[30,2]],[15,"data-value",[30,3]],[12],[1,"\\n            "],[8,[32,0],null,[["@class","@translatedLabel","@action","@actionParam"],["popup-menu-btn",[30,2],[30,0,["applySuggestion"]],[30,2]]],null],[1,"\\n          "],[13],[1,"\\n"]],[2,3]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["&attrs","suggestion","index"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-ai/discourse/components/ai-suggestion-dropdown.js",scope:()=>[s.default,o.default],isStrictMode:!0}),O),g=C((m=O).prototype,"dialog",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=C(m.prototype,"siteSettings",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=C(m.prototype,"composer",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=C(m.prototype,"loading",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=C(m.prototype,"showMenu",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_=C(m.prototype,"generatedSuggestions",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=C(m.prototype,"suggestIcon",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"discourse-sparkles"}}),w=C(m.prototype,"showErrors",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S=C(m.prototype,"error",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),C(m.prototype,"applyClasses",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"applyClasses"),m.prototype),C(m.prototype,"onClickOutside",[c.bind],Object.getOwnPropertyDescriptor(m.prototype,"onClickOutside"),m.prototype),C(m.prototype,"handleClickOutside",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"handleClickOutside"),m.prototype),C(m.prototype,"applySuggestion",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"applySuggestion"),m.prototype),C(m.prototype,"performSuggestion",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"performSuggestion"),m.prototype),m)
function k(){this.showMenu&&"suggest_category"===this.args.mode&&document.querySelector(".category-input")?.classList.remove("showing-ai-suggestion-menu"),this.suggestIcon="discourse-sparkles",this.showMenu=!1,this.showErrors=!1,this.errors=""}function I(e,t){const i=this.siteSettings.max_tags_per_topic
if(!t.tags)return t.set("tags",[e]),void(this.generatedSuggestions=this.generatedSuggestions.filter((t=>t!==e)))
const r=t.tags
return r?.length>=i?(this.showErrors=!0,void(this.error=u.default.t("select_kit.max_content_reached",{count:i}))):(r.push(e),t.set("tags",[...r]),this.generatedSuggestions=this.generatedSuggestions.filter((t=>t!==e)))}function N(){return this.args.composer?.tags&&this.args.composer?.tags.length>0}function R(e,t){if(t===this.SUGGESTION_TYPES.title)return this.generatedSuggestions=e.suggestions
const i=e.assistant.map((e=>e.name))
return t===this.SUGGESTION_TYPES.tag&&M(this,j,N).call(this)?this.generatedSuggestions=i.filter((e=>!this.args.composer.tags.includes(e))):this.generatedSuggestions=i}})),define("discourse/plugins/discourse-ai/discourse/components/modal/diff-modal",["exports","@glimmer/component","@ember/object","@ember/template","discourse/components/d-button","discourse/components/d-modal","I18n","@ember/template-factory","@ember/component"],(function(e,t,i,r,o,n,s,a,l){"use strict"
var c,u
function d(e,t,i,r,o){var n={}
return Object.keys(r).forEach((function(e){n[e]=r[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=s.default.t.bind(s.default)
e.default=(u=class extends t.default{triggerConfirmChanges(){this.args.closeModal(),this.args.confirm()}triggerRevertChanges(){this.args.closeModal(),this.args.revert()}},(0,l.setComponentTemplate)((0,a.createTemplateFactory)({id:"tqHStVL1",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"composer-ai-helper-modal"]],[["@title","@closeModal"],[[28,[32,1],["discourse_ai.ai_helper.context_menu.changes"],null],[30,1]]],[["body","footer"],[[[[1,"\\n"],[41,[30,2],[[[1,"          "],[1,[28,[32,2],[[30,2]],null]],[1,"\\n"]],[]],[[[1,"          "],[10,0],[14,0,"composer-ai-helper-modal__old-value"],[12],[1,"\\n            "],[1,[30,3]],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,0],[14,0,"composer-ai-helper-modal__new-value"],[12],[1,"\\n            "],[1,[30,4]],[1,"\\n          "],[13],[1,"\\n"]],[]]],[1,"      "]],[]],[[[1,"\\n        "],[8,[32,3],[[24,0,"btn-primary confirm"]],[["@action","@label"],[[30,0,["triggerConfirmChanges"]],"discourse_ai.ai_helper.context_menu.confirm"]],null],[1,"\\n        "],[8,[32,3],[[24,0,"btn-flat"]],[["@action","@label"],[[30,0,["triggerRevertChanges"]],"discourse_ai.ai_helper.context_menu.revert"]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@diff","@oldValue","@newValue"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-ai/discourse/components/modal/diff-modal.js",scope:()=>[n.default,p,r.htmlSafe,o.default],isStrictMode:!0}),u),d((c=u).prototype,"triggerConfirmChanges",[i.action],Object.getOwnPropertyDescriptor(c.prototype,"triggerConfirmChanges"),c.prototype),d(c.prototype,"triggerRevertChanges",[i.action],Object.getOwnPropertyDescriptor(c.prototype,"triggerRevertChanges"),c.prototype),c)})),define("discourse/plugins/discourse-ai/discourse/components/model-accuracies",["exports","@ember/component","@glimmer/component","@ember/template-factory"],(function(e,t,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"r8usWg+W",block:'[[[41,[30,1],[[[1,"  "],[10,"table"],[14,0,"reviewable-scores"],[12],[1,"\\n    "],[10,"tbody"],[12],[1,"\\n"],[42,[28,[37,2],[[30,1]],null],null,[[[1,"        "],[10,"tr"],[12],[1,"\\n          "],[10,"td"],[14,"colspan","4"],[12],[1,[28,[35,3],["discourse_ai.reviewables.model_used"],null]],[13],[1,"\\n          "],[10,"td"],[14,"colspan","3"],[12],[1,[30,3]],[13],[1,"\\n          "],[10,"td"],[14,"colspan","4"],[12],[1,[28,[35,3],["discourse_ai.reviewables.accuracy"],null]],[13],[1,"\\n          "],[10,"td"],[14,"colspan","3"],[12],[1,[30,2]],[1,"%"],[13],[1,"\\n        "],[13],[1,"\\n"]],[2,3]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@accuracies","acc","model"],false,["if","each","-each-in","i18n"]]',moduleName:"discourse/plugins/discourse-ai/discourse/components/model-accuracies.hbs",isStrictMode:!1})
class n extends i.default{}e.default=n,(0,t.setComponentTemplate)(o,n)})),define("discourse/plugins/discourse-ai/discourse/components/reviewable-ai-chat-message",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template-factory"],(function(e,t,i,r,o){"use strict"
var n,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,o.createTemplateFactory)({id:"XzIJVzLp",block:'[[[10,0],[14,0,"flagged-post-header"],[12],[1,"\\n  "],[8,[39,0],null,[["@route","@models"],["chat.channel.near-message",[28,[37,1],[[30,0,["chatChannel","slugifiedTitle"]],[30,0,["chatChannel","id"]],[30,1,["target_id"]]],null]]],[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@channel"],[[30,0,["chatChannel"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"post-contents-wrapper"],[12],[1,"\\n  "],[8,[39,3],null,[["@user","@tagName"],[[30,1,["target_created_by"]],""]],null],[1,"\\n  "],[10,0],[14,0,"post-contents"],[12],[1,"\\n    "],[8,[39,4],null,[["@reviewable","@createdBy","@tagName"],[[30,1],[30,1,["target_created_by"]],""]],null],[1,"\\n\\n    "],[10,0],[14,0,"post-body"],[12],[1,"\\n      "],[1,[28,[35,5],[[28,[37,6],[[30,1,["payload","message_cooked"]],[30,1,["cooked"]]],null]],null]],[1,"\\n    "],[13],[1,"\\n\\n    "],[18,2,null],[1,"\\n\\n    "],[8,[39,8],null,[["@accuracies"],[[30,1,["payload","accuracies"]]]],null],[1,"\\n  "],[13],[1,"\\n"],[13]],["@reviewable","&default"],false,["link-to","array","chat-channel-title","reviewable-created-by","reviewable-post-header","html-safe","or","yield","model-accuracies"]]',moduleName:"discourse/plugins/discourse-ai/discourse/components/reviewable-ai-chat-message.hbs",isStrictMode:!1})
let l=e.default=(n=class extends i.default{constructor(){var e,t,i,r
super(...arguments),e=this,t="store",r=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}get chatChannel(){return this.store.createRecord("chat-channel",this.args.reviewable.chat_channel)}},c=n.prototype,u="store",d=[r.inject],p={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(p).forEach((function(e){g[e]=p[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),g),m&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(m):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(c,u,g),g=null),s=g,n)
var c,u,d,p,m,g;(0,t.setComponentTemplate)(a,l)})),define("discourse/plugins/discourse-ai/discourse/components/reviewable-ai-post",["exports","@ember/component","@glimmer/component","@ember/template-factory"],(function(e,t,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"XJ3JIp4P",block:'[[[10,0],[14,0,"flagged-post-header"],[12],[1,"\\n  "],[8,[39,0],null,[["@reviewable","@tagName"],[[30,1],""]],null],[1,"\\n  "],[8,[39,1],null,[["@reviewable","@tagName"],[[30,1],""]],null],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"post-contents-wrapper"],[12],[1,"\\n  "],[8,[39,2],null,[["@user","@tagName"],[[30,1,["target_created_by"]],""]],null],[1,"\\n  "],[10,0],[14,0,"post-contents"],[12],[1,"\\n    "],[8,[39,3],null,[["@reviewable","@createdBy","@tagName"],[[30,1],[30,1,["target_created_by"]],""]],null],[1,"\\n    "],[10,0],[14,0,"post-body"],[12],[1,"\\n"],[41,[30,1,["blank_post"]],[[[1,"        "],[10,2],[12],[1,[28,[35,5],["review.deleted_post"],null]],[13],[1,"\\n"]],[]],[[[1,"        "],[1,[28,[35,6],[[30,1,["cooked"]]],null]],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n\\n    "],[18,2,null],[1,"\\n\\n    "],[8,[39,8],null,[["@accuracies"],[[30,1,["payload","accuracies"]]]],null],[1,"\\n  "],[13],[1,"\\n"],[13]],["@reviewable","&default"],false,["reviewable-topic-link","reviewable-post-edits","reviewable-created-by","reviewable-post-header","if","i18n","html-safe","yield","model-accuracies"]]',moduleName:"discourse/plugins/discourse-ai/discourse/components/reviewable-ai-post.hbs",isStrictMode:!1})
class n extends i.default{}e.default=n,(0,t.setComponentTemplate)(o,n)})),define("discourse/plugins/discourse-ai/discourse/connectors/after-composer-category-input/ai-category-suggestion",["exports","@glimmer/component","@ember/service","discourse/plugins/discourse-ai/discourse/components/ai-suggestion-dropdown","discourse/plugins/discourse-ai/discourse/lib/show-ai-helper","@ember/template-factory","@ember/component"],(function(e,t,i,r,o,n,s){"use strict"
var a,l,c
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(c=class extends t.default{constructor(){var e,t,i,r
super(...arguments),e=this,t="siteSettings",r=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}static shouldRender(e,t){return(0,o.showComposerAIHelper)(e,t)}},(0,s.setComponentTemplate)((0,n.createTemplateFactory)({id:"tgy79Whv",block:'[[[1,"\\n"],[41,[30,0,["siteSettings","ai_embeddings_enabled"]],[[[1,"      "],[8,[32,0],[[24,0,"suggest-category-button"]],[["@mode","@composer"],["suggest_category",[30,1,["composer"]]]],null],[1,"\\n"]],[]],null],[1,"  "]],["@outletArgs"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-ai/discourse/connectors/after-composer-category-input/ai-category-suggestion.js",scope:()=>[r.default],isStrictMode:!0}),c),u=(a=c).prototype,d="siteSettings",p=[i.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},h={},Object.keys(m).forEach((function(e){h[e]=m[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=p.slice().reverse().reduce((function(e,t){return t(u,d,e)||e}),h),g&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(g):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,d,h),h=null),l=h,a)
var u,d,p,m,g,h})),define("discourse/plugins/discourse-ai/discourse/connectors/after-composer-tag-input/ai-tag-suggestion",["exports","@glimmer/component","@ember/service","discourse/plugins/discourse-ai/discourse/components/ai-suggestion-dropdown","discourse/plugins/discourse-ai/discourse/lib/show-ai-helper","@ember/template-factory","@ember/component"],(function(e,t,i,r,o,n,s){"use strict"
var a,l,c
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(c=class extends t.default{constructor(){var e,t,i,r
super(...arguments),e=this,t="siteSettings",r=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}static shouldRender(e,t){return(0,o.showComposerAIHelper)(e,t)}},(0,s.setComponentTemplate)((0,n.createTemplateFactory)({id:"qB6wq01S",block:'[[[1,"\\n"],[41,[30,0,["siteSettings","ai_embeddings_enabled"]],[[[1,"      "],[8,[32,0],[[24,0,"suggest-tags-button"]],[["@mode","@composer"],["suggest_tags",[30,1,["composer"]]]],null],[1,"\\n"]],[]],null],[1,"  "]],["@outletArgs"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-ai/discourse/connectors/after-composer-tag-input/ai-tag-suggestion.js",scope:()=>[r.default],isStrictMode:!0}),c),u=(a=c).prototype,d="siteSettings",p=[i.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},h={},Object.keys(m).forEach((function(e){h[e]=m[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=p.slice().reverse().reduce((function(e,t){return t(u,d,e)||e}),h),g&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(g):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,d,h),h=null),l=h,a)
var u,d,p,m,g,h})),define("discourse/plugins/discourse-ai/discourse/connectors/after-composer-title-input/ai-title-suggestion",["exports","@glimmer/component","discourse/plugins/discourse-ai/discourse/components/ai-suggestion-dropdown","discourse/plugins/discourse-ai/discourse/lib/show-ai-helper","@ember/template-factory","@ember/component"],(function(e,t,i,r,o,n){"use strict"
var s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{static shouldRender(e,t){return(0,r.showComposerAIHelper)(e,t)}}e.default=a,s=a,(0,n.setComponentTemplate)((0,o.createTemplateFactory)({id:"4En7i5/x",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"suggest-titles-button"]],[["@mode","@composer"],["suggest_title",[30,1,["composer"]]]],null],[1,"\\n  "]],["@outletArgs"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-ai/discourse/connectors/after-composer-title-input/ai-title-suggestion.js",scope:()=>[i.default],isStrictMode:!0}),s)})),define("discourse/plugins/discourse-ai/discourse/connectors/after-d-editor/ai-helper-context-menu",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@popperjs/core","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/utilities","discourse-common/config/environment","discourse-common/utils/decorators","discourse/plugins/discourse-ai/discourse/lib/show-ai-helper"],(function(e,t,i,r,o,n,s,a,l,c,u,d){"use strict"
var p,m,g,h,b,f,y,_,v,w,S,O,T,P,j,E,z,A,x,M,C,k,I,N,R
function D(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function U(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var r=i.call(e,t||"default")
if("object"!=typeof r)return r
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function B(e,t,i,r,o){var n={}
return Object.keys(r).forEach((function(e){n[e]=r[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=(0,u.debounce)(c.INPUT_DELAY),m=class extends t.default{static shouldRender(e,t){return(0,d.showComposerAIHelper)(e,t)}constructor(){super(...arguments),D(this,"currentUser",g,this),D(this,"siteSettings",h,this),D(this,"helperOptions",b,this),D(this,"showContextMenu",f,this),D(this,"caretCoords",y,this),D(this,"virtualElement",_,this),D(this,"selectedText",v,this),D(this,"newSelectedText",w,this),D(this,"loading",S,this),D(this,"oldEditorValue",O,this),D(this,"newEditorValue",T,this),D(this,"lastUsedOption",P,this),D(this,"showDiffModal",j,this),D(this,"diff",E,this),D(this,"popperPlacement",z,this),D(this,"previousMenuState",A,this),D(this,"customPromptValue",x,this),U(this,"CONTEXT_MENU_STATES",{triggers:"TRIGGERS",options:"OPTIONS",resets:"RESETS",loading:"LOADING",review:"REVIEW"}),U(this,"prompts",[]),U(this,"promptTypes",{}),U(this,"minSelectionChars",3),D(this,"_menuState",M,this),D(this,"_popper",C,this),D(this,"_dEditorInput",k,this),D(this,"_customPromptInput",I,this),D(this,"_contextMenu",N,this),D(this,"_activeAIRequest",R,this),0===this.helperOptions.length&&this.loadPrompts()}willDestroy(){super.willDestroy(...arguments),document.removeEventListener("selectionchange",this.selectionChanged),document.removeEventListener("keydown",this.onKeyDown),this._popper?.destroy()}get menuState(){return this._menuState}set menuState(e){this.previousMenuState=this._menuState,this._menuState=e}async loadPrompts(){let e=await(0,s.ajax)("/discourse-ai/ai-helper/prompts")
e=e.filter((e=>e.location.includes("composer"))).filter((e=>"generate_titles"!==e.name))
const t=e.findIndex((e=>"custom_prompt"===e.name))
if(-1!==t){const i=e.splice(t,1)[0]
e.unshift(i)}this._showUserCustomPrompts()||(e=e.filter((e=>"custom_prompt"!==e.name))),e.forEach((e=>{this.prompts[e.id]=e})),this.promptTypes=e.reduce(((e,t)=>(e[t.name]=t.prompt_type,e)),{}),this.helperOptions=e}selectionChanged(){if(document.activeElement!==this._dEditorInput)return
const e=Boolean(window.getSelection()&&document.activeElement&&document.activeElement.value)
this.selectedText=e?document.activeElement.value.substring(document.activeElement.selectionStart,document.activeElement.selectionEnd):"",0!==this.selectedText?.length?this.selectedText?.length<this.minSelectionChars||this._onSelectionChanged():this.closeContextMenu()}updatePosition(){this.showContextMenu&&this.positionContextMenu()}onKeyDown(e){return(e.ctrlKey||e.metaKey)&&"z"===e.key&&this.oldEditorValue?this.undoAIAction():"Escape"===e.key?this.closeContextMenu():void 0}_onSelectionChanged(){this.positionContextMenu(),this.showContextMenu=!0}generateGetBoundingClientRect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0
return()=>({width:e,height:t,top:r,right:i,bottom:r,left:i})}get canCloseContextMenu(){return document.activeElement!==this._customPromptInput&&((!this.loading||null===this._activeAIRequest)&&this.menuState!==this.CONTEXT_MENU_STATES.review)}closeContextMenu(){this.canCloseContextMenu&&(this.showContextMenu=!1,this.menuState=this.CONTEXT_MENU_STATES.triggers,this.customPromptValue="")}_updateSuggestedByAI(e){const t=this.args.outletArgs.composer
this.oldEditorValue=this._dEditorInput.value,this.newSelectedText=e.suggestions[0],this.newEditorValue=this.oldEditorValue.replace(this.selectedText,this.newSelectedText),e.diff&&(this.diff=e.diff),t.set("reply",this.newEditorValue),this.menuState=this.CONTEXT_MENU_STATES.review}_toggleLoadingState(e){return e?(this._dEditorInput.classList.add("loading"),this.loading=!0):(this._dEditorInput.classList.remove("loading"),this.loading=!1)}_showUserCustomPrompts(){const e=this.siteSettings?.ai_helper_custom_prompts_allowed_groups.split("|").map((e=>parseInt(e,10)))
return this.currentUser?.groups.some((t=>e.includes(t.id)))}handleBoundaries(){const e=document.querySelector(".d-editor-textarea-wrapper").getBoundingClientRect(),t=document.querySelector(".d-editor-button-bar").getBoundingClientRect().bottom,i=e.bottom,r=this._contextMenu.getBoundingClientRect()
r.top<t||r.bottom>i?this._contextMenu.classList.add("out-of-bounds"):this._contextMenu.classList.remove("out-of-bounds"),this.caretCoords.y-r.height<t?this.popperPlacement="bottom-start":this.popperPlacement="top-start"}positionContextMenu(){this._contextMenu=document.querySelector(".ai-helper-context-menu"),this.caretCoords=(0,l.getCaretPosition)(this._dEditorInput,{pos:(0,l.caretPosition)(this._dEditorInput)}),this.handleBoundaries(),this.virtualElement={getBoundingClientRect:this.generateGetBoundingClientRect(this._contextMenu.clientWidth,this._contextMenu.clientHeight,this.caretCoords.x,this.caretCoords.y)},this._popper=(0,n.createPopper)(this.virtualElement,this._contextMenu,{placement:this.popperPlacement,modifiers:[{name:"offset",options:{offset:[10,0]}}]})}setupContextMenu(){document.addEventListener("selectionchange",this.selectionChanged),document.addEventListener("keydown",this.onKeyDown),this._dEditorInput=document.querySelector(".d-editor-input"),this._dEditorInput&&this._dEditorInput.addEventListener("scroll",this.updatePosition)}setupCustomPrompt(){this._customPromptInput=document.querySelector(".ai-custom-prompt__input"),this._customPromptInput.focus()}toggleAiHelperOptions(){0===this.helperOptions.length&&this.loadPrompts(),this.menuState=this.CONTEXT_MENU_STATES.options}undoAIAction(){this.args.outletArgs.composer.set("reply",this.oldEditorValue),this.menuState=this.CONTEXT_MENU_STATES.resets,this.closeContextMenu()}async updateSelected(e){return this._toggleLoadingState(!0),this.lastUsedOption=e,this.menuState=this.CONTEXT_MENU_STATES.loading,this._activeAIRequest=(0,s.ajax)("/discourse-ai/ai-helper/suggest",{method:"POST",data:{mode:e.id,text:this.selectedText,custom_prompt:this.customPromptValue}}),this._activeAIRequest.then((e=>{this.diff=null,this.newSelectedText=null,this._updateSuggestedByAI(e)})).catch(a.popupAjaxError).finally((()=>{this._toggleLoadingState(!1)})),this._activeAIRequest}viewChanges(){this.showDiffModal=!0}confirmChanges(){this.menuState=this.CONTEXT_MENU_STATES.resets}cancelAIAction(){this._activeAIRequest&&(this._activeAIRequest.abort(),this._activeAIRequest=null,this._toggleLoadingState(!1),this.closeContextMenu())}togglePreviousMenu(){this.menuState=this.previousMenuState}},g=B(m.prototype,"currentUser",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=B(m.prototype,"siteSettings",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=B(m.prototype,"helperOptions",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=B(m.prototype,"showContextMenu",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=B(m.prototype,"caretCoords",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=B(m.prototype,"virtualElement",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=B(m.prototype,"selectedText",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),w=B(m.prototype,"newSelectedText",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=B(m.prototype,"loading",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),O=B(m.prototype,"oldEditorValue",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=B(m.prototype,"newEditorValue",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=B(m.prototype,"lastUsedOption",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=B(m.prototype,"showDiffModal",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E=B(m.prototype,"diff",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=B(m.prototype,"popperPlacement",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"top-start"}}),A=B(m.prototype,"previousMenuState",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=B(m.prototype,"customPromptValue",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),M=B(m.prototype,"_menuState",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.CONTEXT_MENU_STATES.triggers}}),C=B(m.prototype,"_popper",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=B(m.prototype,"_dEditorInput",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=B(m.prototype,"_customPromptInput",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=B(m.prototype,"_contextMenu",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=B(m.prototype,"_activeAIRequest",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B(m.prototype,"selectionChanged",[u.bind],Object.getOwnPropertyDescriptor(m.prototype,"selectionChanged"),m.prototype),B(m.prototype,"updatePosition",[u.bind],Object.getOwnPropertyDescriptor(m.prototype,"updatePosition"),m.prototype),B(m.prototype,"onKeyDown",[u.bind],Object.getOwnPropertyDescriptor(m.prototype,"onKeyDown"),m.prototype),B(m.prototype,"_onSelectionChanged",[p],Object.getOwnPropertyDescriptor(m.prototype,"_onSelectionChanged"),m.prototype),B(m.prototype,"positionContextMenu",[u.afterRender],Object.getOwnPropertyDescriptor(m.prototype,"positionContextMenu"),m.prototype),B(m.prototype,"setupContextMenu",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"setupContextMenu"),m.prototype),B(m.prototype,"setupCustomPrompt",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"setupCustomPrompt"),m.prototype),B(m.prototype,"toggleAiHelperOptions",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"toggleAiHelperOptions"),m.prototype),B(m.prototype,"undoAIAction",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"undoAIAction"),m.prototype),B(m.prototype,"updateSelected",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"updateSelected"),m.prototype),B(m.prototype,"viewChanges",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"viewChanges"),m.prototype),B(m.prototype,"confirmChanges",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"confirmChanges"),m.prototype),B(m.prototype,"cancelAIAction",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"cancelAIAction"),m.prototype),B(m.prototype,"togglePreviousMenu",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"togglePreviousMenu"),m.prototype),m)})),define("discourse/plugins/discourse-ai/discourse/connectors/after-d-editor/composer-open",["exports","@glimmer/component","@ember/object","@ember/service","discourse-i18n"],(function(e,t,i,r,o){"use strict"
var n,s,a,l,c
function u(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function d(e,t,i,r,o){var n={}
return Object.keys(r).forEach((function(e){n[e]=r[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=(0,i.computed)("composerModel.targetRecipients","composerModel.title"),s=(0,i.computed)("composerModel.targetRecipients"),a=class extends t.default{constructor(){super(...arguments),u(this,"currentUser",l,this),u(this,"siteSettings",c,this)}get composerModel(){return this.args?.outletArgs?.composer}get renderChatWarning(){return this.siteSettings.ai_bot_enable_chat_warning}get aiBotClasses(){return this.composerModel?.title===o.default.t("discourse_ai.ai_bot.default_pm_prefix")?"ai-bot-chat":"ai-bot-pm"}get isAiBotChat(){if(this.composerModel&&this.composerModel.targetRecipients&&this.currentUser.ai_enabled_chat_bots){let e=this.composerModel.targetRecipients.split(",")
return this.currentUser.ai_enabled_chat_bots.any((t=>e.any((e=>e===t.username))))}return!1}},l=d(a.prototype,"currentUser",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=d(a.prototype,"siteSettings",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(a.prototype,"aiBotClasses",[n],Object.getOwnPropertyDescriptor(a.prototype,"aiBotClasses"),a.prototype),d(a.prototype,"isAiBotChat",[s],Object.getOwnPropertyDescriptor(a.prototype,"isAiBotChat"),a.prototype),a)})),define("discourse/plugins/discourse-ai/discourse/connectors/composer-fields/persona-selector",["exports","@glimmer/component","@ember/service"],(function(e,t,i){"use strict"
var r,o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends t.default{constructor(){var e,t,i,r
super(...arguments),e=this,t="currentUser",r=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}static shouldRender(e,t){return t?.currentUser?.ai_enabled_personas&&function(e,t){if(e&&e.targetRecipients&&t.ai_enabled_chat_bots){const i=e.targetRecipients.split(",")
return t.ai_enabled_chat_bots.any((e=>i.any((t=>t===e.username))))}return!1}(e.model,t.currentUser)}get composer(){return this.args?.outletArgs?.model}get botOptions(){if(this.currentUser.ai_enabled_personas)return this.currentUser.ai_enabled_personas.map((e=>({id:e.name,name:e.name,description:e.description})))}get value(){return this._value||this.botOptions[0].id}set value(e){this._value=e,this.composer.metaData={ai_persona:e}}},n=r.prototype,s="currentUser",a=[i.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=a.slice().reverse().reduce((function(e,t){return t(n,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(n,s,u),u=null),o=u,r)
var n,s,a,l,c,u})),define("discourse/plugins/discourse-ai/discourse/connectors/full-page-search-below-search-header/semantic-search",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/controllers/full-page-search","discourse/lib/ajax","discourse/lib/search","discourse-common/lib/debounce","discourse-common/utils/decorators","I18n"],(function(e,t,i,r,o,n,s,a,l,c,u){"use strict"
var d,p,m,g,h,b,f,y,_
function v(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function w(e,t,i,r,o){var n={}
return Object.keys(r).forEach((function(e){n[e]=r[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=(0,r.computed)("args.outletArgs.search"),p=(0,r.computed)("args.outletArgs.type","searchTerm"),m=(0,r.computed)("results"),g=class extends t.default{constructor(){super(...arguments),v(this,"appEvents",h,this),v(this,"siteSettings",b,this),v(this,"searching",f,this),v(this,"collapsedResults",y,this),v(this,"results",_,this)}static shouldRender(e,t){let{siteSettings:i}=t
return i.ai_embeddings_semantic_search_enabled}get searchTerm(){return this.args.outletArgs.search}get searchEnabled(){return this.args.outletArgs.type===n.SEARCH_TYPE_DEFAULT&&(0,a.isValidSearchTerm)(this.searchTerm,this.siteSettings)}get collapsedResultsTitle(){return u.default.t("discourse_ai.embeddings.semantic_search_results.toggle",{count:this.results.length})}setup(){this.appEvents.on("full-page-search:trigger-search",this,"debouncedSearch")}teardown(){this.appEvents.off("full-page-search:trigger-search",this,"debouncedSearch")}performHyDESearch(){this.searchEnabled&&(this.searching=!0,this.collapsedResults=!0,this.results=[],(0,s.ajax)("/discourse-ai/embeddings/semantic-search",{data:{q:this.searchTerm}}).then((async e=>{const t=await(0,a.translateResults)(e)||{}
this.results=t.posts})).finally((()=>this.searching=!1)))}debouncedSearch(){(0,l.default)(this,this.performHyDESearch,500)}},h=w(g.prototype,"appEvents",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=w(g.prototype,"siteSettings",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=w(g.prototype,"searching",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),y=w(g.prototype,"collapsedResults",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),_=w(g.prototype,"results",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),w(g.prototype,"searchTerm",[d],Object.getOwnPropertyDescriptor(g.prototype,"searchTerm"),g.prototype),w(g.prototype,"searchEnabled",[p],Object.getOwnPropertyDescriptor(g.prototype,"searchEnabled"),g.prototype),w(g.prototype,"collapsedResultsTitle",[m],Object.getOwnPropertyDescriptor(g.prototype,"collapsedResultsTitle"),g.prototype),w(g.prototype,"setup",[r.action],Object.getOwnPropertyDescriptor(g.prototype,"setup"),g.prototype),w(g.prototype,"teardown",[r.action],Object.getOwnPropertyDescriptor(g.prototype,"teardown"),g.prototype),w(g.prototype,"performHyDESearch",[c.bind],Object.getOwnPropertyDescriptor(g.prototype,"performHyDESearch"),g.prototype),w(g.prototype,"debouncedSearch",[r.action],Object.getOwnPropertyDescriptor(g.prototype,"debouncedSearch"),g.prototype),g)})),define("discourse/plugins/discourse-ai/discourse/connectors/post-text-buttons/ai-helper-options-menu",["exports","@glimmer/component","@glimmer/tracking","@ember/object","discourse/components/d-button","discourse/lib/ajax","discourse/lib/ajax-error","I18n","truth-helpers/helpers/eq","discourse/plugins/discourse-ai/discourse/lib/show-ai-helper","@ember/template-factory","@ember/component"],(function(e,t,i,r,o,n,s,a,l,c,u,d){"use strict"
var p,m,g,h,b,f,y,_
function v(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function w(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var r=i.call(e,t||"default")
if("object"!=typeof r)return r
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function S(e,t,i,r,o){var n={}
return Object.keys(r).forEach((function(e){n[e]=r[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const O=a.default.t.bind(a.default)
e.default=(_=class extends t.default{static shouldRender(e,t){return(0,c.showPostAIHelper)(e,t)}constructor(){super(...arguments),v(this,"helperOptions",m,this),v(this,"menuState",g,this),v(this,"loading",h,this),v(this,"suggestion",b,this),v(this,"showMainButtons",f,this),w(this,"MENU_STATES",{triggers:"TRIGGERS",options:"OPTIONS",loading:"LOADING",result:"RESULT"}),v(this,"_activeAIRequest",y,this),0===this.helperOptions.length&&this.loadPrompts()}async showAIHelperOptions(){this.showMainButtons=!1,this.menuState=this.MENU_STATES.options}async performAISuggestion(e){return this.menuState=this.MENU_STATES.loading,"Explain"===e.name?this._activeAIRequest=(0,n.ajax)("/discourse-ai/ai-helper/explain",{method:"POST",data:{mode:e.value,text:this.args.outletArgs.data.quoteState.buffer,post_id:this.args.outletArgs.data.quoteState.postId}}):this._activeAIRequest=(0,n.ajax)("/discourse-ai/ai-helper/suggest",{method:"POST",data:{mode:e.value,text:this.args.outletArgs.data.quoteState.buffer,custom_prompt:""}}),this._activeAIRequest.then((e=>{let{suggestions:t}=e
this.suggestion=t[0]})).catch(s.popupAjaxError).finally((()=>{this.loading=!1,this.menuState=this.MENU_STATES.result})),this._activeAIRequest}cancelAIAction(){this._activeAIRequest&&(this._activeAIRequest.abort(),this._activeAIRequest=null,this.loading=!1,this.menuState=this.MENU_STATES.options)}async loadPrompts(){let e=await(0,n.ajax)("/discourse-ai/ai-helper/prompts")
this.helperOptions=e.filter((e=>e.location.includes("post"))).map((e=>({name:e.translated_name,value:e.id,icon:e.icon})))}},(0,d.setComponentTemplate)((0,u.createTemplateFactory)({id:"eIk21umZ",block:'[[[1,"\\n"],[41,[30,0,["showMainButtons"]],[[[1,"      "],[18,2,null],[1,"\\n"]],[]],null],[1,"    "],[10,0],[14,0,"ai-post-helper"],[12],[1,"\\n"],[41,[28,[32,0],[[30,0,["menuState"]],[30,0,["MENU_STATES","triggers"]]],null],[[[1,"        "],[8,[32,1],null,[["@class","@icon","@label","@action"],["btn-flat ai-post-helper__trigger","discourse-sparkles","discourse_ai.ai_helper.post_options_menu.trigger",[30,0,["showAIHelperOptions"]]]],null],[1,"\\n\\n"]],[]],[[[41,[28,[32,0],[[30,0,["menuState"]],[30,0,["MENU_STATES","options"]]],null],[[[1,"        "],[10,0],[14,0,"ai-post-helper__options"],[12],[1,"\\n"],[42,[28,[31,3],[[28,[31,3],[[30,0,["helperOptions"]]],null]],null],null,[[[1,"            "],[8,[32,1],[[16,"data-name",[30,1,["name"]]],[16,"data-value",[30,1,["value"]]]],[["@class","@icon","@translatedLabel","@action","@actionParam"],["btn-flat",[30,1,["icon"]],[30,1,["name"]],[30,0,["performAISuggestion"]],[30,1]]],null],[1,"\\n"]],[1]],null],[1,"        "],[13],[1,"\\n\\n"]],[]],[[[41,[28,[32,0],[[30,0,["menuState"]],[30,0,["MENU_STATES","loading"]]],null],[[[1,"        "],[10,0],[14,0,"ai-helper-context-menu__loading"],[12],[1,"\\n          "],[10,0],[14,0,"dot-falling"],[12],[13],[1,"\\n          "],[10,1],[12],[1,"\\n            "],[1,[28,[32,2],["discourse_ai.ai_helper.context_menu.loading"],null]],[1,"\\n          "],[13],[1,"\\n          "],[8,[32,1],[[24,0,"btn-flat cancel-request"]],[["@icon","@title","@action"],["times","discourse_ai.ai_helper.context_menu.cancel",[30,0,["cancelAIAction"]]]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[41,[28,[32,0],[[30,0,["menuState"]],[30,0,["MENU_STATES","result"]]],null],[[[1,"        "],[10,0],[14,0,"ai-post-helper__suggestion"],[12],[1,[30,0,["suggestion"]]],[13],[1,"\\n      "]],[]],null]],[]]]],[]]]],[]]],[1,"    "],[13],[1,"\\n  "]],["option","&default"],false,["if","yield","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-ai/discourse/connectors/post-text-buttons/ai-helper-options-menu.js",scope:()=>[l.default,o.default,O],isStrictMode:!0}),_),m=S((p=_).prototype,"helperOptions",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),g=S(p.prototype,"menuState",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.MENU_STATES.triggers}}),h=S(p.prototype,"loading",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=S(p.prototype,"suggestion",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f=S(p.prototype,"showMainButtons",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),y=S(p.prototype,"_activeAIRequest",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S(p.prototype,"showAIHelperOptions",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"showAIHelperOptions"),p.prototype),S(p.prototype,"performAISuggestion",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"performAISuggestion"),p.prototype),S(p.prototype,"cancelAIAction",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"cancelAIAction"),p.prototype),p)})),define("discourse/plugins/discourse-ai/discourse/connectors/topic-more-content/related-topics",["exports","@glimmer/component","@ember/object","@ember/service","I18n"],(function(e,t,i,r,o){"use strict"
var n,s,a,l,c
function u(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function d(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var r=i.call(e,t||"default")
if("object"!=typeof r)return r
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p(e,t,i,r,o){var n={}
return Object.keys(r).forEach((function(e){n[e]=r[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=(0,i.computed)("moreTopicsPreferenceTracking.selectedTab"),s=class extends t.default{constructor(){super(...arguments),u(this,"store",a,this),u(this,"site",l,this),u(this,"moreTopicsPreferenceTracking",c,this),d(this,"listId","related-topics")}static shouldRender(e){return(e.model.related_topics?.length||0)>0}get hidden(){return this.moreTopicsPreferenceTracking.selectedTab!==this.listId}get relatedTopics(){return this.args.outletArgs.model.related_topics.map((e=>this.store.createRecord("topic",e)))}registerList(){this.moreTopicsPreferenceTracking.registerTopicList({name:o.default.t("discourse_ai.related_topics.pill"),id:this.listId,icon:"discourse-sparkles"})}removeList(){this.moreTopicsPreferenceTracking.removeTopicList(this.listId)}},a=p(s.prototype,"store",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=p(s.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=p(s.prototype,"moreTopicsPreferenceTracking",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(s.prototype,"hidden",[n],Object.getOwnPropertyDescriptor(s.prototype,"hidden"),s.prototype),p(s.prototype,"registerList",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"registerList"),s.prototype),p(s.prototype,"removeList",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"removeList"),s.prototype),s)})),define("discourse/plugins/discourse-ai/discourse/lib/ai-bot-helper",["exports","discourse/models/composer","I18n"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.composeAiBotMessage=function(e,r){let o=r.currentUser.ai_enabled_chat_bots.find((t=>t.model_name===e)).username
r.focusComposer({fallbackToNewTopic:!0,openOpts:{action:t.default.PRIVATE_MESSAGE,recipients:o,topicTitle:i.default.t("discourse_ai.ai_bot.default_pm_prefix"),archetypeId:"private_message",draftKey:t.default.NEW_PRIVATE_MESSAGE_KEY,hasGroups:!1,warningsDisabled:!0}})}})),define("discourse/plugins/discourse-ai/discourse/lib/show-ai-helper",["exports"],(function(e){"use strict"
function t(e){return e.discourse_ai_enabled&&e.composer_ai_helper_enabled}function i(e){return e.split("|").map((e=>parseInt(e,10)))}function r(e,t){return e?.groups.some((e=>t.includes(e.id)))}Object.defineProperty(e,"__esModule",{value:!0}),e.showComposerAIHelper=function(e,o){const n=t(o.siteSettings),s=r(o.currentUser,i(o.siteSettings.ai_helper_allowed_groups)),a=o.siteSettings.ai_helper_allowed_in_pm
if(e?.composer?.privateMessage)return n&&s&&a
return n&&s},e.showPostAIHelper=function(e,o){return t(o.siteSettings)&&r(o.currentUser,i(o.siteSettings.post_ai_helper_allowed_groups))}})),define("discourse/plugins/discourse-ai/discourse/templates/connectors/after-d-editor/ai-helper-context-menu",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"i8oDjfzG",block:'[[[11,0],[4,[38,0],[[30,0,["setupContextMenu"]]],null],[12],[1,"\\n"],[41,[30,0,["showContextMenu"]],[[[1,"    "],[10,0],[14,0,"ai-helper-context-menu"],[12],[1,"\\n"],[41,[28,[37,2],[[30,0,["menuState"]],[30,0,["CONTEXT_MENU_STATES","triggers"]]],null],[[[1,"        "],[10,"ul"],[14,0,"ai-helper-context-menu__trigger"],[12],[1,"\\n          "],[10,"li"],[12],[1,"\\n            "],[8,[39,3],[[24,0,"btn-flat"]],[["@icon","@action","@label"],["discourse-sparkles",[30,0,["toggleAiHelperOptions"]],"discourse_ai.ai_helper.context_menu.trigger"]],null],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n\\n"]],[]],[[[41,[28,[37,2],[[30,0,["menuState"]],[30,0,["CONTEXT_MENU_STATES","options"]]],null],[[[1,"        "],[10,"ul"],[14,0,"ai-helper-context-menu__options"],[12],[1,"\\n"],[42,[28,[37,5],[[28,[37,5],[[30,0,["helperOptions"]]],null]],null],null,[[[41,[28,[37,2],[[30,1,["name"]],"custom_prompt"],null],[[[1,"              "],[11,0],[24,0,"ai-custom-prompt"],[4,[38,0],[[30,0,["setupCustomPrompt"]]],null],[12],[1,"\\n                "],[8,[39,6],[[16,"placeholder",[28,[37,7],["discourse_ai.ai_helper.context_menu.custom_prompt.placeholder"],null]],[24,0,"ai-custom-prompt__input"]],[["@value","@enter"],[[30,0,["customPromptValue"]],[28,[37,8],[[30,0],[28,[37,9],[[30,0,["updateSelected"]],[30,1]],null]],null]]],null],[1,"\\n\\n                "],[8,[39,3],null,[["@class","@icon","@action","@actionParam","@disabled"],["ai-custom-prompt__submit btn-primary","discourse-sparkles",[30,0,["updateSelected"]],[30,1],[28,[37,10],[[30,0,["customPromptValue","length"]]],null]]],null],[1,"\\n              "],[13],[1,"\\n"]],[]],[[[1,"              "],[10,"li"],[15,"data-name",[30,1,["translated_name"]]],[15,"data-value",[30,1,["id"]]],[12],[1,"\\n                "],[8,[39,3],null,[["@icon","@class","@translatedLabel","@action","@actionParam"],[[30,1,["icon"]],"btn-flat",[30,1,["translated_name"]],[30,0,["updateSelected"]],[30,1]]],null],[1,"\\n              "],[13],[1,"\\n"]],[]]]],[1]],null],[1,"        "],[13],[1,"\\n\\n"]],[]],[[[41,[28,[37,2],[[30,0,["menuState"]],[30,0,["CONTEXT_MENU_STATES","loading"]]],null],[[[1,"        "],[10,0],[14,0,"ai-helper-context-menu__loading"],[12],[1,"\\n          "],[10,0],[14,0,"dot-falling"],[12],[13],[1,"\\n          "],[10,1],[12],[1,"\\n            "],[1,[28,[35,7],["discourse_ai.ai_helper.context_menu.loading"],null]],[1,"\\n          "],[13],[1,"\\n          "],[8,[39,3],[[24,0,"btn-flat cancel-request"]],[["@icon","@title","@action"],["times","discourse_ai.ai_helper.context_menu.cancel",[30,0,["cancelAIAction"]]]],null],[1,"\\n        "],[13],[1,"\\n\\n"]],[]],[[[41,[28,[37,2],[[30,0,["menuState"]],[30,0,["CONTEXT_MENU_STATES","review"]]],null],[[[1,"        "],[10,"ul"],[14,0,"ai-helper-context-menu__review"],[12],[1,"\\n          "],[10,"li"],[12],[1,"\\n            "],[8,[39,3],[[24,0,"btn-flat view-changes"]],[["@icon","@label","@action"],["exchange-alt","discourse_ai.ai_helper.context_menu.view_changes",[30,0,["viewChanges"]]]],null],[1,"\\n          "],[13],[1,"\\n          "],[10,"li"],[12],[1,"\\n            "],[8,[39,3],[[24,0,"btn-flat revert"]],[["@icon","@label","@action"],["undo","discourse_ai.ai_helper.context_menu.revert",[30,0,["undoAIAction"]]]],null],[1,"\\n          "],[13],[1,"\\n          "],[10,"li"],[12],[1,"\\n            "],[8,[39,3],[[24,0,"btn-flat confirm"]],[["@icon","@label","@action"],["check","discourse_ai.ai_helper.context_menu.confirm",[30,0,["confirmChanges"]]]],null],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n\\n"]],[]],[[[41,[28,[37,2],[[30,0,["menuState"]],[30,0,["CONTEXT_MENU_STATES","resets"]]],null],[[[1,"        "],[10,"ul"],[14,0,"ai-helper-context-menu__resets"],[12],[1,"\\n          "],[10,"li"],[12],[1,"\\n            "],[8,[39,3],[[24,0,"btn-flat undo"]],[["@icon","@label","@action"],["undo","discourse_ai.ai_helper.context_menu.undo",[30,0,["undoAIAction"]]]],null],[1,"\\n          "],[13],[1,"\\n          "],[10,"li"],[12],[1,"\\n            "],[8,[39,3],[[24,0,"btn-flat"]],[["@icon","@label","@action","@actionParam"],["discourse-sparkles","discourse_ai.ai_helper.context_menu.regen",[30,0,["updateSelected"]],[30,0,["lastUsedOption"]]]],null],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "]],[]],null]],[]]]],[]]]],[]]]],[]]],[1,"    "],[13],[1,"\\n"]],[]],null],[13],[1,"\\n\\n"],[41,[30,0,["showDiffModal"]],[[[1,"  "],[8,[39,11],null,[["@confirm","@diff","@oldValue","@newValue","@revert","@closeModal"],[[30,0,["confirmChanges"]],[30,0,["diff"]],[30,0,["selectedText"]],[30,0,["newSelectedText"]],[30,0,["undoAIAction"]],[28,[37,9],[[28,[37,12],[[30,0,["showDiffModal"]]],null],false],null]]],null],[1,"\\n"]],[]],null]],["option"],false,["did-insert","if","eq","d-button","each","-track-array","input","i18n","action","fn","not","modal/diff-modal","mut"]]',moduleName:"discourse/plugins/discourse-ai/discourse/templates/connectors/after-d-editor/ai-helper-context-menu.hbs",isStrictMode:!1})})),define("discourse/plugins/discourse-ai/discourse/templates/connectors/after-d-editor/composer-open",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"+kLlck0i",block:'[[[41,[30,0,["isAiBotChat"]],[[[1,"  "],[8,[39,1],null,[["@bodyClass"],[[30,0,["aiBotClasses"]]]],null],[1,"\\n"],[41,[30,0,["renderChatWarning"]],[[[1,"    "],[10,0],[14,0,"ai-bot-chat-warning"],[12],[1,[28,[35,2],["discourse_ai.ai_bot.pm_warning"],null]],[13],[1,"\\n"]],[]],null]],[]],null]],[],false,["if","d-section","i18n"]]',moduleName:"discourse/plugins/discourse-ai/discourse/templates/connectors/after-d-editor/composer-open.hbs",isStrictMode:!1})})),define("discourse/plugins/discourse-ai/discourse/templates/connectors/composer-fields/persona-selector",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"UslvXgsD",block:'[[[10,0],[14,0,"gpt-persona"],[12],[1,"\\n  "],[8,[39,0],null,[["@value","@content","@options"],[[30,0,["value"]],[30,0,["botOptions"]],[28,[37,1],null,[["icon"],["robot"]]]]],null],[1,"\\n"],[13]],[],false,["dropdown-select-box","hash"]]',moduleName:"discourse/plugins/discourse-ai/discourse/templates/connectors/composer-fields/persona-selector.hbs",isStrictMode:!1})})),define("discourse/plugins/discourse-ai/discourse/templates/connectors/full-page-search-below-search-header/semantic-search",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"nr3EYLso",block:'[[[41,[30,0,["searchEnabled"]],[[[1,"  "],[10,0],[14,0,"semantic-search__container search-results"],[14,"role","region"],[12],[1,"\\n    "],[11,0],[24,0,"semantic-search__results"],[4,[38,1],[[30,0,["setup"]]],null],[4,[38,1],[[30,0,["debouncedSearch"]]],null],[4,[38,2],[[30,0,["teardown"]]],null],[12],[1,"\\n"],[41,[30,0,["searching"]],[[[1,"        "],[10,0],[14,0,"semantic-search__searching"],[12],[1,"\\n          "],[10,0],[14,0,"semantic-search__searching-text"],[12],[1,"\\n            "],[1,[28,[35,3],["discourse_ai.embeddings.semantic_search_loading"],null]],[1,"\\n          "],[13],[1,"\\n          "],[10,1],[14,0,"semantic-search__indicator-wave"],[12],[1,"\\n            "],[10,1],[14,0,"semantic-search__indicator-dot"],[12],[1,"."],[13],[1,"\\n            "],[10,1],[14,0,"semantic-search__indicator-dot"],[12],[1,"."],[13],[1,"\\n            "],[10,1],[14,0,"semantic-search__indicator-dot"],[12],[1,"."],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[41,[30,0,["results","length"]],[[[1,"          "],[10,0],[14,0,"semantic-search__toggle-button-container"],[12],[1,"\\n            "],[8,[39,4],null,[["@translatedTitle","@translatedLabel","@action","@class","@icon"],[[30,0,["collapsedResultsTitle"]],[30,0,["collapsedResultsTitle"]],[28,[37,5],[[28,[37,6],[[30,0,["collapsedResults"]]],null],[28,[37,7],[[30,0,["collapsedResults"]]],null]],null],"btn-flat",[52,[30,0,["collapsedResults"]],"chevron-right","chevron-down"]]],null],[1,"\\n          "],[13],[1,"\\n\\n"],[41,[51,[30,0,["collapsedResults"]]],[[[1,"            "],[10,0],[14,0,"semantic-search__entries"],[12],[1,"\\n              "],[8,[39,9],null,[["@posts","@highlightQuery"],[[30,0,["results"]],[30,0,["highlightQuery"]]]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],null]],[]],[[[1,"          "],[10,0],[14,0,"semantic-search__searching"],[12],[1,"\\n            "],[1,[28,[35,3],["discourse_ai.embeddings.semantic_search_results.none"],null]],[1,"\\n          "],[13],[1,"\\n"]],[]]]],[]]],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","did-insert","will-destroy","i18n","d-button","fn","mut","not","unless","search-result-entries"]]',moduleName:"discourse/plugins/discourse-ai/discourse/templates/connectors/full-page-search-below-search-header/semantic-search.hbs",isStrictMode:!1})})),define("discourse/plugins/discourse-ai/discourse/templates/connectors/topic-more-content/related-topics",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"6Oz8VQA3",block:'[[[11,0],[24,1,"related-topics"],[16,0,[29,["more-topics__list ",[52,[30,0,["hidden"]],"hidden"]]]],[24,"role","complementary"],[24,"aria-labelledby","related-topics-title"],[4,[38,1],[[30,0,["registerList"]]],null],[4,[38,2],[[30,0,["removeList"]]],null],[12],[1,"\\n  "],[10,"h3"],[14,1,"related-topics-title"],[14,0,"more-topics__list-title"],[12],[1,"\\n    "],[1,[28,[35,3],["discourse_ai.related_topics.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"topics"],[12],[1,"\\n    "],[8,[39,4],null,[["@topics"],[[30,0,["relatedTopics"]]]],null],[1,"\\n  "],[13],[1,"\\n"],[13]],[],false,["if","did-insert","will-destroy","i18n","basic-topic-list"]]',moduleName:"discourse/plugins/discourse-ai/discourse/templates/connectors/topic-more-content/related-topics.hbs",isStrictMode:!1})})),define("discourse/plugins/discourse-ai/discourse/widgets/ai-bot-header-panel-wrapper",["exports","@ember/object","discourse/widgets/render-glimmer","discourse/widgets/widget","@ember/template-factory"],(function(e,t,i,r,o){"use strict"
var n
function s(e,t,i,r,o){var n={}
return Object.keys(r).forEach((function(e){n[e]=r[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(s((n=class extends r.default{buildAttributes(){return{"data-click-outside":!0}}html(){return[new i.default(this,"div.widget-component-connector",(0,o.createTemplateFactory)({id:"w7fEG46j",block:'[[[8,[39,0],null,[["@closePanel"],[[30,1,["closePanel"]]]],null]],["@data"],false,["ai-bot-header-panel"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-ai/discourse/widgets/ai-bot-header-panel-wrapper.js",isStrictMode:!1}),{closePanel:this.closePanel})]}closePanel(){this.sendWidgetAction("hideAiBotPanel")}clickOutside(){this.closePanel()}}).prototype,"closePanel",[t.action],Object.getOwnPropertyDescriptor(n.prototype,"closePanel"),n.prototype),s(n.prototype,"clickOutside",[t.action],Object.getOwnPropertyDescriptor(n.prototype,"clickOutside"),n.prototype),n)})),define("discourse/plugins/discourse-ai/initializers/ai-bot-replies",["exports","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/load-script","discourse/lib/plugin-api","discourse/lib/text","discourse/widgets/render-glimmer","discourse/plugins/discourse-ai/discourse/lib/ai-bot-helper","@ember/template-factory"],(function(e,t,i,r,o,n,s,a,l){"use strict"
function c(e){return e&&[-110,-111,-112].includes(e.id)}function u(e){const t=e.container.lookup("service:site-settings"),i=t.ai_bot_add_to_header?t.ai_bot_enabled_chat_bots.split("|").filter(Boolean):[]
i.length>0&&(e.attachWidgetAction("header","showAiBotPanel",(function(){this.state.botSelectorVisible=!0})),e.attachWidgetAction("header","hideAiBotPanel",(function(){this.state.botSelectorVisible=!1})),e.decorateWidget("header-icons:before",(e=>e.attach("header-dropdown",{title:"discourse_ai.ai_bot.shortcut_title",icon:"robot",action:"clickStartAiBotChat",active:!1,classNames:["ai-bot-button"]}))),1===i.length?e.attachWidgetAction("header","clickStartAiBotChat",(function(){(0,a.composeAiBotMessage)(i[0],e.container.lookup("service:composer"))})):e.attachWidgetAction("header","clickStartAiBotChat",(function(){this.sendWidgetAction("showAiBotPanel")})),e.addHeaderPanel("ai-bot-header-panel-wrapper","botSelectorVisible",(function(){return{}})))}function d(e){e.addPostMenuButton("cancel-gpt",(e=>{if(c(e.user))return{icon:"pause",action:"cancelStreaming",title:"discourse_ai.ai_bot.cancel_streaming",className:"btn btn-default cancel-streaming",position:"first"}})),e.attachWidgetAction("post","cancelStreaming",(function(){(0,t.ajax)(`/discourse-ai/ai-bot/post/${this.model.id}/stop-streaming`,{type:"POST"}).then((()=>{document.querySelector(`#post_${this.model.post_number}`).classList.remove("streaming")})).catch(i.popupAjaxError)})),e.modifyClass("controller:topic",{pluginId:"discourse-ai",onAIBotStreamedReply:function(e){const t=this.model.postStream.findLoadedPost(e.post_id)
t&&(e.raw&&(0,n.cook)(e.raw).then((i=>{t.set("raw",e.raw),t.set("cooked",i),document.querySelector(`#post_${e.post_number}`).classList.add("streaming")
const o=document.createElement("div")
o.innerHTML=i
let n=document.querySelector(`#post_${e.post_number} .cooked`);(0,r.default)("/javascripts/diffhtml.min.js").then((()=>{window.diff.innerHTML(n,o.innerHTML)}))})),e.done&&document.querySelector(`#post_${e.post_number}`).classList.remove("streaming"))},subscribe:function(){this._super(),this.model.isPrivateMessage&&this.model.details.allowed_users&&this.model.details.allowed_users.filter(c).length>=1&&this.messageBus.subscribe(`discourse-ai/ai-bot/topic/${this.model.id}`,this.onAIBotStreamedReply.bind(this))},unsubscribe:function(){this.messageBus.unsubscribe("discourse-ai/ai-bot/topic/*"),this._super()}})}function p(e){let t=null
e.decorateWidget("poster-name:after",(i=>{if(c(i.attrs.user))return t=t||e.container.lookup("controller:topic"),i.widget.attach("persona-flair",{topicController:t})})),(0,s.registerWidgetShim)("persona-flair","span.persona-flair",(0,l.createTemplateFactory)({id:"9jYzNJdM",block:'[[[1,[30,1,["topicController","model","ai_persona_name"]]]],["@data"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-ai/initializers/ai-bot-replies.js",isStrictMode:!1}))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"discourse-ai-bot-replies",initialize(e){const t=e.lookup("service:site-settings"),i=e.lookup("service:current-user")
i?.ai_enabled_chat_bots&&(t.ai_bot_add_to_header&&(0,o.withPluginApi)("1.6.0",u),(0,o.withPluginApi)("1.6.0",d),(0,o.withPluginApi)("1.6.0",p))}}})),define("discourse/plugins/discourse-ai/initializers/related-topics",["exports","discourse/lib/plugin-api"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"discourse-ai-related-topics",initialize(e){e.lookup("service:site-settings").ai_embeddings_semantic_related_topics_enabled&&(0,t.withPluginApi)("1.1.0",(e=>{e.modifyClass("model:post-stream",{pluginId:"discourse-ai",_setSuggestedTopics(e){this._super(...arguments),e.related_topics&&this.topic.setProperties({related_topics:e.related_topics})}})}))}}}))

//# sourceMappingURL=discourse-ai-fbe6fb76ae131743feccb68ebf0e13507dbde4d4fbebb9eb7bf4c3232faa6d05.map
//!

;
